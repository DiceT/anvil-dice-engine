(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();function v_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var vp={exports:{}},Gl={};var Jv;function RM(){if(Jv)return Gl;Jv=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,a,o){var c=null;if(o!==void 0&&(c=""+o),a.key!==void 0&&(c=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:n,type:i,key:c,ref:a!==void 0?a:null,props:o}}return Gl.Fragment=t,Gl.jsx=e,Gl.jsxs=e,Gl}var Kv;function NM(){return Kv||(Kv=1,vp.exports=RM()),vp.exports}var rt=NM(),xp={exports:{}},$t={};var $v;function zM(){if($v)return $t;$v=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),g=Symbol.iterator;function v(D){return D===null||typeof D!="object"?null:(D=g&&D[g]||D["@@iterator"],typeof D=="function"?D:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,S={};function w(D,q,ut){this.props=D,this.context=q,this.refs=S,this.updater=ut||x}w.prototype.isReactComponent={},w.prototype.setState=function(D,q){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,q,"setState")},w.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function _(){}_.prototype=w.prototype;function L(D,q,ut){this.props=D,this.context=q,this.refs=S,this.updater=ut||x}var R=L.prototype=new _;R.constructor=L,M(R,w.prototype),R.isPureReactComponent=!0;var C=Array.isArray;function A(){}var B={H:null,A:null,T:null,S:null},Y=Object.prototype.hasOwnProperty;function X(D,q,ut){var yt=ut.ref;return{$$typeof:n,type:D,key:q,ref:yt!==void 0?yt:null,props:ut}}function st(D,q){return X(D.type,q,D.props)}function V(D){return typeof D=="object"&&D!==null&&D.$$typeof===n}function j(D){var q={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ut){return q[ut]})}var I=/\/+/g;function H(D,q){return typeof D=="object"&&D!==null&&D.key!=null?j(""+D.key):q.toString(36)}function U(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(A,A):(D.status="pending",D.then(function(q){D.status==="pending"&&(D.status="fulfilled",D.value=q)},function(q){D.status==="pending"&&(D.status="rejected",D.reason=q)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function z(D,q,ut,yt,tt){var Ct=typeof D;(Ct==="undefined"||Ct==="boolean")&&(D=null);var bt=!1;if(D===null)bt=!0;else switch(Ct){case"bigint":case"string":case"number":bt=!0;break;case"object":switch(D.$$typeof){case n:case t:bt=!0;break;case m:return bt=D._init,z(bt(D._payload),q,ut,yt,tt)}}if(bt)return tt=tt(D),bt=yt===""?"."+H(D,0):yt,C(tt)?(ut="",bt!=null&&(ut=bt.replace(I,"$&/")+"/"),z(tt,q,ut,"",function(Qt){return Qt})):tt!=null&&(V(tt)&&(tt=st(tt,ut+(tt.key==null||D&&D.key===tt.key?"":(""+tt.key).replace(I,"$&/")+"/")+bt)),q.push(tt)),1;bt=0;var Ht=yt===""?".":yt+":";if(C(D))for(var Lt=0;Lt<D.length;Lt++)yt=D[Lt],Ct=Ht+H(yt,Lt),bt+=z(yt,q,ut,Ct,tt);else if(Lt=v(D),typeof Lt=="function")for(D=Lt.call(D),Lt=0;!(yt=D.next()).done;)yt=yt.value,Ct=Ht+H(yt,Lt++),bt+=z(yt,q,ut,Ct,tt);else if(Ct==="object"){if(typeof D.then=="function")return z(U(D),q,ut,yt,tt);throw q=String(D),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return bt}function Q(D,q,ut){if(D==null)return D;var yt=[],tt=0;return z(D,yt,"","",function(Ct){return q.call(ut,Ct,tt++)}),yt}function $(D){if(D._status===-1){var q=D._result;q=q(),q.then(function(ut){(D._status===0||D._status===-1)&&(D._status=1,D._result=ut)},function(ut){(D._status===0||D._status===-1)&&(D._status=2,D._result=ut)}),D._status===-1&&(D._status=0,D._result=q)}if(D._status===1)return D._result.default;throw D._result}var it=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},ct={map:Q,forEach:function(D,q,ut){Q(D,function(){q.apply(this,arguments)},ut)},count:function(D){var q=0;return Q(D,function(){q++}),q},toArray:function(D){return Q(D,function(q){return q})||[]},only:function(D){if(!V(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return $t.Activity=p,$t.Children=ct,$t.Component=w,$t.Fragment=e,$t.Profiler=a,$t.PureComponent=L,$t.StrictMode=i,$t.Suspense=h,$t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,$t.__COMPILER_RUNTIME={__proto__:null,c:function(D){return B.H.useMemoCache(D)}},$t.cache=function(D){return function(){return D.apply(null,arguments)}},$t.cacheSignal=function(){return null},$t.cloneElement=function(D,q,ut){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var yt=M({},D.props),tt=D.key;if(q!=null)for(Ct in q.key!==void 0&&(tt=""+q.key),q)!Y.call(q,Ct)||Ct==="key"||Ct==="__self"||Ct==="__source"||Ct==="ref"&&q.ref===void 0||(yt[Ct]=q[Ct]);var Ct=arguments.length-2;if(Ct===1)yt.children=ut;else if(1<Ct){for(var bt=Array(Ct),Ht=0;Ht<Ct;Ht++)bt[Ht]=arguments[Ht+2];yt.children=bt}return X(D.type,tt,yt)},$t.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:o,_context:D},D},$t.createElement=function(D,q,ut){var yt,tt={},Ct=null;if(q!=null)for(yt in q.key!==void 0&&(Ct=""+q.key),q)Y.call(q,yt)&&yt!=="key"&&yt!=="__self"&&yt!=="__source"&&(tt[yt]=q[yt]);var bt=arguments.length-2;if(bt===1)tt.children=ut;else if(1<bt){for(var Ht=Array(bt),Lt=0;Lt<bt;Lt++)Ht[Lt]=arguments[Lt+2];tt.children=Ht}if(D&&D.defaultProps)for(yt in bt=D.defaultProps,bt)tt[yt]===void 0&&(tt[yt]=bt[yt]);return X(D,Ct,tt)},$t.createRef=function(){return{current:null}},$t.forwardRef=function(D){return{$$typeof:u,render:D}},$t.isValidElement=V,$t.lazy=function(D){return{$$typeof:m,_payload:{_status:-1,_result:D},_init:$}},$t.memo=function(D,q){return{$$typeof:d,type:D,compare:q===void 0?null:q}},$t.startTransition=function(D){var q=B.T,ut={};B.T=ut;try{var yt=D(),tt=B.S;tt!==null&&tt(ut,yt),typeof yt=="object"&&yt!==null&&typeof yt.then=="function"&&yt.then(A,it)}catch(Ct){it(Ct)}finally{q!==null&&ut.types!==null&&(q.types=ut.types),B.T=q}},$t.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},$t.use=function(D){return B.H.use(D)},$t.useActionState=function(D,q,ut){return B.H.useActionState(D,q,ut)},$t.useCallback=function(D,q){return B.H.useCallback(D,q)},$t.useContext=function(D){return B.H.useContext(D)},$t.useDebugValue=function(){},$t.useDeferredValue=function(D,q){return B.H.useDeferredValue(D,q)},$t.useEffect=function(D,q){return B.H.useEffect(D,q)},$t.useEffectEvent=function(D){return B.H.useEffectEvent(D)},$t.useId=function(){return B.H.useId()},$t.useImperativeHandle=function(D,q,ut){return B.H.useImperativeHandle(D,q,ut)},$t.useInsertionEffect=function(D,q){return B.H.useInsertionEffect(D,q)},$t.useLayoutEffect=function(D,q){return B.H.useLayoutEffect(D,q)},$t.useMemo=function(D,q){return B.H.useMemo(D,q)},$t.useOptimistic=function(D,q){return B.H.useOptimistic(D,q)},$t.useReducer=function(D,q,ut){return B.H.useReducer(D,q,ut)},$t.useRef=function(D){return B.H.useRef(D)},$t.useState=function(D){return B.H.useState(D)},$t.useSyncExternalStore=function(D,q,ut){return B.H.useSyncExternalStore(D,q,ut)},$t.useTransition=function(){return B.H.useTransition()},$t.version="19.2.1",$t}var tx;function qm(){return tx||(tx=1,xp.exports=zM()),xp.exports}var _e=qm();const BM=v_(_e);var bp={exports:{}},Vl={},_p={exports:{}},wp={};var ex;function DM(){return ex||(ex=1,(function(n){function t(z,Q){var $=z.length;z.push(Q);t:for(;0<$;){var it=$-1>>>1,ct=z[it];if(0<a(ct,Q))z[it]=Q,z[$]=ct,$=it;else break t}}function e(z){return z.length===0?null:z[0]}function i(z){if(z.length===0)return null;var Q=z[0],$=z.pop();if($!==Q){z[0]=$;t:for(var it=0,ct=z.length,D=ct>>>1;it<D;){var q=2*(it+1)-1,ut=z[q],yt=q+1,tt=z[yt];if(0>a(ut,$))yt<ct&&0>a(tt,ut)?(z[it]=tt,z[yt]=$,it=yt):(z[it]=ut,z[q]=$,it=q);else if(yt<ct&&0>a(tt,$))z[it]=tt,z[yt]=$,it=yt;else break t}}return Q}function a(z,Q){var $=z.sortIndex-Q.sortIndex;return $!==0?$:z.id-Q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();n.unstable_now=function(){return c.now()-u}}var h=[],d=[],m=1,p=null,g=3,v=!1,x=!1,M=!1,S=!1,w=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function R(z){for(var Q=e(d);Q!==null;){if(Q.callback===null)i(d);else if(Q.startTime<=z)i(d),Q.sortIndex=Q.expirationTime,t(h,Q);else break;Q=e(d)}}function C(z){if(M=!1,R(z),!x)if(e(h)!==null)x=!0,A||(A=!0,j());else{var Q=e(d);Q!==null&&U(C,Q.startTime-z)}}var A=!1,B=-1,Y=5,X=-1;function st(){return S?!0:!(n.unstable_now()-X<Y)}function V(){if(S=!1,A){var z=n.unstable_now();X=z;var Q=!0;try{t:{x=!1,M&&(M=!1,_(B),B=-1),v=!0;var $=g;try{e:{for(R(z),p=e(h);p!==null&&!(p.expirationTime>z&&st());){var it=p.callback;if(typeof it=="function"){p.callback=null,g=p.priorityLevel;var ct=it(p.expirationTime<=z);if(z=n.unstable_now(),typeof ct=="function"){p.callback=ct,R(z),Q=!0;break e}p===e(h)&&i(h),R(z)}else i(h);p=e(h)}if(p!==null)Q=!0;else{var D=e(d);D!==null&&U(C,D.startTime-z),Q=!1}}break t}finally{p=null,g=$,v=!1}Q=void 0}}finally{Q?j():A=!1}}}var j;if(typeof L=="function")j=function(){L(V)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,H=I.port2;I.port1.onmessage=V,j=function(){H.postMessage(null)}}else j=function(){w(V,0)};function U(z,Q){B=w(function(){z(n.unstable_now())},Q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(z){z.callback=null},n.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<z?Math.floor(1e3/z):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_next=function(z){switch(g){case 1:case 2:case 3:var Q=3;break;default:Q=g}var $=g;g=Q;try{return z()}finally{g=$}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function(z,Q){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var $=g;g=z;try{return Q()}finally{g=$}},n.unstable_scheduleCallback=function(z,Q,$){var it=n.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?it+$:it):$=it,z){case 1:var ct=-1;break;case 2:ct=250;break;case 5:ct=1073741823;break;case 4:ct=1e4;break;default:ct=5e3}return ct=$+ct,z={id:m++,callback:Q,priorityLevel:z,startTime:$,expirationTime:ct,sortIndex:-1},$>it?(z.sortIndex=$,t(d,z),e(h)===null&&z===e(d)&&(M?(_(B),B=-1):M=!0,U(C,$-it))):(z.sortIndex=ct,t(h,z),x||v||(x=!0,A||(A=!0,j()))),z},n.unstable_shouldYield=st,n.unstable_wrapCallback=function(z){var Q=g;return function(){var $=g;g=Q;try{return z.apply(this,arguments)}finally{g=$}}}})(wp)),wp}var nx;function OM(){return nx||(nx=1,_p.exports=DM()),_p.exports}var Mp={exports:{}},wn={};var ix;function PM(){if(ix)return wn;ix=1;var n=qm();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,d,m){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:h,containerInfo:d,implementation:m}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,wn.createPortal=function(h,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return o(h,d,null,m)},wn.flushSync=function(h){var d=c.T,m=i.p;try{if(c.T=null,i.p=2,h)return h()}finally{c.T=d,i.p=m,i.d.f()}},wn.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(h,d))},wn.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},wn.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var m=d.as,p=u(m,d.crossOrigin),g=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?i.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:g,fetchPriority:v}):m==="script"&&i.d.X(h,{crossOrigin:p,integrity:g,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},wn.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);i.d.M(h,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(h)},wn.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,p=u(m,d.crossOrigin);i.d.L(h,m,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},wn.preloadModule=function(h,d){if(typeof h=="string")if(d){var m=u(d.as,d.crossOrigin);i.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(h)},wn.requestFormReset=function(h){i.d.r(h)},wn.unstable_batchedUpdates=function(h,d){return h(d)},wn.useFormState=function(h,d,m){return c.H.useFormState(h,d,m)},wn.useFormStatus=function(){return c.H.useHostTransitionStatus()},wn.version="19.2.1",wn}var sx;function UM(){if(sx)return Mp.exports;sx=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Mp.exports=PM(),Mp.exports}var ax;function IM(){if(ax)return Vl;ax=1;var n=OM(),t=qm(),e=UM();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var r=s,l=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(l=r.return),s=r.return;while(s)}return r.tag===3?l:null}function c(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function u(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function h(s){if(o(s)!==s)throw Error(i(188))}function d(s){var r=s.alternate;if(!r){if(r=o(s),r===null)throw Error(i(188));return r!==s?null:s}for(var l=s,f=r;;){var y=l.return;if(y===null)break;var b=y.alternate;if(b===null){if(f=y.return,f!==null){l=f;continue}break}if(y.child===b.child){for(b=y.child;b;){if(b===l)return h(y),s;if(b===f)return h(y),r;b=b.sibling}throw Error(i(188))}if(l.return!==f.return)l=y,f=b;else{for(var E=!1,N=y.child;N;){if(N===l){E=!0,l=y,f=b;break}if(N===f){E=!0,f=y,l=b;break}N=N.sibling}if(!E){for(N=b.child;N;){if(N===l){E=!0,l=b,f=y;break}if(N===f){E=!0,f=b,l=y;break}N=N.sibling}if(!E)throw Error(i(189))}}if(l.alternate!==f)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:r}function m(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=m(s),r!==null)return r;s=s.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),L=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),X=Symbol.for("react.activity"),st=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function j(s){return s===null||typeof s!="object"?null:(s=V&&s[V]||s["@@iterator"],typeof s=="function"?s:null)}var I=Symbol.for("react.client.reference");function H(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===I?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case M:return"Fragment";case w:return"Profiler";case S:return"StrictMode";case C:return"Suspense";case A:return"SuspenseList";case X:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case x:return"Portal";case L:return s.displayName||"Context";case _:return(s._context.displayName||"Context")+".Consumer";case R:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case B:return r=s.displayName||null,r!==null?r:H(s.type)||"Memo";case Y:r=s._payload,s=s._init;try{return H(s(r))}catch{}}return null}var U=Array.isArray,z=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},it=[],ct=-1;function D(s){return{current:s}}function q(s){0>ct||(s.current=it[ct],it[ct]=null,ct--)}function ut(s,r){ct++,it[ct]=s.current,s.current=r}var yt=D(null),tt=D(null),Ct=D(null),bt=D(null);function Ht(s,r){switch(ut(Ct,r),ut(tt,s),ut(yt,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?bv(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=bv(r),s=_v(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}q(yt),ut(yt,s)}function Lt(){q(yt),q(tt),q(Ct)}function Qt(s){s.memoizedState!==null&&ut(bt,s);var r=yt.current,l=_v(r,s.type);r!==l&&(ut(tt,s),ut(yt,l))}function kt(s){tt.current===s&&(q(yt),q(tt)),bt.current===s&&(q(bt),Ul._currentValue=$)}var vt,Et;function wt(s){if(vt===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);vt=r&&r[1]||"",Et=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+vt+s+Et}var Ft=!1;function Rt(s,r){if(!s||Ft)return"";Ft=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(r){var mt=function(){throw Error()};if(Object.defineProperty(mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mt,[])}catch(ot){var at=ot}Reflect.construct(s,[],mt)}else{try{mt.call()}catch(ot){at=ot}s.call(mt.prototype)}}else{try{throw Error()}catch(ot){at=ot}(mt=s())&&typeof mt.catch=="function"&&mt.catch(function(){})}}catch(ot){if(ot&&at&&typeof ot.stack=="string")return[ot.stack,at.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=f.DetermineComponentFrameRoot(),E=b[0],N=b[1];if(E&&N){var k=E.split(`
`),nt=N.split(`
`);for(y=f=0;f<k.length&&!k[f].includes("DetermineComponentFrameRoot");)f++;for(;y<nt.length&&!nt[y].includes("DetermineComponentFrameRoot");)y++;if(f===k.length||y===nt.length)for(f=k.length-1,y=nt.length-1;1<=f&&0<=y&&k[f]!==nt[y];)y--;for(;1<=f&&0<=y;f--,y--)if(k[f]!==nt[y]){if(f!==1||y!==1)do if(f--,y--,0>y||k[f]!==nt[y]){var dt=`
`+k[f].replace(" at new "," at ");return s.displayName&&dt.includes("<anonymous>")&&(dt=dt.replace("<anonymous>",s.displayName)),dt}while(1<=f&&0<=y);break}}}finally{Ft=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?wt(l):""}function F(s,r){switch(s.tag){case 26:case 27:case 5:return wt(s.type);case 16:return wt("Lazy");case 13:return s.child!==r&&r!==null?wt("Suspense Fallback"):wt("Suspense");case 19:return wt("SuspenseList");case 0:case 15:return Rt(s.type,!1);case 11:return Rt(s.type.render,!1);case 1:return Rt(s.type,!0);case 31:return wt("Activity");default:return""}}function O(s){try{var r="",l=null;do r+=F(s,l),l=s,s=s.return;while(s);return r}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var _t=Object.prototype.hasOwnProperty,xt=n.unstable_scheduleCallback,J=n.unstable_cancelCallback,Mt=n.unstable_shouldYield,Nt=n.unstable_requestPaint,Ot=n.unstable_now,Tt=n.unstable_getCurrentPriorityLevel,W=n.unstable_ImmediatePriority,St=n.unstable_UserBlockingPriority,Pt=n.unstable_NormalPriority,At=n.unstable_LowPriority,Vt=n.unstable_IdlePriority,ye=n.log,Qe=n.unstable_setDisableYieldValue,bi=null,Oe=null;function Je(s){if(typeof ye=="function"&&Qe(s),Oe&&typeof Oe.setStrictMode=="function")try{Oe.setStrictMode(bi,s)}catch{}}var Cn=Math.clz32?Math.clz32:Aa,Jo=Math.log,cf=Math.LN2;function Aa(s){return s>>>=0,s===0?32:31-(Jo(s)/cf|0)|0}var Ca=256,La=262144,Ra=4194304;function dn(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Na(s,r,l){var f=s.pendingLanes;if(f===0)return 0;var y=0,b=s.suspendedLanes,E=s.pingedLanes;s=s.warmLanes;var N=f&134217727;return N!==0?(f=N&~b,f!==0?y=dn(f):(E&=N,E!==0?y=dn(E):l||(l=N&~s,l!==0&&(y=dn(l))))):(N=f&~b,N!==0?y=dn(N):E!==0?y=dn(E):l||(l=f&~s,l!==0&&(y=dn(l)))),y===0?0:r!==0&&r!==y&&(r&b)===0&&(b=y&-y,l=r&-r,b>=l||b===32&&(l&4194048)!==0)?r:y}function za(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function uf(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P(){var s=Ra;return Ra<<=1,(Ra&62914560)===0&&(Ra=4194304),s}function ft(s){for(var r=[],l=0;31>l;l++)r.push(s);return r}function lt(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function gt(s,r,l,f,y,b){var E=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var N=s.entanglements,k=s.expirationTimes,nt=s.hiddenUpdates;for(l=E&~l;0<l;){var dt=31-Cn(l),mt=1<<dt;N[dt]=0,k[dt]=-1;var at=nt[dt];if(at!==null)for(nt[dt]=null,dt=0;dt<at.length;dt++){var ot=at[dt];ot!==null&&(ot.lane&=-536870913)}l&=~mt}f!==0&&zt(s,f,0),b!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=b&~(E&~r))}function zt(s,r,l){s.pendingLanes|=r,s.suspendedLanes&=~r;var f=31-Cn(r);s.entangledLanes|=r,s.entanglements[f]=s.entanglements[f]|1073741824|l&261930}function oe(s,r){var l=s.entangledLanes|=r;for(s=s.entanglements;l;){var f=31-Cn(l),y=1<<f;y&r|s[f]&r&&(s[f]|=r),l&=~y}}function ie(s,r){var l=r&-r;return l=(l&42)!==0?1:le(l),(l&(s.suspendedLanes|r))!==0?0:l}function le(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function te(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function We(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:Wv(s.type))}function He(s,r){var l=Q.p;try{return Q.p=s,r()}finally{Q.p=l}}var Zt=Math.random().toString(36).slice(2),Kt="__reactFiber$"+Zt,Ge="__reactProps$"+Zt,ge="__reactContainer$"+Zt,_i="__reactEvents$"+Zt,en="__reactListeners$"+Zt,Ko="__reactHandles$"+Zt,pn="__reactResources$"+Zt,wi="__reactMarker$"+Zt;function Pi(s){delete s[Kt],delete s[Ge],delete s[_i],delete s[en],delete s[Ko]}function ni(s){var r=s[Kt];if(r)return r;for(var l=s.parentNode;l;){if(r=l[ge]||l[Kt]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(s=Cv(s);s!==null;){if(l=s[Kt])return l;s=Cv(s)}return r}s=l,l=s.parentNode}return null}function yr(s){if(s=s[Kt]||s[ge]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function $o(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function vr(s){var r=s[pn];return r||(r=s[pn]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function un(s){s[wi]=!0}var lg=new Set,cg={};function Ba(s,r){xr(s,r),xr(s+"Capture",r)}function xr(s,r){for(cg[s]=r,s=0;s<r.length;s++)lg.add(r[s])}var _1=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ug={},hg={};function w1(s){return _t.call(hg,s)?!0:_t.call(ug,s)?!1:_1.test(s)?hg[s]=!0:(ug[s]=!0,!1)}function zc(s,r,l){if(w1(r))if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var f=r.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+l)}}function Bc(s,r,l){if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+l)}}function es(s,r,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(r,l,""+f)}}function ii(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function fg(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function M1(s,r,l){var f=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var y=f.get,b=f.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return y.call(this)},set:function(E){l=""+E,b.call(this,E)}}),Object.defineProperty(s,r,{enumerable:f.enumerable}),{getValue:function(){return l},setValue:function(E){l=""+E},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function hf(s){if(!s._valueTracker){var r=fg(s)?"checked":"value";s._valueTracker=M1(s,r,""+s[r])}}function dg(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var l=r.getValue(),f="";return s&&(f=fg(s)?s.checked?"true":"false":s.value),s=f,s!==l?(r.setValue(s),!0):!1}function Dc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var S1=/[\n"\\]/g;function si(s){return s.replace(S1,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function ff(s,r,l,f,y,b,E,N){s.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.type=E:s.removeAttribute("type"),r!=null?E==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+ii(r)):s.value!==""+ii(r)&&(s.value=""+ii(r)):E!=="submit"&&E!=="reset"||s.removeAttribute("value"),r!=null?df(s,E,ii(r)):l!=null?df(s,E,ii(l)):f!=null&&s.removeAttribute("value"),y==null&&b!=null&&(s.defaultChecked=!!b),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.name=""+ii(N):s.removeAttribute("name")}function pg(s,r,l,f,y,b,E,N){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(s.type=b),r!=null||l!=null){if(!(b!=="submit"&&b!=="reset"||r!=null)){hf(s);return}l=l!=null?""+ii(l):"",r=r!=null?""+ii(r):l,N||r===s.value||(s.value=r),s.defaultValue=r}f=f??y,f=typeof f!="function"&&typeof f!="symbol"&&!!f,s.checked=N?s.checked:!!f,s.defaultChecked=!!f,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.name=E),hf(s)}function df(s,r,l){r==="number"&&Dc(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function br(s,r,l,f){if(s=s.options,r){r={};for(var y=0;y<l.length;y++)r["$"+l[y]]=!0;for(l=0;l<s.length;l++)y=r.hasOwnProperty("$"+s[l].value),s[l].selected!==y&&(s[l].selected=y),y&&f&&(s[l].defaultSelected=!0)}else{for(l=""+ii(l),r=null,y=0;y<s.length;y++){if(s[y].value===l){s[y].selected=!0,f&&(s[y].defaultSelected=!0);return}r!==null||s[y].disabled||(r=s[y])}r!==null&&(r.selected=!0)}}function mg(s,r,l){if(r!=null&&(r=""+ii(r),r!==s.value&&(s.value=r),l==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=l!=null?""+ii(l):""}function gg(s,r,l,f){if(r==null){if(f!=null){if(l!=null)throw Error(i(92));if(U(f)){if(1<f.length)throw Error(i(93));f=f[0]}l=f}l==null&&(l=""),r=l}l=ii(r),s.defaultValue=l,f=s.textContent,f===l&&f!==""&&f!==null&&(s.value=f),hf(s)}function _r(s,r){if(r){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=r;return}}s.textContent=r}var E1=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function yg(s,r,l){var f=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?f?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":f?s.setProperty(r,l):typeof l!="number"||l===0||E1.has(r)?r==="float"?s.cssFloat=l:s[r]=(""+l).trim():s[r]=l+"px"}function vg(s,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,l!=null){for(var f in l)!l.hasOwnProperty(f)||r!=null&&r.hasOwnProperty(f)||(f.indexOf("--")===0?s.setProperty(f,""):f==="float"?s.cssFloat="":s[f]="");for(var y in r)f=r[y],r.hasOwnProperty(y)&&l[y]!==f&&yg(s,y,f)}else for(var b in r)r.hasOwnProperty(b)&&yg(s,b,r[b])}function pf(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var T1=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),A1=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Oc(s){return A1.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ns(){}var mf=null;function gf(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var wr=null,Mr=null;function xg(s){var r=yr(s);if(r&&(s=r.stateNode)){var l=s[Ge]||null;t:switch(s=r.stateNode,r.type){case"input":if(ff(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+si(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var f=l[r];if(f!==s&&f.form===s.form){var y=f[Ge]||null;if(!y)throw Error(i(90));ff(f,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(r=0;r<l.length;r++)f=l[r],f.form===s.form&&dg(f)}break t;case"textarea":mg(s,l.value,l.defaultValue);break t;case"select":r=l.value,r!=null&&br(s,!!l.multiple,r,!1)}}}var yf=!1;function bg(s,r,l){if(yf)return s(r,l);yf=!0;try{var f=s(r);return f}finally{if(yf=!1,(wr!==null||Mr!==null)&&(wu(),wr&&(r=wr,s=Mr,Mr=wr=null,xg(r),s)))for(r=0;r<s.length;r++)xg(s[r])}}function tl(s,r){var l=s.stateNode;if(l===null)return null;var f=l[Ge]||null;if(f===null)return null;l=f[r];t:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break t;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var is=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vf=!1;if(is)try{var el={};Object.defineProperty(el,"passive",{get:function(){vf=!0}}),window.addEventListener("test",el,el),window.removeEventListener("test",el,el)}catch{vf=!1}var Os=null,xf=null,Pc=null;function _g(){if(Pc)return Pc;var s,r=xf,l=r.length,f,y="value"in Os?Os.value:Os.textContent,b=y.length;for(s=0;s<l&&r[s]===y[s];s++);var E=l-s;for(f=1;f<=E&&r[l-f]===y[b-f];f++);return Pc=y.slice(s,1<f?1-f:void 0)}function Uc(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function Ic(){return!0}function wg(){return!1}function Bn(s){function r(l,f,y,b,E){this._reactName=l,this._targetInst=y,this.type=f,this.nativeEvent=b,this.target=E,this.currentTarget=null;for(var N in s)s.hasOwnProperty(N)&&(l=s[N],this[N]=l?l(b):b[N]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Ic:wg,this.isPropagationStopped=wg,this}return p(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ic)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ic)},persist:function(){},isPersistent:Ic}),r}var Da={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fc=Bn(Da),nl=p({},Da,{view:0,detail:0}),C1=Bn(nl),bf,_f,il,Hc=p({},nl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mf,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==il&&(il&&s.type==="mousemove"?(bf=s.screenX-il.screenX,_f=s.screenY-il.screenY):_f=bf=0,il=s),bf)},movementY:function(s){return"movementY"in s?s.movementY:_f}}),Mg=Bn(Hc),L1=p({},Hc,{dataTransfer:0}),R1=Bn(L1),N1=p({},nl,{relatedTarget:0}),wf=Bn(N1),z1=p({},Da,{animationName:0,elapsedTime:0,pseudoElement:0}),B1=Bn(z1),D1=p({},Da,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),O1=Bn(D1),P1=p({},Da,{data:0}),Sg=Bn(P1),U1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},I1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},F1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H1(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=F1[s])?!!r[s]:!1}function Mf(){return H1}var G1=p({},nl,{key:function(s){if(s.key){var r=U1[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Uc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?I1[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mf,charCode:function(s){return s.type==="keypress"?Uc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Uc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),V1=Bn(G1),k1=p({},Hc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Eg=Bn(k1),W1=p({},nl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mf}),j1=Bn(W1),q1=p({},Da,{propertyName:0,elapsedTime:0,pseudoElement:0}),Y1=Bn(q1),X1=p({},Hc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Z1=Bn(X1),Q1=p({},Da,{newState:0,oldState:0}),J1=Bn(Q1),K1=[9,13,27,32],Sf=is&&"CompositionEvent"in window,sl=null;is&&"documentMode"in document&&(sl=document.documentMode);var $1=is&&"TextEvent"in window&&!sl,Tg=is&&(!Sf||sl&&8<sl&&11>=sl),Ag=" ",Cg=!1;function Lg(s,r){switch(s){case"keyup":return K1.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rg(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Sr=!1;function tw(s,r){switch(s){case"compositionend":return Rg(r);case"keypress":return r.which!==32?null:(Cg=!0,Ag);case"textInput":return s=r.data,s===Ag&&Cg?null:s;default:return null}}function ew(s,r){if(Sr)return s==="compositionend"||!Sf&&Lg(s,r)?(s=_g(),Pc=xf=Os=null,Sr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Tg&&r.locale!=="ko"?null:r.data;default:return null}}var nw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ng(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!nw[s.type]:r==="textarea"}function zg(s,r,l,f){wr?Mr?Mr.push(f):Mr=[f]:wr=f,r=Lu(r,"onChange"),0<r.length&&(l=new Fc("onChange","change",null,l,f),s.push({event:l,listeners:r}))}var al=null,rl=null;function iw(s){pv(s,0)}function Gc(s){var r=$o(s);if(dg(r))return s}function Bg(s,r){if(s==="change")return r}var Dg=!1;if(is){var Ef;if(is){var Tf="oninput"in document;if(!Tf){var Og=document.createElement("div");Og.setAttribute("oninput","return;"),Tf=typeof Og.oninput=="function"}Ef=Tf}else Ef=!1;Dg=Ef&&(!document.documentMode||9<document.documentMode)}function Pg(){al&&(al.detachEvent("onpropertychange",Ug),rl=al=null)}function Ug(s){if(s.propertyName==="value"&&Gc(rl)){var r=[];zg(r,rl,s,gf(s)),bg(iw,r)}}function sw(s,r,l){s==="focusin"?(Pg(),al=r,rl=l,al.attachEvent("onpropertychange",Ug)):s==="focusout"&&Pg()}function aw(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Gc(rl)}function rw(s,r){if(s==="click")return Gc(r)}function ow(s,r){if(s==="input"||s==="change")return Gc(r)}function lw(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Vn=typeof Object.is=="function"?Object.is:lw;function ol(s,r){if(Vn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var l=Object.keys(s),f=Object.keys(r);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var y=l[f];if(!_t.call(r,y)||!Vn(s[y],r[y]))return!1}return!0}function Ig(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Fg(s,r){var l=Ig(s);s=0;for(var f;l;){if(l.nodeType===3){if(f=s+l.textContent.length,s<=r&&f>=r)return{node:l,offset:r-s};s=f}t:{for(;l;){if(l.nextSibling){l=l.nextSibling;break t}l=l.parentNode}l=void 0}l=Ig(l)}}function Hg(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?Hg(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Gg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Dc(s.document);r instanceof s.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)s=r.contentWindow;else break;r=Dc(s.document)}return r}function Af(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var cw=is&&"documentMode"in document&&11>=document.documentMode,Er=null,Cf=null,ll=null,Lf=!1;function Vg(s,r,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Lf||Er==null||Er!==Dc(f)||(f=Er,"selectionStart"in f&&Af(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ll&&ol(ll,f)||(ll=f,f=Lu(Cf,"onSelect"),0<f.length&&(r=new Fc("onSelect","select",null,r,l),s.push({event:r,listeners:f}),r.target=Er)))}function Oa(s,r){var l={};return l[s.toLowerCase()]=r.toLowerCase(),l["Webkit"+s]="webkit"+r,l["Moz"+s]="moz"+r,l}var Tr={animationend:Oa("Animation","AnimationEnd"),animationiteration:Oa("Animation","AnimationIteration"),animationstart:Oa("Animation","AnimationStart"),transitionrun:Oa("Transition","TransitionRun"),transitionstart:Oa("Transition","TransitionStart"),transitioncancel:Oa("Transition","TransitionCancel"),transitionend:Oa("Transition","TransitionEnd")},Rf={},kg={};is&&(kg=document.createElement("div").style,"AnimationEvent"in window||(delete Tr.animationend.animation,delete Tr.animationiteration.animation,delete Tr.animationstart.animation),"TransitionEvent"in window||delete Tr.transitionend.transition);function Pa(s){if(Rf[s])return Rf[s];if(!Tr[s])return s;var r=Tr[s],l;for(l in r)if(r.hasOwnProperty(l)&&l in kg)return Rf[s]=r[l];return s}var Wg=Pa("animationend"),jg=Pa("animationiteration"),qg=Pa("animationstart"),uw=Pa("transitionrun"),hw=Pa("transitionstart"),fw=Pa("transitioncancel"),Yg=Pa("transitionend"),Xg=new Map,Nf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Nf.push("scrollEnd");function Mi(s,r){Xg.set(s,r),Ba(r,[s])}var Vc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},ai=[],Ar=0,zf=0;function kc(){for(var s=Ar,r=zf=Ar=0;r<s;){var l=ai[r];ai[r++]=null;var f=ai[r];ai[r++]=null;var y=ai[r];ai[r++]=null;var b=ai[r];if(ai[r++]=null,f!==null&&y!==null){var E=f.pending;E===null?y.next=y:(y.next=E.next,E.next=y),f.pending=y}b!==0&&Zg(l,y,b)}}function Wc(s,r,l,f){ai[Ar++]=s,ai[Ar++]=r,ai[Ar++]=l,ai[Ar++]=f,zf|=f,s.lanes|=f,s=s.alternate,s!==null&&(s.lanes|=f)}function Bf(s,r,l,f){return Wc(s,r,l,f),jc(s)}function Ua(s,r){return Wc(s,null,null,r),jc(s)}function Zg(s,r,l){s.lanes|=l;var f=s.alternate;f!==null&&(f.lanes|=l);for(var y=!1,b=s.return;b!==null;)b.childLanes|=l,f=b.alternate,f!==null&&(f.childLanes|=l),b.tag===22&&(s=b.stateNode,s===null||s._visibility&1||(y=!0)),s=b,b=b.return;return s.tag===3?(b=s.stateNode,y&&r!==null&&(y=31-Cn(l),s=b.hiddenUpdates,f=s[y],f===null?s[y]=[r]:f.push(r),r.lane=l|536870912),b):null}function jc(s){if(50<Rl)throw Rl=0,Vd=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var Cr={};function dw(s,r,l,f){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(s,r,l,f){return new dw(s,r,l,f)}function Df(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ss(s,r){var l=s.alternate;return l===null?(l=kn(s.tag,r,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=r,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,r=s.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Qg(s,r){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,r=l.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function qc(s,r,l,f,y,b){var E=0;if(f=s,typeof s=="function")Df(s)&&(E=1);else if(typeof s=="string")E=vM(s,l,yt.current)?26:s==="html"||s==="head"||s==="body"?27:5;else t:switch(s){case X:return s=kn(31,l,r,y),s.elementType=X,s.lanes=b,s;case M:return Ia(l.children,y,b,r);case S:E=8,y|=24;break;case w:return s=kn(12,l,r,y|2),s.elementType=w,s.lanes=b,s;case C:return s=kn(13,l,r,y),s.elementType=C,s.lanes=b,s;case A:return s=kn(19,l,r,y),s.elementType=A,s.lanes=b,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case L:E=10;break t;case _:E=9;break t;case R:E=11;break t;case B:E=14;break t;case Y:E=16,f=null;break t}E=29,l=Error(i(130,s===null?"null":typeof s,"")),f=null}return r=kn(E,l,r,y),r.elementType=s,r.type=f,r.lanes=b,r}function Ia(s,r,l,f){return s=kn(7,s,f,r),s.lanes=l,s}function Of(s,r,l){return s=kn(6,s,null,r),s.lanes=l,s}function Jg(s){var r=kn(18,null,null,0);return r.stateNode=s,r}function Pf(s,r,l){return r=kn(4,s.children!==null?s.children:[],s.key,r),r.lanes=l,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var Kg=new WeakMap;function ri(s,r){if(typeof s=="object"&&s!==null){var l=Kg.get(s);return l!==void 0?l:(r={value:s,source:r,stack:O(r)},Kg.set(s,r),r)}return{value:s,source:r,stack:O(r)}}var Lr=[],Rr=0,Yc=null,cl=0,oi=[],li=0,Ps=null,Ui=1,Ii="";function as(s,r){Lr[Rr++]=cl,Lr[Rr++]=Yc,Yc=s,cl=r}function $g(s,r,l){oi[li++]=Ui,oi[li++]=Ii,oi[li++]=Ps,Ps=s;var f=Ui;s=Ii;var y=32-Cn(f)-1;f&=~(1<<y),l+=1;var b=32-Cn(r)+y;if(30<b){var E=y-y%5;b=(f&(1<<E)-1).toString(32),f>>=E,y-=E,Ui=1<<32-Cn(r)+y|l<<y|f,Ii=b+s}else Ui=1<<b|l<<y|f,Ii=s}function Uf(s){s.return!==null&&(as(s,1),$g(s,1,0))}function If(s){for(;s===Yc;)Yc=Lr[--Rr],Lr[Rr]=null,cl=Lr[--Rr],Lr[Rr]=null;for(;s===Ps;)Ps=oi[--li],oi[li]=null,Ii=oi[--li],oi[li]=null,Ui=oi[--li],oi[li]=null}function ty(s,r){oi[li++]=Ui,oi[li++]=Ii,oi[li++]=Ps,Ui=r.id,Ii=r.overflow,Ps=s}var mn=null,Pe=null,pe=!1,Us=null,ci=!1,Ff=Error(i(519));function Is(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ul(ri(r,s)),Ff}function ey(s){var r=s.stateNode,l=s.type,f=s.memoizedProps;switch(r[Kt]=s,r[Ge]=f,l){case"dialog":ue("cancel",r),ue("close",r);break;case"iframe":case"object":case"embed":ue("load",r);break;case"video":case"audio":for(l=0;l<zl.length;l++)ue(zl[l],r);break;case"source":ue("error",r);break;case"img":case"image":case"link":ue("error",r),ue("load",r);break;case"details":ue("toggle",r);break;case"input":ue("invalid",r),pg(r,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":ue("invalid",r);break;case"textarea":ue("invalid",r),gg(r,f.value,f.defaultValue,f.children)}l=f.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||f.suppressHydrationWarning===!0||vv(r.textContent,l)?(f.popover!=null&&(ue("beforetoggle",r),ue("toggle",r)),f.onScroll!=null&&ue("scroll",r),f.onScrollEnd!=null&&ue("scrollend",r),f.onClick!=null&&(r.onclick=ns),r=!0):r=!1,r||Is(s,!0)}function ny(s){for(mn=s.return;mn;)switch(mn.tag){case 5:case 31:case 13:ci=!1;return;case 27:case 3:ci=!0;return;default:mn=mn.return}}function Nr(s){if(s!==mn)return!1;if(!pe)return ny(s),pe=!0,!1;var r=s.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||ip(s.type,s.memoizedProps)),l=!l),l&&Pe&&Is(s),ny(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Pe=Av(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Pe=Av(s)}else r===27?(r=Pe,Ks(s.type)?(s=lp,lp=null,Pe=s):Pe=r):Pe=mn?hi(s.stateNode.nextSibling):null;return!0}function Fa(){Pe=mn=null,pe=!1}function Hf(){var s=Us;return s!==null&&(Un===null?Un=s:Un.push.apply(Un,s),Us=null),s}function ul(s){Us===null?Us=[s]:Us.push(s)}var Gf=D(null),Ha=null,rs=null;function Fs(s,r,l){ut(Gf,r._currentValue),r._currentValue=l}function os(s){s._currentValue=Gf.current,q(Gf)}function Vf(s,r,l){for(;s!==null;){var f=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,f!==null&&(f.childLanes|=r)):f!==null&&(f.childLanes&r)!==r&&(f.childLanes|=r),s===l)break;s=s.return}}function kf(s,r,l,f){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var b=y.dependencies;if(b!==null){var E=y.child;b=b.firstContext;t:for(;b!==null;){var N=b;b=y;for(var k=0;k<r.length;k++)if(N.context===r[k]){b.lanes|=l,N=b.alternate,N!==null&&(N.lanes|=l),Vf(b.return,l,s),f||(E=null);break t}b=N.next}}else if(y.tag===18){if(E=y.return,E===null)throw Error(i(341));E.lanes|=l,b=E.alternate,b!==null&&(b.lanes|=l),Vf(E,l,s),E=null}else E=y.child;if(E!==null)E.return=y;else for(E=y;E!==null;){if(E===s){E=null;break}if(y=E.sibling,y!==null){y.return=E.return,E=y;break}E=E.return}y=E}}function zr(s,r,l,f){s=null;for(var y=r,b=!1;y!==null;){if(!b){if((y.flags&524288)!==0)b=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var E=y.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var N=y.type;Vn(y.pendingProps.value,E.value)||(s!==null?s.push(N):s=[N])}}else if(y===bt.current){if(E=y.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(Ul):s=[Ul])}y=y.return}s!==null&&kf(r,s,l,f),r.flags|=262144}function Xc(s){for(s=s.firstContext;s!==null;){if(!Vn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ga(s){Ha=s,rs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function gn(s){return iy(Ha,s)}function Zc(s,r){return Ha===null&&Ga(s),iy(s,r)}function iy(s,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},rs===null){if(s===null)throw Error(i(308));rs=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else rs=rs.next=r;return l}var pw=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(l,f){s.push(f)}};this.abort=function(){r.aborted=!0,s.forEach(function(l){return l()})}},mw=n.unstable_scheduleCallback,gw=n.unstable_NormalPriority,nn={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Wf(){return{controller:new pw,data:new Map,refCount:0}}function hl(s){s.refCount--,s.refCount===0&&mw(gw,function(){s.controller.abort()})}var fl=null,jf=0,Br=0,Dr=null;function yw(s,r){if(fl===null){var l=fl=[];jf=0,Br=Xd(),Dr={status:"pending",value:void 0,then:function(f){l.push(f)}}}return jf++,r.then(sy,sy),r}function sy(){if(--jf===0&&fl!==null){Dr!==null&&(Dr.status="fulfilled");var s=fl;fl=null,Br=0,Dr=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function vw(s,r){var l=[],f={status:"pending",value:null,reason:null,then:function(y){l.push(y)}};return s.then(function(){f.status="fulfilled",f.value=r;for(var y=0;y<l.length;y++)(0,l[y])(r)},function(y){for(f.status="rejected",f.reason=y,y=0;y<l.length;y++)(0,l[y])(void 0)}),f}var ay=z.S;z.S=function(s,r){V0=Ot(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&yw(s,r),ay!==null&&ay(s,r)};var Va=D(null);function qf(){var s=Va.current;return s!==null?s:Ce.pooledCache}function Qc(s,r){r===null?ut(Va,Va.current):ut(Va,r.pool)}function ry(){var s=qf();return s===null?null:{parent:nn._currentValue,pool:s}}var Or=Error(i(460)),Yf=Error(i(474)),Jc=Error(i(542)),Kc={then:function(){}};function oy(s){return s=s.status,s==="fulfilled"||s==="rejected"}function ly(s,r,l){switch(l=s[l],l===void 0?s.push(r):l!==r&&(r.then(ns,ns),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,uy(s),s;default:if(typeof r.status=="string")r.then(ns,ns);else{if(s=Ce,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(f){if(r.status==="pending"){var y=r;y.status="fulfilled",y.value=f}},function(f){if(r.status==="pending"){var y=r;y.status="rejected",y.reason=f}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,uy(s),s}throw Wa=r,Or}}function ka(s){try{var r=s._init;return r(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Wa=l,Or):l}}var Wa=null;function cy(){if(Wa===null)throw Error(i(459));var s=Wa;return Wa=null,s}function uy(s){if(s===Or||s===Jc)throw Error(i(483))}var Pr=null,dl=0;function $c(s){var r=dl;return dl+=1,Pr===null&&(Pr=[]),ly(Pr,s,r)}function pl(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function tu(s,r){throw r.$$typeof===g?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function hy(s){function r(K,Z){if(s){var et=K.deletions;et===null?(K.deletions=[Z],K.flags|=16):et.push(Z)}}function l(K,Z){if(!s)return null;for(;Z!==null;)r(K,Z),Z=Z.sibling;return null}function f(K){for(var Z=new Map;K!==null;)K.key!==null?Z.set(K.key,K):Z.set(K.index,K),K=K.sibling;return Z}function y(K,Z){return K=ss(K,Z),K.index=0,K.sibling=null,K}function b(K,Z,et){return K.index=et,s?(et=K.alternate,et!==null?(et=et.index,et<Z?(K.flags|=67108866,Z):et):(K.flags|=67108866,Z)):(K.flags|=1048576,Z)}function E(K){return s&&K.alternate===null&&(K.flags|=67108866),K}function N(K,Z,et,pt){return Z===null||Z.tag!==6?(Z=Of(et,K.mode,pt),Z.return=K,Z):(Z=y(Z,et),Z.return=K,Z)}function k(K,Z,et,pt){var jt=et.type;return jt===M?dt(K,Z,et.props.children,pt,et.key):Z!==null&&(Z.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Y&&ka(jt)===Z.type)?(Z=y(Z,et.props),pl(Z,et),Z.return=K,Z):(Z=qc(et.type,et.key,et.props,null,K.mode,pt),pl(Z,et),Z.return=K,Z)}function nt(K,Z,et,pt){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==et.containerInfo||Z.stateNode.implementation!==et.implementation?(Z=Pf(et,K.mode,pt),Z.return=K,Z):(Z=y(Z,et.children||[]),Z.return=K,Z)}function dt(K,Z,et,pt,jt){return Z===null||Z.tag!==7?(Z=Ia(et,K.mode,pt,jt),Z.return=K,Z):(Z=y(Z,et),Z.return=K,Z)}function mt(K,Z,et){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Z=Of(""+Z,K.mode,et),Z.return=K,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case v:return et=qc(Z.type,Z.key,Z.props,null,K.mode,et),pl(et,Z),et.return=K,et;case x:return Z=Pf(Z,K.mode,et),Z.return=K,Z;case Y:return Z=ka(Z),mt(K,Z,et)}if(U(Z)||j(Z))return Z=Ia(Z,K.mode,et,null),Z.return=K,Z;if(typeof Z.then=="function")return mt(K,$c(Z),et);if(Z.$$typeof===L)return mt(K,Zc(K,Z),et);tu(K,Z)}return null}function at(K,Z,et,pt){var jt=Z!==null?Z.key:null;if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return jt!==null?null:N(K,Z,""+et,pt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case v:return et.key===jt?k(K,Z,et,pt):null;case x:return et.key===jt?nt(K,Z,et,pt):null;case Y:return et=ka(et),at(K,Z,et,pt)}if(U(et)||j(et))return jt!==null?null:dt(K,Z,et,pt,null);if(typeof et.then=="function")return at(K,Z,$c(et),pt);if(et.$$typeof===L)return at(K,Z,Zc(K,et),pt);tu(K,et)}return null}function ot(K,Z,et,pt,jt){if(typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint")return K=K.get(et)||null,N(Z,K,""+pt,jt);if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case v:return K=K.get(pt.key===null?et:pt.key)||null,k(Z,K,pt,jt);case x:return K=K.get(pt.key===null?et:pt.key)||null,nt(Z,K,pt,jt);case Y:return pt=ka(pt),ot(K,Z,et,pt,jt)}if(U(pt)||j(pt))return K=K.get(et)||null,dt(Z,K,pt,jt,null);if(typeof pt.then=="function")return ot(K,Z,et,$c(pt),jt);if(pt.$$typeof===L)return ot(K,Z,et,Zc(Z,pt),jt);tu(Z,pt)}return null}function It(K,Z,et,pt){for(var jt=null,ve=null,Gt=Z,ae=Z=0,de=null;Gt!==null&&ae<et.length;ae++){Gt.index>ae?(de=Gt,Gt=null):de=Gt.sibling;var xe=at(K,Gt,et[ae],pt);if(xe===null){Gt===null&&(Gt=de);break}s&&Gt&&xe.alternate===null&&r(K,Gt),Z=b(xe,Z,ae),ve===null?jt=xe:ve.sibling=xe,ve=xe,Gt=de}if(ae===et.length)return l(K,Gt),pe&&as(K,ae),jt;if(Gt===null){for(;ae<et.length;ae++)Gt=mt(K,et[ae],pt),Gt!==null&&(Z=b(Gt,Z,ae),ve===null?jt=Gt:ve.sibling=Gt,ve=Gt);return pe&&as(K,ae),jt}for(Gt=f(Gt);ae<et.length;ae++)de=ot(Gt,K,ae,et[ae],pt),de!==null&&(s&&de.alternate!==null&&Gt.delete(de.key===null?ae:de.key),Z=b(de,Z,ae),ve===null?jt=de:ve.sibling=de,ve=de);return s&&Gt.forEach(function(ia){return r(K,ia)}),pe&&as(K,ae),jt}function Yt(K,Z,et,pt){if(et==null)throw Error(i(151));for(var jt=null,ve=null,Gt=Z,ae=Z=0,de=null,xe=et.next();Gt!==null&&!xe.done;ae++,xe=et.next()){Gt.index>ae?(de=Gt,Gt=null):de=Gt.sibling;var ia=at(K,Gt,xe.value,pt);if(ia===null){Gt===null&&(Gt=de);break}s&&Gt&&ia.alternate===null&&r(K,Gt),Z=b(ia,Z,ae),ve===null?jt=ia:ve.sibling=ia,ve=ia,Gt=de}if(xe.done)return l(K,Gt),pe&&as(K,ae),jt;if(Gt===null){for(;!xe.done;ae++,xe=et.next())xe=mt(K,xe.value,pt),xe!==null&&(Z=b(xe,Z,ae),ve===null?jt=xe:ve.sibling=xe,ve=xe);return pe&&as(K,ae),jt}for(Gt=f(Gt);!xe.done;ae++,xe=et.next())xe=ot(Gt,K,ae,xe.value,pt),xe!==null&&(s&&xe.alternate!==null&&Gt.delete(xe.key===null?ae:xe.key),Z=b(xe,Z,ae),ve===null?jt=xe:ve.sibling=xe,ve=xe);return s&&Gt.forEach(function(LM){return r(K,LM)}),pe&&as(K,ae),jt}function Ae(K,Z,et,pt){if(typeof et=="object"&&et!==null&&et.type===M&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case v:t:{for(var jt=et.key;Z!==null;){if(Z.key===jt){if(jt=et.type,jt===M){if(Z.tag===7){l(K,Z.sibling),pt=y(Z,et.props.children),pt.return=K,K=pt;break t}}else if(Z.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Y&&ka(jt)===Z.type){l(K,Z.sibling),pt=y(Z,et.props),pl(pt,et),pt.return=K,K=pt;break t}l(K,Z);break}else r(K,Z);Z=Z.sibling}et.type===M?(pt=Ia(et.props.children,K.mode,pt,et.key),pt.return=K,K=pt):(pt=qc(et.type,et.key,et.props,null,K.mode,pt),pl(pt,et),pt.return=K,K=pt)}return E(K);case x:t:{for(jt=et.key;Z!==null;){if(Z.key===jt)if(Z.tag===4&&Z.stateNode.containerInfo===et.containerInfo&&Z.stateNode.implementation===et.implementation){l(K,Z.sibling),pt=y(Z,et.children||[]),pt.return=K,K=pt;break t}else{l(K,Z);break}else r(K,Z);Z=Z.sibling}pt=Pf(et,K.mode,pt),pt.return=K,K=pt}return E(K);case Y:return et=ka(et),Ae(K,Z,et,pt)}if(U(et))return It(K,Z,et,pt);if(j(et)){if(jt=j(et),typeof jt!="function")throw Error(i(150));return et=jt.call(et),Yt(K,Z,et,pt)}if(typeof et.then=="function")return Ae(K,Z,$c(et),pt);if(et.$$typeof===L)return Ae(K,Z,Zc(K,et),pt);tu(K,et)}return typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint"?(et=""+et,Z!==null&&Z.tag===6?(l(K,Z.sibling),pt=y(Z,et),pt.return=K,K=pt):(l(K,Z),pt=Of(et,K.mode,pt),pt.return=K,K=pt),E(K)):l(K,Z)}return function(K,Z,et,pt){try{dl=0;var jt=Ae(K,Z,et,pt);return Pr=null,jt}catch(Gt){if(Gt===Or||Gt===Jc)throw Gt;var ve=kn(29,Gt,null,K.mode);return ve.lanes=pt,ve.return=K,ve}finally{}}}var ja=hy(!0),fy=hy(!1),Hs=!1;function Xf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Zf(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Gs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Vs(s,r,l){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(be&2)!==0){var y=f.pending;return y===null?r.next=r:(r.next=y.next,y.next=r),f.pending=r,r=jc(s),Zg(s,null,l),r}return Wc(s,f,r,l),jc(s)}function ml(s,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var f=r.lanes;f&=s.pendingLanes,l|=f,r.lanes=l,oe(s,l)}}function Qf(s,r){var l=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var y=null,b=null;if(l=l.firstBaseUpdate,l!==null){do{var E={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};b===null?y=b=E:b=b.next=E,l=l.next}while(l!==null);b===null?y=b=r:b=b.next=r}else y=b=r;l={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:b,shared:f.shared,callbacks:f.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=r:s.next=r,l.lastBaseUpdate=r}var Jf=!1;function gl(){if(Jf){var s=Dr;if(s!==null)throw s}}function yl(s,r,l,f){Jf=!1;var y=s.updateQueue;Hs=!1;var b=y.firstBaseUpdate,E=y.lastBaseUpdate,N=y.shared.pending;if(N!==null){y.shared.pending=null;var k=N,nt=k.next;k.next=null,E===null?b=nt:E.next=nt,E=k;var dt=s.alternate;dt!==null&&(dt=dt.updateQueue,N=dt.lastBaseUpdate,N!==E&&(N===null?dt.firstBaseUpdate=nt:N.next=nt,dt.lastBaseUpdate=k))}if(b!==null){var mt=y.baseState;E=0,dt=nt=k=null,N=b;do{var at=N.lane&-536870913,ot=at!==N.lane;if(ot?(fe&at)===at:(f&at)===at){at!==0&&at===Br&&(Jf=!0),dt!==null&&(dt=dt.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});t:{var It=s,Yt=N;at=r;var Ae=l;switch(Yt.tag){case 1:if(It=Yt.payload,typeof It=="function"){mt=It.call(Ae,mt,at);break t}mt=It;break t;case 3:It.flags=It.flags&-65537|128;case 0:if(It=Yt.payload,at=typeof It=="function"?It.call(Ae,mt,at):It,at==null)break t;mt=p({},mt,at);break t;case 2:Hs=!0}}at=N.callback,at!==null&&(s.flags|=64,ot&&(s.flags|=8192),ot=y.callbacks,ot===null?y.callbacks=[at]:ot.push(at))}else ot={lane:at,tag:N.tag,payload:N.payload,callback:N.callback,next:null},dt===null?(nt=dt=ot,k=mt):dt=dt.next=ot,E|=at;if(N=N.next,N===null){if(N=y.shared.pending,N===null)break;ot=N,N=ot.next,ot.next=null,y.lastBaseUpdate=ot,y.shared.pending=null}}while(!0);dt===null&&(k=mt),y.baseState=k,y.firstBaseUpdate=nt,y.lastBaseUpdate=dt,b===null&&(y.shared.lanes=0),Ys|=E,s.lanes=E,s.memoizedState=mt}}function dy(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function py(s,r){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)dy(l[s],r)}var Ur=D(null),eu=D(0);function my(s,r){s=gs,ut(eu,s),ut(Ur,r),gs=s|r.baseLanes}function Kf(){ut(eu,gs),ut(Ur,Ur.current)}function $f(){gs=eu.current,q(Ur),q(eu)}var Wn=D(null),ui=null;function ks(s){var r=s.alternate;ut(Ke,Ke.current&1),ut(Wn,s),ui===null&&(r===null||Ur.current!==null||r.memoizedState!==null)&&(ui=s)}function td(s){ut(Ke,Ke.current),ut(Wn,s),ui===null&&(ui=s)}function gy(s){s.tag===22?(ut(Ke,Ke.current),ut(Wn,s),ui===null&&(ui=s)):Ws()}function Ws(){ut(Ke,Ke.current),ut(Wn,Wn.current)}function jn(s){q(Wn),ui===s&&(ui=null),q(Ke)}var Ke=D(0);function nu(s){for(var r=s;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||rp(l)||op(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var ls=0,se=null,Ee=null,sn=null,iu=!1,Ir=!1,qa=!1,su=0,vl=0,Fr=null,xw=0;function Ye(){throw Error(i(321))}function ed(s,r){if(r===null)return!1;for(var l=0;l<r.length&&l<s.length;l++)if(!Vn(s[l],r[l]))return!1;return!0}function nd(s,r,l,f,y,b){return ls=b,se=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,z.H=s===null||s.memoizedState===null?$y:yd,qa=!1,b=l(f,y),qa=!1,Ir&&(b=vy(r,l,f,y)),yy(s),b}function yy(s){z.H=_l;var r=Ee!==null&&Ee.next!==null;if(ls=0,sn=Ee=se=null,iu=!1,vl=0,Fr=null,r)throw Error(i(300));s===null||an||(s=s.dependencies,s!==null&&Xc(s)&&(an=!0))}function vy(s,r,l,f){se=s;var y=0;do{if(Ir&&(Fr=null),vl=0,Ir=!1,25<=y)throw Error(i(301));if(y+=1,sn=Ee=null,s.updateQueue!=null){var b=s.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}z.H=t0,b=r(l,f)}while(Ir);return b}function bw(){var s=z.H,r=s.useState()[0];return r=typeof r.then=="function"?xl(r):r,s=s.useState()[0],(Ee!==null?Ee.memoizedState:null)!==s&&(se.flags|=1024),r}function id(){var s=su!==0;return su=0,s}function sd(s,r,l){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~l}function ad(s){if(iu){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}iu=!1}ls=0,sn=Ee=se=null,Ir=!1,vl=su=0,Fr=null}function Ln(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?se.memoizedState=sn=s:sn=sn.next=s,sn}function $e(){if(Ee===null){var s=se.alternate;s=s!==null?s.memoizedState:null}else s=Ee.next;var r=sn===null?se.memoizedState:sn.next;if(r!==null)sn=r,Ee=s;else{if(s===null)throw se.alternate===null?Error(i(467)):Error(i(310));Ee=s,s={memoizedState:Ee.memoizedState,baseState:Ee.baseState,baseQueue:Ee.baseQueue,queue:Ee.queue,next:null},sn===null?se.memoizedState=sn=s:sn=sn.next=s}return sn}function au(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function xl(s){var r=vl;return vl+=1,Fr===null&&(Fr=[]),s=ly(Fr,s,r),r=se,(sn===null?r.memoizedState:sn.next)===null&&(r=r.alternate,z.H=r===null||r.memoizedState===null?$y:yd),s}function ru(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return xl(s);if(s.$$typeof===L)return gn(s)}throw Error(i(438,String(s)))}function rd(s){var r=null,l=se.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var f=se.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(r={data:f.data.map(function(y){return y.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=au(),se.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(s),f=0;f<s;f++)l[f]=st;return r.index++,l}function cs(s,r){return typeof r=="function"?r(s):r}function ou(s){var r=$e();return od(r,Ee,s)}function od(s,r,l){var f=s.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=l;var y=s.baseQueue,b=f.pending;if(b!==null){if(y!==null){var E=y.next;y.next=b.next,b.next=E}r.baseQueue=y=b,f.pending=null}if(b=s.baseState,y===null)s.memoizedState=b;else{r=y.next;var N=E=null,k=null,nt=r,dt=!1;do{var mt=nt.lane&-536870913;if(mt!==nt.lane?(fe&mt)===mt:(ls&mt)===mt){var at=nt.revertLane;if(at===0)k!==null&&(k=k.next={lane:0,revertLane:0,gesture:null,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null}),mt===Br&&(dt=!0);else if((ls&at)===at){nt=nt.next,at===Br&&(dt=!0);continue}else mt={lane:0,revertLane:nt.revertLane,gesture:null,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null},k===null?(N=k=mt,E=b):k=k.next=mt,se.lanes|=at,Ys|=at;mt=nt.action,qa&&l(b,mt),b=nt.hasEagerState?nt.eagerState:l(b,mt)}else at={lane:mt,revertLane:nt.revertLane,gesture:nt.gesture,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null},k===null?(N=k=at,E=b):k=k.next=at,se.lanes|=mt,Ys|=mt;nt=nt.next}while(nt!==null&&nt!==r);if(k===null?E=b:k.next=N,!Vn(b,s.memoizedState)&&(an=!0,dt&&(l=Dr,l!==null)))throw l;s.memoizedState=b,s.baseState=E,s.baseQueue=k,f.lastRenderedState=b}return y===null&&(f.lanes=0),[s.memoizedState,f.dispatch]}function ld(s){var r=$e(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var f=l.dispatch,y=l.pending,b=r.memoizedState;if(y!==null){l.pending=null;var E=y=y.next;do b=s(b,E.action),E=E.next;while(E!==y);Vn(b,r.memoizedState)||(an=!0),r.memoizedState=b,r.baseQueue===null&&(r.baseState=b),l.lastRenderedState=b}return[b,f]}function xy(s,r,l){var f=se,y=$e(),b=pe;if(b){if(l===void 0)throw Error(i(407));l=l()}else l=r();var E=!Vn((Ee||y).memoizedState,l);if(E&&(y.memoizedState=l,an=!0),y=y.queue,hd(wy.bind(null,f,y,s),[s]),y.getSnapshot!==r||E||sn!==null&&sn.memoizedState.tag&1){if(f.flags|=2048,Hr(9,{destroy:void 0},_y.bind(null,f,y,l,r),null),Ce===null)throw Error(i(349));b||(ls&127)!==0||by(f,r,l)}return l}function by(s,r,l){s.flags|=16384,s={getSnapshot:r,value:l},r=se.updateQueue,r===null?(r=au(),se.updateQueue=r,r.stores=[s]):(l=r.stores,l===null?r.stores=[s]:l.push(s))}function _y(s,r,l,f){r.value=l,r.getSnapshot=f,My(r)&&Sy(s)}function wy(s,r,l){return l(function(){My(r)&&Sy(s)})}function My(s){var r=s.getSnapshot;s=s.value;try{var l=r();return!Vn(s,l)}catch{return!0}}function Sy(s){var r=Ua(s,2);r!==null&&In(r,s,2)}function cd(s){var r=Ln();if(typeof s=="function"){var l=s;if(s=l(),qa){Je(!0);try{l()}finally{Je(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:cs,lastRenderedState:s},r}function Ey(s,r,l,f){return s.baseState=l,od(s,Ee,typeof f=="function"?f:cs)}function _w(s,r,l,f,y){if(uu(s))throw Error(i(485));if(s=r.action,s!==null){var b={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){b.listeners.push(E)}};z.T!==null?l(!0):b.isTransition=!1,f(b),l=r.pending,l===null?(b.next=r.pending=b,Ty(r,b)):(b.next=l.next,r.pending=l.next=b)}}function Ty(s,r){var l=r.action,f=r.payload,y=s.state;if(r.isTransition){var b=z.T,E={};z.T=E;try{var N=l(y,f),k=z.S;k!==null&&k(E,N),Ay(s,r,N)}catch(nt){ud(s,r,nt)}finally{b!==null&&E.types!==null&&(b.types=E.types),z.T=b}}else try{b=l(y,f),Ay(s,r,b)}catch(nt){ud(s,r,nt)}}function Ay(s,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(f){Cy(s,r,f)},function(f){return ud(s,r,f)}):Cy(s,r,l)}function Cy(s,r,l){r.status="fulfilled",r.value=l,Ly(r),s.state=l,r=s.pending,r!==null&&(l=r.next,l===r?s.pending=null:(l=l.next,r.next=l,Ty(s,l)))}function ud(s,r,l){var f=s.pending;if(s.pending=null,f!==null){f=f.next;do r.status="rejected",r.reason=l,Ly(r),r=r.next;while(r!==f)}s.action=null}function Ly(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function Ry(s,r){return r}function Ny(s,r){if(pe){var l=Ce.formState;if(l!==null){t:{var f=se;if(pe){if(Pe){e:{for(var y=Pe,b=ci;y.nodeType!==8;){if(!b){y=null;break e}if(y=hi(y.nextSibling),y===null){y=null;break e}}b=y.data,y=b==="F!"||b==="F"?y:null}if(y){Pe=hi(y.nextSibling),f=y.data==="F!";break t}}Is(f)}f=!1}f&&(r=l[0])}}return l=Ln(),l.memoizedState=l.baseState=r,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ry,lastRenderedState:r},l.queue=f,l=Qy.bind(null,se,f),f.dispatch=l,f=cd(!1),b=gd.bind(null,se,!1,f.queue),f=Ln(),y={state:r,dispatch:null,action:s,pending:null},f.queue=y,l=_w.bind(null,se,y,b,l),y.dispatch=l,f.memoizedState=s,[r,l,!1]}function zy(s){var r=$e();return By(r,Ee,s)}function By(s,r,l){if(r=od(s,r,Ry)[0],s=ou(cs)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var f=xl(r)}catch(E){throw E===Or?Jc:E}else f=r;r=$e();var y=r.queue,b=y.dispatch;return l!==r.memoizedState&&(se.flags|=2048,Hr(9,{destroy:void 0},ww.bind(null,y,l),null)),[f,b,s]}function ww(s,r){s.action=r}function Dy(s){var r=$e(),l=Ee;if(l!==null)return By(r,l,s);$e(),r=r.memoizedState,l=$e();var f=l.queue.dispatch;return l.memoizedState=s,[r,f,!1]}function Hr(s,r,l,f){return s={tag:s,create:l,deps:f,inst:r,next:null},r=se.updateQueue,r===null&&(r=au(),se.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=s.next=s:(f=l.next,l.next=s,s.next=f,r.lastEffect=s),s}function Oy(){return $e().memoizedState}function lu(s,r,l,f){var y=Ln();se.flags|=s,y.memoizedState=Hr(1|r,{destroy:void 0},l,f===void 0?null:f)}function cu(s,r,l,f){var y=$e();f=f===void 0?null:f;var b=y.memoizedState.inst;Ee!==null&&f!==null&&ed(f,Ee.memoizedState.deps)?y.memoizedState=Hr(r,b,l,f):(se.flags|=s,y.memoizedState=Hr(1|r,b,l,f))}function Py(s,r){lu(8390656,8,s,r)}function hd(s,r){cu(2048,8,s,r)}function Mw(s){se.flags|=4;var r=se.updateQueue;if(r===null)r=au(),se.updateQueue=r,r.events=[s];else{var l=r.events;l===null?r.events=[s]:l.push(s)}}function Uy(s){var r=$e().memoizedState;return Mw({ref:r,nextImpl:s}),function(){if((be&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Iy(s,r){return cu(4,2,s,r)}function Fy(s,r){return cu(4,4,s,r)}function Hy(s,r){if(typeof r=="function"){s=s();var l=r(s);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Gy(s,r,l){l=l!=null?l.concat([s]):null,cu(4,4,Hy.bind(null,r,s),l)}function fd(){}function Vy(s,r){var l=$e();r=r===void 0?null:r;var f=l.memoizedState;return r!==null&&ed(r,f[1])?f[0]:(l.memoizedState=[s,r],s)}function ky(s,r){var l=$e();r=r===void 0?null:r;var f=l.memoizedState;if(r!==null&&ed(r,f[1]))return f[0];if(f=s(),qa){Je(!0);try{s()}finally{Je(!1)}}return l.memoizedState=[f,r],f}function dd(s,r,l){return l===void 0||(ls&1073741824)!==0&&(fe&261930)===0?s.memoizedState=r:(s.memoizedState=l,s=W0(),se.lanes|=s,Ys|=s,l)}function Wy(s,r,l,f){return Vn(l,r)?l:Ur.current!==null?(s=dd(s,l,f),Vn(s,r)||(an=!0),s):(ls&42)===0||(ls&1073741824)!==0&&(fe&261930)===0?(an=!0,s.memoizedState=l):(s=W0(),se.lanes|=s,Ys|=s,r)}function jy(s,r,l,f,y){var b=Q.p;Q.p=b!==0&&8>b?b:8;var E=z.T,N={};z.T=N,gd(s,!1,r,l);try{var k=y(),nt=z.S;if(nt!==null&&nt(N,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var dt=vw(k,f);bl(s,r,dt,Xn(s))}else bl(s,r,f,Xn(s))}catch(mt){bl(s,r,{then:function(){},status:"rejected",reason:mt},Xn())}finally{Q.p=b,E!==null&&N.types!==null&&(E.types=N.types),z.T=E}}function Sw(){}function pd(s,r,l,f){if(s.tag!==5)throw Error(i(476));var y=qy(s).queue;jy(s,y,r,$,l===null?Sw:function(){return Yy(s),l(f)})}function qy(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:cs,lastRenderedState:$},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:cs,lastRenderedState:l},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function Yy(s){var r=qy(s);r.next===null&&(r=s.alternate.memoizedState),bl(s,r.next.queue,{},Xn())}function md(){return gn(Ul)}function Xy(){return $e().memoizedState}function Zy(){return $e().memoizedState}function Ew(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var l=Xn();s=Gs(l);var f=Vs(r,s,l);f!==null&&(In(f,r,l),ml(f,r,l)),r={cache:Wf()},s.payload=r;return}r=r.return}}function Tw(s,r,l){var f=Xn();l={lane:f,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},uu(s)?Jy(r,l):(l=Bf(s,r,l,f),l!==null&&(In(l,s,f),Ky(l,r,f)))}function Qy(s,r,l){var f=Xn();bl(s,r,l,f)}function bl(s,r,l,f){var y={lane:f,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(uu(s))Jy(r,y);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=r.lastRenderedReducer,b!==null))try{var E=r.lastRenderedState,N=b(E,l);if(y.hasEagerState=!0,y.eagerState=N,Vn(N,E))return Wc(s,r,y,0),Ce===null&&kc(),!1}catch{}finally{}if(l=Bf(s,r,y,f),l!==null)return In(l,s,f),Ky(l,r,f),!0}return!1}function gd(s,r,l,f){if(f={lane:2,revertLane:Xd(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},uu(s)){if(r)throw Error(i(479))}else r=Bf(s,l,f,2),r!==null&&In(r,s,2)}function uu(s){var r=s.alternate;return s===se||r!==null&&r===se}function Jy(s,r){Ir=iu=!0;var l=s.pending;l===null?r.next=r:(r.next=l.next,l.next=r),s.pending=r}function Ky(s,r,l){if((l&4194048)!==0){var f=r.lanes;f&=s.pendingLanes,l|=f,r.lanes=l,oe(s,l)}}var _l={readContext:gn,use:ru,useCallback:Ye,useContext:Ye,useEffect:Ye,useImperativeHandle:Ye,useLayoutEffect:Ye,useInsertionEffect:Ye,useMemo:Ye,useReducer:Ye,useRef:Ye,useState:Ye,useDebugValue:Ye,useDeferredValue:Ye,useTransition:Ye,useSyncExternalStore:Ye,useId:Ye,useHostTransitionStatus:Ye,useFormState:Ye,useActionState:Ye,useOptimistic:Ye,useMemoCache:Ye,useCacheRefresh:Ye};_l.useEffectEvent=Ye;var $y={readContext:gn,use:ru,useCallback:function(s,r){return Ln().memoizedState=[s,r===void 0?null:r],s},useContext:gn,useEffect:Py,useImperativeHandle:function(s,r,l){l=l!=null?l.concat([s]):null,lu(4194308,4,Hy.bind(null,r,s),l)},useLayoutEffect:function(s,r){return lu(4194308,4,s,r)},useInsertionEffect:function(s,r){lu(4,2,s,r)},useMemo:function(s,r){var l=Ln();r=r===void 0?null:r;var f=s();if(qa){Je(!0);try{s()}finally{Je(!1)}}return l.memoizedState=[f,r],f},useReducer:function(s,r,l){var f=Ln();if(l!==void 0){var y=l(r);if(qa){Je(!0);try{l(r)}finally{Je(!1)}}}else y=r;return f.memoizedState=f.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},f.queue=s,s=s.dispatch=Tw.bind(null,se,s),[f.memoizedState,s]},useRef:function(s){var r=Ln();return s={current:s},r.memoizedState=s},useState:function(s){s=cd(s);var r=s.queue,l=Qy.bind(null,se,r);return r.dispatch=l,[s.memoizedState,l]},useDebugValue:fd,useDeferredValue:function(s,r){var l=Ln();return dd(l,s,r)},useTransition:function(){var s=cd(!1);return s=jy.bind(null,se,s.queue,!0,!1),Ln().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,l){var f=se,y=Ln();if(pe){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),Ce===null)throw Error(i(349));(fe&127)!==0||by(f,r,l)}y.memoizedState=l;var b={value:l,getSnapshot:r};return y.queue=b,Py(wy.bind(null,f,b,s),[s]),f.flags|=2048,Hr(9,{destroy:void 0},_y.bind(null,f,b,l,r),null),l},useId:function(){var s=Ln(),r=Ce.identifierPrefix;if(pe){var l=Ii,f=Ui;l=(f&~(1<<32-Cn(f)-1)).toString(32)+l,r="_"+r+"R_"+l,l=su++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=xw++,r="_"+r+"r_"+l.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:md,useFormState:Ny,useActionState:Ny,useOptimistic:function(s){var r=Ln();r.memoizedState=r.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=gd.bind(null,se,!0,l),l.dispatch=r,[s,r]},useMemoCache:rd,useCacheRefresh:function(){return Ln().memoizedState=Ew.bind(null,se)},useEffectEvent:function(s){var r=Ln(),l={impl:s};return r.memoizedState=l,function(){if((be&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},yd={readContext:gn,use:ru,useCallback:Vy,useContext:gn,useEffect:hd,useImperativeHandle:Gy,useInsertionEffect:Iy,useLayoutEffect:Fy,useMemo:ky,useReducer:ou,useRef:Oy,useState:function(){return ou(cs)},useDebugValue:fd,useDeferredValue:function(s,r){var l=$e();return Wy(l,Ee.memoizedState,s,r)},useTransition:function(){var s=ou(cs)[0],r=$e().memoizedState;return[typeof s=="boolean"?s:xl(s),r]},useSyncExternalStore:xy,useId:Xy,useHostTransitionStatus:md,useFormState:zy,useActionState:zy,useOptimistic:function(s,r){var l=$e();return Ey(l,Ee,s,r)},useMemoCache:rd,useCacheRefresh:Zy};yd.useEffectEvent=Uy;var t0={readContext:gn,use:ru,useCallback:Vy,useContext:gn,useEffect:hd,useImperativeHandle:Gy,useInsertionEffect:Iy,useLayoutEffect:Fy,useMemo:ky,useReducer:ld,useRef:Oy,useState:function(){return ld(cs)},useDebugValue:fd,useDeferredValue:function(s,r){var l=$e();return Ee===null?dd(l,s,r):Wy(l,Ee.memoizedState,s,r)},useTransition:function(){var s=ld(cs)[0],r=$e().memoizedState;return[typeof s=="boolean"?s:xl(s),r]},useSyncExternalStore:xy,useId:Xy,useHostTransitionStatus:md,useFormState:Dy,useActionState:Dy,useOptimistic:function(s,r){var l=$e();return Ee!==null?Ey(l,Ee,s,r):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:rd,useCacheRefresh:Zy};t0.useEffectEvent=Uy;function vd(s,r,l,f){r=s.memoizedState,l=l(f,r),l=l==null?r:p({},r,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var xd={enqueueSetState:function(s,r,l){s=s._reactInternals;var f=Xn(),y=Gs(f);y.payload=r,l!=null&&(y.callback=l),r=Vs(s,y,f),r!==null&&(In(r,s,f),ml(r,s,f))},enqueueReplaceState:function(s,r,l){s=s._reactInternals;var f=Xn(),y=Gs(f);y.tag=1,y.payload=r,l!=null&&(y.callback=l),r=Vs(s,y,f),r!==null&&(In(r,s,f),ml(r,s,f))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var l=Xn(),f=Gs(l);f.tag=2,r!=null&&(f.callback=r),r=Vs(s,f,l),r!==null&&(In(r,s,l),ml(r,s,l))}};function e0(s,r,l,f,y,b,E){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,b,E):r.prototype&&r.prototype.isPureReactComponent?!ol(l,f)||!ol(y,b):!0}function n0(s,r,l,f){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,f),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,f),r.state!==s&&xd.enqueueReplaceState(r,r.state,null)}function Ya(s,r){var l=r;if("ref"in r){l={};for(var f in r)f!=="ref"&&(l[f]=r[f])}if(s=s.defaultProps){l===r&&(l=p({},l));for(var y in s)l[y]===void 0&&(l[y]=s[y])}return l}function i0(s){Vc(s)}function s0(s){console.error(s)}function a0(s){Vc(s)}function hu(s,r){try{var l=s.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(f){setTimeout(function(){throw f})}}function r0(s,r,l){try{var f=s.onCaughtError;f(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function bd(s,r,l){return l=Gs(l),l.tag=3,l.payload={element:null},l.callback=function(){hu(s,r)},l}function o0(s){return s=Gs(s),s.tag=3,s}function l0(s,r,l,f){var y=l.type.getDerivedStateFromError;if(typeof y=="function"){var b=f.value;s.payload=function(){return y(b)},s.callback=function(){r0(r,l,f)}}var E=l.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(s.callback=function(){r0(r,l,f),typeof y!="function"&&(Xs===null?Xs=new Set([this]):Xs.add(this));var N=f.stack;this.componentDidCatch(f.value,{componentStack:N!==null?N:""})})}function Aw(s,r,l,f,y){if(l.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(r=l.alternate,r!==null&&zr(r,l,y,!0),l=Wn.current,l!==null){switch(l.tag){case 31:case 13:return ui===null?Mu():l.alternate===null&&Xe===0&&(Xe=3),l.flags&=-257,l.flags|=65536,l.lanes=y,f===Kc?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([f]):r.add(f),jd(s,f,y)),!1;case 22:return l.flags|=65536,f===Kc?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([f])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([f]):l.add(f)),jd(s,f,y)),!1}throw Error(i(435,l.tag))}return jd(s,f,y),Mu(),!1}if(pe)return r=Wn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=y,f!==Ff&&(s=Error(i(422),{cause:f}),ul(ri(s,l)))):(f!==Ff&&(r=Error(i(423),{cause:f}),ul(ri(r,l))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,f=ri(f,l),y=bd(s.stateNode,f,y),Qf(s,y),Xe!==4&&(Xe=2)),!1;var b=Error(i(520),{cause:f});if(b=ri(b,l),Ll===null?Ll=[b]:Ll.push(b),Xe!==4&&(Xe=2),r===null)return!0;f=ri(f,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,s=y&-y,l.lanes|=s,s=bd(l.stateNode,f,s),Qf(l,s),!1;case 1:if(r=l.type,b=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Xs===null||!Xs.has(b))))return l.flags|=65536,y&=-y,l.lanes|=y,y=o0(y),l0(y,s,l,f),Qf(l,y),!1}l=l.return}while(l!==null);return!1}var _d=Error(i(461)),an=!1;function yn(s,r,l,f){r.child=s===null?fy(r,null,l,f):ja(r,s.child,l,f)}function c0(s,r,l,f,y){l=l.render;var b=r.ref;if("ref"in f){var E={};for(var N in f)N!=="ref"&&(E[N]=f[N])}else E=f;return Ga(r),f=nd(s,r,l,E,b,y),N=id(),s!==null&&!an?(sd(s,r,y),us(s,r,y)):(pe&&N&&Uf(r),r.flags|=1,yn(s,r,f,y),r.child)}function u0(s,r,l,f,y){if(s===null){var b=l.type;return typeof b=="function"&&!Df(b)&&b.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=b,h0(s,r,b,f,y)):(s=qc(l.type,null,f,r,r.mode,y),s.ref=r.ref,s.return=r,r.child=s)}if(b=s.child,!Ld(s,y)){var E=b.memoizedProps;if(l=l.compare,l=l!==null?l:ol,l(E,f)&&s.ref===r.ref)return us(s,r,y)}return r.flags|=1,s=ss(b,f),s.ref=r.ref,s.return=r,r.child=s}function h0(s,r,l,f,y){if(s!==null){var b=s.memoizedProps;if(ol(b,f)&&s.ref===r.ref)if(an=!1,r.pendingProps=f=b,Ld(s,y))(s.flags&131072)!==0&&(an=!0);else return r.lanes=s.lanes,us(s,r,y)}return wd(s,r,l,f,y)}function f0(s,r,l,f){var y=f.children,b=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((r.flags&128)!==0){if(b=b!==null?b.baseLanes|l:l,s!==null){for(f=r.child=s.child,y=0;f!==null;)y=y|f.lanes|f.childLanes,f=f.sibling;f=y&~b}else f=0,r.child=null;return d0(s,r,b,l,f)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&Qc(r,b!==null?b.cachePool:null),b!==null?my(r,b):Kf(),gy(r);else return f=r.lanes=536870912,d0(s,r,b!==null?b.baseLanes|l:l,l,f)}else b!==null?(Qc(r,b.cachePool),my(r,b),Ws(),r.memoizedState=null):(s!==null&&Qc(r,null),Kf(),Ws());return yn(s,r,y,l),r.child}function wl(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function d0(s,r,l,f,y){var b=qf();return b=b===null?null:{parent:nn._currentValue,pool:b},r.memoizedState={baseLanes:l,cachePool:b},s!==null&&Qc(r,null),Kf(),gy(r),s!==null&&zr(s,r,f,!0),r.childLanes=y,null}function fu(s,r){return r=pu({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function p0(s,r,l){return ja(r,s.child,null,l),s=fu(r,r.pendingProps),s.flags|=2,jn(r),r.memoizedState=null,s}function Cw(s,r,l){var f=r.pendingProps,y=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(pe){if(f.mode==="hidden")return s=fu(r,f),r.lanes=536870912,wl(null,s);if(td(r),(s=Pe)?(s=Tv(s,ci),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Ps!==null?{id:Ui,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},l=Jg(s),l.return=r,r.child=l,mn=r,Pe=null)):s=null,s===null)throw Is(r);return r.lanes=536870912,null}return fu(r,f)}var b=s.memoizedState;if(b!==null){var E=b.dehydrated;if(td(r),y)if(r.flags&256)r.flags&=-257,r=p0(s,r,l);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(an||zr(s,r,l,!1),y=(l&s.childLanes)!==0,an||y){if(f=Ce,f!==null&&(E=ie(f,l),E!==0&&E!==b.retryLane))throw b.retryLane=E,Ua(s,E),In(f,s,E),_d;Mu(),r=p0(s,r,l)}else s=b.treeContext,Pe=hi(E.nextSibling),mn=r,pe=!0,Us=null,ci=!1,s!==null&&ty(r,s),r=fu(r,f),r.flags|=4096;return r}return s=ss(s.child,{mode:f.mode,children:f.children}),s.ref=r.ref,r.child=s,s.return=r,s}function du(s,r){var l=r.ref;if(l===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(r.flags|=4194816)}}function wd(s,r,l,f,y){return Ga(r),l=nd(s,r,l,f,void 0,y),f=id(),s!==null&&!an?(sd(s,r,y),us(s,r,y)):(pe&&f&&Uf(r),r.flags|=1,yn(s,r,l,y),r.child)}function m0(s,r,l,f,y,b){return Ga(r),r.updateQueue=null,l=vy(r,f,l,y),yy(s),f=id(),s!==null&&!an?(sd(s,r,b),us(s,r,b)):(pe&&f&&Uf(r),r.flags|=1,yn(s,r,l,b),r.child)}function g0(s,r,l,f,y){if(Ga(r),r.stateNode===null){var b=Cr,E=l.contextType;typeof E=="object"&&E!==null&&(b=gn(E)),b=new l(f,b),r.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=xd,r.stateNode=b,b._reactInternals=r,b=r.stateNode,b.props=f,b.state=r.memoizedState,b.refs={},Xf(r),E=l.contextType,b.context=typeof E=="object"&&E!==null?gn(E):Cr,b.state=r.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(vd(r,l,E,f),b.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(E=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),E!==b.state&&xd.enqueueReplaceState(b,b.state,null),yl(r,f,b,y),gl(),b.state=r.memoizedState),typeof b.componentDidMount=="function"&&(r.flags|=4194308),f=!0}else if(s===null){b=r.stateNode;var N=r.memoizedProps,k=Ya(l,N);b.props=k;var nt=b.context,dt=l.contextType;E=Cr,typeof dt=="object"&&dt!==null&&(E=gn(dt));var mt=l.getDerivedStateFromProps;dt=typeof mt=="function"||typeof b.getSnapshotBeforeUpdate=="function",N=r.pendingProps!==N,dt||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(N||nt!==E)&&n0(r,b,f,E),Hs=!1;var at=r.memoizedState;b.state=at,yl(r,f,b,y),gl(),nt=r.memoizedState,N||at!==nt||Hs?(typeof mt=="function"&&(vd(r,l,mt,f),nt=r.memoizedState),(k=Hs||e0(r,l,k,f,at,nt,E))?(dt||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(r.flags|=4194308)):(typeof b.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=f,r.memoizedState=nt),b.props=f,b.state=nt,b.context=E,f=k):(typeof b.componentDidMount=="function"&&(r.flags|=4194308),f=!1)}else{b=r.stateNode,Zf(s,r),E=r.memoizedProps,dt=Ya(l,E),b.props=dt,mt=r.pendingProps,at=b.context,nt=l.contextType,k=Cr,typeof nt=="object"&&nt!==null&&(k=gn(nt)),N=l.getDerivedStateFromProps,(nt=typeof N=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(E!==mt||at!==k)&&n0(r,b,f,k),Hs=!1,at=r.memoizedState,b.state=at,yl(r,f,b,y),gl();var ot=r.memoizedState;E!==mt||at!==ot||Hs||s!==null&&s.dependencies!==null&&Xc(s.dependencies)?(typeof N=="function"&&(vd(r,l,N,f),ot=r.memoizedState),(dt=Hs||e0(r,l,dt,f,at,ot,k)||s!==null&&s.dependencies!==null&&Xc(s.dependencies))?(nt||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(f,ot,k),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(f,ot,k)),typeof b.componentDidUpdate=="function"&&(r.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof b.componentDidUpdate!="function"||E===s.memoizedProps&&at===s.memoizedState||(r.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&at===s.memoizedState||(r.flags|=1024),r.memoizedProps=f,r.memoizedState=ot),b.props=f,b.state=ot,b.context=k,f=dt):(typeof b.componentDidUpdate!="function"||E===s.memoizedProps&&at===s.memoizedState||(r.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&at===s.memoizedState||(r.flags|=1024),f=!1)}return b=f,du(s,r),f=(r.flags&128)!==0,b||f?(b=r.stateNode,l=f&&typeof l.getDerivedStateFromError!="function"?null:b.render(),r.flags|=1,s!==null&&f?(r.child=ja(r,s.child,null,y),r.child=ja(r,null,l,y)):yn(s,r,l,y),r.memoizedState=b.state,s=r.child):s=us(s,r,y),s}function y0(s,r,l,f){return Fa(),r.flags|=256,yn(s,r,l,f),r.child}var Md={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Sd(s){return{baseLanes:s,cachePool:ry()}}function Ed(s,r,l){return s=s!==null?s.childLanes&~l:0,r&&(s|=Yn),s}function v0(s,r,l){var f=r.pendingProps,y=!1,b=(r.flags&128)!==0,E;if((E=b)||(E=s!==null&&s.memoizedState===null?!1:(Ke.current&2)!==0),E&&(y=!0,r.flags&=-129),E=(r.flags&32)!==0,r.flags&=-33,s===null){if(pe){if(y?ks(r):Ws(),(s=Pe)?(s=Tv(s,ci),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Ps!==null?{id:Ui,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},l=Jg(s),l.return=r,r.child=l,mn=r,Pe=null)):s=null,s===null)throw Is(r);return op(s)?r.lanes=32:r.lanes=536870912,null}var N=f.children;return f=f.fallback,y?(Ws(),y=r.mode,N=pu({mode:"hidden",children:N},y),f=Ia(f,y,l,null),N.return=r,f.return=r,N.sibling=f,r.child=N,f=r.child,f.memoizedState=Sd(l),f.childLanes=Ed(s,E,l),r.memoizedState=Md,wl(null,f)):(ks(r),Td(r,N))}var k=s.memoizedState;if(k!==null&&(N=k.dehydrated,N!==null)){if(b)r.flags&256?(ks(r),r.flags&=-257,r=Ad(s,r,l)):r.memoizedState!==null?(Ws(),r.child=s.child,r.flags|=128,r=null):(Ws(),N=f.fallback,y=r.mode,f=pu({mode:"visible",children:f.children},y),N=Ia(N,y,l,null),N.flags|=2,f.return=r,N.return=r,f.sibling=N,r.child=f,ja(r,s.child,null,l),f=r.child,f.memoizedState=Sd(l),f.childLanes=Ed(s,E,l),r.memoizedState=Md,r=wl(null,f));else if(ks(r),op(N)){if(E=N.nextSibling&&N.nextSibling.dataset,E)var nt=E.dgst;E=nt,f=Error(i(419)),f.stack="",f.digest=E,ul({value:f,source:null,stack:null}),r=Ad(s,r,l)}else if(an||zr(s,r,l,!1),E=(l&s.childLanes)!==0,an||E){if(E=Ce,E!==null&&(f=ie(E,l),f!==0&&f!==k.retryLane))throw k.retryLane=f,Ua(s,f),In(E,s,f),_d;rp(N)||Mu(),r=Ad(s,r,l)}else rp(N)?(r.flags|=192,r.child=s.child,r=null):(s=k.treeContext,Pe=hi(N.nextSibling),mn=r,pe=!0,Us=null,ci=!1,s!==null&&ty(r,s),r=Td(r,f.children),r.flags|=4096);return r}return y?(Ws(),N=f.fallback,y=r.mode,k=s.child,nt=k.sibling,f=ss(k,{mode:"hidden",children:f.children}),f.subtreeFlags=k.subtreeFlags&65011712,nt!==null?N=ss(nt,N):(N=Ia(N,y,l,null),N.flags|=2),N.return=r,f.return=r,f.sibling=N,r.child=f,wl(null,f),f=r.child,N=s.child.memoizedState,N===null?N=Sd(l):(y=N.cachePool,y!==null?(k=nn._currentValue,y=y.parent!==k?{parent:k,pool:k}:y):y=ry(),N={baseLanes:N.baseLanes|l,cachePool:y}),f.memoizedState=N,f.childLanes=Ed(s,E,l),r.memoizedState=Md,wl(s.child,f)):(ks(r),l=s.child,s=l.sibling,l=ss(l,{mode:"visible",children:f.children}),l.return=r,l.sibling=null,s!==null&&(E=r.deletions,E===null?(r.deletions=[s],r.flags|=16):E.push(s)),r.child=l,r.memoizedState=null,l)}function Td(s,r){return r=pu({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function pu(s,r){return s=kn(22,s,null,r),s.lanes=0,s}function Ad(s,r,l){return ja(r,s.child,null,l),s=Td(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function x0(s,r,l){s.lanes|=r;var f=s.alternate;f!==null&&(f.lanes|=r),Vf(s.return,r,l)}function Cd(s,r,l,f,y,b){var E=s.memoizedState;E===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:y,treeForkCount:b}:(E.isBackwards=r,E.rendering=null,E.renderingStartTime=0,E.last=f,E.tail=l,E.tailMode=y,E.treeForkCount=b)}function b0(s,r,l){var f=r.pendingProps,y=f.revealOrder,b=f.tail;f=f.children;var E=Ke.current,N=(E&2)!==0;if(N?(E=E&1|2,r.flags|=128):E&=1,ut(Ke,E),yn(s,r,f,l),f=pe?cl:0,!N&&s!==null&&(s.flags&128)!==0)t:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&x0(s,l,r);else if(s.tag===19)x0(s,l,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break t;for(;s.sibling===null;){if(s.return===null||s.return===r)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(y){case"forwards":for(l=r.child,y=null;l!==null;)s=l.alternate,s!==null&&nu(s)===null&&(y=l),l=l.sibling;l=y,l===null?(y=r.child,r.child=null):(y=l.sibling,l.sibling=null),Cd(r,!1,y,l,b,f);break;case"backwards":case"unstable_legacy-backwards":for(l=null,y=r.child,r.child=null;y!==null;){if(s=y.alternate,s!==null&&nu(s)===null){r.child=y;break}s=y.sibling,y.sibling=l,l=y,y=s}Cd(r,!0,l,null,b,f);break;case"together":Cd(r,!1,null,null,void 0,f);break;default:r.memoizedState=null}return r.child}function us(s,r,l){if(s!==null&&(r.dependencies=s.dependencies),Ys|=r.lanes,(l&r.childLanes)===0)if(s!==null){if(zr(s,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,l=ss(s,s.pendingProps),r.child=l,l.return=r;s.sibling!==null;)s=s.sibling,l=l.sibling=ss(s,s.pendingProps),l.return=r;l.sibling=null}return r.child}function Ld(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&Xc(s)))}function Lw(s,r,l){switch(r.tag){case 3:Ht(r,r.stateNode.containerInfo),Fs(r,nn,s.memoizedState.cache),Fa();break;case 27:case 5:Qt(r);break;case 4:Ht(r,r.stateNode.containerInfo);break;case 10:Fs(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,td(r),null;break;case 13:var f=r.memoizedState;if(f!==null)return f.dehydrated!==null?(ks(r),r.flags|=128,null):(l&r.child.childLanes)!==0?v0(s,r,l):(ks(r),s=us(s,r,l),s!==null?s.sibling:null);ks(r);break;case 19:var y=(s.flags&128)!==0;if(f=(l&r.childLanes)!==0,f||(zr(s,r,l,!1),f=(l&r.childLanes)!==0),y){if(f)return b0(s,r,l);r.flags|=128}if(y=r.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),ut(Ke,Ke.current),f)break;return null;case 22:return r.lanes=0,f0(s,r,l,r.pendingProps);case 24:Fs(r,nn,s.memoizedState.cache)}return us(s,r,l)}function _0(s,r,l){if(s!==null)if(s.memoizedProps!==r.pendingProps)an=!0;else{if(!Ld(s,l)&&(r.flags&128)===0)return an=!1,Lw(s,r,l);an=(s.flags&131072)!==0}else an=!1,pe&&(r.flags&1048576)!==0&&$g(r,cl,r.index);switch(r.lanes=0,r.tag){case 16:t:{var f=r.pendingProps;if(s=ka(r.elementType),r.type=s,typeof s=="function")Df(s)?(f=Ya(s,f),r.tag=1,r=g0(null,r,s,f,l)):(r.tag=0,r=wd(null,r,s,f,l));else{if(s!=null){var y=s.$$typeof;if(y===R){r.tag=11,r=c0(null,r,s,f,l);break t}else if(y===B){r.tag=14,r=u0(null,r,s,f,l);break t}}throw r=H(s)||s,Error(i(306,r,""))}}return r;case 0:return wd(s,r,r.type,r.pendingProps,l);case 1:return f=r.type,y=Ya(f,r.pendingProps),g0(s,r,f,y,l);case 3:t:{if(Ht(r,r.stateNode.containerInfo),s===null)throw Error(i(387));f=r.pendingProps;var b=r.memoizedState;y=b.element,Zf(s,r),yl(r,f,null,l);var E=r.memoizedState;if(f=E.cache,Fs(r,nn,f),f!==b.cache&&kf(r,[nn],l,!0),gl(),f=E.element,b.isDehydrated)if(b={element:f,isDehydrated:!1,cache:E.cache},r.updateQueue.baseState=b,r.memoizedState=b,r.flags&256){r=y0(s,r,f,l);break t}else if(f!==y){y=ri(Error(i(424)),r),ul(y),r=y0(s,r,f,l);break t}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Pe=hi(s.firstChild),mn=r,pe=!0,Us=null,ci=!0,l=fy(r,null,f,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Fa(),f===y){r=us(s,r,l);break t}yn(s,r,f,l)}r=r.child}return r;case 26:return du(s,r),s===null?(l=zv(r.type,null,r.pendingProps,null))?r.memoizedState=l:pe||(l=r.type,s=r.pendingProps,f=Ru(Ct.current).createElement(l),f[Kt]=r,f[Ge]=s,vn(f,l,s),un(f),r.stateNode=f):r.memoizedState=zv(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Qt(r),s===null&&pe&&(f=r.stateNode=Lv(r.type,r.pendingProps,Ct.current),mn=r,ci=!0,y=Pe,Ks(r.type)?(lp=y,Pe=hi(f.firstChild)):Pe=y),yn(s,r,r.pendingProps.children,l),du(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&pe&&((y=f=Pe)&&(f=aM(f,r.type,r.pendingProps,ci),f!==null?(r.stateNode=f,mn=r,Pe=hi(f.firstChild),ci=!1,y=!0):y=!1),y||Is(r)),Qt(r),y=r.type,b=r.pendingProps,E=s!==null?s.memoizedProps:null,f=b.children,ip(y,b)?f=null:E!==null&&ip(y,E)&&(r.flags|=32),r.memoizedState!==null&&(y=nd(s,r,bw,null,null,l),Ul._currentValue=y),du(s,r),yn(s,r,f,l),r.child;case 6:return s===null&&pe&&((s=l=Pe)&&(l=rM(l,r.pendingProps,ci),l!==null?(r.stateNode=l,mn=r,Pe=null,s=!0):s=!1),s||Is(r)),null;case 13:return v0(s,r,l);case 4:return Ht(r,r.stateNode.containerInfo),f=r.pendingProps,s===null?r.child=ja(r,null,f,l):yn(s,r,f,l),r.child;case 11:return c0(s,r,r.type,r.pendingProps,l);case 7:return yn(s,r,r.pendingProps,l),r.child;case 8:return yn(s,r,r.pendingProps.children,l),r.child;case 12:return yn(s,r,r.pendingProps.children,l),r.child;case 10:return f=r.pendingProps,Fs(r,r.type,f.value),yn(s,r,f.children,l),r.child;case 9:return y=r.type._context,f=r.pendingProps.children,Ga(r),y=gn(y),f=f(y),r.flags|=1,yn(s,r,f,l),r.child;case 14:return u0(s,r,r.type,r.pendingProps,l);case 15:return h0(s,r,r.type,r.pendingProps,l);case 19:return b0(s,r,l);case 31:return Cw(s,r,l);case 22:return f0(s,r,l,r.pendingProps);case 24:return Ga(r),f=gn(nn),s===null?(y=qf(),y===null&&(y=Ce,b=Wf(),y.pooledCache=b,b.refCount++,b!==null&&(y.pooledCacheLanes|=l),y=b),r.memoizedState={parent:f,cache:y},Xf(r),Fs(r,nn,y)):((s.lanes&l)!==0&&(Zf(s,r),yl(r,null,null,l),gl()),y=s.memoizedState,b=r.memoizedState,y.parent!==f?(y={parent:f,cache:f},r.memoizedState=y,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=y),Fs(r,nn,f)):(f=b.cache,Fs(r,nn,f),f!==y.cache&&kf(r,[nn],l,!0))),yn(s,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function hs(s){s.flags|=4}function Rd(s,r,l,f,y){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(y&335544128)===y)if(s.stateNode.complete)s.flags|=8192;else if(X0())s.flags|=8192;else throw Wa=Kc,Yf}else s.flags&=-16777217}function w0(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Uv(r))if(X0())s.flags|=8192;else throw Wa=Kc,Yf}function mu(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?P():536870912,s.lanes|=r,Wr|=r)}function Ml(s,r){if(!pe)switch(s.tailMode){case"hidden":r=s.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function Ue(s){var r=s.alternate!==null&&s.alternate.child===s.child,l=0,f=0;if(r)for(var y=s.child;y!==null;)l|=y.lanes|y.childLanes,f|=y.subtreeFlags&65011712,f|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)l|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=f,s.childLanes=l,r}function Rw(s,r,l){var f=r.pendingProps;switch(If(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ue(r),null;case 1:return Ue(r),null;case 3:return l=r.stateNode,f=null,s!==null&&(f=s.memoizedState.cache),r.memoizedState.cache!==f&&(r.flags|=2048),os(nn),Lt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Nr(r)?hs(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Hf())),Ue(r),null;case 26:var y=r.type,b=r.memoizedState;return s===null?(hs(r),b!==null?(Ue(r),w0(r,b)):(Ue(r),Rd(r,y,null,f,l))):b?b!==s.memoizedState?(hs(r),Ue(r),w0(r,b)):(Ue(r),r.flags&=-16777217):(s=s.memoizedProps,s!==f&&hs(r),Ue(r),Rd(r,y,s,f,l)),null;case 27:if(kt(r),l=Ct.current,y=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==f&&hs(r);else{if(!f){if(r.stateNode===null)throw Error(i(166));return Ue(r),null}s=yt.current,Nr(r)?ey(r):(s=Lv(y,f,l),r.stateNode=s,hs(r))}return Ue(r),null;case 5:if(kt(r),y=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==f&&hs(r);else{if(!f){if(r.stateNode===null)throw Error(i(166));return Ue(r),null}if(b=yt.current,Nr(r))ey(r);else{var E=Ru(Ct.current);switch(b){case 1:b=E.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:b=E.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":b=E.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":b=E.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":b=E.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof f.is=="string"?E.createElement("select",{is:f.is}):E.createElement("select"),f.multiple?b.multiple=!0:f.size&&(b.size=f.size);break;default:b=typeof f.is=="string"?E.createElement(y,{is:f.is}):E.createElement(y)}}b[Kt]=r,b[Ge]=f;t:for(E=r.child;E!==null;){if(E.tag===5||E.tag===6)b.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===r)break t;for(;E.sibling===null;){if(E.return===null||E.return===r)break t;E=E.return}E.sibling.return=E.return,E=E.sibling}r.stateNode=b;t:switch(vn(b,y,f),y){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break t;case"img":f=!0;break t;default:f=!1}f&&hs(r)}}return Ue(r),Rd(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,l),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==f&&hs(r);else{if(typeof f!="string"&&r.stateNode===null)throw Error(i(166));if(s=Ct.current,Nr(r)){if(s=r.stateNode,l=r.memoizedProps,f=null,y=mn,y!==null)switch(y.tag){case 27:case 5:f=y.memoizedProps}s[Kt]=r,s=!!(s.nodeValue===l||f!==null&&f.suppressHydrationWarning===!0||vv(s.nodeValue,l)),s||Is(r,!0)}else s=Ru(s).createTextNode(f),s[Kt]=r,r.stateNode=s}return Ue(r),null;case 31:if(l=r.memoizedState,s===null||s.memoizedState!==null){if(f=Nr(r),l!==null){if(s===null){if(!f)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Kt]=r}else Fa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ue(r),s=!1}else l=Hf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return r.flags&256?(jn(r),r):(jn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Ue(r),null;case 13:if(f=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=Nr(r),f!==null&&f.dehydrated!==null){if(s===null){if(!y)throw Error(i(318));if(y=r.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[Kt]=r}else Fa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ue(r),y=!1}else y=Hf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return r.flags&256?(jn(r),r):(jn(r),null)}return jn(r),(r.flags&128)!==0?(r.lanes=l,r):(l=f!==null,s=s!==null&&s.memoizedState!==null,l&&(f=r.child,y=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(y=f.alternate.memoizedState.cachePool.pool),b=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),b!==y&&(f.flags|=2048)),l!==s&&l&&(r.child.flags|=8192),mu(r,r.updateQueue),Ue(r),null);case 4:return Lt(),s===null&&Kd(r.stateNode.containerInfo),Ue(r),null;case 10:return os(r.type),Ue(r),null;case 19:if(q(Ke),f=r.memoizedState,f===null)return Ue(r),null;if(y=(r.flags&128)!==0,b=f.rendering,b===null)if(y)Ml(f,!1);else{if(Xe!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(b=nu(s),b!==null){for(r.flags|=128,Ml(f,!1),s=b.updateQueue,r.updateQueue=s,mu(r,s),r.subtreeFlags=0,s=l,l=r.child;l!==null;)Qg(l,s),l=l.sibling;return ut(Ke,Ke.current&1|2),pe&&as(r,f.treeForkCount),r.child}s=s.sibling}f.tail!==null&&Ot()>bu&&(r.flags|=128,y=!0,Ml(f,!1),r.lanes=4194304)}else{if(!y)if(s=nu(b),s!==null){if(r.flags|=128,y=!0,s=s.updateQueue,r.updateQueue=s,mu(r,s),Ml(f,!0),f.tail===null&&f.tailMode==="hidden"&&!b.alternate&&!pe)return Ue(r),null}else 2*Ot()-f.renderingStartTime>bu&&l!==536870912&&(r.flags|=128,y=!0,Ml(f,!1),r.lanes=4194304);f.isBackwards?(b.sibling=r.child,r.child=b):(s=f.last,s!==null?s.sibling=b:r.child=b,f.last=b)}return f.tail!==null?(s=f.tail,f.rendering=s,f.tail=s.sibling,f.renderingStartTime=Ot(),s.sibling=null,l=Ke.current,ut(Ke,y?l&1|2:l&1),pe&&as(r,f.treeForkCount),s):(Ue(r),null);case 22:case 23:return jn(r),$f(),f=r.memoizedState!==null,s!==null?s.memoizedState!==null!==f&&(r.flags|=8192):f&&(r.flags|=8192),f?(l&536870912)!==0&&(r.flags&128)===0&&(Ue(r),r.subtreeFlags&6&&(r.flags|=8192)):Ue(r),l=r.updateQueue,l!==null&&mu(r,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),f=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(f=r.memoizedState.cachePool.pool),f!==l&&(r.flags|=2048),s!==null&&q(Va),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),os(nn),Ue(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function Nw(s,r){switch(If(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return os(nn),Lt(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return kt(r),null;case 31:if(r.memoizedState!==null){if(jn(r),r.alternate===null)throw Error(i(340));Fa()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(jn(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Fa()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return q(Ke),null;case 4:return Lt(),null;case 10:return os(r.type),null;case 22:case 23:return jn(r),$f(),s!==null&&q(Va),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return os(nn),null;case 25:return null;default:return null}}function M0(s,r){switch(If(r),r.tag){case 3:os(nn),Lt();break;case 26:case 27:case 5:kt(r);break;case 4:Lt();break;case 31:r.memoizedState!==null&&jn(r);break;case 13:jn(r);break;case 19:q(Ke);break;case 10:os(r.type);break;case 22:case 23:jn(r),$f(),s!==null&&q(Va);break;case 24:os(nn)}}function Sl(s,r){try{var l=r.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var y=f.next;l=y;do{if((l.tag&s)===s){f=void 0;var b=l.create,E=l.inst;f=b(),E.destroy=f}l=l.next}while(l!==y)}}catch(N){Se(r,r.return,N)}}function js(s,r,l){try{var f=r.updateQueue,y=f!==null?f.lastEffect:null;if(y!==null){var b=y.next;f=b;do{if((f.tag&s)===s){var E=f.inst,N=E.destroy;if(N!==void 0){E.destroy=void 0,y=r;var k=l,nt=N;try{nt()}catch(dt){Se(y,k,dt)}}}f=f.next}while(f!==b)}}catch(dt){Se(r,r.return,dt)}}function S0(s){var r=s.updateQueue;if(r!==null){var l=s.stateNode;try{py(r,l)}catch(f){Se(s,s.return,f)}}}function E0(s,r,l){l.props=Ya(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(f){Se(s,r,f)}}function El(s,r){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var f=s.stateNode;break;case 30:f=s.stateNode;break;default:f=s.stateNode}typeof l=="function"?s.refCleanup=l(f):l.current=f}}catch(y){Se(s,r,y)}}function Fi(s,r){var l=s.ref,f=s.refCleanup;if(l!==null)if(typeof f=="function")try{f()}catch(y){Se(s,r,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(y){Se(s,r,y)}else l.current=null}function T0(s){var r=s.type,l=s.memoizedProps,f=s.stateNode;try{t:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&f.focus();break t;case"img":l.src?f.src=l.src:l.srcSet&&(f.srcset=l.srcSet)}}catch(y){Se(s,s.return,y)}}function Nd(s,r,l){try{var f=s.stateNode;$w(f,s.type,l,r),f[Ge]=r}catch(y){Se(s,s.return,y)}}function A0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ks(s.type)||s.tag===4}function zd(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||A0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ks(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Bd(s,r,l){var f=s.tag;if(f===5||f===6)s=s.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(s),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=ns));else if(f!==4&&(f===27&&Ks(s.type)&&(l=s.stateNode,r=null),s=s.child,s!==null))for(Bd(s,r,l),s=s.sibling;s!==null;)Bd(s,r,l),s=s.sibling}function gu(s,r,l){var f=s.tag;if(f===5||f===6)s=s.stateNode,r?l.insertBefore(s,r):l.appendChild(s);else if(f!==4&&(f===27&&Ks(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(gu(s,r,l),s=s.sibling;s!==null;)gu(s,r,l),s=s.sibling}function C0(s){var r=s.stateNode,l=s.memoizedProps;try{for(var f=s.type,y=r.attributes;y.length;)r.removeAttributeNode(y[0]);vn(r,f,l),r[Kt]=s,r[Ge]=l}catch(b){Se(s,s.return,b)}}var fs=!1,rn=!1,Dd=!1,L0=typeof WeakSet=="function"?WeakSet:Set,hn=null;function zw(s,r){if(s=s.containerInfo,ep=Uu,s=Gg(s),Af(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else t:{l=(l=s.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var y=f.anchorOffset,b=f.focusNode;f=f.focusOffset;try{l.nodeType,b.nodeType}catch{l=null;break t}var E=0,N=-1,k=-1,nt=0,dt=0,mt=s,at=null;e:for(;;){for(var ot;mt!==l||y!==0&&mt.nodeType!==3||(N=E+y),mt!==b||f!==0&&mt.nodeType!==3||(k=E+f),mt.nodeType===3&&(E+=mt.nodeValue.length),(ot=mt.firstChild)!==null;)at=mt,mt=ot;for(;;){if(mt===s)break e;if(at===l&&++nt===y&&(N=E),at===b&&++dt===f&&(k=E),(ot=mt.nextSibling)!==null)break;mt=at,at=mt.parentNode}mt=ot}l=N===-1||k===-1?null:{start:N,end:k}}else l=null}l=l||{start:0,end:0}}else l=null;for(np={focusedElem:s,selectionRange:l},Uu=!1,hn=r;hn!==null;)if(r=hn,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,hn=s;else for(;hn!==null;){switch(r=hn,b=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)y=s[l],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&b!==null){s=void 0,l=r,y=b.memoizedProps,b=b.memoizedState,f=l.stateNode;try{var It=Ya(l.type,y);s=f.getSnapshotBeforeUpdate(It,b),f.__reactInternalSnapshotBeforeUpdate=s}catch(Yt){Se(l,l.return,Yt)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,l=s.nodeType,l===9)ap(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ap(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,hn=s;break}hn=r.return}}function R0(s,r,l){var f=l.flags;switch(l.tag){case 0:case 11:case 15:ps(s,l),f&4&&Sl(5,l);break;case 1:if(ps(s,l),f&4)if(s=l.stateNode,r===null)try{s.componentDidMount()}catch(E){Se(l,l.return,E)}else{var y=Ya(l.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(y,r,s.__reactInternalSnapshotBeforeUpdate)}catch(E){Se(l,l.return,E)}}f&64&&S0(l),f&512&&El(l,l.return);break;case 3:if(ps(s,l),f&64&&(s=l.updateQueue,s!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{py(s,r)}catch(E){Se(l,l.return,E)}}break;case 27:r===null&&f&4&&C0(l);case 26:case 5:ps(s,l),r===null&&f&4&&T0(l),f&512&&El(l,l.return);break;case 12:ps(s,l);break;case 31:ps(s,l),f&4&&B0(s,l);break;case 13:ps(s,l),f&4&&D0(s,l),f&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=Gw.bind(null,l),oM(s,l))));break;case 22:if(f=l.memoizedState!==null||fs,!f){r=r!==null&&r.memoizedState!==null||rn,y=fs;var b=rn;fs=f,(rn=r)&&!b?ms(s,l,(l.subtreeFlags&8772)!==0):ps(s,l),fs=y,rn=b}break;case 30:break;default:ps(s,l)}}function N0(s){var r=s.alternate;r!==null&&(s.alternate=null,N0(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Pi(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Ve=null,Dn=!1;function ds(s,r,l){for(l=l.child;l!==null;)z0(s,r,l),l=l.sibling}function z0(s,r,l){if(Oe&&typeof Oe.onCommitFiberUnmount=="function")try{Oe.onCommitFiberUnmount(bi,l)}catch{}switch(l.tag){case 26:rn||Fi(l,r),ds(s,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:rn||Fi(l,r);var f=Ve,y=Dn;Ks(l.type)&&(Ve=l.stateNode,Dn=!1),ds(s,r,l),Dl(l.stateNode),Ve=f,Dn=y;break;case 5:rn||Fi(l,r);case 6:if(f=Ve,y=Dn,Ve=null,ds(s,r,l),Ve=f,Dn=y,Ve!==null)if(Dn)try{(Ve.nodeType===9?Ve.body:Ve.nodeName==="HTML"?Ve.ownerDocument.body:Ve).removeChild(l.stateNode)}catch(b){Se(l,r,b)}else try{Ve.removeChild(l.stateNode)}catch(b){Se(l,r,b)}break;case 18:Ve!==null&&(Dn?(s=Ve,Sv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Kr(s)):Sv(Ve,l.stateNode));break;case 4:f=Ve,y=Dn,Ve=l.stateNode.containerInfo,Dn=!0,ds(s,r,l),Ve=f,Dn=y;break;case 0:case 11:case 14:case 15:js(2,l,r),rn||js(4,l,r),ds(s,r,l);break;case 1:rn||(Fi(l,r),f=l.stateNode,typeof f.componentWillUnmount=="function"&&E0(l,r,f)),ds(s,r,l);break;case 21:ds(s,r,l);break;case 22:rn=(f=rn)||l.memoizedState!==null,ds(s,r,l),rn=f;break;default:ds(s,r,l)}}function B0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Kr(s)}catch(l){Se(r,r.return,l)}}}function D0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Kr(s)}catch(l){Se(r,r.return,l)}}function Bw(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new L0),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new L0),r;default:throw Error(i(435,s.tag))}}function yu(s,r){var l=Bw(s);r.forEach(function(f){if(!l.has(f)){l.add(f);var y=Vw.bind(null,s,f);f.then(y,y)}})}function On(s,r){var l=r.deletions;if(l!==null)for(var f=0;f<l.length;f++){var y=l[f],b=s,E=r,N=E;t:for(;N!==null;){switch(N.tag){case 27:if(Ks(N.type)){Ve=N.stateNode,Dn=!1;break t}break;case 5:Ve=N.stateNode,Dn=!1;break t;case 3:case 4:Ve=N.stateNode.containerInfo,Dn=!0;break t}N=N.return}if(Ve===null)throw Error(i(160));z0(b,E,y),Ve=null,Dn=!1,b=y.alternate,b!==null&&(b.return=null),y.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)O0(r,s),r=r.sibling}var Si=null;function O0(s,r){var l=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:On(r,s),Pn(s),f&4&&(js(3,s,s.return),Sl(3,s),js(5,s,s.return));break;case 1:On(r,s),Pn(s),f&512&&(rn||l===null||Fi(l,l.return)),f&64&&fs&&(s=s.updateQueue,s!==null&&(f=s.callbacks,f!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?f:l.concat(f))));break;case 26:var y=Si;if(On(r,s),Pn(s),f&512&&(rn||l===null||Fi(l,l.return)),f&4){var b=l!==null?l.memoizedState:null;if(f=s.memoizedState,l===null)if(f===null)if(s.stateNode===null){t:{f=s.type,l=s.memoizedProps,y=y.ownerDocument||y;e:switch(f){case"title":b=y.getElementsByTagName("title")[0],(!b||b[wi]||b[Kt]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=y.createElement(f),y.head.insertBefore(b,y.querySelector("head > title"))),vn(b,f,l),b[Kt]=s,un(b),f=b;break t;case"link":var E=Ov("link","href",y).get(f+(l.href||""));if(E){for(var N=0;N<E.length;N++)if(b=E[N],b.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&b.getAttribute("rel")===(l.rel==null?null:l.rel)&&b.getAttribute("title")===(l.title==null?null:l.title)&&b.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){E.splice(N,1);break e}}b=y.createElement(f),vn(b,f,l),y.head.appendChild(b);break;case"meta":if(E=Ov("meta","content",y).get(f+(l.content||""))){for(N=0;N<E.length;N++)if(b=E[N],b.getAttribute("content")===(l.content==null?null:""+l.content)&&b.getAttribute("name")===(l.name==null?null:l.name)&&b.getAttribute("property")===(l.property==null?null:l.property)&&b.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&b.getAttribute("charset")===(l.charSet==null?null:l.charSet)){E.splice(N,1);break e}}b=y.createElement(f),vn(b,f,l),y.head.appendChild(b);break;default:throw Error(i(468,f))}b[Kt]=s,un(b),f=b}s.stateNode=f}else Pv(y,s.type,s.stateNode);else s.stateNode=Dv(y,f,s.memoizedProps);else b!==f?(b===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):b.count--,f===null?Pv(y,s.type,s.stateNode):Dv(y,f,s.memoizedProps)):f===null&&s.stateNode!==null&&Nd(s,s.memoizedProps,l.memoizedProps)}break;case 27:On(r,s),Pn(s),f&512&&(rn||l===null||Fi(l,l.return)),l!==null&&f&4&&Nd(s,s.memoizedProps,l.memoizedProps);break;case 5:if(On(r,s),Pn(s),f&512&&(rn||l===null||Fi(l,l.return)),s.flags&32){y=s.stateNode;try{_r(y,"")}catch(It){Se(s,s.return,It)}}f&4&&s.stateNode!=null&&(y=s.memoizedProps,Nd(s,y,l!==null?l.memoizedProps:y)),f&1024&&(Dd=!0);break;case 6:if(On(r,s),Pn(s),f&4){if(s.stateNode===null)throw Error(i(162));f=s.memoizedProps,l=s.stateNode;try{l.nodeValue=f}catch(It){Se(s,s.return,It)}}break;case 3:if(Bu=null,y=Si,Si=Nu(r.containerInfo),On(r,s),Si=y,Pn(s),f&4&&l!==null&&l.memoizedState.isDehydrated)try{Kr(r.containerInfo)}catch(It){Se(s,s.return,It)}Dd&&(Dd=!1,P0(s));break;case 4:f=Si,Si=Nu(s.stateNode.containerInfo),On(r,s),Pn(s),Si=f;break;case 12:On(r,s),Pn(s);break;case 31:On(r,s),Pn(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,yu(s,f)));break;case 13:On(r,s),Pn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(xu=Ot()),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,yu(s,f)));break;case 22:y=s.memoizedState!==null;var k=l!==null&&l.memoizedState!==null,nt=fs,dt=rn;if(fs=nt||y,rn=dt||k,On(r,s),rn=dt,fs=nt,Pn(s),f&8192)t:for(r=s.stateNode,r._visibility=y?r._visibility&-2:r._visibility|1,y&&(l===null||k||fs||rn||Xa(s)),l=null,r=s;;){if(r.tag===5||r.tag===26){if(l===null){k=l=r;try{if(b=k.stateNode,y)E=b.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{N=k.stateNode;var mt=k.memoizedProps.style,at=mt!=null&&mt.hasOwnProperty("display")?mt.display:null;N.style.display=at==null||typeof at=="boolean"?"":(""+at).trim()}}catch(It){Se(k,k.return,It)}}}else if(r.tag===6){if(l===null){k=r;try{k.stateNode.nodeValue=y?"":k.memoizedProps}catch(It){Se(k,k.return,It)}}}else if(r.tag===18){if(l===null){k=r;try{var ot=k.stateNode;y?Ev(ot,!0):Ev(k.stateNode,!1)}catch(It){Se(k,k.return,It)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break t;for(;r.sibling===null;){if(r.return===null||r.return===s)break t;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}f&4&&(f=s.updateQueue,f!==null&&(l=f.retryQueue,l!==null&&(f.retryQueue=null,yu(s,l))));break;case 19:On(r,s),Pn(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,yu(s,f)));break;case 30:break;case 21:break;default:On(r,s),Pn(s)}}function Pn(s){var r=s.flags;if(r&2){try{for(var l,f=s.return;f!==null;){if(A0(f)){l=f;break}f=f.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var y=l.stateNode,b=zd(s);gu(s,b,y);break;case 5:var E=l.stateNode;l.flags&32&&(_r(E,""),l.flags&=-33);var N=zd(s);gu(s,N,E);break;case 3:case 4:var k=l.stateNode.containerInfo,nt=zd(s);Bd(s,nt,k);break;default:throw Error(i(161))}}catch(dt){Se(s,s.return,dt)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function P0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;P0(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function ps(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)R0(s,r.alternate,r),r=r.sibling}function Xa(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:js(4,r,r.return),Xa(r);break;case 1:Fi(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&E0(r,r.return,l),Xa(r);break;case 27:Dl(r.stateNode);case 26:case 5:Fi(r,r.return),Xa(r);break;case 22:r.memoizedState===null&&Xa(r);break;case 30:Xa(r);break;default:Xa(r)}s=s.sibling}}function ms(s,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var f=r.alternate,y=s,b=r,E=b.flags;switch(b.tag){case 0:case 11:case 15:ms(y,b,l),Sl(4,b);break;case 1:if(ms(y,b,l),f=b,y=f.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(nt){Se(f,f.return,nt)}if(f=b,y=f.updateQueue,y!==null){var N=f.stateNode;try{var k=y.shared.hiddenCallbacks;if(k!==null)for(y.shared.hiddenCallbacks=null,y=0;y<k.length;y++)dy(k[y],N)}catch(nt){Se(f,f.return,nt)}}l&&E&64&&S0(b),El(b,b.return);break;case 27:C0(b);case 26:case 5:ms(y,b,l),l&&f===null&&E&4&&T0(b),El(b,b.return);break;case 12:ms(y,b,l);break;case 31:ms(y,b,l),l&&E&4&&B0(y,b);break;case 13:ms(y,b,l),l&&E&4&&D0(y,b);break;case 22:b.memoizedState===null&&ms(y,b,l),El(b,b.return);break;case 30:break;default:ms(y,b,l)}r=r.sibling}}function Od(s,r){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&hl(l))}function Pd(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&hl(s))}function Ei(s,r,l,f){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)U0(s,r,l,f),r=r.sibling}function U0(s,r,l,f){var y=r.flags;switch(r.tag){case 0:case 11:case 15:Ei(s,r,l,f),y&2048&&Sl(9,r);break;case 1:Ei(s,r,l,f);break;case 3:Ei(s,r,l,f),y&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&hl(s)));break;case 12:if(y&2048){Ei(s,r,l,f),s=r.stateNode;try{var b=r.memoizedProps,E=b.id,N=b.onPostCommit;typeof N=="function"&&N(E,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(k){Se(r,r.return,k)}}else Ei(s,r,l,f);break;case 31:Ei(s,r,l,f);break;case 13:Ei(s,r,l,f);break;case 23:break;case 22:b=r.stateNode,E=r.alternate,r.memoizedState!==null?b._visibility&2?Ei(s,r,l,f):Tl(s,r):b._visibility&2?Ei(s,r,l,f):(b._visibility|=2,Gr(s,r,l,f,(r.subtreeFlags&10256)!==0||!1)),y&2048&&Od(E,r);break;case 24:Ei(s,r,l,f),y&2048&&Pd(r.alternate,r);break;default:Ei(s,r,l,f)}}function Gr(s,r,l,f,y){for(y=y&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var b=s,E=r,N=l,k=f,nt=E.flags;switch(E.tag){case 0:case 11:case 15:Gr(b,E,N,k,y),Sl(8,E);break;case 23:break;case 22:var dt=E.stateNode;E.memoizedState!==null?dt._visibility&2?Gr(b,E,N,k,y):Tl(b,E):(dt._visibility|=2,Gr(b,E,N,k,y)),y&&nt&2048&&Od(E.alternate,E);break;case 24:Gr(b,E,N,k,y),y&&nt&2048&&Pd(E.alternate,E);break;default:Gr(b,E,N,k,y)}r=r.sibling}}function Tl(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=s,f=r,y=f.flags;switch(f.tag){case 22:Tl(l,f),y&2048&&Od(f.alternate,f);break;case 24:Tl(l,f),y&2048&&Pd(f.alternate,f);break;default:Tl(l,f)}r=r.sibling}}var Al=8192;function Vr(s,r,l){if(s.subtreeFlags&Al)for(s=s.child;s!==null;)I0(s,r,l),s=s.sibling}function I0(s,r,l){switch(s.tag){case 26:Vr(s,r,l),s.flags&Al&&s.memoizedState!==null&&xM(l,Si,s.memoizedState,s.memoizedProps);break;case 5:Vr(s,r,l);break;case 3:case 4:var f=Si;Si=Nu(s.stateNode.containerInfo),Vr(s,r,l),Si=f;break;case 22:s.memoizedState===null&&(f=s.alternate,f!==null&&f.memoizedState!==null?(f=Al,Al=16777216,Vr(s,r,l),Al=f):Vr(s,r,l));break;default:Vr(s,r,l)}}function F0(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Cl(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var f=r[l];hn=f,G0(f,s)}F0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)H0(s),s=s.sibling}function H0(s){switch(s.tag){case 0:case 11:case 15:Cl(s),s.flags&2048&&js(9,s,s.return);break;case 3:Cl(s);break;case 12:Cl(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,vu(s)):Cl(s);break;default:Cl(s)}}function vu(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var f=r[l];hn=f,G0(f,s)}F0(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:js(8,r,r.return),vu(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,vu(r));break;default:vu(r)}s=s.sibling}}function G0(s,r){for(;hn!==null;){var l=hn;switch(l.tag){case 0:case 11:case 15:js(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var f=l.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:hl(l.memoizedState.cache)}if(f=l.child,f!==null)f.return=l,hn=f;else t:for(l=s;hn!==null;){f=hn;var y=f.sibling,b=f.return;if(N0(f),f===l){hn=null;break t}if(y!==null){y.return=b,hn=y;break t}hn=b}}}var Dw={getCacheForType:function(s){var r=gn(nn),l=r.data.get(s);return l===void 0&&(l=s(),r.data.set(s,l)),l},cacheSignal:function(){return gn(nn).controller.signal}},Ow=typeof WeakMap=="function"?WeakMap:Map,be=0,Ce=null,ce=null,fe=0,Me=0,qn=null,qs=!1,kr=!1,Ud=!1,gs=0,Xe=0,Ys=0,Za=0,Id=0,Yn=0,Wr=0,Ll=null,Un=null,Fd=!1,xu=0,V0=0,bu=1/0,_u=null,Xs=null,ln=0,Zs=null,jr=null,ys=0,Hd=0,Gd=null,k0=null,Rl=0,Vd=null;function Xn(){return(be&2)!==0&&fe!==0?fe&-fe:z.T!==null?Xd():We()}function W0(){if(Yn===0)if((fe&536870912)===0||pe){var s=La;La<<=1,(La&3932160)===0&&(La=262144),Yn=s}else Yn=536870912;return s=Wn.current,s!==null&&(s.flags|=32),Yn}function In(s,r,l){(s===Ce&&(Me===2||Me===9)||s.cancelPendingCommit!==null)&&(qr(s,0),Qs(s,fe,Yn,!1)),lt(s,l),((be&2)===0||s!==Ce)&&(s===Ce&&((be&2)===0&&(Za|=l),Xe===4&&Qs(s,fe,Yn,!1)),Hi(s))}function j0(s,r,l){if((be&6)!==0)throw Error(i(327));var f=!l&&(r&127)===0&&(r&s.expiredLanes)===0||za(s,r),y=f?Iw(s,r):Wd(s,r,!0),b=f;do{if(y===0){kr&&!f&&Qs(s,r,0,!1);break}else{if(l=s.current.alternate,b&&!Pw(l)){y=Wd(s,r,!1),b=!1;continue}if(y===2){if(b=r,s.errorRecoveryDisabledLanes&b)var E=0;else E=s.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){r=E;t:{var N=s;y=Ll;var k=N.current.memoizedState.isDehydrated;if(k&&(qr(N,E).flags|=256),E=Wd(N,E,!1),E!==2){if(Ud&&!k){N.errorRecoveryDisabledLanes|=b,Za|=b,y=4;break t}b=Un,Un=y,b!==null&&(Un===null?Un=b:Un.push.apply(Un,b))}y=E}if(b=!1,y!==2)continue}}if(y===1){qr(s,0),Qs(s,r,0,!0);break}t:{switch(f=s,b=y,b){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Qs(f,r,Yn,!qs);break t;case 2:Un=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(y=xu+300-Ot(),10<y)){if(Qs(f,r,Yn,!qs),Na(f,0,!0)!==0)break t;ys=r,f.timeoutHandle=wv(q0.bind(null,f,l,Un,_u,Fd,r,Yn,Za,Wr,qs,b,"Throttled",-0,0),y);break t}q0(f,l,Un,_u,Fd,r,Yn,Za,Wr,qs,b,null,-0,0)}}break}while(!0);Hi(s)}function q0(s,r,l,f,y,b,E,N,k,nt,dt,mt,at,ot){if(s.timeoutHandle=-1,mt=r.subtreeFlags,mt&8192||(mt&16785408)===16785408){mt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ns},I0(r,b,mt);var It=(b&62914560)===b?xu-Ot():(b&4194048)===b?V0-Ot():0;if(It=bM(mt,It),It!==null){ys=b,s.cancelPendingCommit=It(tv.bind(null,s,r,b,l,f,y,E,N,k,dt,mt,null,at,ot)),Qs(s,b,E,!nt);return}}tv(s,r,b,l,f,y,E,N,k)}function Pw(s){for(var r=s;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var f=0;f<l.length;f++){var y=l[f],b=y.getSnapshot;y=y.value;try{if(!Vn(b(),y))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Qs(s,r,l,f){r&=~Id,r&=~Za,s.suspendedLanes|=r,s.pingedLanes&=~r,f&&(s.warmLanes|=r),f=s.expirationTimes;for(var y=r;0<y;){var b=31-Cn(y),E=1<<b;f[b]=-1,y&=~E}l!==0&&zt(s,l,r)}function wu(){return(be&6)===0?(Nl(0),!1):!0}function kd(){if(ce!==null){if(Me===0)var s=ce.return;else s=ce,rs=Ha=null,ad(s),Pr=null,dl=0,s=ce;for(;s!==null;)M0(s.alternate,s),s=s.return;ce=null}}function qr(s,r){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,nM(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),ys=0,kd(),Ce=s,ce=l=ss(s.current,null),fe=r,Me=0,qn=null,qs=!1,kr=za(s,r),Ud=!1,Wr=Yn=Id=Za=Ys=Xe=0,Un=Ll=null,Fd=!1,(r&8)!==0&&(r|=r&32);var f=s.entangledLanes;if(f!==0)for(s=s.entanglements,f&=r;0<f;){var y=31-Cn(f),b=1<<y;r|=s[y],f&=~b}return gs=r,kc(),l}function Y0(s,r){se=null,z.H=_l,r===Or||r===Jc?(r=cy(),Me=3):r===Yf?(r=cy(),Me=4):Me=r===_d?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,qn=r,ce===null&&(Xe=1,hu(s,ri(r,s.current)))}function X0(){var s=Wn.current;return s===null?!0:(fe&4194048)===fe?ui===null:(fe&62914560)===fe||(fe&536870912)!==0?s===ui:!1}function Z0(){var s=z.H;return z.H=_l,s===null?_l:s}function Q0(){var s=z.A;return z.A=Dw,s}function Mu(){Xe=4,qs||(fe&4194048)!==fe&&Wn.current!==null||(kr=!0),(Ys&134217727)===0&&(Za&134217727)===0||Ce===null||Qs(Ce,fe,Yn,!1)}function Wd(s,r,l){var f=be;be|=2;var y=Z0(),b=Q0();(Ce!==s||fe!==r)&&(_u=null,qr(s,r)),r=!1;var E=Xe;t:do try{if(Me!==0&&ce!==null){var N=ce,k=qn;switch(Me){case 8:kd(),E=6;break t;case 3:case 2:case 9:case 6:Wn.current===null&&(r=!0);var nt=Me;if(Me=0,qn=null,Yr(s,N,k,nt),l&&kr){E=0;break t}break;default:nt=Me,Me=0,qn=null,Yr(s,N,k,nt)}}Uw(),E=Xe;break}catch(dt){Y0(s,dt)}while(!0);return r&&s.shellSuspendCounter++,rs=Ha=null,be=f,z.H=y,z.A=b,ce===null&&(Ce=null,fe=0,kc()),E}function Uw(){for(;ce!==null;)J0(ce)}function Iw(s,r){var l=be;be|=2;var f=Z0(),y=Q0();Ce!==s||fe!==r?(_u=null,bu=Ot()+500,qr(s,r)):kr=za(s,r);t:do try{if(Me!==0&&ce!==null){r=ce;var b=qn;e:switch(Me){case 1:Me=0,qn=null,Yr(s,r,b,1);break;case 2:case 9:if(oy(b)){Me=0,qn=null,K0(r);break}r=function(){Me!==2&&Me!==9||Ce!==s||(Me=7),Hi(s)},b.then(r,r);break t;case 3:Me=7;break t;case 4:Me=5;break t;case 7:oy(b)?(Me=0,qn=null,K0(r)):(Me=0,qn=null,Yr(s,r,b,7));break;case 5:var E=null;switch(ce.tag){case 26:E=ce.memoizedState;case 5:case 27:var N=ce;if(E?Uv(E):N.stateNode.complete){Me=0,qn=null;var k=N.sibling;if(k!==null)ce=k;else{var nt=N.return;nt!==null?(ce=nt,Su(nt)):ce=null}break e}}Me=0,qn=null,Yr(s,r,b,5);break;case 6:Me=0,qn=null,Yr(s,r,b,6);break;case 8:kd(),Xe=6;break t;default:throw Error(i(462))}}Fw();break}catch(dt){Y0(s,dt)}while(!0);return rs=Ha=null,z.H=f,z.A=y,be=l,ce!==null?0:(Ce=null,fe=0,kc(),Xe)}function Fw(){for(;ce!==null&&!Mt();)J0(ce)}function J0(s){var r=_0(s.alternate,s,gs);s.memoizedProps=s.pendingProps,r===null?Su(s):ce=r}function K0(s){var r=s,l=r.alternate;switch(r.tag){case 15:case 0:r=m0(l,r,r.pendingProps,r.type,void 0,fe);break;case 11:r=m0(l,r,r.pendingProps,r.type.render,r.ref,fe);break;case 5:ad(r);default:M0(l,r),r=ce=Qg(r,gs),r=_0(l,r,gs)}s.memoizedProps=s.pendingProps,r===null?Su(s):ce=r}function Yr(s,r,l,f){rs=Ha=null,ad(r),Pr=null,dl=0;var y=r.return;try{if(Aw(s,y,r,l,fe)){Xe=1,hu(s,ri(l,s.current)),ce=null;return}}catch(b){if(y!==null)throw ce=y,b;Xe=1,hu(s,ri(l,s.current)),ce=null;return}r.flags&32768?(pe||f===1?s=!0:kr||(fe&536870912)!==0?s=!1:(qs=s=!0,(f===2||f===9||f===3||f===6)&&(f=Wn.current,f!==null&&f.tag===13&&(f.flags|=16384))),$0(r,s)):Su(r)}function Su(s){var r=s;do{if((r.flags&32768)!==0){$0(r,qs);return}s=r.return;var l=Rw(r.alternate,r,gs);if(l!==null){ce=l;return}if(r=r.sibling,r!==null){ce=r;return}ce=r=s}while(r!==null);Xe===0&&(Xe=5)}function $0(s,r){do{var l=Nw(s.alternate,s);if(l!==null){l.flags&=32767,ce=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(s=s.sibling,s!==null)){ce=s;return}ce=s=l}while(s!==null);Xe=6,ce=null}function tv(s,r,l,f,y,b,E,N,k){s.cancelPendingCommit=null;do Eu();while(ln!==0);if((be&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(b=r.lanes|r.childLanes,b|=zf,gt(s,l,b,E,N,k),s===Ce&&(ce=Ce=null,fe=0),jr=r,Zs=s,ys=l,Hd=b,Gd=y,k0=f,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,kw(Pt,function(){return av(),null})):(s.callbackNode=null,s.callbackPriority=0),f=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||f){f=z.T,z.T=null,y=Q.p,Q.p=2,E=be,be|=4;try{zw(s,r,l)}finally{be=E,Q.p=y,z.T=f}}ln=1,ev(),nv(),iv()}}function ev(){if(ln===1){ln=0;var s=Zs,r=jr,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=z.T,z.T=null;var f=Q.p;Q.p=2;var y=be;be|=4;try{O0(r,s);var b=np,E=Gg(s.containerInfo),N=b.focusedElem,k=b.selectionRange;if(E!==N&&N&&N.ownerDocument&&Hg(N.ownerDocument.documentElement,N)){if(k!==null&&Af(N)){var nt=k.start,dt=k.end;if(dt===void 0&&(dt=nt),"selectionStart"in N)N.selectionStart=nt,N.selectionEnd=Math.min(dt,N.value.length);else{var mt=N.ownerDocument||document,at=mt&&mt.defaultView||window;if(at.getSelection){var ot=at.getSelection(),It=N.textContent.length,Yt=Math.min(k.start,It),Ae=k.end===void 0?Yt:Math.min(k.end,It);!ot.extend&&Yt>Ae&&(E=Ae,Ae=Yt,Yt=E);var K=Fg(N,Yt),Z=Fg(N,Ae);if(K&&Z&&(ot.rangeCount!==1||ot.anchorNode!==K.node||ot.anchorOffset!==K.offset||ot.focusNode!==Z.node||ot.focusOffset!==Z.offset)){var et=mt.createRange();et.setStart(K.node,K.offset),ot.removeAllRanges(),Yt>Ae?(ot.addRange(et),ot.extend(Z.node,Z.offset)):(et.setEnd(Z.node,Z.offset),ot.addRange(et))}}}}for(mt=[],ot=N;ot=ot.parentNode;)ot.nodeType===1&&mt.push({element:ot,left:ot.scrollLeft,top:ot.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<mt.length;N++){var pt=mt[N];pt.element.scrollLeft=pt.left,pt.element.scrollTop=pt.top}}Uu=!!ep,np=ep=null}finally{be=y,Q.p=f,z.T=l}}s.current=r,ln=2}}function nv(){if(ln===2){ln=0;var s=Zs,r=jr,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=z.T,z.T=null;var f=Q.p;Q.p=2;var y=be;be|=4;try{R0(s,r.alternate,r)}finally{be=y,Q.p=f,z.T=l}}ln=3}}function iv(){if(ln===4||ln===3){ln=0,Nt();var s=Zs,r=jr,l=ys,f=k0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?ln=5:(ln=0,jr=Zs=null,sv(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(Xs=null),te(l),r=r.stateNode,Oe&&typeof Oe.onCommitFiberRoot=="function")try{Oe.onCommitFiberRoot(bi,r,void 0,(r.current.flags&128)===128)}catch{}if(f!==null){r=z.T,y=Q.p,Q.p=2,z.T=null;try{for(var b=s.onRecoverableError,E=0;E<f.length;E++){var N=f[E];b(N.value,{componentStack:N.stack})}}finally{z.T=r,Q.p=y}}(ys&3)!==0&&Eu(),Hi(s),y=s.pendingLanes,(l&261930)!==0&&(y&42)!==0?s===Vd?Rl++:(Rl=0,Vd=s):Rl=0,Nl(0)}}function sv(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,hl(r)))}function Eu(){return ev(),nv(),iv(),av()}function av(){if(ln!==5)return!1;var s=Zs,r=Hd;Hd=0;var l=te(ys),f=z.T,y=Q.p;try{Q.p=32>l?32:l,z.T=null,l=Gd,Gd=null;var b=Zs,E=ys;if(ln=0,jr=Zs=null,ys=0,(be&6)!==0)throw Error(i(331));var N=be;if(be|=4,H0(b.current),U0(b,b.current,E,l),be=N,Nl(0,!1),Oe&&typeof Oe.onPostCommitFiberRoot=="function")try{Oe.onPostCommitFiberRoot(bi,b)}catch{}return!0}finally{Q.p=y,z.T=f,sv(s,r)}}function rv(s,r,l){r=ri(l,r),r=bd(s.stateNode,r,2),s=Vs(s,r,2),s!==null&&(lt(s,2),Hi(s))}function Se(s,r,l){if(s.tag===3)rv(s,s,l);else for(;r!==null;){if(r.tag===3){rv(r,s,l);break}else if(r.tag===1){var f=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Xs===null||!Xs.has(f))){s=ri(l,s),l=o0(2),f=Vs(r,l,2),f!==null&&(l0(l,f,r,s),lt(f,2),Hi(f));break}}r=r.return}}function jd(s,r,l){var f=s.pingCache;if(f===null){f=s.pingCache=new Ow;var y=new Set;f.set(r,y)}else y=f.get(r),y===void 0&&(y=new Set,f.set(r,y));y.has(l)||(Ud=!0,y.add(l),s=Hw.bind(null,s,r,l),r.then(s,s))}function Hw(s,r,l){var f=s.pingCache;f!==null&&f.delete(r),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Ce===s&&(fe&l)===l&&(Xe===4||Xe===3&&(fe&62914560)===fe&&300>Ot()-xu?(be&2)===0&&qr(s,0):Id|=l,Wr===fe&&(Wr=0)),Hi(s)}function ov(s,r){r===0&&(r=P()),s=Ua(s,r),s!==null&&(lt(s,r),Hi(s))}function Gw(s){var r=s.memoizedState,l=0;r!==null&&(l=r.retryLane),ov(s,l)}function Vw(s,r){var l=0;switch(s.tag){case 31:case 13:var f=s.stateNode,y=s.memoizedState;y!==null&&(l=y.retryLane);break;case 19:f=s.stateNode;break;case 22:f=s.stateNode._retryCache;break;default:throw Error(i(314))}f!==null&&f.delete(r),ov(s,l)}function kw(s,r){return xt(s,r)}var Tu=null,Xr=null,qd=!1,Au=!1,Yd=!1,Js=0;function Hi(s){s!==Xr&&s.next===null&&(Xr===null?Tu=Xr=s:Xr=Xr.next=s),Au=!0,qd||(qd=!0,jw())}function Nl(s,r){if(!Yd&&Au){Yd=!0;do for(var l=!1,f=Tu;f!==null;){if(s!==0){var y=f.pendingLanes;if(y===0)var b=0;else{var E=f.suspendedLanes,N=f.pingedLanes;b=(1<<31-Cn(42|s)+1)-1,b&=y&~(E&~N),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(l=!0,hv(f,b))}else b=fe,b=Na(f,f===Ce?b:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(b&3)===0||za(f,b)||(l=!0,hv(f,b));f=f.next}while(l);Yd=!1}}function Ww(){lv()}function lv(){Au=qd=!1;var s=0;Js!==0&&eM()&&(s=Js);for(var r=Ot(),l=null,f=Tu;f!==null;){var y=f.next,b=cv(f,r);b===0?(f.next=null,l===null?Tu=y:l.next=y,y===null&&(Xr=l)):(l=f,(s!==0||(b&3)!==0)&&(Au=!0)),f=y}ln!==0&&ln!==5||Nl(s),Js!==0&&(Js=0)}function cv(s,r){for(var l=s.suspendedLanes,f=s.pingedLanes,y=s.expirationTimes,b=s.pendingLanes&-62914561;0<b;){var E=31-Cn(b),N=1<<E,k=y[E];k===-1?((N&l)===0||(N&f)!==0)&&(y[E]=uf(N,r)):k<=r&&(s.expiredLanes|=N),b&=~N}if(r=Ce,l=fe,l=Na(s,s===r?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f=s.callbackNode,l===0||s===r&&(Me===2||Me===9)||s.cancelPendingCommit!==null)return f!==null&&f!==null&&J(f),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||za(s,l)){if(r=l&-l,r===s.callbackPriority)return r;switch(f!==null&&J(f),te(l)){case 2:case 8:l=St;break;case 32:l=Pt;break;case 268435456:l=Vt;break;default:l=Pt}return f=uv.bind(null,s),l=xt(l,f),s.callbackPriority=r,s.callbackNode=l,r}return f!==null&&f!==null&&J(f),s.callbackPriority=2,s.callbackNode=null,2}function uv(s,r){if(ln!==0&&ln!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Eu()&&s.callbackNode!==l)return null;var f=fe;return f=Na(s,s===Ce?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f===0?null:(j0(s,f,r),cv(s,Ot()),s.callbackNode!=null&&s.callbackNode===l?uv.bind(null,s):null)}function hv(s,r){if(Eu())return null;j0(s,r,!0)}function jw(){iM(function(){(be&6)!==0?xt(W,Ww):lv()})}function Xd(){if(Js===0){var s=Br;s===0&&(s=Ca,Ca<<=1,(Ca&261888)===0&&(Ca=256)),Js=s}return Js}function fv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Oc(""+s)}function dv(s,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,s.id&&l.setAttribute("form",s.id),r.parentNode.insertBefore(l,r),s=new FormData(s),l.parentNode.removeChild(l),s}function qw(s,r,l,f,y){if(r==="submit"&&l&&l.stateNode===y){var b=fv((y[Ge]||null).action),E=f.submitter;E&&(r=(r=E[Ge]||null)?fv(r.formAction):E.getAttribute("formAction"),r!==null&&(b=r,E=null));var N=new Fc("action","action",null,f,y);s.push({event:N,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Js!==0){var k=E?dv(y,E):new FormData(y);pd(l,{pending:!0,data:k,method:y.method,action:b},null,k)}}else typeof b=="function"&&(N.preventDefault(),k=E?dv(y,E):new FormData(y),pd(l,{pending:!0,data:k,method:y.method,action:b},b,k))},currentTarget:y}]})}}for(var Zd=0;Zd<Nf.length;Zd++){var Qd=Nf[Zd],Yw=Qd.toLowerCase(),Xw=Qd[0].toUpperCase()+Qd.slice(1);Mi(Yw,"on"+Xw)}Mi(Wg,"onAnimationEnd"),Mi(jg,"onAnimationIteration"),Mi(qg,"onAnimationStart"),Mi("dblclick","onDoubleClick"),Mi("focusin","onFocus"),Mi("focusout","onBlur"),Mi(uw,"onTransitionRun"),Mi(hw,"onTransitionStart"),Mi(fw,"onTransitionCancel"),Mi(Yg,"onTransitionEnd"),xr("onMouseEnter",["mouseout","mouseover"]),xr("onMouseLeave",["mouseout","mouseover"]),xr("onPointerEnter",["pointerout","pointerover"]),xr("onPointerLeave",["pointerout","pointerover"]),Ba("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ba("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ba("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ba("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ba("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ba("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zl));function pv(s,r){r=(r&4)!==0;for(var l=0;l<s.length;l++){var f=s[l],y=f.event;f=f.listeners;t:{var b=void 0;if(r)for(var E=f.length-1;0<=E;E--){var N=f[E],k=N.instance,nt=N.currentTarget;if(N=N.listener,k!==b&&y.isPropagationStopped())break t;b=N,y.currentTarget=nt;try{b(y)}catch(dt){Vc(dt)}y.currentTarget=null,b=k}else for(E=0;E<f.length;E++){if(N=f[E],k=N.instance,nt=N.currentTarget,N=N.listener,k!==b&&y.isPropagationStopped())break t;b=N,y.currentTarget=nt;try{b(y)}catch(dt){Vc(dt)}y.currentTarget=null,b=k}}}}function ue(s,r){var l=r[_i];l===void 0&&(l=r[_i]=new Set);var f=s+"__bubble";l.has(f)||(mv(r,s,2,!1),l.add(f))}function Jd(s,r,l){var f=0;r&&(f|=4),mv(l,s,f,r)}var Cu="_reactListening"+Math.random().toString(36).slice(2);function Kd(s){if(!s[Cu]){s[Cu]=!0,lg.forEach(function(l){l!=="selectionchange"&&(Zw.has(l)||Jd(l,!1,s),Jd(l,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Cu]||(r[Cu]=!0,Jd("selectionchange",!1,r))}}function mv(s,r,l,f){switch(Wv(r)){case 2:var y=MM;break;case 8:y=SM;break;default:y=dp}l=y.bind(null,r,l,s),y=void 0,!vf||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(y=!0),f?y!==void 0?s.addEventListener(r,l,{capture:!0,passive:y}):s.addEventListener(r,l,!0):y!==void 0?s.addEventListener(r,l,{passive:y}):s.addEventListener(r,l,!1)}function $d(s,r,l,f,y){var b=f;if((r&1)===0&&(r&2)===0&&f!==null)t:for(;;){if(f===null)return;var E=f.tag;if(E===3||E===4){var N=f.stateNode.containerInfo;if(N===y)break;if(E===4)for(E=f.return;E!==null;){var k=E.tag;if((k===3||k===4)&&E.stateNode.containerInfo===y)return;E=E.return}for(;N!==null;){if(E=ni(N),E===null)return;if(k=E.tag,k===5||k===6||k===26||k===27){f=b=E;continue t}N=N.parentNode}}f=f.return}bg(function(){var nt=b,dt=gf(l),mt=[];t:{var at=Xg.get(s);if(at!==void 0){var ot=Fc,It=s;switch(s){case"keypress":if(Uc(l)===0)break t;case"keydown":case"keyup":ot=V1;break;case"focusin":It="focus",ot=wf;break;case"focusout":It="blur",ot=wf;break;case"beforeblur":case"afterblur":ot=wf;break;case"click":if(l.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=Mg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=R1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=j1;break;case Wg:case jg:case qg:ot=B1;break;case Yg:ot=Y1;break;case"scroll":case"scrollend":ot=C1;break;case"wheel":ot=Z1;break;case"copy":case"cut":case"paste":ot=O1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=Eg;break;case"toggle":case"beforetoggle":ot=J1}var Yt=(r&4)!==0,Ae=!Yt&&(s==="scroll"||s==="scrollend"),K=Yt?at!==null?at+"Capture":null:at;Yt=[];for(var Z=nt,et;Z!==null;){var pt=Z;if(et=pt.stateNode,pt=pt.tag,pt!==5&&pt!==26&&pt!==27||et===null||K===null||(pt=tl(Z,K),pt!=null&&Yt.push(Bl(Z,pt,et))),Ae)break;Z=Z.return}0<Yt.length&&(at=new ot(at,It,null,l,dt),mt.push({event:at,listeners:Yt}))}}if((r&7)===0){t:{if(at=s==="mouseover"||s==="pointerover",ot=s==="mouseout"||s==="pointerout",at&&l!==mf&&(It=l.relatedTarget||l.fromElement)&&(ni(It)||It[ge]))break t;if((ot||at)&&(at=dt.window===dt?dt:(at=dt.ownerDocument)?at.defaultView||at.parentWindow:window,ot?(It=l.relatedTarget||l.toElement,ot=nt,It=It?ni(It):null,It!==null&&(Ae=o(It),Yt=It.tag,It!==Ae||Yt!==5&&Yt!==27&&Yt!==6)&&(It=null)):(ot=null,It=nt),ot!==It)){if(Yt=Mg,pt="onMouseLeave",K="onMouseEnter",Z="mouse",(s==="pointerout"||s==="pointerover")&&(Yt=Eg,pt="onPointerLeave",K="onPointerEnter",Z="pointer"),Ae=ot==null?at:$o(ot),et=It==null?at:$o(It),at=new Yt(pt,Z+"leave",ot,l,dt),at.target=Ae,at.relatedTarget=et,pt=null,ni(dt)===nt&&(Yt=new Yt(K,Z+"enter",It,l,dt),Yt.target=et,Yt.relatedTarget=Ae,pt=Yt),Ae=pt,ot&&It)e:{for(Yt=Qw,K=ot,Z=It,et=0,pt=K;pt;pt=Yt(pt))et++;pt=0;for(var jt=Z;jt;jt=Yt(jt))pt++;for(;0<et-pt;)K=Yt(K),et--;for(;0<pt-et;)Z=Yt(Z),pt--;for(;et--;){if(K===Z||Z!==null&&K===Z.alternate){Yt=K;break e}K=Yt(K),Z=Yt(Z)}Yt=null}else Yt=null;ot!==null&&gv(mt,at,ot,Yt,!1),It!==null&&Ae!==null&&gv(mt,Ae,It,Yt,!0)}}t:{if(at=nt?$o(nt):window,ot=at.nodeName&&at.nodeName.toLowerCase(),ot==="select"||ot==="input"&&at.type==="file")var ve=Bg;else if(Ng(at))if(Dg)ve=ow;else{ve=aw;var Gt=sw}else ot=at.nodeName,!ot||ot.toLowerCase()!=="input"||at.type!=="checkbox"&&at.type!=="radio"?nt&&pf(nt.elementType)&&(ve=Bg):ve=rw;if(ve&&(ve=ve(s,nt))){zg(mt,ve,l,dt);break t}Gt&&Gt(s,at,nt),s==="focusout"&&nt&&at.type==="number"&&nt.memoizedProps.value!=null&&df(at,"number",at.value)}switch(Gt=nt?$o(nt):window,s){case"focusin":(Ng(Gt)||Gt.contentEditable==="true")&&(Er=Gt,Cf=nt,ll=null);break;case"focusout":ll=Cf=Er=null;break;case"mousedown":Lf=!0;break;case"contextmenu":case"mouseup":case"dragend":Lf=!1,Vg(mt,l,dt);break;case"selectionchange":if(cw)break;case"keydown":case"keyup":Vg(mt,l,dt)}var ae;if(Sf)t:{switch(s){case"compositionstart":var de="onCompositionStart";break t;case"compositionend":de="onCompositionEnd";break t;case"compositionupdate":de="onCompositionUpdate";break t}de=void 0}else Sr?Lg(s,l)&&(de="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(de="onCompositionStart");de&&(Tg&&l.locale!=="ko"&&(Sr||de!=="onCompositionStart"?de==="onCompositionEnd"&&Sr&&(ae=_g()):(Os=dt,xf="value"in Os?Os.value:Os.textContent,Sr=!0)),Gt=Lu(nt,de),0<Gt.length&&(de=new Sg(de,s,null,l,dt),mt.push({event:de,listeners:Gt}),ae?de.data=ae:(ae=Rg(l),ae!==null&&(de.data=ae)))),(ae=$1?tw(s,l):ew(s,l))&&(de=Lu(nt,"onBeforeInput"),0<de.length&&(Gt=new Sg("onBeforeInput","beforeinput",null,l,dt),mt.push({event:Gt,listeners:de}),Gt.data=ae)),qw(mt,s,nt,l,dt)}pv(mt,r)})}function Bl(s,r,l){return{instance:s,listener:r,currentTarget:l}}function Lu(s,r){for(var l=r+"Capture",f=[];s!==null;){var y=s,b=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||b===null||(y=tl(s,l),y!=null&&f.unshift(Bl(s,y,b)),y=tl(s,r),y!=null&&f.push(Bl(s,y,b))),s.tag===3)return f;s=s.return}return[]}function Qw(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function gv(s,r,l,f,y){for(var b=r._reactName,E=[];l!==null&&l!==f;){var N=l,k=N.alternate,nt=N.stateNode;if(N=N.tag,k!==null&&k===f)break;N!==5&&N!==26&&N!==27||nt===null||(k=nt,y?(nt=tl(l,b),nt!=null&&E.unshift(Bl(l,nt,k))):y||(nt=tl(l,b),nt!=null&&E.push(Bl(l,nt,k)))),l=l.return}E.length!==0&&s.push({event:r,listeners:E})}var Jw=/\r\n?/g,Kw=/\u0000|\uFFFD/g;function yv(s){return(typeof s=="string"?s:""+s).replace(Jw,`
`).replace(Kw,"")}function vv(s,r){return r=yv(r),yv(s)===r}function Te(s,r,l,f,y,b){switch(l){case"children":typeof f=="string"?r==="body"||r==="textarea"&&f===""||_r(s,f):(typeof f=="number"||typeof f=="bigint")&&r!=="body"&&_r(s,""+f);break;case"className":Bc(s,"class",f);break;case"tabIndex":Bc(s,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Bc(s,l,f);break;case"style":vg(s,f,b);break;case"data":if(r!=="object"){Bc(s,"data",f);break}case"src":case"href":if(f===""&&(r!=="a"||l!=="href")){s.removeAttribute(l);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(l);break}f=Oc(""+f),s.setAttribute(l,f);break;case"action":case"formAction":if(typeof f=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(l==="formAction"?(r!=="input"&&Te(s,r,"name",y.name,y,null),Te(s,r,"formEncType",y.formEncType,y,null),Te(s,r,"formMethod",y.formMethod,y,null),Te(s,r,"formTarget",y.formTarget,y,null)):(Te(s,r,"encType",y.encType,y,null),Te(s,r,"method",y.method,y,null),Te(s,r,"target",y.target,y,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(l);break}f=Oc(""+f),s.setAttribute(l,f);break;case"onClick":f!=null&&(s.onclick=ns);break;case"onScroll":f!=null&&ue("scroll",s);break;case"onScrollEnd":f!=null&&ue("scrollend",s);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(l=f.__html,l!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":s.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){s.removeAttribute("xlink:href");break}l=Oc(""+f),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(l,""+f):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":f===!0?s.setAttribute(l,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(l,f):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?s.setAttribute(l,f):s.removeAttribute(l);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?s.removeAttribute(l):s.setAttribute(l,f);break;case"popover":ue("beforetoggle",s),ue("toggle",s),zc(s,"popover",f);break;case"xlinkActuate":es(s,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":es(s,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":es(s,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":es(s,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":es(s,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":es(s,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":es(s,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":es(s,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":es(s,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":zc(s,"is",f);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=T1.get(l)||l,zc(s,l,f))}}function tp(s,r,l,f,y,b){switch(l){case"style":vg(s,f,b);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(l=f.__html,l!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof f=="string"?_r(s,f):(typeof f=="number"||typeof f=="bigint")&&_r(s,""+f);break;case"onScroll":f!=null&&ue("scroll",s);break;case"onScrollEnd":f!=null&&ue("scrollend",s);break;case"onClick":f!=null&&(s.onclick=ns);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!cg.hasOwnProperty(l))t:{if(l[0]==="o"&&l[1]==="n"&&(y=l.endsWith("Capture"),r=l.slice(2,y?l.length-7:void 0),b=s[Ge]||null,b=b!=null?b[l]:null,typeof b=="function"&&s.removeEventListener(r,b,y),typeof f=="function")){typeof b!="function"&&b!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(r,f,y);break t}l in s?s[l]=f:f===!0?s.setAttribute(l,""):zc(s,l,f)}}}function vn(s,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ue("error",s),ue("load",s);var f=!1,y=!1,b;for(b in l)if(l.hasOwnProperty(b)){var E=l[b];if(E!=null)switch(b){case"src":f=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Te(s,r,b,E,l,null)}}y&&Te(s,r,"srcSet",l.srcSet,l,null),f&&Te(s,r,"src",l.src,l,null);return;case"input":ue("invalid",s);var N=b=E=y=null,k=null,nt=null;for(f in l)if(l.hasOwnProperty(f)){var dt=l[f];if(dt!=null)switch(f){case"name":y=dt;break;case"type":E=dt;break;case"checked":k=dt;break;case"defaultChecked":nt=dt;break;case"value":b=dt;break;case"defaultValue":N=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(i(137,r));break;default:Te(s,r,f,dt,l,null)}}pg(s,b,N,k,nt,E,y,!1);return;case"select":ue("invalid",s),f=E=b=null;for(y in l)if(l.hasOwnProperty(y)&&(N=l[y],N!=null))switch(y){case"value":b=N;break;case"defaultValue":E=N;break;case"multiple":f=N;default:Te(s,r,y,N,l,null)}r=b,l=E,s.multiple=!!f,r!=null?br(s,!!f,r,!1):l!=null&&br(s,!!f,l,!0);return;case"textarea":ue("invalid",s),b=y=f=null;for(E in l)if(l.hasOwnProperty(E)&&(N=l[E],N!=null))switch(E){case"value":f=N;break;case"defaultValue":y=N;break;case"children":b=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:Te(s,r,E,N,l,null)}gg(s,f,y,b);return;case"option":for(k in l)if(l.hasOwnProperty(k)&&(f=l[k],f!=null))switch(k){case"selected":s.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Te(s,r,k,f,l,null)}return;case"dialog":ue("beforetoggle",s),ue("toggle",s),ue("cancel",s),ue("close",s);break;case"iframe":case"object":ue("load",s);break;case"video":case"audio":for(f=0;f<zl.length;f++)ue(zl[f],s);break;case"image":ue("error",s),ue("load",s);break;case"details":ue("toggle",s);break;case"embed":case"source":case"link":ue("error",s),ue("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(nt in l)if(l.hasOwnProperty(nt)&&(f=l[nt],f!=null))switch(nt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Te(s,r,nt,f,l,null)}return;default:if(pf(r)){for(dt in l)l.hasOwnProperty(dt)&&(f=l[dt],f!==void 0&&tp(s,r,dt,f,l,void 0));return}}for(N in l)l.hasOwnProperty(N)&&(f=l[N],f!=null&&Te(s,r,N,f,l,null))}function $w(s,r,l,f){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,b=null,E=null,N=null,k=null,nt=null,dt=null;for(ot in l){var mt=l[ot];if(l.hasOwnProperty(ot)&&mt!=null)switch(ot){case"checked":break;case"value":break;case"defaultValue":k=mt;default:f.hasOwnProperty(ot)||Te(s,r,ot,null,f,mt)}}for(var at in f){var ot=f[at];if(mt=l[at],f.hasOwnProperty(at)&&(ot!=null||mt!=null))switch(at){case"type":b=ot;break;case"name":y=ot;break;case"checked":nt=ot;break;case"defaultChecked":dt=ot;break;case"value":E=ot;break;case"defaultValue":N=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(i(137,r));break;default:ot!==mt&&Te(s,r,at,ot,f,mt)}}ff(s,E,N,k,nt,dt,b,y);return;case"select":ot=E=N=at=null;for(b in l)if(k=l[b],l.hasOwnProperty(b)&&k!=null)switch(b){case"value":break;case"multiple":ot=k;default:f.hasOwnProperty(b)||Te(s,r,b,null,f,k)}for(y in f)if(b=f[y],k=l[y],f.hasOwnProperty(y)&&(b!=null||k!=null))switch(y){case"value":at=b;break;case"defaultValue":N=b;break;case"multiple":E=b;default:b!==k&&Te(s,r,y,b,f,k)}r=N,l=E,f=ot,at!=null?br(s,!!l,at,!1):!!f!=!!l&&(r!=null?br(s,!!l,r,!0):br(s,!!l,l?[]:"",!1));return;case"textarea":ot=at=null;for(N in l)if(y=l[N],l.hasOwnProperty(N)&&y!=null&&!f.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:Te(s,r,N,null,f,y)}for(E in f)if(y=f[E],b=l[E],f.hasOwnProperty(E)&&(y!=null||b!=null))switch(E){case"value":at=y;break;case"defaultValue":ot=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==b&&Te(s,r,E,y,f,b)}mg(s,at,ot);return;case"option":for(var It in l)if(at=l[It],l.hasOwnProperty(It)&&at!=null&&!f.hasOwnProperty(It))switch(It){case"selected":s.selected=!1;break;default:Te(s,r,It,null,f,at)}for(k in f)if(at=f[k],ot=l[k],f.hasOwnProperty(k)&&at!==ot&&(at!=null||ot!=null))switch(k){case"selected":s.selected=at&&typeof at!="function"&&typeof at!="symbol";break;default:Te(s,r,k,at,f,ot)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Yt in l)at=l[Yt],l.hasOwnProperty(Yt)&&at!=null&&!f.hasOwnProperty(Yt)&&Te(s,r,Yt,null,f,at);for(nt in f)if(at=f[nt],ot=l[nt],f.hasOwnProperty(nt)&&at!==ot&&(at!=null||ot!=null))switch(nt){case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(i(137,r));break;default:Te(s,r,nt,at,f,ot)}return;default:if(pf(r)){for(var Ae in l)at=l[Ae],l.hasOwnProperty(Ae)&&at!==void 0&&!f.hasOwnProperty(Ae)&&tp(s,r,Ae,void 0,f,at);for(dt in f)at=f[dt],ot=l[dt],!f.hasOwnProperty(dt)||at===ot||at===void 0&&ot===void 0||tp(s,r,dt,at,f,ot);return}}for(var K in l)at=l[K],l.hasOwnProperty(K)&&at!=null&&!f.hasOwnProperty(K)&&Te(s,r,K,null,f,at);for(mt in f)at=f[mt],ot=l[mt],!f.hasOwnProperty(mt)||at===ot||at==null&&ot==null||Te(s,r,mt,at,f,ot)}function xv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tM(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,l=performance.getEntriesByType("resource"),f=0;f<l.length;f++){var y=l[f],b=y.transferSize,E=y.initiatorType,N=y.duration;if(b&&N&&xv(E)){for(E=0,N=y.responseEnd,f+=1;f<l.length;f++){var k=l[f],nt=k.startTime;if(nt>N)break;var dt=k.transferSize,mt=k.initiatorType;dt&&xv(mt)&&(k=k.responseEnd,E+=dt*(k<N?1:(N-nt)/(k-nt)))}if(--f,r+=8*(b+E)/(y.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var ep=null,np=null;function Ru(s){return s.nodeType===9?s:s.ownerDocument}function bv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _v(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function ip(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var sp=null;function eM(){var s=window.event;return s&&s.type==="popstate"?s===sp?!1:(sp=s,!0):(sp=null,!1)}var wv=typeof setTimeout=="function"?setTimeout:void 0,nM=typeof clearTimeout=="function"?clearTimeout:void 0,Mv=typeof Promise=="function"?Promise:void 0,iM=typeof queueMicrotask=="function"?queueMicrotask:typeof Mv<"u"?function(s){return Mv.resolve(null).then(s).catch(sM)}:wv;function sM(s){setTimeout(function(){throw s})}function Ks(s){return s==="head"}function Sv(s,r){var l=r,f=0;do{var y=l.nextSibling;if(s.removeChild(l),y&&y.nodeType===8)if(l=y.data,l==="/$"||l==="/&"){if(f===0){s.removeChild(y),Kr(r);return}f--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")f++;else if(l==="html")Dl(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,Dl(l);for(var b=l.firstChild;b;){var E=b.nextSibling,N=b.nodeName;b[wi]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&b.rel.toLowerCase()==="stylesheet"||l.removeChild(b),b=E}}else l==="body"&&Dl(s.ownerDocument.body);l=y}while(l);Kr(r)}function Ev(s,r){var l=s;s=0;do{var f=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),f&&f.nodeType===8)if(l=f.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=f}while(l)}function ap(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":ap(l),Pi(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function aM(s,r,l,f){for(;s.nodeType===1;){var y=l;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!f&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(f){if(!s[wi])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(b=s.getAttribute("rel"),b==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(b!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(b=s.getAttribute("src"),(b!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&b&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var b=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===b)return s}else return s;if(s=hi(s.nextSibling),s===null)break}return null}function rM(s,r,l){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=hi(s.nextSibling),s===null))return null;return s}function Tv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=hi(s.nextSibling),s===null))return null;return s}function rp(s){return s.data==="$?"||s.data==="$~"}function op(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function oM(s,r){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||l.readyState!=="loading")r();else{var f=function(){r(),l.removeEventListener("DOMContentLoaded",f)};l.addEventListener("DOMContentLoaded",f),s._reactRetry=f}}function hi(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var lp=null;function Av(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(r===0)return hi(s.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}s=s.nextSibling}return null}function Cv(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return s;r--}else l!=="/$"&&l!=="/&"||r++}s=s.previousSibling}return null}function Lv(s,r,l){switch(r=Ru(l),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Dl(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Pi(s)}var fi=new Map,Rv=new Set;function Nu(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var vs=Q.d;Q.d={f:lM,r:cM,D:uM,C:hM,L:fM,m:dM,X:mM,S:pM,M:gM};function lM(){var s=vs.f(),r=wu();return s||r}function cM(s){var r=yr(s);r!==null&&r.tag===5&&r.type==="form"?Yy(r):vs.r(s)}var Zr=typeof document>"u"?null:document;function Nv(s,r,l){var f=Zr;if(f&&typeof r=="string"&&r){var y=si(r);y='link[rel="'+s+'"][href="'+y+'"]',typeof l=="string"&&(y+='[crossorigin="'+l+'"]'),Rv.has(y)||(Rv.add(y),s={rel:s,crossOrigin:l,href:r},f.querySelector(y)===null&&(r=f.createElement("link"),vn(r,"link",s),un(r),f.head.appendChild(r)))}}function uM(s){vs.D(s),Nv("dns-prefetch",s,null)}function hM(s,r){vs.C(s,r),Nv("preconnect",s,r)}function fM(s,r,l){vs.L(s,r,l);var f=Zr;if(f&&s&&r){var y='link[rel="preload"][as="'+si(r)+'"]';r==="image"&&l&&l.imageSrcSet?(y+='[imagesrcset="'+si(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(y+='[imagesizes="'+si(l.imageSizes)+'"]')):y+='[href="'+si(s)+'"]';var b=y;switch(r){case"style":b=Qr(s);break;case"script":b=Jr(s)}fi.has(b)||(s=p({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:s,as:r},l),fi.set(b,s),f.querySelector(y)!==null||r==="style"&&f.querySelector(Ol(b))||r==="script"&&f.querySelector(Pl(b))||(r=f.createElement("link"),vn(r,"link",s),un(r),f.head.appendChild(r)))}}function dM(s,r){vs.m(s,r);var l=Zr;if(l&&s){var f=r&&typeof r.as=="string"?r.as:"script",y='link[rel="modulepreload"][as="'+si(f)+'"][href="'+si(s)+'"]',b=y;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Jr(s)}if(!fi.has(b)&&(s=p({rel:"modulepreload",href:s},r),fi.set(b,s),l.querySelector(y)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Pl(b)))return}f=l.createElement("link"),vn(f,"link",s),un(f),l.head.appendChild(f)}}}function pM(s,r,l){vs.S(s,r,l);var f=Zr;if(f&&s){var y=vr(f).hoistableStyles,b=Qr(s);r=r||"default";var E=y.get(b);if(!E){var N={loading:0,preload:null};if(E=f.querySelector(Ol(b)))N.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":r},l),(l=fi.get(b))&&cp(s,l);var k=E=f.createElement("link");un(k),vn(k,"link",s),k._p=new Promise(function(nt,dt){k.onload=nt,k.onerror=dt}),k.addEventListener("load",function(){N.loading|=1}),k.addEventListener("error",function(){N.loading|=2}),N.loading|=4,zu(E,r,f)}E={type:"stylesheet",instance:E,count:1,state:N},y.set(b,E)}}}function mM(s,r){vs.X(s,r);var l=Zr;if(l&&s){var f=vr(l).hoistableScripts,y=Jr(s),b=f.get(y);b||(b=l.querySelector(Pl(y)),b||(s=p({src:s,async:!0},r),(r=fi.get(y))&&up(s,r),b=l.createElement("script"),un(b),vn(b,"link",s),l.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(y,b))}}function gM(s,r){vs.M(s,r);var l=Zr;if(l&&s){var f=vr(l).hoistableScripts,y=Jr(s),b=f.get(y);b||(b=l.querySelector(Pl(y)),b||(s=p({src:s,async:!0,type:"module"},r),(r=fi.get(y))&&up(s,r),b=l.createElement("script"),un(b),vn(b,"link",s),l.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(y,b))}}function zv(s,r,l,f){var y=(y=Ct.current)?Nu(y):null;if(!y)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=Qr(l.href),l=vr(y).hoistableStyles,f=l.get(r),f||(f={type:"style",instance:null,count:0,state:null},l.set(r,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Qr(l.href);var b=vr(y).hoistableStyles,E=b.get(s);if(E||(y=y.ownerDocument||y,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(s,E),(b=y.querySelector(Ol(s)))&&!b._p&&(E.instance=b,E.state.loading=5),fi.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},fi.set(s,l),b||yM(y,s,l,E.state))),r&&f===null)throw Error(i(528,""));return E}if(r&&f!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Jr(l),l=vr(y).hoistableScripts,f=l.get(r),f||(f={type:"script",instance:null,count:0,state:null},l.set(r,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Qr(s){return'href="'+si(s)+'"'}function Ol(s){return'link[rel="stylesheet"]['+s+"]"}function Bv(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function yM(s,r,l,f){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?f.loading=1:(r=s.createElement("link"),f.preload=r,r.addEventListener("load",function(){return f.loading|=1}),r.addEventListener("error",function(){return f.loading|=2}),vn(r,"link",l),un(r),s.head.appendChild(r))}function Jr(s){return'[src="'+si(s)+'"]'}function Pl(s){return"script[async]"+s}function Dv(s,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var f=s.querySelector('style[data-href~="'+si(l.href)+'"]');if(f)return r.instance=f,un(f),f;var y=p({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return f=(s.ownerDocument||s).createElement("style"),un(f),vn(f,"style",y),zu(f,l.precedence,s),r.instance=f;case"stylesheet":y=Qr(l.href);var b=s.querySelector(Ol(y));if(b)return r.state.loading|=4,r.instance=b,un(b),b;f=Bv(l),(y=fi.get(y))&&cp(f,y),b=(s.ownerDocument||s).createElement("link"),un(b);var E=b;return E._p=new Promise(function(N,k){E.onload=N,E.onerror=k}),vn(b,"link",f),r.state.loading|=4,zu(b,l.precedence,s),r.instance=b;case"script":return b=Jr(l.src),(y=s.querySelector(Pl(b)))?(r.instance=y,un(y),y):(f=l,(y=fi.get(b))&&(f=p({},l),up(f,y)),s=s.ownerDocument||s,y=s.createElement("script"),un(y),vn(y,"link",f),s.head.appendChild(y),r.instance=y);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(f=r.instance,r.state.loading|=4,zu(f,l.precedence,s));return r.instance}function zu(s,r,l){for(var f=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=f.length?f[f.length-1]:null,b=y,E=0;E<f.length;E++){var N=f[E];if(N.dataset.precedence===r)b=N;else if(b!==y)break}b?b.parentNode.insertBefore(s,b.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(s,r.firstChild))}function cp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function up(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Bu=null;function Ov(s,r,l){if(Bu===null){var f=new Map,y=Bu=new Map;y.set(l,f)}else y=Bu,f=y.get(l),f||(f=new Map,y.set(l,f));if(f.has(s))return f;for(f.set(s,null),l=l.getElementsByTagName(s),y=0;y<l.length;y++){var b=l[y];if(!(b[wi]||b[Kt]||s==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var E=b.getAttribute(r)||"";E=s+E;var N=f.get(E);N?N.push(b):f.set(E,[b])}}return f}function Pv(s,r,l){s=s.ownerDocument||s,s.head.insertBefore(l,r==="title"?s.querySelector("head > title"):null)}function vM(s,r,l){if(l===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Uv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function xM(s,r,l,f){if(l.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var y=Qr(f.href),b=r.querySelector(Ol(y));if(b){r=b._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=Du.bind(s),r.then(s,s)),l.state.loading|=4,l.instance=b,un(b);return}b=r.ownerDocument||r,f=Bv(f),(y=fi.get(y))&&cp(f,y),b=b.createElement("link"),un(b);var E=b;E._p=new Promise(function(N,k){E.onload=N,E.onerror=k}),vn(b,"link",f),l.instance=b}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=Du.bind(s),r.addEventListener("load",l),r.addEventListener("error",l))}}var hp=0;function bM(s,r){return s.stylesheets&&s.count===0&&Pu(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var f=setTimeout(function(){if(s.stylesheets&&Pu(s,s.stylesheets),s.unsuspend){var b=s.unsuspend;s.unsuspend=null,b()}},6e4+r);0<s.imgBytes&&hp===0&&(hp=62500*tM());var y=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Pu(s,s.stylesheets),s.unsuspend)){var b=s.unsuspend;s.unsuspend=null,b()}},(s.imgBytes>hp?50:800)+r);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(f),clearTimeout(y)}}:null}function Du(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Pu(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Ou=null;function Pu(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Ou=new Map,r.forEach(_M,s),Ou=null,Du.call(s))}function _M(s,r){if(!(r.state.loading&4)){var l=Ou.get(s);if(l)var f=l.get(null);else{l=new Map,Ou.set(s,l);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<y.length;b++){var E=y[b];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(l.set(E.dataset.precedence,E),f=E)}f&&l.set(null,f)}y=r.instance,E=y.getAttribute("data-precedence"),b=l.get(E)||f,b===f&&l.set(null,y),l.set(E,y),this.count++,f=Du.bind(this),y.addEventListener("load",f),y.addEventListener("error",f),b?b.parentNode.insertBefore(y,b.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),r.state.loading|=4}}var Ul={$$typeof:L,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function wM(s,r,l,f,y,b,E,N,k){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ft(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ft(0),this.hiddenUpdates=ft(null),this.identifierPrefix=f,this.onUncaughtError=y,this.onCaughtError=b,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function Iv(s,r,l,f,y,b,E,N,k,nt,dt,mt){return s=new wM(s,r,l,E,k,nt,dt,mt,N),r=1,b===!0&&(r|=24),b=kn(3,null,null,r),s.current=b,b.stateNode=s,r=Wf(),r.refCount++,s.pooledCache=r,r.refCount++,b.memoizedState={element:f,isDehydrated:l,cache:r},Xf(b),s}function Fv(s){return s?(s=Cr,s):Cr}function Hv(s,r,l,f,y,b){y=Fv(y),f.context===null?f.context=y:f.pendingContext=y,f=Gs(r),f.payload={element:l},b=b===void 0?null:b,b!==null&&(f.callback=b),l=Vs(s,f,r),l!==null&&(In(l,s,r),ml(l,s,r))}function Gv(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<r?l:r}}function fp(s,r){Gv(s,r),(s=s.alternate)&&Gv(s,r)}function Vv(s){if(s.tag===13||s.tag===31){var r=Ua(s,67108864);r!==null&&In(r,s,67108864),fp(s,67108864)}}function kv(s){if(s.tag===13||s.tag===31){var r=Xn();r=le(r);var l=Ua(s,r);l!==null&&In(l,s,r),fp(s,r)}}var Uu=!0;function MM(s,r,l,f){var y=z.T;z.T=null;var b=Q.p;try{Q.p=2,dp(s,r,l,f)}finally{Q.p=b,z.T=y}}function SM(s,r,l,f){var y=z.T;z.T=null;var b=Q.p;try{Q.p=8,dp(s,r,l,f)}finally{Q.p=b,z.T=y}}function dp(s,r,l,f){if(Uu){var y=pp(f);if(y===null)$d(s,r,f,Iu,l),jv(s,f);else if(TM(y,s,r,l,f))f.stopPropagation();else if(jv(s,f),r&4&&-1<EM.indexOf(s)){for(;y!==null;){var b=yr(y);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var E=dn(b.pendingLanes);if(E!==0){var N=b;for(N.pendingLanes|=2,N.entangledLanes|=2;E;){var k=1<<31-Cn(E);N.entanglements[1]|=k,E&=~k}Hi(b),(be&6)===0&&(bu=Ot()+500,Nl(0))}}break;case 31:case 13:N=Ua(b,2),N!==null&&In(N,b,2),wu(),fp(b,2)}if(b=pp(f),b===null&&$d(s,r,f,Iu,l),b===y)break;y=b}y!==null&&f.stopPropagation()}else $d(s,r,f,null,l)}}function pp(s){return s=gf(s),mp(s)}var Iu=null;function mp(s){if(Iu=null,s=ni(s),s!==null){var r=o(s);if(r===null)s=null;else{var l=r.tag;if(l===13){if(s=c(r),s!==null)return s;s=null}else if(l===31){if(s=u(r),s!==null)return s;s=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return Iu=s,null}function Wv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Tt()){case W:return 2;case St:return 8;case Pt:case At:return 32;case Vt:return 268435456;default:return 32}default:return 32}}var gp=!1,$s=null,ta=null,ea=null,Il=new Map,Fl=new Map,na=[],EM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function jv(s,r){switch(s){case"focusin":case"focusout":$s=null;break;case"dragenter":case"dragleave":ta=null;break;case"mouseover":case"mouseout":ea=null;break;case"pointerover":case"pointerout":Il.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fl.delete(r.pointerId)}}function Hl(s,r,l,f,y,b){return s===null||s.nativeEvent!==b?(s={blockedOn:r,domEventName:l,eventSystemFlags:f,nativeEvent:b,targetContainers:[y]},r!==null&&(r=yr(r),r!==null&&Vv(r)),s):(s.eventSystemFlags|=f,r=s.targetContainers,y!==null&&r.indexOf(y)===-1&&r.push(y),s)}function TM(s,r,l,f,y){switch(r){case"focusin":return $s=Hl($s,s,r,l,f,y),!0;case"dragenter":return ta=Hl(ta,s,r,l,f,y),!0;case"mouseover":return ea=Hl(ea,s,r,l,f,y),!0;case"pointerover":var b=y.pointerId;return Il.set(b,Hl(Il.get(b)||null,s,r,l,f,y)),!0;case"gotpointercapture":return b=y.pointerId,Fl.set(b,Hl(Fl.get(b)||null,s,r,l,f,y)),!0}return!1}function qv(s){var r=ni(s.target);if(r!==null){var l=o(r);if(l!==null){if(r=l.tag,r===13){if(r=c(l),r!==null){s.blockedOn=r,He(s.priority,function(){kv(l)});return}}else if(r===31){if(r=u(l),r!==null){s.blockedOn=r,He(s.priority,function(){kv(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Fu(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var l=pp(s.nativeEvent);if(l===null){l=s.nativeEvent;var f=new l.constructor(l.type,l);mf=f,l.target.dispatchEvent(f),mf=null}else return r=yr(l),r!==null&&Vv(r),s.blockedOn=l,!1;r.shift()}return!0}function Yv(s,r,l){Fu(s)&&l.delete(r)}function AM(){gp=!1,$s!==null&&Fu($s)&&($s=null),ta!==null&&Fu(ta)&&(ta=null),ea!==null&&Fu(ea)&&(ea=null),Il.forEach(Yv),Fl.forEach(Yv)}function Hu(s,r){s.blockedOn===r&&(s.blockedOn=null,gp||(gp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,AM)))}var Gu=null;function Xv(s){Gu!==s&&(Gu=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Gu===s&&(Gu=null);for(var r=0;r<s.length;r+=3){var l=s[r],f=s[r+1],y=s[r+2];if(typeof f!="function"){if(mp(f||l)===null)continue;break}var b=yr(l);b!==null&&(s.splice(r,3),r-=3,pd(b,{pending:!0,data:y,method:l.method,action:f},f,y))}}))}function Kr(s){function r(k){return Hu(k,s)}$s!==null&&Hu($s,s),ta!==null&&Hu(ta,s),ea!==null&&Hu(ea,s),Il.forEach(r),Fl.forEach(r);for(var l=0;l<na.length;l++){var f=na[l];f.blockedOn===s&&(f.blockedOn=null)}for(;0<na.length&&(l=na[0],l.blockedOn===null);)qv(l),l.blockedOn===null&&na.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(f=0;f<l.length;f+=3){var y=l[f],b=l[f+1],E=y[Ge]||null;if(typeof b=="function")E||Xv(l);else if(E){var N=null;if(b&&b.hasAttribute("formAction")){if(y=b,E=b[Ge]||null)N=E.formAction;else if(mp(y)!==null)continue}else N=E.action;typeof N=="function"?l[f+1]=N:(l.splice(f,3),f-=3),Xv(l)}}}function Zv(){function s(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(E){return y=E})},focusReset:"manual",scroll:"manual"})}function r(){y!==null&&(y(),y=null),f||setTimeout(l,20)}function l(){if(!f&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,y=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){f=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),y!==null&&(y(),y=null)}}}function yp(s){this._internalRoot=s}Vu.prototype.render=yp.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,f=Xn();Hv(l,f,s,r,null,null)},Vu.prototype.unmount=yp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;Hv(s.current,2,null,s,null,null),wu(),r[ge]=null}};function Vu(s){this._internalRoot=s}Vu.prototype.unstable_scheduleHydration=function(s){if(s){var r=We();s={blockedOn:null,target:s,priority:r};for(var l=0;l<na.length&&r!==0&&r<na[l].priority;l++);na.splice(l,0,s),l===0&&qv(s)}};var Qv=t.version;if(Qv!=="19.2.1")throw Error(i(527,Qv,"19.2.1"));Q.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=d(r),s=s!==null?m(s):null,s=s===null?null:s.stateNode,s};var CM={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ku=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ku.isDisabled&&ku.supportsFiber)try{bi=ku.inject(CM),Oe=ku}catch{}}return Vl.createRoot=function(s,r){if(!a(s))throw Error(i(299));var l=!1,f="",y=i0,b=s0,E=a0;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(y=r.onUncaughtError),r.onCaughtError!==void 0&&(b=r.onCaughtError),r.onRecoverableError!==void 0&&(E=r.onRecoverableError)),r=Iv(s,1,!1,null,null,l,f,null,y,b,E,Zv),s[ge]=r.current,Kd(s),new yp(r)},Vl.hydrateRoot=function(s,r,l){if(!a(s))throw Error(i(299));var f=!1,y="",b=i0,E=s0,N=a0,k=null;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(y=l.identifierPrefix),l.onUncaughtError!==void 0&&(b=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(N=l.onRecoverableError),l.formState!==void 0&&(k=l.formState)),r=Iv(s,1,!0,r,l??null,f,y,k,b,E,N,Zv),r.context=Fv(null),l=r.current,f=Xn(),f=le(f),y=Gs(f),y.callback=null,Vs(l,y,f),l=f,r.current.lanes=l,lt(r,l),Hi(r),s[ge]=r.current,Kd(s),new Vu(r)},Vl.version="19.2.1",Vl}var rx;function FM(){if(rx)return bp.exports;rx=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),bp.exports=IM(),bp.exports}var HM=FM();const GM=v_(HM),VM="124",da={ROTATE:0,DOLLY:1,PAN:2},pa={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},kM=0,ox=1,WM=2,x_=1,Ym=2,nc=3,Xh=0,_n=1,zo=2,b_=1,sc=0,ac=1,lx=2,cx=3,ux=4,jM=5,vo=100,qM=101,YM=102,hx=103,fx=104,XM=200,ZM=201,QM=202,JM=203,__=204,w_=205,KM=206,$M=207,tS=208,eS=209,nS=210,iS=0,sS=1,aS=2,om=3,rS=4,oS=5,lS=6,cS=7,Zh=0,uS=1,hS=2,rc=0,fS=1,dS=2,pS=3,mS=4,gS=5,M_=300,Xm=301,Zm=302,dx=303,px=304,Qm=306,Jm=307,lm=1e3,Kn=1001,cm=1002,Rn=1003,mx=1004,gx=1005,En=1006,yS=1007,Qh=1008,Km=1009,vS=1010,xS=1011,Dh=1012,bS=1013,zh=1014,ma=1015,Oh=1016,_S=1017,wS=1018,MS=1019,oc=1020,SS=1021,sr=1022,zi=1023,ES=1024,TS=1025,Lo=1026,dc=1027,AS=1028,CS=1029,LS=1030,RS=1031,NS=1032,zS=1033,yx=33776,vx=33777,xx=33778,bx=33779,_x=35840,wx=35841,Mx=35842,Sx=35843,BS=36196,Ex=37492,Tx=37496,DS=37808,OS=37809,PS=37810,US=37811,IS=37812,FS=37813,HS=37814,GS=37815,VS=37816,kS=37817,WS=37818,jS=37819,qS=37820,YS=37821,XS=36492,ZS=37840,QS=37841,JS=37842,KS=37843,$S=37844,tE=37845,eE=37846,nE=37847,iE=37848,sE=37849,aE=37850,rE=37851,oE=37852,lE=37853,cE=2200,uE=2201,hE=2202,Ph=2300,Bh=2301,Sp=2302,bo=2400,_o=2401,Uh=2402,$m=2500,S_=2501,fE=0,Lc=3e3,Jh=3001,dE=3007,pE=3002,mE=3003,gE=3004,yE=3005,vE=3006,xE=3200,bE=3201,qo=0,_E=1,Ep=7680,wE=519,Kh=35044,pc=35048,Ax="300 es";function Oi(){}Object.assign(Oi.prototype,{addEventListener:function(n,t){this._listeners===void 0&&(this._listeners={});const e=this._listeners;e[n]===void 0&&(e[n]=[]),e[n].indexOf(t)===-1&&e[n].push(t)},hasEventListener:function(n,t){if(this._listeners===void 0)return!1;const e=this._listeners;return e[n]!==void 0&&e[n].indexOf(t)!==-1},removeEventListener:function(n,t){if(this._listeners===void 0)return;const i=this._listeners[n];if(i!==void 0){const a=i.indexOf(t);a!==-1&&i.splice(a,1)}},dispatchEvent:function(n){if(this._listeners===void 0)return;const e=this._listeners[n.type];if(e!==void 0){n.target=this;const i=e.slice(0);for(let a=0,o=i.length;a<o;a++)i[a].call(this,n)}}});const xn=[];for(let n=0;n<256;n++)xn[n]=(n<16?"0":"")+n.toString(16);let Wu=1234567;const ne={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const n=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(xn[n&255]+xn[n>>8&255]+xn[n>>16&255]+xn[n>>24&255]+"-"+xn[t&255]+xn[t>>8&255]+"-"+xn[t>>16&15|64]+xn[t>>24&255]+"-"+xn[e&63|128]+xn[e>>8&255]+"-"+xn[e>>16&255]+xn[e>>24&255]+xn[i&255]+xn[i>>8&255]+xn[i>>16&255]+xn[i>>24&255]).toUpperCase()},clamp:function(n,t,e){return Math.max(t,Math.min(e,n))},euclideanModulo:function(n,t){return(n%t+t)%t},mapLinear:function(n,t,e,i,a){return i+(n-t)*(a-i)/(e-t)},lerp:function(n,t,e){return(1-e)*n+e*t},smoothstep:function(n,t,e){return n<=t?0:n>=e?1:(n=(n-t)/(e-t),n*n*(3-2*n))},smootherstep:function(n,t,e){return n<=t?0:n>=e?1:(n=(n-t)/(e-t),n*n*n*(n*(n*6-15)+10))},randInt:function(n,t){return n+Math.floor(Math.random()*(t-n+1))},randFloat:function(n,t){return n+Math.random()*(t-n)},randFloatSpread:function(n){return n*(.5-Math.random())},seededRandom:function(n){return n!==void 0&&(Wu=n%2147483647),Wu=Wu*16807%2147483647,(Wu-1)/2147483646},degToRad:function(n){return n*ne.DEG2RAD},radToDeg:function(n){return n*ne.RAD2DEG},isPowerOfTwo:function(n){return(n&n-1)===0&&n!==0},ceilPowerOfTwo:function(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},floorPowerOfTwo:function(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},setQuaternionFromProperEuler:function(n,t,e,i,a){const o=Math.cos,c=Math.sin,u=o(e/2),h=c(e/2),d=o((t+i)/2),m=c((t+i)/2),p=o((t-i)/2),g=c((t-i)/2),v=o((i-t)/2),x=c((i-t)/2);switch(a){case"XYX":n.set(u*m,h*p,h*g,u*d);break;case"YZY":n.set(h*g,u*m,h*p,u*d);break;case"ZXZ":n.set(h*p,h*g,u*m,u*d);break;case"XZX":n.set(u*m,h*x,h*v,u*d);break;case"YXY":n.set(h*v,u*m,h*x,u*d);break;case"ZYZ":n.set(h*x,h*v,u*m,u*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+a)}}};class ht{constructor(t=0,e=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,i=this.y,a=t.elements;return this.x=a[0]*e+a[3]*i+a[6],this.y=a[1]*e+a[4]*i+a[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,i){return i!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const i=Math.cos(e),a=Math.sin(e),o=this.x-t.x,c=this.y-t.y;return this.x=o*i-c*a+t.x,this.y=o*a+c*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class Hn{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,i,a,o,c,u,h,d){const m=this.elements;return m[0]=t,m[1]=a,m[2]=u,m[3]=e,m[4]=o,m[5]=h,m[6]=i,m[7]=c,m[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return new this.constructor().fromArray(this.elements)}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}extractBasis(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,a=e.elements,o=this.elements,c=i[0],u=i[3],h=i[6],d=i[1],m=i[4],p=i[7],g=i[2],v=i[5],x=i[8],M=a[0],S=a[3],w=a[6],_=a[1],L=a[4],R=a[7],C=a[2],A=a[5],B=a[8];return o[0]=c*M+u*_+h*C,o[3]=c*S+u*L+h*A,o[6]=c*w+u*R+h*B,o[1]=d*M+m*_+p*C,o[4]=d*S+m*L+p*A,o[7]=d*w+m*R+p*B,o[2]=g*M+v*_+x*C,o[5]=g*S+v*L+x*A,o[8]=g*w+v*R+x*B,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[1],a=t[2],o=t[3],c=t[4],u=t[5],h=t[6],d=t[7],m=t[8];return e*c*m-e*u*d-i*o*m+i*u*h+a*o*d-a*c*h}invert(){const t=this.elements,e=t[0],i=t[1],a=t[2],o=t[3],c=t[4],u=t[5],h=t[6],d=t[7],m=t[8],p=m*c-u*d,g=u*h-m*o,v=d*o-c*h,x=e*p+i*g+a*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const M=1/x;return t[0]=p*M,t[1]=(a*d-m*i)*M,t[2]=(u*i-a*c)*M,t[3]=g*M,t[4]=(m*e-a*h)*M,t[5]=(a*o-u*e)*M,t[6]=v*M,t[7]=(i*h-d*e)*M,t[8]=(c*e-i*o)*M,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).copy(this).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,i,a,o,c,u){const h=Math.cos(o),d=Math.sin(o);return this.set(i*h,i*d,-i*(h*c+d*u)+c+t,-a*d,a*h,-a*(-d*c+h*u)+u+e,0,0,1),this}scale(t,e){const i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),a=this.elements,o=a[0],c=a[3],u=a[6],h=a[1],d=a[4],m=a[7];return a[0]=e*o+i*h,a[3]=e*c+i*d,a[6]=e*u+i*m,a[1]=-i*o+e*h,a[4]=-i*c+e*d,a[7]=-i*u+e*m,this}translate(t,e){const i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this}equals(t){const e=this.elements,i=t.elements;for(let a=0;a<9;a++)if(e[a]!==i[a])return!1;return!0}fromArray(t,e=0){for(let i=0;i<9;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}}let $r;const Yo={getDataURL:function(n){if(/^data:/i.test(n.src)||typeof HTMLCanvasElement>"u")return n.src;let t;if(n instanceof HTMLCanvasElement)t=n;else{$r===void 0&&($r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),$r.width=n.width,$r.height=n.height;const e=$r.getContext("2d");n instanceof ImageData?e.putImageData(n,0,0):e.drawImage(n,0,0,n.width,n.height),t=$r}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}};let ME=0;function De(n=De.DEFAULT_IMAGE,t=De.DEFAULT_MAPPING,e=Kn,i=Kn,a=En,o=Qh,c=zi,u=Km,h=1,d=Lc){Object.defineProperty(this,"id",{value:ME++}),this.uuid=ne.generateUUID(),this.name="",this.image=n,this.mipmaps=[],this.mapping=t,this.wrapS=e,this.wrapT=i,this.magFilter=a,this.minFilter=o,this.anisotropy=h,this.format=c,this.internalFormat=null,this.type=u,this.offset=new ht(0,0),this.repeat=new ht(1,1),this.center=new ht(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Hn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.version=0,this.onUpdate=null}De.DEFAULT_IMAGE=void 0;De.DEFAULT_MAPPING=M_;De.prototype=Object.assign(Object.create(Oi.prototype),{constructor:De,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(n){return this.name=n.name,this.image=n.image,this.mipmaps=n.mipmaps.slice(0),this.mapping=n.mapping,this.wrapS=n.wrapS,this.wrapT=n.wrapT,this.magFilter=n.magFilter,this.minFilter=n.minFilter,this.anisotropy=n.anisotropy,this.format=n.format,this.internalFormat=n.internalFormat,this.type=n.type,this.offset.copy(n.offset),this.repeat.copy(n.repeat),this.center.copy(n.center),this.rotation=n.rotation,this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrix.copy(n.matrix),this.generateMipmaps=n.generateMipmaps,this.premultiplyAlpha=n.premultiplyAlpha,this.flipY=n.flipY,this.unpackAlignment=n.unpackAlignment,this.encoding=n.encoding,this},toJSON:function(n){const t=n===void 0||typeof n=="string";if(!t&&n.textures[this.uuid]!==void 0)return n.textures[this.uuid];const e={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const i=this.image;if(i.uuid===void 0&&(i.uuid=ne.generateUUID()),!t&&n.images[i.uuid]===void 0){let a;if(Array.isArray(i)){a=[];for(let o=0,c=i.length;o<c;o++)i[o].isDataTexture?a.push(Tp(i[o].image)):a.push(Tp(i[o]))}else a=Tp(i);n.images[i.uuid]={uuid:i.uuid,url:a}}e.image=i.uuid}return t||(n.textures[this.uuid]=e),e},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(n){if(this.mapping!==M_)return n;if(n.applyMatrix3(this.matrix),n.x<0||n.x>1)switch(this.wrapS){case lm:n.x=n.x-Math.floor(n.x);break;case Kn:n.x=n.x<0?0:1;break;case cm:Math.abs(Math.floor(n.x)%2)===1?n.x=Math.ceil(n.x)-n.x:n.x=n.x-Math.floor(n.x);break}if(n.y<0||n.y>1)switch(this.wrapT){case lm:n.y=n.y-Math.floor(n.y);break;case Kn:n.y=n.y<0?0:1;break;case cm:Math.abs(Math.floor(n.y)%2)===1?n.y=Math.ceil(n.y)-n.y:n.y=n.y-Math.floor(n.y);break}return this.flipY&&(n.y=1-n.y),n}});Object.defineProperty(De.prototype,"needsUpdate",{set:function(n){n===!0&&this.version++}});function Tp(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Yo.getDataURL(n):n.data?{data:Array.prototype.slice.call(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}class Le{constructor(t=0,e=0,i=0,a=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=t,this.y=e,this.z=i,this.w=a}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,i,a){return this.x=t,this.y=e,this.z=i,this.w=a,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,i=this.y,a=this.z,o=this.w,c=t.elements;return this.x=c[0]*e+c[4]*i+c[8]*a+c[12]*o,this.y=c[1]*e+c[5]*i+c[9]*a+c[13]*o,this.z=c[2]*e+c[6]*i+c[10]*a+c[14]*o,this.w=c[3]*e+c[7]*i+c[11]*a+c[15]*o,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,i,a,o;const h=t.elements,d=h[0],m=h[4],p=h[8],g=h[1],v=h[5],x=h[9],M=h[2],S=h[6],w=h[10];if(Math.abs(m-g)<.01&&Math.abs(p-M)<.01&&Math.abs(x-S)<.01){if(Math.abs(m+g)<.1&&Math.abs(p+M)<.1&&Math.abs(x+S)<.1&&Math.abs(d+v+w-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const L=(d+1)/2,R=(v+1)/2,C=(w+1)/2,A=(m+g)/4,B=(p+M)/4,Y=(x+S)/4;return L>R&&L>C?L<.01?(i=0,a=.707106781,o=.707106781):(i=Math.sqrt(L),a=A/i,o=B/i):R>C?R<.01?(i=.707106781,a=0,o=.707106781):(a=Math.sqrt(R),i=A/a,o=Y/a):C<.01?(i=.707106781,a=.707106781,o=0):(o=Math.sqrt(C),i=B/o,a=Y/o),this.set(i,a,o,e),this}let _=Math.sqrt((S-x)*(S-x)+(p-M)*(p-M)+(g-m)*(g-m));return Math.abs(_)<.001&&(_=1),this.x=(S-x)/_,this.y=(p-M)/_,this.z=(g-m)/_,this.w=Math.acos((d+v+w-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this.w=t.w+(e.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,i){return i!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}function Bi(n,t,e){this.width=n,this.height=t,this.scissor=new Le(0,0,n,t),this.scissorTest=!1,this.viewport=new Le(0,0,n,t),e=e||{},this.texture=new De(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.image={},this.texture.image.width=n,this.texture.image.height=t,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:En,this.depthBuffer=e.depthBuffer!==void 0?e.depthBuffer:!0,this.stencilBuffer=e.stencilBuffer!==void 0?e.stencilBuffer:!1,this.depthTexture=e.depthTexture!==void 0?e.depthTexture:null}Bi.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Bi,isWebGLRenderTarget:!0,setSize:function(n,t){(this.width!==n||this.height!==t)&&(this.width=n,this.height=t,this.texture.image.width=n,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,n,t),this.scissor.set(0,0,n,t)},clone:function(){return new this.constructor().copy(this)},copy:function(n){return this.width=n.width,this.height=n.height,this.viewport.copy(n.viewport),this.texture=n.texture.clone(),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Cx(n,t,e){Bi.call(this,n,t,e),this.samples=4}Cx.prototype=Object.assign(Object.create(Bi.prototype),{constructor:Cx,isWebGLMultisampleRenderTarget:!0,copy:function(n){return Bi.prototype.copy.call(this,n),this.samples=n.samples,this}});let Nn=class{constructor(t=0,e=0,i=0,a=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=e,this._z=i,this._w=a}static slerp(t,e,i,a){return i.copy(t).slerp(e,a)}static slerpFlat(t,e,i,a,o,c,u){let h=i[a+0],d=i[a+1],m=i[a+2],p=i[a+3];const g=o[c+0],v=o[c+1],x=o[c+2],M=o[c+3];if(p!==M||h!==g||d!==v||m!==x){let S=1-u;const w=h*g+d*v+m*x+p*M,_=w>=0?1:-1,L=1-w*w;if(L>Number.EPSILON){const C=Math.sqrt(L),A=Math.atan2(C,w*_);S=Math.sin(S*A)/C,u=Math.sin(u*A)/C}const R=u*_;if(h=h*S+g*R,d=d*S+v*R,m=m*S+x*R,p=p*S+M*R,S===1-u){const C=1/Math.sqrt(h*h+d*d+m*m+p*p);h*=C,d*=C,m*=C,p*=C}}t[e]=h,t[e+1]=d,t[e+2]=m,t[e+3]=p}static multiplyQuaternionsFlat(t,e,i,a,o,c){const u=i[a],h=i[a+1],d=i[a+2],m=i[a+3],p=o[c],g=o[c+1],v=o[c+2],x=o[c+3];return t[e]=u*x+m*p+h*v-d*g,t[e+1]=h*x+m*g+d*p-u*v,t[e+2]=d*x+m*v+u*g-h*p,t[e+3]=m*x-u*p-h*g-d*v,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,a){return this._x=t,this._y=e,this._z=i,this._w=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=t._x,a=t._y,o=t._z,c=t._order,u=Math.cos,h=Math.sin,d=u(i/2),m=u(a/2),p=u(o/2),g=h(i/2),v=h(a/2),x=h(o/2);switch(c){case"XYZ":this._x=g*m*p+d*v*x,this._y=d*v*p-g*m*x,this._z=d*m*x+g*v*p,this._w=d*m*p-g*v*x;break;case"YXZ":this._x=g*m*p+d*v*x,this._y=d*v*p-g*m*x,this._z=d*m*x-g*v*p,this._w=d*m*p+g*v*x;break;case"ZXY":this._x=g*m*p-d*v*x,this._y=d*v*p+g*m*x,this._z=d*m*x+g*v*p,this._w=d*m*p-g*v*x;break;case"ZYX":this._x=g*m*p-d*v*x,this._y=d*v*p+g*m*x,this._z=d*m*x-g*v*p,this._w=d*m*p+g*v*x;break;case"YZX":this._x=g*m*p+d*v*x,this._y=d*v*p+g*m*x,this._z=d*m*x-g*v*p,this._w=d*m*p-g*v*x;break;case"XZY":this._x=g*m*p-d*v*x,this._y=d*v*p-g*m*x,this._z=d*m*x+g*v*p,this._w=d*m*p+g*v*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const i=e/2,a=Math.sin(i);return this._x=t.x*a,this._y=t.y*a,this._z=t.z*a,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,i=e[0],a=e[4],o=e[8],c=e[1],u=e[5],h=e[9],d=e[2],m=e[6],p=e[10],g=i+u+p;if(g>0){const v=.5/Math.sqrt(g+1);this._w=.25/v,this._x=(m-h)*v,this._y=(o-d)*v,this._z=(c-a)*v}else if(i>u&&i>p){const v=2*Math.sqrt(1+i-u-p);this._w=(m-h)/v,this._x=.25*v,this._y=(a+c)/v,this._z=(o+d)/v}else if(u>p){const v=2*Math.sqrt(1+u-i-p);this._w=(o-d)/v,this._x=(a+c)/v,this._y=.25*v,this._z=(h+m)/v}else{const v=2*Math.sqrt(1+p-i-u);this._w=(c-a)/v,this._x=(o+d)/v,this._y=(h+m)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let a=t.dot(e)+1;return a<1e-6?(a=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=a):(this._x=0,this._y=-t.z,this._z=t.y,this._w=a)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=a),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(ne.clamp(this.dot(t),-1,1)))}rotateTowards(t,e){const i=this.angleTo(t);if(i===0)return this;const a=Math.min(1,e/i);return this.slerp(t,a),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return e!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const i=t._x,a=t._y,o=t._z,c=t._w,u=e._x,h=e._y,d=e._z,m=e._w;return this._x=i*m+c*u+a*d-o*h,this._y=a*m+c*h+o*u-i*d,this._z=o*m+c*d+i*h-a*u,this._w=c*m-i*u-a*h-o*d,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const i=this._x,a=this._y,o=this._z,c=this._w;let u=c*t._w+i*t._x+a*t._y+o*t._z;if(u<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,u=-u):this.copy(t),u>=1)return this._w=c,this._x=i,this._y=a,this._z=o,this;const h=1-u*u;if(h<=Number.EPSILON){const v=1-e;return this._w=v*c+e*this._w,this._x=v*i+e*this._x,this._y=v*a+e*this._y,this._z=v*o+e*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(h),m=Math.atan2(d,u),p=Math.sin((1-e)*m)/d,g=Math.sin(e*m)/d;return this._w=c*p+this._w*g,this._x=i*p+this._x*g,this._y=a*p+this._y*g,this._z=o*p+this._z*g,this._onChangeCallback(),this}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}};class G{constructor(t=0,e=0,i=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=e,this.z=i}set(t,e,i){return i===void 0&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Lx.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Lx.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,i=this.y,a=this.z,o=t.elements;return this.x=o[0]*e+o[3]*i+o[6]*a,this.y=o[1]*e+o[4]*i+o[7]*a,this.z=o[2]*e+o[5]*i+o[8]*a,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,i=this.y,a=this.z,o=t.elements,c=1/(o[3]*e+o[7]*i+o[11]*a+o[15]);return this.x=(o[0]*e+o[4]*i+o[8]*a+o[12])*c,this.y=(o[1]*e+o[5]*i+o[9]*a+o[13])*c,this.z=(o[2]*e+o[6]*i+o[10]*a+o[14])*c,this}applyQuaternion(t){const e=this.x,i=this.y,a=this.z,o=t.x,c=t.y,u=t.z,h=t.w,d=h*e+c*a-u*i,m=h*i+u*e-o*a,p=h*a+o*i-c*e,g=-o*e-c*i-u*a;return this.x=d*h+g*-o+m*-u-p*-c,this.y=m*h+g*-c+p*-o-d*-u,this.z=p*h+g*-u+d*-c-m*-o,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,i=this.y,a=this.z,o=t.elements;return this.x=o[0]*e+o[4]*i+o[8]*a,this.y=o[1]*e+o[5]*i+o[9]*a,this.z=o[2]*e+o[6]*i+o[10]*a,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t,e){return e!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const i=t.x,a=t.y,o=t.z,c=e.x,u=e.y,h=e.z;return this.x=a*h-o*u,this.y=o*c-i*h,this.z=i*u-a*c,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return Ap.copy(this).projectOnVector(t),this.sub(Ap)}reflect(t){return this.sub(Ap.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(ne.clamp(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y,a=this.z-t.z;return e*e+i*i+a*a}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){const a=Math.sin(e)*t;return this.x=a*Math.sin(i),this.y=Math.cos(e)*t,this.z=a*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),a=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=a,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,i){return i!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const Ap=new G,Lx=new Nn;class Ta{constructor(t,e){Object.defineProperty(this,"isBox3",{value:!0}),this.min=t!==void 0?t:new G(1/0,1/0,1/0),this.max=e!==void 0?e:new G(-1/0,-1/0,-1/0)}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,i=1/0,a=1/0,o=-1/0,c=-1/0,u=-1/0;for(let h=0,d=t.length;h<d;h+=3){const m=t[h],p=t[h+1],g=t[h+2];m<e&&(e=m),p<i&&(i=p),g<a&&(a=g),m>o&&(o=m),p>c&&(c=p),g>u&&(u=g)}return this.min.set(e,i,a),this.max.set(o,c,u),this}setFromBufferAttribute(t){let e=1/0,i=1/0,a=1/0,o=-1/0,c=-1/0,u=-1/0;for(let h=0,d=t.count;h<d;h++){const m=t.getX(h),p=t.getY(h),g=t.getZ(h);m<e&&(e=m),p<i&&(i=p),g<a&&(a=g),m>o&&(o=m),p>c&&(c=p),g>u&&(u=g)}return this.min.set(e,i,a),this.max.set(o,c,u),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=kl.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return t===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new G),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return t===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new G),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;e!==void 0&&(e.boundingBox===null&&e.computeBoundingBox(),Lp.copy(e.boundingBox),Lp.applyMatrix4(t.matrixWorld),this.union(Lp));const i=t.children;for(let a=0,o=i.length;a<o;a++)this.expandByObject(i[a]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new G),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,kl),kl.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Wl),ju.subVectors(this.max,Wl),to.subVectors(t.a,Wl),eo.subVectors(t.b,Wl),no.subVectors(t.c,Wl),sa.subVectors(eo,to),aa.subVectors(no,eo),Qa.subVectors(to,no);let e=[0,-sa.z,sa.y,0,-aa.z,aa.y,0,-Qa.z,Qa.y,sa.z,0,-sa.x,aa.z,0,-aa.x,Qa.z,0,-Qa.x,-sa.y,sa.x,0,-aa.y,aa.x,0,-Qa.y,Qa.x,0];return!Cp(e,to,eo,no,ju)||(e=[1,0,0,0,1,0,0,0,1],!Cp(e,to,eo,no,ju))?!1:(qu.crossVectors(sa,aa),e=[qu.x,qu.y,qu.z],Cp(e,to,eo,no,ju))}clampPoint(t,e){return e===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new G),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return kl.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return t===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=this.getSize(kl).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(xs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),xs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),xs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),xs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),xs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),xs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),xs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),xs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(xs),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}function Cp(n,t,e,i,a){for(let o=0,c=n.length-3;o<=c;o+=3){Ja.fromArray(n,o);const u=a.x*Math.abs(Ja.x)+a.y*Math.abs(Ja.y)+a.z*Math.abs(Ja.z),h=t.dot(Ja),d=e.dot(Ja),m=i.dot(Ja);if(Math.max(-Math.max(h,d,m),Math.min(h,d,m))>u)return!1}return!0}const xs=[new G,new G,new G,new G,new G,new G,new G,new G],kl=new G,Lp=new Ta,to=new G,eo=new G,no=new G,sa=new G,aa=new G,Qa=new G,Wl=new G,ju=new G,qu=new G,Ja=new G,SE=new Ta;let Di=class{constructor(t,e){this.center=t!==void 0?t:new G,this.radius=e!==void 0?e:-1}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const i=this.center;e!==void 0?i.copy(e):SE.setFromPoints(t).getCenter(i);let a=0;for(let o=0,c=t.length;o<c;o++)a=Math.max(a,i.distanceToSquared(t[o]));return this.radius=Math.sqrt(a),this}clone(){return new this.constructor().copy(this)}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const i=this.center.distanceToSquared(t);return e===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new G),e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return t===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Ta),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}};const bs=new G,Rp=new G,Yu=new G,ra=new G,Np=new G,Xu=new G,zp=new G;let Rc=class{constructor(t,e){this.origin=t!==void 0?t:new G,this.direction=e!==void 0?e:new G(0,0,-1)}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}clone(){return new this.constructor().copy(this)}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e===void 0&&(console.warn("THREE.Ray: .at() target is now required"),e=new G),e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,bs)),this}closestPointToPoint(t,e){e===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new G),e.subVectors(t,this.origin);const i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=bs.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(bs.copy(this.direction).multiplyScalar(e).add(this.origin),bs.distanceToSquared(t))}distanceSqToSegment(t,e,i,a){Rp.copy(t).add(e).multiplyScalar(.5),Yu.copy(e).sub(t).normalize(),ra.copy(this.origin).sub(Rp);const o=t.distanceTo(e)*.5,c=-this.direction.dot(Yu),u=ra.dot(this.direction),h=-ra.dot(Yu),d=ra.lengthSq(),m=Math.abs(1-c*c);let p,g,v,x;if(m>0)if(p=c*h-u,g=c*u-h,x=o*m,p>=0)if(g>=-x)if(g<=x){const M=1/m;p*=M,g*=M,v=p*(p+c*g+2*u)+g*(c*p+g+2*h)+d}else g=o,p=Math.max(0,-(c*g+u)),v=-p*p+g*(g+2*h)+d;else g=-o,p=Math.max(0,-(c*g+u)),v=-p*p+g*(g+2*h)+d;else g<=-x?(p=Math.max(0,-(-c*o+u)),g=p>0?-o:Math.min(Math.max(-o,-h),o),v=-p*p+g*(g+2*h)+d):g<=x?(p=0,g=Math.min(Math.max(-o,-h),o),v=g*(g+2*h)+d):(p=Math.max(0,-(c*o+u)),g=p>0?o:Math.min(Math.max(-o,-h),o),v=-p*p+g*(g+2*h)+d);else g=c>0?-o:o,p=Math.max(0,-(c*g+u)),v=-p*p+g*(g+2*h)+d;return i&&i.copy(this.direction).multiplyScalar(p).add(this.origin),a&&a.copy(Yu).multiplyScalar(g).add(Rp),v}intersectSphere(t,e){bs.subVectors(t.center,this.origin);const i=bs.dot(this.direction),a=bs.dot(bs)-i*i,o=t.radius*t.radius;if(a>o)return null;const c=Math.sqrt(o-a),u=i-c,h=i+c;return u<0&&h<0?null:u<0?this.at(h,e):this.at(u,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){const i=this.distanceToPlane(t);return i===null?null:this.at(i,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,a,o,c,u,h;const d=1/this.direction.x,m=1/this.direction.y,p=1/this.direction.z,g=this.origin;return d>=0?(i=(t.min.x-g.x)*d,a=(t.max.x-g.x)*d):(i=(t.max.x-g.x)*d,a=(t.min.x-g.x)*d),m>=0?(o=(t.min.y-g.y)*m,c=(t.max.y-g.y)*m):(o=(t.max.y-g.y)*m,c=(t.min.y-g.y)*m),i>c||o>a||((o>i||i!==i)&&(i=o),(c<a||a!==a)&&(a=c),p>=0?(u=(t.min.z-g.z)*p,h=(t.max.z-g.z)*p):(u=(t.max.z-g.z)*p,h=(t.min.z-g.z)*p),i>h||u>a)||((u>i||i!==i)&&(i=u),(h<a||a!==a)&&(a=h),a<0)?null:this.at(i>=0?i:a,e)}intersectsBox(t){return this.intersectBox(t,bs)!==null}intersectTriangle(t,e,i,a,o){Np.subVectors(e,t),Xu.subVectors(i,t),zp.crossVectors(Np,Xu);let c=this.direction.dot(zp),u;if(c>0){if(a)return null;u=1}else if(c<0)u=-1,c=-c;else return null;ra.subVectors(this.origin,t);const h=u*this.direction.dot(Xu.crossVectors(ra,Xu));if(h<0)return null;const d=u*this.direction.dot(Np.cross(ra));if(d<0||h+d>c)return null;const m=-u*ra.dot(zp);return m<0?null:this.at(m/c,o)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}};class re{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,i,a,o,c,u,h,d,m,p,g,v,x,M,S){const w=this.elements;return w[0]=t,w[4]=e,w[8]=i,w[12]=a,w[1]=o,w[5]=c,w[9]=u,w[13]=h,w[2]=d,w[6]=m,w[10]=p,w[14]=g,w[3]=v,w[7]=x,w[11]=M,w[15]=S,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new re().fromArray(this.elements)}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){const e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}extractBasis(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,i=t.elements,a=1/io.setFromMatrixColumn(t,0).length(),o=1/io.setFromMatrixColumn(t,1).length(),c=1/io.setFromMatrixColumn(t,2).length();return e[0]=i[0]*a,e[1]=i[1]*a,e[2]=i[2]*a,e[3]=0,e[4]=i[4]*o,e[5]=i[5]*o,e[6]=i[6]*o,e[7]=0,e[8]=i[8]*c,e[9]=i[9]*c,e[10]=i[10]*c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,i=t.x,a=t.y,o=t.z,c=Math.cos(i),u=Math.sin(i),h=Math.cos(a),d=Math.sin(a),m=Math.cos(o),p=Math.sin(o);if(t.order==="XYZ"){const g=c*m,v=c*p,x=u*m,M=u*p;e[0]=h*m,e[4]=-h*p,e[8]=d,e[1]=v+x*d,e[5]=g-M*d,e[9]=-u*h,e[2]=M-g*d,e[6]=x+v*d,e[10]=c*h}else if(t.order==="YXZ"){const g=h*m,v=h*p,x=d*m,M=d*p;e[0]=g+M*u,e[4]=x*u-v,e[8]=c*d,e[1]=c*p,e[5]=c*m,e[9]=-u,e[2]=v*u-x,e[6]=M+g*u,e[10]=c*h}else if(t.order==="ZXY"){const g=h*m,v=h*p,x=d*m,M=d*p;e[0]=g-M*u,e[4]=-c*p,e[8]=x+v*u,e[1]=v+x*u,e[5]=c*m,e[9]=M-g*u,e[2]=-c*d,e[6]=u,e[10]=c*h}else if(t.order==="ZYX"){const g=c*m,v=c*p,x=u*m,M=u*p;e[0]=h*m,e[4]=x*d-v,e[8]=g*d+M,e[1]=h*p,e[5]=M*d+g,e[9]=v*d-x,e[2]=-d,e[6]=u*h,e[10]=c*h}else if(t.order==="YZX"){const g=c*h,v=c*d,x=u*h,M=u*d;e[0]=h*m,e[4]=M-g*p,e[8]=x*p+v,e[1]=p,e[5]=c*m,e[9]=-u*m,e[2]=-d*m,e[6]=v*p+x,e[10]=g-M*p}else if(t.order==="XZY"){const g=c*h,v=c*d,x=u*h,M=u*d;e[0]=h*m,e[4]=-p,e[8]=d*m,e[1]=g*p+M,e[5]=c*m,e[9]=v*p-x,e[2]=x*p-v,e[6]=u*m,e[10]=M*p+g}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(EE,t,TE)}lookAt(t,e,i){const a=this.elements;return Zn.subVectors(t,e),Zn.lengthSq()===0&&(Zn.z=1),Zn.normalize(),oa.crossVectors(i,Zn),oa.lengthSq()===0&&(Math.abs(i.z)===1?Zn.x+=1e-4:Zn.z+=1e-4,Zn.normalize(),oa.crossVectors(i,Zn)),oa.normalize(),Zu.crossVectors(Zn,oa),a[0]=oa.x,a[4]=Zu.x,a[8]=Zn.x,a[1]=oa.y,a[5]=Zu.y,a[9]=Zn.y,a[2]=oa.z,a[6]=Zu.z,a[10]=Zn.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,a=e.elements,o=this.elements,c=i[0],u=i[4],h=i[8],d=i[12],m=i[1],p=i[5],g=i[9],v=i[13],x=i[2],M=i[6],S=i[10],w=i[14],_=i[3],L=i[7],R=i[11],C=i[15],A=a[0],B=a[4],Y=a[8],X=a[12],st=a[1],V=a[5],j=a[9],I=a[13],H=a[2],U=a[6],z=a[10],Q=a[14],$=a[3],it=a[7],ct=a[11],D=a[15];return o[0]=c*A+u*st+h*H+d*$,o[4]=c*B+u*V+h*U+d*it,o[8]=c*Y+u*j+h*z+d*ct,o[12]=c*X+u*I+h*Q+d*D,o[1]=m*A+p*st+g*H+v*$,o[5]=m*B+p*V+g*U+v*it,o[9]=m*Y+p*j+g*z+v*ct,o[13]=m*X+p*I+g*Q+v*D,o[2]=x*A+M*st+S*H+w*$,o[6]=x*B+M*V+S*U+w*it,o[10]=x*Y+M*j+S*z+w*ct,o[14]=x*X+M*I+S*Q+w*D,o[3]=_*A+L*st+R*H+C*$,o[7]=_*B+L*V+R*U+C*it,o[11]=_*Y+L*j+R*z+C*ct,o[15]=_*X+L*I+R*Q+C*D,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[4],a=t[8],o=t[12],c=t[1],u=t[5],h=t[9],d=t[13],m=t[2],p=t[6],g=t[10],v=t[14],x=t[3],M=t[7],S=t[11],w=t[15];return x*(+o*h*p-a*d*p-o*u*g+i*d*g+a*u*v-i*h*v)+M*(+e*h*v-e*d*g+o*c*g-a*c*v+a*d*m-o*h*m)+S*(+e*d*p-e*u*v-o*c*p+i*c*v+o*u*m-i*d*m)+w*(-a*u*m-e*h*p+e*u*g+a*c*p-i*c*g+i*h*m)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){const a=this.elements;return t.isVector3?(a[12]=t.x,a[13]=t.y,a[14]=t.z):(a[12]=t,a[13]=e,a[14]=i),this}invert(){const t=this.elements,e=t[0],i=t[1],a=t[2],o=t[3],c=t[4],u=t[5],h=t[6],d=t[7],m=t[8],p=t[9],g=t[10],v=t[11],x=t[12],M=t[13],S=t[14],w=t[15],_=p*S*d-M*g*d+M*h*v-u*S*v-p*h*w+u*g*w,L=x*g*d-m*S*d-x*h*v+c*S*v+m*h*w-c*g*w,R=m*M*d-x*p*d+x*u*v-c*M*v-m*u*w+c*p*w,C=x*p*h-m*M*h-x*u*g+c*M*g+m*u*S-c*p*S,A=e*_+i*L+a*R+o*C;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const B=1/A;return t[0]=_*B,t[1]=(M*g*o-p*S*o-M*a*v+i*S*v+p*a*w-i*g*w)*B,t[2]=(u*S*o-M*h*o+M*a*d-i*S*d-u*a*w+i*h*w)*B,t[3]=(p*h*o-u*g*o-p*a*d+i*g*d+u*a*v-i*h*v)*B,t[4]=L*B,t[5]=(m*S*o-x*g*o+x*a*v-e*S*v-m*a*w+e*g*w)*B,t[6]=(x*h*o-c*S*o-x*a*d+e*S*d+c*a*w-e*h*w)*B,t[7]=(c*g*o-m*h*o+m*a*d-e*g*d-c*a*v+e*h*v)*B,t[8]=R*B,t[9]=(x*p*o-m*M*o-x*i*v+e*M*v+m*i*w-e*p*w)*B,t[10]=(c*M*o-x*u*o+x*i*d-e*M*d-c*i*w+e*u*w)*B,t[11]=(m*u*o-c*p*o-m*i*d+e*p*d+c*i*v-e*u*v)*B,t[12]=C*B,t[13]=(m*M*a-x*p*a+x*i*g-e*M*g-m*i*S+e*p*S)*B,t[14]=(x*u*a-c*M*a-x*i*h+e*M*h+c*i*S-e*u*S)*B,t[15]=(c*p*a-m*u*a+m*i*h-e*p*h-c*i*g+e*u*g)*B,this}scale(t){const e=this.elements,i=t.x,a=t.y,o=t.z;return e[0]*=i,e[4]*=a,e[8]*=o,e[1]*=i,e[5]*=a,e[9]*=o,e[2]*=i,e[6]*=a,e[10]*=o,e[3]*=i,e[7]*=a,e[11]*=o,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],a=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,a))}makeTranslation(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const i=Math.cos(e),a=Math.sin(e),o=1-i,c=t.x,u=t.y,h=t.z,d=o*c,m=o*u;return this.set(d*c+i,d*u-a*h,d*h+a*u,0,d*u+a*h,m*u+i,m*h-a*c,0,d*h-a*u,m*h+a*c,o*h*h+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this}compose(t,e,i){const a=this.elements,o=e._x,c=e._y,u=e._z,h=e._w,d=o+o,m=c+c,p=u+u,g=o*d,v=o*m,x=o*p,M=c*m,S=c*p,w=u*p,_=h*d,L=h*m,R=h*p,C=i.x,A=i.y,B=i.z;return a[0]=(1-(M+w))*C,a[1]=(v+R)*C,a[2]=(x-L)*C,a[3]=0,a[4]=(v-R)*A,a[5]=(1-(g+w))*A,a[6]=(S+_)*A,a[7]=0,a[8]=(x+L)*B,a[9]=(S-_)*B,a[10]=(1-(g+M))*B,a[11]=0,a[12]=t.x,a[13]=t.y,a[14]=t.z,a[15]=1,this}decompose(t,e,i){const a=this.elements;let o=io.set(a[0],a[1],a[2]).length();const c=io.set(a[4],a[5],a[6]).length(),u=io.set(a[8],a[9],a[10]).length();this.determinant()<0&&(o=-o),t.x=a[12],t.y=a[13],t.z=a[14],Ti.copy(this);const d=1/o,m=1/c,p=1/u;return Ti.elements[0]*=d,Ti.elements[1]*=d,Ti.elements[2]*=d,Ti.elements[4]*=m,Ti.elements[5]*=m,Ti.elements[6]*=m,Ti.elements[8]*=p,Ti.elements[9]*=p,Ti.elements[10]*=p,e.setFromRotationMatrix(Ti),i.x=o,i.y=c,i.z=u,this}makePerspective(t,e,i,a,o,c){c===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const u=this.elements,h=2*o/(e-t),d=2*o/(i-a),m=(e+t)/(e-t),p=(i+a)/(i-a),g=-(c+o)/(c-o),v=-2*c*o/(c-o);return u[0]=h,u[4]=0,u[8]=m,u[12]=0,u[1]=0,u[5]=d,u[9]=p,u[13]=0,u[2]=0,u[6]=0,u[10]=g,u[14]=v,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(t,e,i,a,o,c){const u=this.elements,h=1/(e-t),d=1/(i-a),m=1/(c-o),p=(e+t)*h,g=(i+a)*d,v=(c+o)*m;return u[0]=2*h,u[4]=0,u[8]=0,u[12]=-p,u[1]=0,u[5]=2*d,u[9]=0,u[13]=-g,u[2]=0,u[6]=0,u[10]=-2*m,u[14]=-v,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(t){const e=this.elements,i=t.elements;for(let a=0;a<16;a++)if(e[a]!==i[a])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}const io=new G,Ti=new re,EE=new G(0,0,0),TE=new G(1,1,1),oa=new G,Zu=new G,Zn=new G;class Nc{constructor(t=0,e=0,i=0,a=Nc.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=t,this._y=e,this._z=i,this._order=a}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,i,a){return this._x=t,this._y=e,this._z=i,this._order=a||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e,i){const a=ne.clamp,o=t.elements,c=o[0],u=o[4],h=o[8],d=o[1],m=o[5],p=o[9],g=o[2],v=o[6],x=o[10];switch(e=e||this._order,e){case"XYZ":this._y=Math.asin(a(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-p,x),this._z=Math.atan2(-u,c)):(this._x=Math.atan2(v,m),this._z=0);break;case"YXZ":this._x=Math.asin(-a(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(h,x),this._z=Math.atan2(d,m)):(this._y=Math.atan2(-g,c),this._z=0);break;case"ZXY":this._x=Math.asin(a(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-g,x),this._z=Math.atan2(-u,m)):(this._y=0,this._z=Math.atan2(d,c));break;case"ZYX":this._y=Math.asin(-a(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(v,x),this._z=Math.atan2(d,c)):(this._x=0,this._z=Math.atan2(-u,m));break;case"YZX":this._z=Math.asin(a(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-p,m),this._y=Math.atan2(-g,c)):(this._x=0,this._y=Math.atan2(h,x));break;case"XZY":this._z=Math.asin(-a(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(v,m),this._y=Math.atan2(h,c)):(this._x=Math.atan2(-p,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,i!==!1&&this._onChangeCallback(),this}setFromQuaternion(t,e,i){return Rx.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Rx,e,i)}setFromVector3(t,e){return this.set(t.x,t.y,t.z,e||this._order)}reorder(t){return Nx.setFromEuler(this),this.setFromQuaternion(Nx,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new G(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Nc.DefaultOrder="XYZ";Nc.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const Rx=new re,Nx=new Nn;class E_{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}}let AE=0;const zx=new G,so=new Nn,_s=new re,Qu=new G,jl=new G,CE=new G,LE=new Nn,Bx=new G(1,0,0),Dx=new G(0,1,0),Ox=new G(0,0,1),RE={type:"added"},Px={type:"removed"};function Xt(){Object.defineProperty(this,"id",{value:AE++}),this.uuid=ne.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Xt.DefaultUp.clone();const n=new G,t=new Nc,e=new Nn,i=new G(1,1,1);function a(){e.setFromEuler(t,!1)}function o(){t.setFromQuaternion(e,void 0,!1)}t._onChange(a),e._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:n},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:e},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new re},normalMatrix:{value:new Hn}}),this.matrix=new re,this.matrixWorld=new re,this.matrixAutoUpdate=Xt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new E_,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Xt.DefaultUp=new G(0,1,0);Xt.DefaultMatrixAutoUpdate=!0;Xt.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Xt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(n){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(n),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(n){return this.quaternion.premultiply(n),this},setRotationFromAxisAngle:function(n,t){this.quaternion.setFromAxisAngle(n,t)},setRotationFromEuler:function(n){this.quaternion.setFromEuler(n,!0)},setRotationFromMatrix:function(n){this.quaternion.setFromRotationMatrix(n)},setRotationFromQuaternion:function(n){this.quaternion.copy(n)},rotateOnAxis:function(n,t){return so.setFromAxisAngle(n,t),this.quaternion.multiply(so),this},rotateOnWorldAxis:function(n,t){return so.setFromAxisAngle(n,t),this.quaternion.premultiply(so),this},rotateX:function(n){return this.rotateOnAxis(Bx,n)},rotateY:function(n){return this.rotateOnAxis(Dx,n)},rotateZ:function(n){return this.rotateOnAxis(Ox,n)},translateOnAxis:function(n,t){return zx.copy(n).applyQuaternion(this.quaternion),this.position.add(zx.multiplyScalar(t)),this},translateX:function(n){return this.translateOnAxis(Bx,n)},translateY:function(n){return this.translateOnAxis(Dx,n)},translateZ:function(n){return this.translateOnAxis(Ox,n)},localToWorld:function(n){return n.applyMatrix4(this.matrixWorld)},worldToLocal:function(n){return n.applyMatrix4(_s.copy(this.matrixWorld).invert())},lookAt:function(n,t,e){n.isVector3?Qu.copy(n):Qu.set(n,t,e);const i=this.parent;this.updateWorldMatrix(!0,!1),jl.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_s.lookAt(jl,Qu,this.up):_s.lookAt(Qu,jl,this.up),this.quaternion.setFromRotationMatrix(_s),i&&(_s.extractRotation(i.matrixWorld),so.setFromRotationMatrix(_s),this.quaternion.premultiply(so.invert()))},add:function(n){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return n===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",n),this):(n&&n.isObject3D?(n.parent!==null&&n.parent.remove(n),n.parent=this,this.children.push(n),n.dispatchEvent(RE)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",n),this)},remove:function(n){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(n);return t!==-1&&(n.parent=null,this.children.splice(t,1),n.dispatchEvent(Px)),this},clear:function(){for(let n=0;n<this.children.length;n++){const t=this.children[n];t.parent=null,t.dispatchEvent(Px)}return this.children.length=0,this},attach:function(n){return this.updateWorldMatrix(!0,!1),_s.copy(this.matrixWorld).invert(),n.parent!==null&&(n.parent.updateWorldMatrix(!0,!1),_s.multiply(n.parent.matrixWorld)),n.applyMatrix4(_s),n.updateWorldMatrix(!1,!1),this.add(n),this},getObjectById:function(n){return this.getObjectByProperty("id",n)},getObjectByName:function(n){return this.getObjectByProperty("name",n)},getObjectByProperty:function(n,t){if(this[n]===t)return this;for(let e=0,i=this.children.length;e<i;e++){const o=this.children[e].getObjectByProperty(n,t);if(o!==void 0)return o}},getWorldPosition:function(n){return n===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),n=new G),this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(n){return n===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),n=new Nn),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jl,n,CE),n},getWorldScale:function(n){return n===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new G),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jl,LE,n),n},getWorldDirection:function(n){n===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),n=new G),this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return n.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(n){n(this);const t=this.children;for(let e=0,i=t.length;e<i;e++)t[e].traverse(n)},traverseVisible:function(n){if(this.visible===!1)return;n(this);const t=this.children;for(let e=0,i=t.length;e<i;e++)t[e].traverseVisible(n)},traverseAncestors:function(n){const t=this.parent;t!==null&&(n(t),t.traverseAncestors(n))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(n){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||n)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,n=!0);const t=this.children;for(let e=0,i=t.length;e<i;e++)t[e].updateMatrixWorld(n)},updateWorldMatrix:function(n,t){const e=this.parent;if(n===!0&&e!==null&&e.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let a=0,o=i.length;a<o;a++)i[a].updateWorldMatrix(!1,!0)}},toJSON:function(n){const t=n===void 0||typeof n=="string",e={};t&&(n={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},e.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON());function a(c,u){return c[u.uuid]===void 0&&(c[u.uuid]=u.toJSON(n)),u.uuid}if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(n.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const u=c.shapes;if(Array.isArray(u))for(let h=0,d=u.length;h<d;h++){const m=u[h];a(n.shapes,m)}else a(n.shapes,u)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(n.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let u=0,h=this.material.length;u<h;u++)c.push(a(n.materials,this.material[u]));i.material=c}else i.material=a(n.materials,this.material);if(this.children.length>0){i.children=[];for(let c=0;c<this.children.length;c++)i.children.push(this.children[c].toJSON(n).object)}if(this.animations.length>0){i.animations=[];for(let c=0;c<this.animations.length;c++){const u=this.animations[c];i.animations.push(a(n.animations,u))}}if(t){const c=o(n.geometries),u=o(n.materials),h=o(n.textures),d=o(n.images),m=o(n.shapes),p=o(n.skeletons),g=o(n.animations);c.length>0&&(e.geometries=c),u.length>0&&(e.materials=u),h.length>0&&(e.textures=h),d.length>0&&(e.images=d),m.length>0&&(e.shapes=m),p.length>0&&(e.skeletons=p),g.length>0&&(e.animations=g)}return e.object=i,e;function o(c){const u=[];for(const h in c){const d=c[h];delete d.metadata,u.push(d)}return u}},clone:function(n){return new this.constructor().copy(this,n)},copy:function(n,t=!0){if(this.name=n.name,this.up.copy(n.up),this.position.copy(n.position),this.rotation.order=n.rotation.order,this.quaternion.copy(n.quaternion),this.scale.copy(n.scale),this.matrix.copy(n.matrix),this.matrixWorld.copy(n.matrixWorld),this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrixWorldNeedsUpdate=n.matrixWorldNeedsUpdate,this.layers.mask=n.layers.mask,this.visible=n.visible,this.castShadow=n.castShadow,this.receiveShadow=n.receiveShadow,this.frustumCulled=n.frustumCulled,this.renderOrder=n.renderOrder,this.userData=JSON.parse(JSON.stringify(n.userData)),t===!0)for(let e=0;e<n.children.length;e++){const i=n.children[e];this.add(i.clone())}return this}});const Bp=new G,NE=new G,zE=new Hn;let Ls=class{constructor(t,e){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=t!==void 0?t:new G(1,0,0),this.constant=e!==void 0?e:0}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,i,a){return this.normal.set(t,e,i),this.constant=a,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,i){const a=Bp.subVectors(i,e).cross(NE.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(a,t),this}clone(){return new this.constructor().copy(this)}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new G),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){e===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new G);const i=t.delta(Bp),a=this.normal.dot(i);if(a===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):void 0;const o=-(t.start.dot(this.normal)+this.constant)/a;if(!(o<0||o>1))return e.copy(i).multiplyScalar(o).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new G),t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const i=e||zE.getNormalMatrix(t),a=this.coplanarPoint(Bp).applyMatrix4(t),o=this.normal.applyMatrix3(i).normalize();return this.constant=-a.dot(o),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}};const Ai=new G,ws=new G,Dp=new G,Ms=new G,ao=new G,ro=new G,Ux=new G,Op=new G,Pp=new G,Up=new G;class Sn{constructor(t,e,i){this.a=t!==void 0?t:new G,this.b=e!==void 0?e:new G,this.c=i!==void 0?i:new G}static getNormal(t,e,i,a){a===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),a=new G),a.subVectors(i,e),Ai.subVectors(t,e),a.cross(Ai);const o=a.lengthSq();return o>0?a.multiplyScalar(1/Math.sqrt(o)):a.set(0,0,0)}static getBarycoord(t,e,i,a,o){Ai.subVectors(a,e),ws.subVectors(i,e),Dp.subVectors(t,e);const c=Ai.dot(Ai),u=Ai.dot(ws),h=Ai.dot(Dp),d=ws.dot(ws),m=ws.dot(Dp),p=c*d-u*u;if(o===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),o=new G),p===0)return o.set(-2,-1,-1);const g=1/p,v=(d*h-u*m)*g,x=(c*m-u*h)*g;return o.set(1-v-x,x,v)}static containsPoint(t,e,i,a){return this.getBarycoord(t,e,i,a,Ms),Ms.x>=0&&Ms.y>=0&&Ms.x+Ms.y<=1}static getUV(t,e,i,a,o,c,u,h){return this.getBarycoord(t,e,i,a,Ms),h.set(0,0),h.addScaledVector(o,Ms.x),h.addScaledVector(c,Ms.y),h.addScaledVector(u,Ms.z),h}static isFrontFacing(t,e,i,a){return Ai.subVectors(i,e),ws.subVectors(t,e),Ai.cross(ws).dot(a)<0}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}setFromPointsAndIndices(t,e,i,a){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[a]),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Ai.subVectors(this.c,this.b),ws.subVectors(this.a,this.b),Ai.cross(ws).length()*.5}getMidpoint(t){return t===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new G),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Sn.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Ls),t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Sn.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,i,a,o){return Sn.getUV(t,this.a,this.b,this.c,e,i,a,o)}containsPoint(t){return Sn.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Sn.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){e===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new G);const i=this.a,a=this.b,o=this.c;let c,u;ao.subVectors(a,i),ro.subVectors(o,i),Op.subVectors(t,i);const h=ao.dot(Op),d=ro.dot(Op);if(h<=0&&d<=0)return e.copy(i);Pp.subVectors(t,a);const m=ao.dot(Pp),p=ro.dot(Pp);if(m>=0&&p<=m)return e.copy(a);const g=h*p-m*d;if(g<=0&&h>=0&&m<=0)return c=h/(h-m),e.copy(i).addScaledVector(ao,c);Up.subVectors(t,o);const v=ao.dot(Up),x=ro.dot(Up);if(x>=0&&v<=x)return e.copy(o);const M=v*d-h*x;if(M<=0&&d>=0&&x<=0)return u=d/(d-x),e.copy(i).addScaledVector(ro,u);const S=m*x-v*p;if(S<=0&&p-m>=0&&v-x>=0)return Ux.subVectors(o,a),u=(p-m)/(p-m+(v-x)),e.copy(a).addScaledVector(Ux,u);const w=1/(S+M+g);return c=M*w,u=g*w,e.copy(i).addScaledVector(ao,c).addScaledVector(ro,u)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const T_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ci={h:0,s:0,l:0},Ju={h:0,s:0,l:0};function Ip(n,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+(t-n)*6*e:e<1/2?t:e<2/3?n+(t-n)*6*(2/3-e):n}function Fp(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Hp(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}class Wt{constructor(t,e,i){return Object.defineProperty(this,"isColor",{value:!0}),e===void 0&&i===void 0?this.set(t):this.setRGB(t,e,i)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this}setRGB(t,e,i){return this.r=t,this.g=e,this.b=i,this}setHSL(t,e,i){if(t=ne.euclideanModulo(t,1),e=ne.clamp(e,0,1),i=ne.clamp(i,0,1),e===0)this.r=this.g=this.b=i;else{const a=i<=.5?i*(1+e):i+e-i*e,o=2*i-a;this.r=Ip(o,a,t+1/3),this.g=Ip(o,a,t),this.b=Ip(o,a,t-1/3)}return this}setStyle(t){function e(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){let a;const o=i[1],c=i[2];switch(o){case"rgb":case"rgba":if(a=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,e(a[4]),this;if(a=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,e(a[4]),this;break;case"hsl":case"hsla":if(a=/^(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c)){const u=parseFloat(a[1])/360,h=parseInt(a[2],10)/100,d=parseInt(a[3],10)/100;return e(a[4]),this.setHSL(u,h,d)}break}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const a=i[1],o=a.length;if(o===3)return this.r=parseInt(a.charAt(0)+a.charAt(0),16)/255,this.g=parseInt(a.charAt(1)+a.charAt(1),16)/255,this.b=parseInt(a.charAt(2)+a.charAt(2),16)/255,this;if(o===6)return this.r=parseInt(a.charAt(0)+a.charAt(1),16)/255,this.g=parseInt(a.charAt(2)+a.charAt(3),16)/255,this.b=parseInt(a.charAt(4)+a.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=T_[t];return e!==void 0?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=Fp(t.r),this.g=Fp(t.g),this.b=Fp(t.b),this}copyLinearToSRGB(t){return this.r=Hp(t.r),this.g=Hp(t.g),this.b=Hp(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){t===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});const e=this.r,i=this.g,a=this.b,o=Math.max(e,i,a),c=Math.min(e,i,a);let u,h;const d=(c+o)/2;if(c===o)u=0,h=0;else{const m=o-c;switch(h=d<=.5?m/(o+c):m/(2-o-c),o){case e:u=(i-a)/m+(i<a?6:0);break;case i:u=(a-e)/m+2;break;case a:u=(e-i)/m+4;break}u/=6}return t.h=u,t.s=h,t.l=d,t}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(t,e,i){return this.getHSL(Ci),Ci.h+=t,Ci.s+=e,Ci.l+=i,this.setHSL(Ci.h,Ci.s,Ci.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpHSL(t,e){this.getHSL(Ci),t.getHSL(Ju);const i=ne.lerp(Ci.h,Ju.h,e),a=ne.lerp(Ci.s,Ju.s,e),o=ne.lerp(Ci.l,Ju.l,e);return this.setHSL(i,a,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Wt.NAMES=T_;Wt.prototype.r=1;Wt.prototype.g=1;Wt.prototype.b=1;class Jn{constructor(t,e,i,a,o,c=0){this.a=t,this.b=e,this.c=i,this.normal=a&&a.isVector3?a:new G,this.vertexNormals=Array.isArray(a)?a:[],this.color=o&&o.isColor?o:new Wt,this.vertexColors=Array.isArray(o)?o:[],this.materialIndex=c}clone(){return new this.constructor().copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}}let BE=0;function Jt(){Object.defineProperty(this,"id",{value:BE++}),this.uuid=ne.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=ac,this.side=Xh,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=__,this.blendDst=w_,this.blendEquation=vo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=om,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=wE,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ep,this.stencilZFail=Ep,this.stencilZPass=Ep,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Jt.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Jt,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(n){if(n!==void 0)for(const t in n){const e=n[t];if(e===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===b_;continue}const i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(e):i&&i.isVector3&&e&&e.isVector3?i.copy(e):this[t]=e}},toJSON:function(n){const t=n===void 0||typeof n=="string";t&&(n={textures:{},images:{}});const e={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.color&&this.color.isColor&&(e.color=this.color.getHex()),this.roughness!==void 0&&(e.roughness=this.roughness),this.metalness!==void 0&&(e.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(e.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(e.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(e.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(e.specular=this.specular.getHex()),this.shininess!==void 0&&(e.shininess=this.shininess),this.clearcoat!==void 0&&(e.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(e.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(e.clearcoatMap=this.clearcoatMap.toJSON(n).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(e.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(n).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(e.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(n).uuid,e.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(e.map=this.map.toJSON(n).uuid),this.matcap&&this.matcap.isTexture&&(e.matcap=this.matcap.toJSON(n).uuid),this.alphaMap&&this.alphaMap.isTexture&&(e.alphaMap=this.alphaMap.toJSON(n).uuid),this.lightMap&&this.lightMap.isTexture&&(e.lightMap=this.lightMap.toJSON(n).uuid),this.aoMap&&this.aoMap.isTexture&&(e.aoMap=this.aoMap.toJSON(n).uuid,e.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(e.bumpMap=this.bumpMap.toJSON(n).uuid,e.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(e.normalMap=this.normalMap.toJSON(n).uuid,e.normalMapType=this.normalMapType,e.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(e.displacementMap=this.displacementMap.toJSON(n).uuid,e.displacementScale=this.displacementScale,e.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(e.roughnessMap=this.roughnessMap.toJSON(n).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(e.metalnessMap=this.metalnessMap.toJSON(n).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(e.emissiveMap=this.emissiveMap.toJSON(n).uuid),this.specularMap&&this.specularMap.isTexture&&(e.specularMap=this.specularMap.toJSON(n).uuid),this.envMap&&this.envMap.isTexture&&(e.envMap=this.envMap.toJSON(n).uuid,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,this.combine!==void 0&&(e.combine=this.combine),this.envMapIntensity!==void 0&&(e.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(e.gradientMap=this.gradientMap.toJSON(n).uuid),this.size!==void 0&&(e.size=this.size),this.sizeAttenuation!==void 0&&(e.sizeAttenuation=this.sizeAttenuation),this.blending!==ac&&(e.blending=this.blending),this.flatShading===!0&&(e.flatShading=this.flatShading),this.side!==Xh&&(e.side=this.side),this.vertexColors&&(e.vertexColors=!0),this.opacity<1&&(e.opacity=this.opacity),this.transparent===!0&&(e.transparent=this.transparent),e.depthFunc=this.depthFunc,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.stencilWrite=this.stencilWrite,e.stencilWriteMask=this.stencilWriteMask,e.stencilFunc=this.stencilFunc,e.stencilRef=this.stencilRef,e.stencilFuncMask=this.stencilFuncMask,e.stencilFail=this.stencilFail,e.stencilZFail=this.stencilZFail,e.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(e.rotation=this.rotation),this.polygonOffset===!0&&(e.polygonOffset=!0),this.polygonOffsetFactor!==0&&(e.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(e.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(e.linewidth=this.linewidth),this.dashSize!==void 0&&(e.dashSize=this.dashSize),this.gapSize!==void 0&&(e.gapSize=this.gapSize),this.scale!==void 0&&(e.scale=this.scale),this.dithering===!0&&(e.dithering=!0),this.alphaTest>0&&(e.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(e.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(e.wireframe=this.wireframe),this.wireframeLinewidth>1&&(e.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(e.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(e.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(e.morphTargets=!0),this.morphNormals===!0&&(e.morphNormals=!0),this.skinning===!0&&(e.skinning=!0),this.visible===!1&&(e.visible=!1),this.toneMapped===!1&&(e.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(e.userData=this.userData);function i(a){const o=[];for(const c in a){const u=a[c];delete u.metadata,o.push(u)}return o}if(t){const a=i(n.textures),o=i(n.images);a.length>0&&(e.textures=a),o.length>0&&(e.images=o)}return e},clone:function(){return new this.constructor().copy(this)},copy:function(n){this.name=n.name,this.fog=n.fog,this.blending=n.blending,this.side=n.side,this.flatShading=n.flatShading,this.vertexColors=n.vertexColors,this.opacity=n.opacity,this.transparent=n.transparent,this.blendSrc=n.blendSrc,this.blendDst=n.blendDst,this.blendEquation=n.blendEquation,this.blendSrcAlpha=n.blendSrcAlpha,this.blendDstAlpha=n.blendDstAlpha,this.blendEquationAlpha=n.blendEquationAlpha,this.depthFunc=n.depthFunc,this.depthTest=n.depthTest,this.depthWrite=n.depthWrite,this.stencilWriteMask=n.stencilWriteMask,this.stencilFunc=n.stencilFunc,this.stencilRef=n.stencilRef,this.stencilFuncMask=n.stencilFuncMask,this.stencilFail=n.stencilFail,this.stencilZFail=n.stencilZFail,this.stencilZPass=n.stencilZPass,this.stencilWrite=n.stencilWrite;const t=n.clippingPlanes;let e=null;if(t!==null){const i=t.length;e=new Array(i);for(let a=0;a!==i;++a)e[a]=t[a].clone()}return this.clippingPlanes=e,this.clipIntersection=n.clipIntersection,this.clipShadows=n.clipShadows,this.shadowSide=n.shadowSide,this.colorWrite=n.colorWrite,this.precision=n.precision,this.polygonOffset=n.polygonOffset,this.polygonOffsetFactor=n.polygonOffsetFactor,this.polygonOffsetUnits=n.polygonOffsetUnits,this.dithering=n.dithering,this.alphaTest=n.alphaTest,this.premultipliedAlpha=n.premultipliedAlpha,this.visible=n.visible,this.toneMapped=n.toneMapped,this.userData=JSON.parse(JSON.stringify(n.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(Jt.prototype,"needsUpdate",{set:function(n){n===!0&&this.version++}});function ba(n){Jt.call(this),this.type="MeshBasicMaterial",this.color=new Wt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(n)}ba.prototype=Object.create(Jt.prototype);ba.prototype.constructor=ba;ba.prototype.isMeshBasicMaterial=!0;ba.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.color.copy(n.color),this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this};const ze=new G,Ku=new ht;function ee(n,t,e){if(Array.isArray(n))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=n,this.itemSize=t,this.count=n!==void 0?n.length/t:0,this.normalized=e===!0,this.usage=Kh,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(ee.prototype,"needsUpdate",{set:function(n){n===!0&&this.version++}});Object.assign(ee.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(n){return this.usage=n,this},copy:function(n){return this.name=n.name,this.array=new n.array.constructor(n.array),this.itemSize=n.itemSize,this.count=n.count,this.normalized=n.normalized,this.usage=n.usage,this},copyAt:function(n,t,e){n*=this.itemSize,e*=t.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[n+i]=t.array[e+i];return this},copyArray:function(n){return this.array.set(n),this},copyColorsArray:function(n){const t=this.array;let e=0;for(let i=0,a=n.length;i<a;i++){let o=n[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new Wt),t[e++]=o.r,t[e++]=o.g,t[e++]=o.b}return this},copyVector2sArray:function(n){const t=this.array;let e=0;for(let i=0,a=n.length;i<a;i++){let o=n[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new ht),t[e++]=o.x,t[e++]=o.y}return this},copyVector3sArray:function(n){const t=this.array;let e=0;for(let i=0,a=n.length;i<a;i++){let o=n[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new G),t[e++]=o.x,t[e++]=o.y,t[e++]=o.z}return this},copyVector4sArray:function(n){const t=this.array;let e=0;for(let i=0,a=n.length;i<a;i++){let o=n[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new Le),t[e++]=o.x,t[e++]=o.y,t[e++]=o.z,t[e++]=o.w}return this},applyMatrix3:function(n){if(this.itemSize===2)for(let t=0,e=this.count;t<e;t++)Ku.fromBufferAttribute(this,t),Ku.applyMatrix3(n),this.setXY(t,Ku.x,Ku.y);else if(this.itemSize===3)for(let t=0,e=this.count;t<e;t++)ze.fromBufferAttribute(this,t),ze.applyMatrix3(n),this.setXYZ(t,ze.x,ze.y,ze.z);return this},applyMatrix4:function(n){for(let t=0,e=this.count;t<e;t++)ze.x=this.getX(t),ze.y=this.getY(t),ze.z=this.getZ(t),ze.applyMatrix4(n),this.setXYZ(t,ze.x,ze.y,ze.z);return this},applyNormalMatrix:function(n){for(let t=0,e=this.count;t<e;t++)ze.x=this.getX(t),ze.y=this.getY(t),ze.z=this.getZ(t),ze.applyNormalMatrix(n),this.setXYZ(t,ze.x,ze.y,ze.z);return this},transformDirection:function(n){for(let t=0,e=this.count;t<e;t++)ze.x=this.getX(t),ze.y=this.getY(t),ze.z=this.getZ(t),ze.transformDirection(n),this.setXYZ(t,ze.x,ze.y,ze.z);return this},set:function(n,t=0){return this.array.set(n,t),this},getX:function(n){return this.array[n*this.itemSize]},setX:function(n,t){return this.array[n*this.itemSize]=t,this},getY:function(n){return this.array[n*this.itemSize+1]},setY:function(n,t){return this.array[n*this.itemSize+1]=t,this},getZ:function(n){return this.array[n*this.itemSize+2]},setZ:function(n,t){return this.array[n*this.itemSize+2]=t,this},getW:function(n){return this.array[n*this.itemSize+3]},setW:function(n,t){return this.array[n*this.itemSize+3]=t,this},setXY:function(n,t,e){return n*=this.itemSize,this.array[n+0]=t,this.array[n+1]=e,this},setXYZ:function(n,t,e,i){return n*=this.itemSize,this.array[n+0]=t,this.array[n+1]=e,this.array[n+2]=i,this},setXYZW:function(n,t,e,i,a){return n*=this.itemSize,this.array[n+0]=t,this.array[n+1]=e,this.array[n+2]=i,this.array[n+3]=a,this},onUpload:function(n){return this.onUploadCallback=n,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function um(n,t,e){ee.call(this,new Int8Array(n),t,e)}um.prototype=Object.create(ee.prototype);um.prototype.constructor=um;function hm(n,t,e){ee.call(this,new Uint8Array(n),t,e)}hm.prototype=Object.create(ee.prototype);hm.prototype.constructor=hm;function fm(n,t,e){ee.call(this,new Uint8ClampedArray(n),t,e)}fm.prototype=Object.create(ee.prototype);fm.prototype.constructor=fm;function dm(n,t,e){ee.call(this,new Int16Array(n),t,e)}dm.prototype=Object.create(ee.prototype);dm.prototype.constructor=dm;function mc(n,t,e){ee.call(this,new Uint16Array(n),t,e)}mc.prototype=Object.create(ee.prototype);mc.prototype.constructor=mc;function pm(n,t,e){ee.call(this,new Int32Array(n),t,e)}pm.prototype=Object.create(ee.prototype);pm.prototype.constructor=pm;function gc(n,t,e){ee.call(this,new Uint32Array(n),t,e)}gc.prototype=Object.create(ee.prototype);gc.prototype.constructor=gc;function Ih(n,t,e){ee.call(this,new Uint16Array(n),t,e)}Ih.prototype=Object.create(ee.prototype);Ih.prototype.constructor=Ih;Ih.prototype.isFloat16BufferAttribute=!0;function we(n,t,e){ee.call(this,new Float32Array(n),t,e)}we.prototype=Object.create(ee.prototype);we.prototype.constructor=we;function mm(n,t,e){ee.call(this,new Float64Array(n),t,e)}mm.prototype=Object.create(ee.prototype);mm.prototype.constructor=mm;class DE{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(t){const e=[];let i,a,o;const c=t.faces;for(a=0;a<c.length;a++){const u=c[a];u.materialIndex!==o&&(o=u.materialIndex,i!==void 0&&(i.count=a*3-i.start,e.push(i)),i={start:a*3,materialIndex:o})}i!==void 0&&(i.count=a*3-i.start,e.push(i)),this.groups=e}fromGeometry(t){const e=t.faces,i=t.vertices,a=t.faceVertexUvs,o=a[0]&&a[0].length>0,c=a[1]&&a[1].length>0,u=t.morphTargets,h=u.length;let d;if(h>0){d=[];for(let w=0;w<h;w++)d[w]={name:u[w].name,data:[]};this.morphTargets.position=d}const m=t.morphNormals,p=m.length;let g;if(p>0){g=[];for(let w=0;w<p;w++)g[w]={name:m[w].name,data:[]};this.morphTargets.normal=g}const v=t.skinIndices,x=t.skinWeights,M=v.length===i.length,S=x.length===i.length;i.length>0&&e.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let w=0;w<e.length;w++){const _=e[w];this.vertices.push(i[_.a],i[_.b],i[_.c]);const L=_.vertexNormals;if(L.length===3)this.normals.push(L[0],L[1],L[2]);else{const C=_.normal;this.normals.push(C,C,C)}const R=_.vertexColors;if(R.length===3)this.colors.push(R[0],R[1],R[2]);else{const C=_.color;this.colors.push(C,C,C)}if(o===!0){const C=a[0][w];C!==void 0?this.uvs.push(C[0],C[1],C[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",w),this.uvs.push(new ht,new ht,new ht))}if(c===!0){const C=a[1][w];C!==void 0?this.uvs2.push(C[0],C[1],C[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",w),this.uvs2.push(new ht,new ht,new ht))}for(let C=0;C<h;C++){const A=u[C].vertices;d[C].data.push(A[_.a],A[_.b],A[_.c])}for(let C=0;C<p;C++){const A=m[C].vertexNormals[w];g[C].data.push(A.a,A.b,A.c)}M&&this.skinIndices.push(v[_.a],v[_.b],v[_.c]),S&&this.skinWeights.push(x[_.a],x[_.b],x[_.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}}function A_(n){if(n.length===0)return-1/0;let t=n[0];for(let e=1,i=n.length;e<i;++e)n[e]>t&&(t=n[e]);return t}const OE={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function $u(n,t){return new OE[n](t)}let PE=1;const Gi=new re,Gp=new Xt,oo=new G,Qn=new Ta,ql=new Ta,fn=new G;function Re(){Object.defineProperty(this,"id",{value:PE+=2}),this.uuid=ne.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Re.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Re,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(n){return Array.isArray(n)?this.index=new(A_(n)>65535?gc:mc)(n,1):this.index=n,this},getAttribute:function(n){return this.attributes[n]},setAttribute:function(n,t){return this.attributes[n]=t,this},deleteAttribute:function(n){return delete this.attributes[n],this},hasAttribute:function(n){return this.attributes[n]!==void 0},addGroup:function(n,t,e=0){this.groups.push({start:n,count:t,materialIndex:e})},clearGroups:function(){this.groups=[]},setDrawRange:function(n,t){this.drawRange.start=n,this.drawRange.count=t},applyMatrix4:function(n){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(n),t.needsUpdate=!0);const e=this.attributes.normal;if(e!==void 0){const a=new Hn().getNormalMatrix(n);e.applyNormalMatrix(a),e.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(n),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(n){return Gi.makeRotationX(n),this.applyMatrix4(Gi),this},rotateY:function(n){return Gi.makeRotationY(n),this.applyMatrix4(Gi),this},rotateZ:function(n){return Gi.makeRotationZ(n),this.applyMatrix4(Gi),this},translate:function(n,t,e){return Gi.makeTranslation(n,t,e),this.applyMatrix4(Gi),this},scale:function(n,t,e){return Gi.makeScale(n,t,e),this.applyMatrix4(Gi),this},lookAt:function(n){return Gp.lookAt(n),Gp.updateMatrix(),this.applyMatrix4(Gp.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(oo).negate(),this.translate(oo.x,oo.y,oo.z),this},setFromObject:function(n){const t=n.geometry;if(n.isPoints||n.isLine){const e=new we(t.vertices.length*3,3),i=new we(t.colors.length*3,3);if(this.setAttribute("position",e.copyVector3sArray(t.vertices)),this.setAttribute("color",i.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){const a=new we(t.lineDistances.length,1);this.setAttribute("lineDistance",a.copyArray(t.lineDistances))}t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone())}else n.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(n){const t=[];for(let e=0,i=n.length;e<i;e++){const a=n[e];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new we(t,3)),this},updateFromObject:function(n){let t=n.geometry;if(n.isMesh){let e=t.__directGeometry;if(t.elementsNeedUpdate===!0&&(e=void 0,t.elementsNeedUpdate=!1),e===void 0)return this.fromGeometry(t);e.verticesNeedUpdate=t.verticesNeedUpdate,e.normalsNeedUpdate=t.normalsNeedUpdate,e.colorsNeedUpdate=t.colorsNeedUpdate,e.uvsNeedUpdate=t.uvsNeedUpdate,e.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=e}if(t.verticesNeedUpdate===!0){const e=this.attributes.position;e!==void 0&&(e.copyVector3sArray(t.vertices),e.needsUpdate=!0),t.verticesNeedUpdate=!1}if(t.normalsNeedUpdate===!0){const e=this.attributes.normal;e!==void 0&&(e.copyVector3sArray(t.normals),e.needsUpdate=!0),t.normalsNeedUpdate=!1}if(t.colorsNeedUpdate===!0){const e=this.attributes.color;e!==void 0&&(e.copyColorsArray(t.colors),e.needsUpdate=!0),t.colorsNeedUpdate=!1}if(t.uvsNeedUpdate){const e=this.attributes.uv;e!==void 0&&(e.copyVector2sArray(t.uvs),e.needsUpdate=!0),t.uvsNeedUpdate=!1}if(t.lineDistancesNeedUpdate){const e=this.attributes.lineDistance;e!==void 0&&(e.copyArray(t.lineDistances),e.needsUpdate=!0),t.lineDistancesNeedUpdate=!1}return t.groupsNeedUpdate&&(t.computeGroups(n.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(n){return n.__directGeometry=new DE().fromGeometry(n),this.fromDirectGeometry(n.__directGeometry)},fromDirectGeometry:function(n){const t=new Float32Array(n.vertices.length*3);if(this.setAttribute("position",new ee(t,3).copyVector3sArray(n.vertices)),n.normals.length>0){const e=new Float32Array(n.normals.length*3);this.setAttribute("normal",new ee(e,3).copyVector3sArray(n.normals))}if(n.colors.length>0){const e=new Float32Array(n.colors.length*3);this.setAttribute("color",new ee(e,3).copyColorsArray(n.colors))}if(n.uvs.length>0){const e=new Float32Array(n.uvs.length*2);this.setAttribute("uv",new ee(e,2).copyVector2sArray(n.uvs))}if(n.uvs2.length>0){const e=new Float32Array(n.uvs2.length*2);this.setAttribute("uv2",new ee(e,2).copyVector2sArray(n.uvs2))}this.groups=n.groups;for(const e in n.morphTargets){const i=[],a=n.morphTargets[e];for(let o=0,c=a.length;o<c;o++){const u=a[o],h=new we(u.data.length*3,3);h.name=u.name,i.push(h.copyVector3sArray(u.data))}this.morphAttributes[e]=i}if(n.skinIndices.length>0){const e=new we(n.skinIndices.length*4,4);this.setAttribute("skinIndex",e.copyVector4sArray(n.skinIndices))}if(n.skinWeights.length>0){const e=new we(n.skinWeights.length*4,4);this.setAttribute("skinWeight",e.copyVector4sArray(n.skinWeights))}return n.boundingSphere!==null&&(this.boundingSphere=n.boundingSphere.clone()),n.boundingBox!==null&&(this.boundingBox=n.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Ta);const n=this.attributes.position,t=this.morphAttributes.position;if(n&&n.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new G(-1/0,-1/0,-1/0),new G(1/0,1/0,1/0));return}if(n!==void 0){if(this.boundingBox.setFromBufferAttribute(n),t)for(let e=0,i=t.length;e<i;e++){const a=t[e];Qn.setFromBufferAttribute(a),this.morphTargetsRelative?(fn.addVectors(this.boundingBox.min,Qn.min),this.boundingBox.expandByPoint(fn),fn.addVectors(this.boundingBox.max,Qn.max),this.boundingBox.expandByPoint(fn)):(this.boundingBox.expandByPoint(Qn.min),this.boundingBox.expandByPoint(Qn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Di);const n=this.attributes.position,t=this.morphAttributes.position;if(n&&n.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new G,1/0);return}if(n){const e=this.boundingSphere.center;if(Qn.setFromBufferAttribute(n),t)for(let a=0,o=t.length;a<o;a++){const c=t[a];ql.setFromBufferAttribute(c),this.morphTargetsRelative?(fn.addVectors(Qn.min,ql.min),Qn.expandByPoint(fn),fn.addVectors(Qn.max,ql.max),Qn.expandByPoint(fn)):(Qn.expandByPoint(ql.min),Qn.expandByPoint(ql.max))}Qn.getCenter(e);let i=0;for(let a=0,o=n.count;a<o;a++)fn.fromBufferAttribute(n,a),i=Math.max(i,e.distanceToSquared(fn));if(t)for(let a=0,o=t.length;a<o;a++){const c=t[a],u=this.morphTargetsRelative;for(let h=0,d=c.count;h<d;h++)fn.fromBufferAttribute(c,h),u&&(oo.fromBufferAttribute(n,h),fn.add(oo)),i=Math.max(i,e.distanceToSquared(fn))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const n=this.index,t=this.getAttribute("position");if(t!==void 0){let e=this.getAttribute("normal");if(e===void 0)e=new ee(new Float32Array(t.count*3),3),this.setAttribute("normal",e);else for(let p=0,g=e.count;p<g;p++)e.setXYZ(p,0,0,0);const i=new G,a=new G,o=new G,c=new G,u=new G,h=new G,d=new G,m=new G;if(n)for(let p=0,g=n.count;p<g;p+=3){const v=n.getX(p+0),x=n.getX(p+1),M=n.getX(p+2);i.fromBufferAttribute(t,v),a.fromBufferAttribute(t,x),o.fromBufferAttribute(t,M),d.subVectors(o,a),m.subVectors(i,a),d.cross(m),c.fromBufferAttribute(e,v),u.fromBufferAttribute(e,x),h.fromBufferAttribute(e,M),c.add(d),u.add(d),h.add(d),e.setXYZ(v,c.x,c.y,c.z),e.setXYZ(x,u.x,u.y,u.z),e.setXYZ(M,h.x,h.y,h.z)}else for(let p=0,g=t.count;p<g;p+=3)i.fromBufferAttribute(t,p+0),a.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),d.subVectors(o,a),m.subVectors(i,a),d.cross(m),e.setXYZ(p+0,d.x,d.y,d.z),e.setXYZ(p+1,d.x,d.y,d.z),e.setXYZ(p+2,d.x,d.y,d.z);this.normalizeNormals(),e.needsUpdate=!0}},merge:function(n,t){if(!(n&&n.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",n);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const e=this.attributes;for(const i in e){if(n.attributes[i]===void 0)continue;const o=e[i].array,c=n.attributes[i],u=c.array,h=c.itemSize*t,d=Math.min(u.length,o.length-h);for(let m=0,p=h;m<d;m++,p++)o[p]=u[m]}return this},normalizeNormals:function(){const n=this.attributes.normal;for(let t=0,e=n.count;t<e;t++)fn.fromBufferAttribute(n,t),fn.normalize(),n.setXYZ(t,fn.x,fn.y,fn.z)},toNonIndexed:function(){function n(c,u){const h=c.array,d=c.itemSize,m=c.normalized,p=new h.constructor(u.length*d);let g=0,v=0;for(let x=0,M=u.length;x<M;x++){g=u[x]*d;for(let S=0;S<d;S++)p[v++]=h[g++]}return new ee(p,d,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const t=new Re,e=this.index.array,i=this.attributes;for(const c in i){const u=i[c],h=n(u,e);t.setAttribute(c,h)}const a=this.morphAttributes;for(const c in a){const u=[],h=a[c];for(let d=0,m=h.length;d<m;d++){const p=h[d],g=n(p,e);u.push(g)}t.morphAttributes[c]=u}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];t.addGroup(h.start,h.count,h.materialIndex)}return t},toJSON:function(){const n={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),Object.keys(this.userData).length>0&&(n.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const h in u)u[h]!==void 0&&(n[h]=u[h]);return n}n.data={attributes:{}};const t=this.index;t!==null&&(n.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const e=this.attributes;for(const u in e){const h=e[u],d=h.toJSON(n.data);h.name!==""&&(d.name=h.name),n.data.attributes[u]=d}const i={};let a=!1;for(const u in this.morphAttributes){const h=this.morphAttributes[u],d=[];for(let m=0,p=h.length;m<p;m++){const g=h[m],v=g.toJSON(n.data);g.name!==""&&(v.name=g.name),d.push(v)}d.length>0&&(i[u]=d,a=!0)}a&&(n.data.morphAttributes=i,n.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(n.data.groups=JSON.parse(JSON.stringify(o)));const c=this.boundingSphere;return c!==null&&(n.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),n},clone:function(){return new Re().copy(this)},copy:function(n){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=n.name;const e=n.index;e!==null&&this.setIndex(e.clone(t));const i=n.attributes;for(const h in i){const d=i[h];this.setAttribute(h,d.clone(t))}const a=n.morphAttributes;for(const h in a){const d=[],m=a[h];for(let p=0,g=m.length;p<g;p++)d.push(m[p].clone(t));this.morphAttributes[h]=d}this.morphTargetsRelative=n.morphTargetsRelative;const o=n.groups;for(let h=0,d=o.length;h<d;h++){const m=o[h];this.addGroup(m.start,m.count,m.materialIndex)}const c=n.boundingBox;c!==null&&(this.boundingBox=c.clone());const u=n.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=n.drawRange.start,this.drawRange.count=n.drawRange.count,this.userData=n.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Ix=new re,Ka=new Rc,Vp=new Di,la=new G,ca=new G,ua=new G,kp=new G,Wp=new G,jp=new G,th=new G,eh=new G,nh=new G,wo=new ht,Mo=new ht,So=new ht,lc=new G,ih=new G;function Ze(n=new Re,t=new ba){Xt.call(this),this.type="Mesh",this.geometry=n,this.material=t,this.updateMorphTargets()}Ze.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Ze,isMesh:!0,copy:function(n){return Xt.prototype.copy.call(this,n),n.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=n.morphTargetInfluences.slice()),n.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},n.morphTargetDictionary)),this.material=n.material,this.geometry=n.geometry,this},updateMorphTargets:function(){const n=this.geometry;if(n.isBufferGeometry){const t=n.morphAttributes,e=Object.keys(t);if(e.length>0){const i=t[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,o=i.length;a<o;a++){const c=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=a}}}}else{const t=n.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(n,t){const e=this.geometry,i=this.material,a=this.matrixWorld;if(i===void 0||(e.boundingSphere===null&&e.computeBoundingSphere(),Vp.copy(e.boundingSphere),Vp.applyMatrix4(a),n.ray.intersectsSphere(Vp)===!1)||(Ix.copy(a).invert(),Ka.copy(n.ray).applyMatrix4(Ix),e.boundingBox!==null&&Ka.intersectsBox(e.boundingBox)===!1))return;let o;if(e.isBufferGeometry){const c=e.index,u=e.attributes.position,h=e.morphAttributes.position,d=e.morphTargetsRelative,m=e.attributes.uv,p=e.attributes.uv2,g=e.groups,v=e.drawRange;if(c!==null)if(Array.isArray(i))for(let x=0,M=g.length;x<M;x++){const S=g[x],w=i[S.materialIndex],_=Math.max(S.start,v.start),L=Math.min(S.start+S.count,v.start+v.count);for(let R=_,C=L;R<C;R+=3){const A=c.getX(R),B=c.getX(R+1),Y=c.getX(R+2);o=sh(this,w,n,Ka,u,h,d,m,p,A,B,Y),o&&(o.faceIndex=Math.floor(R/3),o.face.materialIndex=S.materialIndex,t.push(o))}}else{const x=Math.max(0,v.start),M=Math.min(c.count,v.start+v.count);for(let S=x,w=M;S<w;S+=3){const _=c.getX(S),L=c.getX(S+1),R=c.getX(S+2);o=sh(this,i,n,Ka,u,h,d,m,p,_,L,R),o&&(o.faceIndex=Math.floor(S/3),t.push(o))}}else if(u!==void 0)if(Array.isArray(i))for(let x=0,M=g.length;x<M;x++){const S=g[x],w=i[S.materialIndex],_=Math.max(S.start,v.start),L=Math.min(S.start+S.count,v.start+v.count);for(let R=_,C=L;R<C;R+=3){const A=R,B=R+1,Y=R+2;o=sh(this,w,n,Ka,u,h,d,m,p,A,B,Y),o&&(o.faceIndex=Math.floor(R/3),o.face.materialIndex=S.materialIndex,t.push(o))}}else{const x=Math.max(0,v.start),M=Math.min(u.count,v.start+v.count);for(let S=x,w=M;S<w;S+=3){const _=S,L=S+1,R=S+2;o=sh(this,i,n,Ka,u,h,d,m,p,_,L,R),o&&(o.faceIndex=Math.floor(S/3),t.push(o))}}}else if(e.isGeometry){const c=Array.isArray(i),u=e.vertices,h=e.faces;let d;const m=e.faceVertexUvs[0];m.length>0&&(d=m);for(let p=0,g=h.length;p<g;p++){const v=h[p],x=c?i[v.materialIndex]:i;if(x===void 0)continue;const M=u[v.a],S=u[v.b],w=u[v.c];if(o=C_(this,x,n,Ka,M,S,w,lc),o){if(d&&d[p]){const _=d[p];wo.copy(_[0]),Mo.copy(_[1]),So.copy(_[2]),o.uv=Sn.getUV(lc,M,S,w,wo,Mo,So,new ht)}o.face=v,o.faceIndex=p,t.push(o)}}}}});function C_(n,t,e,i,a,o,c,u){let h;if(t.side===_n?h=i.intersectTriangle(c,o,a,!0,u):h=i.intersectTriangle(a,o,c,t.side!==zo,u),h===null)return null;ih.copy(u),ih.applyMatrix4(n.matrixWorld);const d=e.ray.origin.distanceTo(ih);return d<e.near||d>e.far?null:{distance:d,point:ih.clone(),object:n}}function sh(n,t,e,i,a,o,c,u,h,d,m,p){la.fromBufferAttribute(a,d),ca.fromBufferAttribute(a,m),ua.fromBufferAttribute(a,p);const g=n.morphTargetInfluences;if(t.morphTargets&&o&&g){th.set(0,0,0),eh.set(0,0,0),nh.set(0,0,0);for(let x=0,M=o.length;x<M;x++){const S=g[x],w=o[x];S!==0&&(kp.fromBufferAttribute(w,d),Wp.fromBufferAttribute(w,m),jp.fromBufferAttribute(w,p),c?(th.addScaledVector(kp,S),eh.addScaledVector(Wp,S),nh.addScaledVector(jp,S)):(th.addScaledVector(kp.sub(la),S),eh.addScaledVector(Wp.sub(ca),S),nh.addScaledVector(jp.sub(ua),S)))}la.add(th),ca.add(eh),ua.add(nh)}n.isSkinnedMesh&&(n.boneTransform(d,la),n.boneTransform(m,ca),n.boneTransform(p,ua));const v=C_(n,t,e,i,la,ca,ua,lc);if(v){u&&(wo.fromBufferAttribute(u,d),Mo.fromBufferAttribute(u,m),So.fromBufferAttribute(u,p),v.uv=Sn.getUV(lc,la,ca,ua,wo,Mo,So,new ht)),h&&(wo.fromBufferAttribute(h,d),Mo.fromBufferAttribute(h,m),So.fromBufferAttribute(h,p),v.uv2=Sn.getUV(lc,la,ca,ua,wo,Mo,So,new ht));const x=new Jn(d,m,p);Sn.getNormal(la,ca,ua,x.normal),v.face=x}return v}class tg extends Re{constructor(t=1,e=1,i=1,a=1,o=1,c=1){super(),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:a,heightSegments:o,depthSegments:c};const u=this;a=Math.floor(a),o=Math.floor(o),c=Math.floor(c);const h=[],d=[],m=[],p=[];let g=0,v=0;x("z","y","x",-1,-1,i,e,t,c,o,0),x("z","y","x",1,-1,i,e,-t,c,o,1),x("x","z","y",1,1,t,i,e,a,c,2),x("x","z","y",1,-1,t,i,-e,a,c,3),x("x","y","z",1,-1,t,e,i,a,o,4),x("x","y","z",-1,-1,t,e,-i,a,o,5),this.setIndex(h),this.setAttribute("position",new we(d,3)),this.setAttribute("normal",new we(m,3)),this.setAttribute("uv",new we(p,2));function x(M,S,w,_,L,R,C,A,B,Y,X){const st=R/B,V=C/Y,j=R/2,I=C/2,H=A/2,U=B+1,z=Y+1;let Q=0,$=0;const it=new G;for(let ct=0;ct<z;ct++){const D=ct*V-I;for(let q=0;q<U;q++){const ut=q*st-j;it[M]=ut*_,it[S]=D*L,it[w]=H,d.push(it.x,it.y,it.z),it[M]=0,it[S]=0,it[w]=A>0?1:-1,m.push(it.x,it.y,it.z),p.push(q/B),p.push(1-ct/Y),Q+=1}}for(let ct=0;ct<Y;ct++)for(let D=0;D<B;D++){const q=g+D+U*ct,ut=g+D+U*(ct+1),yt=g+(D+1)+U*(ct+1),tt=g+(D+1)+U*ct;h.push(q,ut,tt),h.push(ut,yt,tt),$+=6}u.addGroup(v,$,X),v+=$,g+=Q}}}function Bo(n){const t={};for(const e in n){t[e]={};for(const i in n[e]){const a=n[e][i];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture)?t[e][i]=a.clone():Array.isArray(a)?t[e][i]=a.slice():t[e][i]=a}}return t}function Mn(n){const t={};for(let e=0;e<n.length;e++){const i=Bo(n[e]);for(const a in i)t[a]=i[a]}return t}const UE={clone:Bo,merge:Mn};var IE=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,FE=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function Gn(n){Jt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=IE,this.fragmentShader=FE,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,n!==void 0&&(n.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(n))}Gn.prototype=Object.create(Jt.prototype);Gn.prototype.constructor=Gn;Gn.prototype.isShaderMaterial=!0;Gn.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.fragmentShader=n.fragmentShader,this.vertexShader=n.vertexShader,this.uniforms=Bo(n.uniforms),this.defines=Object.assign({},n.defines),this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.lights=n.lights,this.clipping=n.clipping,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.morphNormals=n.morphNormals,this.extensions=Object.assign({},n.extensions),this.glslVersion=n.glslVersion,this};Gn.prototype.toJSON=function(n){const t=Jt.prototype.toJSON.call(this,n);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(n).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const e={};for(const i in this.extensions)this.extensions[i]===!0&&(e[i]=!0);return Object.keys(e).length>0&&(t.extensions=e),t};function _a(){Xt.call(this),this.type="Camera",this.matrixWorldInverse=new re,this.projectionMatrix=new re,this.projectionMatrixInverse=new re}_a.prototype=Object.assign(Object.create(Xt.prototype),{constructor:_a,isCamera:!0,copy:function(n,t){return Xt.prototype.copy.call(this,n,t),this.matrixWorldInverse.copy(n.matrixWorldInverse),this.projectionMatrix.copy(n.projectionMatrix),this.projectionMatrixInverse.copy(n.projectionMatrixInverse),this},getWorldDirection:function(n){n===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),n=new G),this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return n.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(n){Xt.prototype.updateMatrixWorld.call(this,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(n,t){Xt.prototype.updateWorldMatrix.call(this,n,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return new this.constructor().copy(this)}});function on(n=50,t=1,e=.1,i=2e3){_a.call(this),this.type="PerspectiveCamera",this.fov=n,this.zoom=1,this.near=e,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}on.prototype=Object.assign(Object.create(_a.prototype),{constructor:on,isPerspectiveCamera:!0,copy:function(n,t){return _a.prototype.copy.call(this,n,t),this.fov=n.fov,this.zoom=n.zoom,this.near=n.near,this.far=n.far,this.focus=n.focus,this.aspect=n.aspect,this.view=n.view===null?null:Object.assign({},n.view),this.filmGauge=n.filmGauge,this.filmOffset=n.filmOffset,this},setFocalLength:function(n){const t=.5*this.getFilmHeight()/n;this.fov=ne.RAD2DEG*2*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){const n=Math.tan(ne.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/n},getEffectiveFOV:function(){return ne.RAD2DEG*2*Math.atan(Math.tan(ne.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(n,t,e,i,a,o){this.aspect=n/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=t,this.view.offsetX=e,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const n=this.near;let t=n*Math.tan(ne.DEG2RAD*.5*this.fov)/this.zoom,e=2*t,i=this.aspect*e,a=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const u=o.fullWidth,h=o.fullHeight;a+=o.offsetX*i/u,t-=o.offsetY*e/h,i*=o.width/u,e*=o.height/h}const c=this.filmOffset;c!==0&&(a+=n*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,t,t-e,n,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(n){const t=Xt.prototype.toJSON.call(this,n);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});const lo=90,co=1;function Do(n,t,e){if(Xt.call(this),this.type="CubeCamera",e.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=e;const i=new on(lo,co,n,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new G(1,0,0)),this.add(i);const a=new on(lo,co,n,t);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new G(-1,0,0)),this.add(a);const o=new on(lo,co,n,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new G(0,1,0)),this.add(o);const c=new on(lo,co,n,t);c.layers=this.layers,c.up.set(0,0,-1),c.lookAt(new G(0,-1,0)),this.add(c);const u=new on(lo,co,n,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new G(0,0,1)),this.add(u);const h=new on(lo,co,n,t);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new G(0,0,-1)),this.add(h),this.update=function(d,m){this.parent===null&&this.updateMatrixWorld();const p=d.xr.enabled,g=d.getRenderTarget();d.xr.enabled=!1;const v=e.texture.generateMipmaps;e.texture.generateMipmaps=!1,d.setRenderTarget(e,0),d.render(m,i),d.setRenderTarget(e,1),d.render(m,a),d.setRenderTarget(e,2),d.render(m,o),d.setRenderTarget(e,3),d.render(m,c),d.setRenderTarget(e,4),d.render(m,u),e.texture.generateMipmaps=v,d.setRenderTarget(e,5),d.render(m,h),d.setRenderTarget(g),d.xr.enabled=p}}Do.prototype=Object.create(Xt.prototype);Do.prototype.constructor=Do;function wa(n,t,e,i,a,o,c,u,h,d){n=n!==void 0?n:[],t=t!==void 0?t:Xm,c=c!==void 0?c:sr,De.call(this,n,t,e,i,a,o,c,u,h,d),this.flipY=!1,this._needsFlipEnvMap=!0}wa.prototype=Object.create(De.prototype);wa.prototype.constructor=wa;wa.prototype.isCubeTexture=!0;Object.defineProperty(wa.prototype,"images",{get:function(){return this.image},set:function(n){this.image=n}});function rr(n,t,e){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=e),Bi.call(this,n,n,t),t=t||{},this.texture=new wa(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture._needsFlipEnvMap=!1}rr.prototype=Object.create(Bi.prototype);rr.prototype.constructor=rr;rr.prototype.isWebGLCubeRenderTarget=!0;rr.prototype.fromEquirectangularTexture=function(n,t){this.texture.type=t.type,this.texture.format=zi,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const e={uniforms:{tEquirect:{value:null}},vertexShader:`

			varying vec3 vWorldDirection;

			vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

				return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

			}

			void main() {

				vWorldDirection = transformDirection( position, modelMatrix );

				#include <begin_vertex>
				#include <project_vertex>

			}
		`,fragmentShader:`

			uniform sampler2D tEquirect;

			varying vec3 vWorldDirection;

			#include <common>

			void main() {

				vec3 direction = normalize( vWorldDirection );

				vec2 sampleUV = equirectUv( direction );

				gl_FragColor = texture2D( tEquirect, sampleUV );

			}
		`},i=new tg(5,5,5),a=new Gn({name:"CubemapFromEquirect",uniforms:Bo(e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:_n,blending:sc});a.uniforms.tEquirect.value=t;const o=new Ze(i,a),c=t.minFilter;return t.minFilter===Qh&&(t.minFilter=En),new Do(1,10,this).update(n,o),t.minFilter=c,o.geometry.dispose(),o.material.dispose(),this};rr.prototype.clear=function(n,t,e,i){const a=n.getRenderTarget();for(let o=0;o<6;o++)n.setRenderTarget(this,o),n.clear(t,e,i);n.setRenderTarget(a)};function Oo(n,t,e,i,a,o,c,u,h,d,m,p){De.call(this,null,o,c,u,h,d,i,a,m,p),this.image={data:n||null,width:t||1,height:e||1},this.magFilter=h!==void 0?h:Rn,this.minFilter=d!==void 0?d:Rn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Oo.prototype=Object.create(De.prototype);Oo.prototype.constructor=Oo;Oo.prototype.isDataTexture=!0;const uo=new Di,ah=new G;class $h{constructor(t,e,i,a,o,c){this.planes=[t!==void 0?t:new Ls,e!==void 0?e:new Ls,i!==void 0?i:new Ls,a!==void 0?a:new Ls,o!==void 0?o:new Ls,c!==void 0?c:new Ls]}set(t,e,i,a,o,c){const u=this.planes;return u[0].copy(t),u[1].copy(e),u[2].copy(i),u[3].copy(a),u[4].copy(o),u[5].copy(c),this}clone(){return new this.constructor().copy(this)}copy(t){const e=this.planes;for(let i=0;i<6;i++)e[i].copy(t.planes[i]);return this}setFromProjectionMatrix(t){const e=this.planes,i=t.elements,a=i[0],o=i[1],c=i[2],u=i[3],h=i[4],d=i[5],m=i[6],p=i[7],g=i[8],v=i[9],x=i[10],M=i[11],S=i[12],w=i[13],_=i[14],L=i[15];return e[0].setComponents(u-a,p-h,M-g,L-S).normalize(),e[1].setComponents(u+a,p+h,M+g,L+S).normalize(),e[2].setComponents(u+o,p+d,M+v,L+w).normalize(),e[3].setComponents(u-o,p-d,M-v,L-w).normalize(),e[4].setComponents(u-c,p-m,M-x,L-_).normalize(),e[5].setComponents(u+c,p+m,M+x,L+_).normalize(),this}intersectsObject(t){const e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),uo.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(uo)}intersectsSprite(t){return uo.center.set(0,0,0),uo.radius=.7071067811865476,uo.applyMatrix4(t.matrixWorld),this.intersectsSphere(uo)}intersectsSphere(t){const e=this.planes,i=t.center,a=-t.radius;for(let o=0;o<6;o++)if(e[o].distanceToPoint(i)<a)return!1;return!0}intersectsBox(t){const e=this.planes;for(let i=0;i<6;i++){const a=e[i];if(ah.x=a.normal.x>0?t.max.x:t.min.x,ah.y=a.normal.y>0?t.max.y:t.min.y,ah.z=a.normal.z>0?t.max.z:t.min.z,a.distanceToPoint(ah)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}}function L_(){let n=null,t=!1,e=null,i=null;function a(o,c){e(o,c),i=n.requestAnimationFrame(a)}return{start:function(){t!==!0&&e!==null&&(i=n.requestAnimationFrame(a),t=!0)},stop:function(){n.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(o){e=o},setContext:function(o){n=o}}}function HE(n,t){const e=t.isWebGL2,i=new WeakMap;function a(d,m){const p=d.array,g=d.usage,v=n.createBuffer();n.bindBuffer(m,v),n.bufferData(m,p,g),d.onUploadCallback();let x=5126;return p instanceof Float32Array?x=5126:p instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):p instanceof Uint16Array?d.isFloat16BufferAttribute?e?x=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):x=5123:p instanceof Int16Array?x=5122:p instanceof Uint32Array?x=5125:p instanceof Int32Array?x=5124:p instanceof Int8Array?x=5120:p instanceof Uint8Array&&(x=5121),{buffer:v,type:x,bytesPerElement:p.BYTES_PER_ELEMENT,version:d.version}}function o(d,m,p){const g=m.array,v=m.updateRange;n.bindBuffer(p,d),v.count===-1?n.bufferSubData(p,0,g):(e?n.bufferSubData(p,v.offset*g.BYTES_PER_ELEMENT,g,v.offset,v.count):n.bufferSubData(p,v.offset*g.BYTES_PER_ELEMENT,g.subarray(v.offset,v.offset+v.count)),v.count=-1)}function c(d){return d.isInterleavedBufferAttribute&&(d=d.data),i.get(d)}function u(d){d.isInterleavedBufferAttribute&&(d=d.data);const m=i.get(d);m&&(n.deleteBuffer(m.buffer),i.delete(d))}function h(d,m){if(d.isGLBufferAttribute){const g=i.get(d);(!g||g.version<d.version)&&i.set(d,{buffer:d.buffer,type:d.type,bytesPerElement:d.elementSize,version:d.version});return}d.isInterleavedBufferAttribute&&(d=d.data);const p=i.get(d);p===void 0?i.set(d,a(d,m)):p.version<d.version&&(o(p.buffer,d,m),p.version=d.version)}return{get:c,remove:u,update:h}}class R_ extends Re{constructor(t=1,e=1,i=1,a=1){super(),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:a};const o=t/2,c=e/2,u=Math.floor(i),h=Math.floor(a),d=u+1,m=h+1,p=t/u,g=e/h,v=[],x=[],M=[],S=[];for(let w=0;w<m;w++){const _=w*g-c;for(let L=0;L<d;L++){const R=L*p-o;x.push(R,-_,0),M.push(0,0,1),S.push(L/u),S.push(1-w/h)}}for(let w=0;w<h;w++)for(let _=0;_<u;_++){const L=_+d*w,R=_+d*(w+1),C=_+1+d*(w+1),A=_+1+d*w;v.push(L,R,A),v.push(R,C,A)}this.setIndex(v),this.setAttribute("position",new we(x,3)),this.setAttribute("normal",new we(M,3)),this.setAttribute("uv",new we(S,2))}}var GE=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,VE=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,kE=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,WE=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,jE=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,qE="vec3 transformed = vec3( position );",YE=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,XE=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,ZE=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,QE=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,JE=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,KE=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,$E=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,tT=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,eT=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,nT=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,iT=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,sT=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,aT=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,rT=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,oT=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,lT=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,cT=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,uT=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,hT="gl_FragColor = linearToOutputTexel( gl_FragColor );",fT=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,dT=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,pT=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,mT=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,gT=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,yT=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,vT=`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,xT=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,bT=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,_T=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,wT=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,MT=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,ST=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,ET=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,TT=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,AT=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,CT=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,LT=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,RT=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,NT=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,zT=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,BT=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,DT=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,OT=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,PT=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,UT=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,IT=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,FT=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,HT=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,GT=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,VT=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,kT=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,WT=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,jT=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,qT=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,YT=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,XT=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,ZT=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,QT=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,JT=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,KT=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,$T=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,tA=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,eA=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,nA=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,iA=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,sA=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,aA=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,rA=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,oA=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,lA=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,cA=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,uA=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,hA=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,fA=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,dA=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,pA=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,mA=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,gA=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,yA=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,vA=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,xA=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,bA=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,_A=`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,wA=`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,MA=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,SA=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,EA=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,TA=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,AA=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,CA=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,LA=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,RA=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,NA=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,zA=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,BA=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,DA=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,OA=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,PA=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,UA=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,IA=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,FA=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,HA=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,GA=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,VA=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kA=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,WA=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,jA=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qA=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,YA=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,XA=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ZA=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,QA=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,JA=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,KA=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$A=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,t2=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,e2=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,n2=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,i2=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,s2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,a2=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,r2=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,o2=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`;const he={alphamap_fragment:GE,alphamap_pars_fragment:VE,alphatest_fragment:kE,aomap_fragment:WE,aomap_pars_fragment:jE,begin_vertex:qE,beginnormal_vertex:YE,bsdfs:XE,bumpmap_pars_fragment:ZE,clipping_planes_fragment:QE,clipping_planes_pars_fragment:JE,clipping_planes_pars_vertex:KE,clipping_planes_vertex:$E,color_fragment:tT,color_pars_fragment:eT,color_pars_vertex:nT,color_vertex:iT,common:sT,cube_uv_reflection_fragment:aT,defaultnormal_vertex:rT,displacementmap_pars_vertex:oT,displacementmap_vertex:lT,emissivemap_fragment:cT,emissivemap_pars_fragment:uT,encodings_fragment:hT,encodings_pars_fragment:fT,envmap_fragment:dT,envmap_common_pars_fragment:pT,envmap_pars_fragment:mT,envmap_pars_vertex:gT,envmap_physical_pars_fragment:AT,envmap_vertex:yT,fog_vertex:vT,fog_pars_vertex:xT,fog_fragment:bT,fog_pars_fragment:_T,gradientmap_pars_fragment:wT,lightmap_fragment:MT,lightmap_pars_fragment:ST,lights_lambert_vertex:ET,lights_pars_begin:TT,lights_toon_fragment:CT,lights_toon_pars_fragment:LT,lights_phong_fragment:RT,lights_phong_pars_fragment:NT,lights_physical_fragment:zT,lights_physical_pars_fragment:BT,lights_fragment_begin:DT,lights_fragment_maps:OT,lights_fragment_end:PT,logdepthbuf_fragment:UT,logdepthbuf_pars_fragment:IT,logdepthbuf_pars_vertex:FT,logdepthbuf_vertex:HT,map_fragment:GT,map_pars_fragment:VT,map_particle_fragment:kT,map_particle_pars_fragment:WT,metalnessmap_fragment:jT,metalnessmap_pars_fragment:qT,morphnormal_vertex:YT,morphtarget_pars_vertex:XT,morphtarget_vertex:ZT,normal_fragment_begin:QT,normal_fragment_maps:JT,normalmap_pars_fragment:KT,clearcoat_normal_fragment_begin:$T,clearcoat_normal_fragment_maps:tA,clearcoat_pars_fragment:eA,packing:nA,premultiplied_alpha_fragment:iA,project_vertex:sA,dithering_fragment:aA,dithering_pars_fragment:rA,roughnessmap_fragment:oA,roughnessmap_pars_fragment:lA,shadowmap_pars_fragment:cA,shadowmap_pars_vertex:uA,shadowmap_vertex:hA,shadowmask_pars_fragment:fA,skinbase_vertex:dA,skinning_pars_vertex:pA,skinning_vertex:mA,skinnormal_vertex:gA,specularmap_fragment:yA,specularmap_pars_fragment:vA,tonemapping_fragment:xA,tonemapping_pars_fragment:bA,transmissionmap_fragment:_A,transmissionmap_pars_fragment:wA,uv_pars_fragment:MA,uv_pars_vertex:SA,uv_vertex:EA,uv2_pars_fragment:TA,uv2_pars_vertex:AA,uv2_vertex:CA,worldpos_vertex:LA,background_frag:RA,background_vert:NA,cube_frag:zA,cube_vert:BA,depth_frag:DA,depth_vert:OA,distanceRGBA_frag:PA,distanceRGBA_vert:UA,equirect_frag:IA,equirect_vert:FA,linedashed_frag:HA,linedashed_vert:GA,meshbasic_frag:VA,meshbasic_vert:kA,meshlambert_frag:WA,meshlambert_vert:jA,meshmatcap_frag:qA,meshmatcap_vert:YA,meshtoon_frag:XA,meshtoon_vert:ZA,meshphong_frag:QA,meshphong_vert:JA,meshphysical_frag:KA,meshphysical_vert:$A,normal_frag:t2,normal_vert:e2,points_frag:n2,points_vert:i2,shadow_frag:s2,shadow_vert:a2,sprite_frag:r2,sprite_vert:o2},Bt={common:{diffuse:{value:new Wt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Hn},uv2Transform:{value:new Hn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ht(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Wt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Wt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Hn}},sprite:{diffuse:{value:new Wt(15658734)},opacity:{value:1},center:{value:new ht(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Hn}}},Yi={basic:{uniforms:Mn([Bt.common,Bt.specularmap,Bt.envmap,Bt.aomap,Bt.lightmap,Bt.fog]),vertexShader:he.meshbasic_vert,fragmentShader:he.meshbasic_frag},lambert:{uniforms:Mn([Bt.common,Bt.specularmap,Bt.envmap,Bt.aomap,Bt.lightmap,Bt.emissivemap,Bt.fog,Bt.lights,{emissive:{value:new Wt(0)}}]),vertexShader:he.meshlambert_vert,fragmentShader:he.meshlambert_frag},phong:{uniforms:Mn([Bt.common,Bt.specularmap,Bt.envmap,Bt.aomap,Bt.lightmap,Bt.emissivemap,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,Bt.fog,Bt.lights,{emissive:{value:new Wt(0)},specular:{value:new Wt(1118481)},shininess:{value:30}}]),vertexShader:he.meshphong_vert,fragmentShader:he.meshphong_frag},standard:{uniforms:Mn([Bt.common,Bt.envmap,Bt.aomap,Bt.lightmap,Bt.emissivemap,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,Bt.roughnessmap,Bt.metalnessmap,Bt.fog,Bt.lights,{emissive:{value:new Wt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:he.meshphysical_vert,fragmentShader:he.meshphysical_frag},toon:{uniforms:Mn([Bt.common,Bt.aomap,Bt.lightmap,Bt.emissivemap,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,Bt.gradientmap,Bt.fog,Bt.lights,{emissive:{value:new Wt(0)}}]),vertexShader:he.meshtoon_vert,fragmentShader:he.meshtoon_frag},matcap:{uniforms:Mn([Bt.common,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,Bt.fog,{matcap:{value:null}}]),vertexShader:he.meshmatcap_vert,fragmentShader:he.meshmatcap_frag},points:{uniforms:Mn([Bt.points,Bt.fog]),vertexShader:he.points_vert,fragmentShader:he.points_frag},dashed:{uniforms:Mn([Bt.common,Bt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:he.linedashed_vert,fragmentShader:he.linedashed_frag},depth:{uniforms:Mn([Bt.common,Bt.displacementmap]),vertexShader:he.depth_vert,fragmentShader:he.depth_frag},normal:{uniforms:Mn([Bt.common,Bt.bumpmap,Bt.normalmap,Bt.displacementmap,{opacity:{value:1}}]),vertexShader:he.normal_vert,fragmentShader:he.normal_frag},sprite:{uniforms:Mn([Bt.sprite,Bt.fog]),vertexShader:he.sprite_vert,fragmentShader:he.sprite_frag},background:{uniforms:{uvTransform:{value:new Hn},t2D:{value:null}},vertexShader:he.background_vert,fragmentShader:he.background_frag},cube:{uniforms:Mn([Bt.envmap,{opacity:{value:1}}]),vertexShader:he.cube_vert,fragmentShader:he.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:he.equirect_vert,fragmentShader:he.equirect_frag},distanceRGBA:{uniforms:Mn([Bt.common,Bt.displacementmap,{referencePosition:{value:new G},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:he.distanceRGBA_vert,fragmentShader:he.distanceRGBA_frag},shadow:{uniforms:Mn([Bt.lights,Bt.fog,{color:{value:new Wt(0)},opacity:{value:1}}]),vertexShader:he.shadow_vert,fragmentShader:he.shadow_frag}};Yi.physical={uniforms:Mn([Yi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ht(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Wt(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:he.meshphysical_vert,fragmentShader:he.meshphysical_frag};function l2(n,t,e,i,a){const o=new Wt(0);let c=0,u,h,d=null,m=0,p=null;function g(x,M,S,w){let _=M.isScene===!0?M.background:null;_&&_.isTexture&&(_=t.get(_));const L=n.xr,R=L.getSession&&L.getSession();R&&R.environmentBlendMode==="additive"&&(_=null),_===null?v(o,c):_&&_.isColor&&(v(_,1),w=!0),(n.autoClear||w)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),_&&(_.isCubeTexture||_.isWebGLCubeRenderTarget||_.mapping===Qm)?(h===void 0&&(h=new Ze(new tg(1,1,1),new Gn({name:"BackgroundCubeMaterial",uniforms:Bo(Yi.cube.uniforms),vertexShader:Yi.cube.vertexShader,fragmentShader:Yi.cube.fragmentShader,side:_n,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(C,A,B){this.matrixWorld.copyPosition(B.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(h)),_.isWebGLCubeRenderTarget&&(_=_.texture),h.material.uniforms.envMap.value=_,h.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_._needsFlipEnvMap?-1:1,(d!==_||m!==_.version||p!==n.toneMapping)&&(h.material.needsUpdate=!0,d=_,m=_.version,p=n.toneMapping),x.unshift(h,h.geometry,h.material,0,0,null)):_&&_.isTexture&&(u===void 0&&(u=new Ze(new R_(2,2),new Gn({name:"BackgroundMaterial",uniforms:Bo(Yi.background.uniforms),vertexShader:Yi.background.vertexShader,fragmentShader:Yi.background.fragmentShader,side:Xh,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=_,_.matrixAutoUpdate===!0&&_.updateMatrix(),u.material.uniforms.uvTransform.value.copy(_.matrix),(d!==_||m!==_.version||p!==n.toneMapping)&&(u.material.needsUpdate=!0,d=_,m=_.version,p=n.toneMapping),x.unshift(u,u.geometry,u.material,0,0,null))}function v(x,M){e.buffers.color.setClear(x.r,x.g,x.b,M,a)}return{getClearColor:function(){return o},setClearColor:function(x,M=1){o.set(x),c=M,v(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(x){c=x,v(o,c)},render:g}}function c2(n,t,e,i){const a=n.getParameter(34921),o=i.isWebGL2?null:t.get("OES_vertex_array_object"),c=i.isWebGL2||o!==null,u={},h=M(null);let d=h;function m(I,H,U,z,Q){let $=!1;if(c){const it=x(z,U,H);d!==it&&(d=it,g(d.object)),$=S(z,Q),$&&w(z,Q)}else{const it=H.wireframe===!0;(d.geometry!==z.id||d.program!==U.id||d.wireframe!==it)&&(d.geometry=z.id,d.program=U.id,d.wireframe=it,$=!0)}I.isInstancedMesh===!0&&($=!0),Q!==null&&e.update(Q,34963),$&&(B(I,H,U,z),Q!==null&&n.bindBuffer(34963,e.get(Q).buffer))}function p(){return i.isWebGL2?n.createVertexArray():o.createVertexArrayOES()}function g(I){return i.isWebGL2?n.bindVertexArray(I):o.bindVertexArrayOES(I)}function v(I){return i.isWebGL2?n.deleteVertexArray(I):o.deleteVertexArrayOES(I)}function x(I,H,U){const z=U.wireframe===!0;let Q=u[I.id];Q===void 0&&(Q={},u[I.id]=Q);let $=Q[H.id];$===void 0&&($={},Q[H.id]=$);let it=$[z];return it===void 0&&(it=M(p()),$[z]=it),it}function M(I){const H=[],U=[],z=[];for(let Q=0;Q<a;Q++)H[Q]=0,U[Q]=0,z[Q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:H,enabledAttributes:U,attributeDivisors:z,object:I,attributes:{},index:null}}function S(I,H){const U=d.attributes,z=I.attributes;let Q=0;for(const $ in z){const it=U[$],ct=z[$];if(it===void 0||it.attribute!==ct||it.data!==ct.data)return!0;Q++}return d.attributesNum!==Q||d.index!==H}function w(I,H){const U={},z=I.attributes;let Q=0;for(const $ in z){const it=z[$],ct={};ct.attribute=it,it.data&&(ct.data=it.data),U[$]=ct,Q++}d.attributes=U,d.attributesNum=Q,d.index=H}function _(){const I=d.newAttributes;for(let H=0,U=I.length;H<U;H++)I[H]=0}function L(I){R(I,0)}function R(I,H){const U=d.newAttributes,z=d.enabledAttributes,Q=d.attributeDivisors;U[I]=1,z[I]===0&&(n.enableVertexAttribArray(I),z[I]=1),Q[I]!==H&&((i.isWebGL2?n:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](I,H),Q[I]=H)}function C(){const I=d.newAttributes,H=d.enabledAttributes;for(let U=0,z=H.length;U<z;U++)H[U]!==I[U]&&(n.disableVertexAttribArray(U),H[U]=0)}function A(I,H,U,z,Q,$){i.isWebGL2===!0&&(U===5124||U===5125)?n.vertexAttribIPointer(I,H,U,Q,$):n.vertexAttribPointer(I,H,U,z,Q,$)}function B(I,H,U,z){if(i.isWebGL2===!1&&(I.isInstancedMesh||z.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;_();const Q=z.attributes,$=U.getAttributes(),it=H.defaultAttributeValues;for(const ct in $){const D=$[ct];if(D>=0){const q=Q[ct];if(q!==void 0){const ut=q.normalized,yt=q.itemSize,tt=e.get(q);if(tt===void 0)continue;const Ct=tt.buffer,bt=tt.type,Ht=tt.bytesPerElement;if(q.isInterleavedBufferAttribute){const Lt=q.data,Qt=Lt.stride,kt=q.offset;Lt&&Lt.isInstancedInterleavedBuffer?(R(D,Lt.meshPerAttribute),z._maxInstanceCount===void 0&&(z._maxInstanceCount=Lt.meshPerAttribute*Lt.count)):L(D),n.bindBuffer(34962,Ct),A(D,yt,bt,ut,Qt*Ht,kt*Ht)}else q.isInstancedBufferAttribute?(R(D,q.meshPerAttribute),z._maxInstanceCount===void 0&&(z._maxInstanceCount=q.meshPerAttribute*q.count)):L(D),n.bindBuffer(34962,Ct),A(D,yt,bt,ut,0,0)}else if(ct==="instanceMatrix"){const ut=e.get(I.instanceMatrix);if(ut===void 0)continue;const yt=ut.buffer,tt=ut.type;R(D+0,1),R(D+1,1),R(D+2,1),R(D+3,1),n.bindBuffer(34962,yt),n.vertexAttribPointer(D+0,4,tt,!1,64,0),n.vertexAttribPointer(D+1,4,tt,!1,64,16),n.vertexAttribPointer(D+2,4,tt,!1,64,32),n.vertexAttribPointer(D+3,4,tt,!1,64,48)}else if(ct==="instanceColor"){const ut=e.get(I.instanceColor);if(ut===void 0)continue;const yt=ut.buffer,tt=ut.type;R(D,1),n.bindBuffer(34962,yt),n.vertexAttribPointer(D,3,tt,!1,12,0)}else if(it!==void 0){const ut=it[ct];if(ut!==void 0)switch(ut.length){case 2:n.vertexAttrib2fv(D,ut);break;case 3:n.vertexAttrib3fv(D,ut);break;case 4:n.vertexAttrib4fv(D,ut);break;default:n.vertexAttrib1fv(D,ut)}}}}C()}function Y(){V();for(const I in u){const H=u[I];for(const U in H){const z=H[U];for(const Q in z)v(z[Q].object),delete z[Q];delete H[U]}delete u[I]}}function X(I){if(u[I.id]===void 0)return;const H=u[I.id];for(const U in H){const z=H[U];for(const Q in z)v(z[Q].object),delete z[Q];delete H[U]}delete u[I.id]}function st(I){for(const H in u){const U=u[H];if(U[I.id]===void 0)continue;const z=U[I.id];for(const Q in z)v(z[Q].object),delete z[Q];delete U[I.id]}}function V(){j(),d!==h&&(d=h,g(d.object))}function j(){h.geometry=null,h.program=null,h.wireframe=!1}return{setup:m,reset:V,resetDefaultState:j,dispose:Y,releaseStatesOfGeometry:X,releaseStatesOfProgram:st,initAttributes:_,enableAttribute:L,disableUnusedAttributes:C}}function u2(n,t,e,i){const a=i.isWebGL2;let o;function c(d){o=d}function u(d,m){n.drawArrays(o,d,m),e.update(m,o,1)}function h(d,m,p){if(p===0)return;let g,v;if(a)g=n,v="drawArraysInstanced";else if(g=t.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",g===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[v](o,d,m,p),e.update(m,o,p)}this.setMode=c,this.render=u,this.renderInstances=h}function h2(n,t,e){let i;function a(){if(i!==void 0)return i;const A=t.get("EXT_texture_filter_anisotropic");return A!==null?i=n.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT):i=0,i}function o(A){if(A==="highp"){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";A="mediump"}return A==="mediump"&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const c=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&n instanceof WebGL2ComputeRenderingContext;let u=e.precision!==void 0?e.precision:"highp";const h=o(u);h!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",h,"instead."),u=h);const d=e.logarithmicDepthBuffer===!0,m=n.getParameter(34930),p=n.getParameter(35660),g=n.getParameter(3379),v=n.getParameter(34076),x=n.getParameter(34921),M=n.getParameter(36347),S=n.getParameter(36348),w=n.getParameter(36349),_=p>0,L=c||!!t.get("OES_texture_float"),R=_&&L,C=c?n.getParameter(36183):0;return{isWebGL2:c,getMaxAnisotropy:a,getMaxPrecision:o,precision:u,logarithmicDepthBuffer:d,maxTextures:m,maxVertexTextures:p,maxTextureSize:g,maxCubemapSize:v,maxAttributes:x,maxVertexUniforms:M,maxVaryings:S,maxFragmentUniforms:w,vertexTextures:_,floatFragmentTextures:L,floatVertexTextures:R,maxSamples:C}}function f2(n){const t=this;let e=null,i=0,a=!1,o=!1;const c=new Ls,u=new Hn,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(p,g,v){const x=p.length!==0||g||i!==0||a;return a=g,e=m(p,v,0),i=p.length,x},this.beginShadows=function(){o=!0,m(null)},this.endShadows=function(){o=!1,d()},this.setState=function(p,g,v){const x=p.clippingPlanes,M=p.clipIntersection,S=p.clipShadows,w=n.get(p);if(!a||x===null||x.length===0||o&&!S)o?m(null):d();else{const _=o?0:i,L=_*4;let R=w.clippingState||null;h.value=R,R=m(x,g,L,v);for(let C=0;C!==L;++C)R[C]=e[C];w.clippingState=R,this.numIntersection=M?this.numPlanes:0,this.numPlanes+=_}};function d(){h.value!==e&&(h.value=e,h.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function m(p,g,v,x){const M=p!==null?p.length:0;let S=null;if(M!==0){if(S=h.value,x!==!0||S===null){const w=v+M*4,_=g.matrixWorldInverse;u.getNormalMatrix(_),(S===null||S.length<w)&&(S=new Float32Array(w));for(let L=0,R=v;L!==M;++L,R+=4)c.copy(p[L]).applyMatrix4(_,u),c.normal.toArray(S,R),S[R+3]=c.constant}h.value=S,h.needsUpdate=!0}return t.numPlanes=M,t.numIntersection=0,S}}function d2(n){let t=new WeakMap;function e(c,u){return u===dx?c.mapping=Xm:u===px&&(c.mapping=Zm),c}function i(c){if(c&&c.isTexture){const u=c.mapping;if(u===dx||u===px)if(t.has(c)){const h=t.get(c).texture;return e(h,c.mapping)}else{const h=c.image;if(h&&h.height>0){const d=n.getRenderList(),m=n.getRenderTarget(),p=new rr(h.height/2);return p.fromEquirectangularTexture(n,c),t.set(c,p),n.setRenderTarget(m),n.setRenderList(d),c.addEventListener("dispose",a),e(p.texture,c.mapping)}else return null}}return c}function a(c){const u=c.target;u.removeEventListener("dispose",a);const h=t.get(u);h!==void 0&&(t.delete(u),h.dispose())}function o(){t=new WeakMap}return{get:i,dispose:o}}function p2(n){const t={};return{has:function(e){if(t[e]!==void 0)return t[e]!==null;let i;switch(e){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(e)}return t[e]=i,i!==null},get:function(e){return this.has(e)||console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t[e]}}}function m2(n,t,e,i){const a=new WeakMap,o=new WeakMap;function c(p){const g=p.target,v=a.get(g);v.index!==null&&t.remove(v.index);for(const M in v.attributes)t.remove(v.attributes[M]);g.removeEventListener("dispose",c),a.delete(g);const x=o.get(v);x&&(t.remove(x),o.delete(v)),i.releaseStatesOfGeometry(v),g.isInstancedBufferGeometry===!0&&delete g._maxInstanceCount,e.memory.geometries--}function u(p,g){let v=a.get(g);return v||(g.addEventListener("dispose",c),g.isBufferGeometry?v=g:g.isGeometry&&(g._bufferGeometry===void 0&&(g._bufferGeometry=new Re().setFromObject(p)),v=g._bufferGeometry),a.set(g,v),e.memory.geometries++,v)}function h(p){const g=p.attributes;for(const x in g)t.update(g[x],34962);const v=p.morphAttributes;for(const x in v){const M=v[x];for(let S=0,w=M.length;S<w;S++)t.update(M[S],34962)}}function d(p){const g=[],v=p.index,x=p.attributes.position;let M=0;if(v!==null){const _=v.array;M=v.version;for(let L=0,R=_.length;L<R;L+=3){const C=_[L+0],A=_[L+1],B=_[L+2];g.push(C,A,A,B,B,C)}}else{const _=x.array;M=x.version;for(let L=0,R=_.length/3-1;L<R;L+=3){const C=L+0,A=L+1,B=L+2;g.push(C,A,A,B,B,C)}}const S=new(A_(g)>65535?gc:mc)(g,1);S.version=M;const w=o.get(p);w&&t.remove(w),o.set(p,S)}function m(p){const g=o.get(p);if(g){const v=p.index;v!==null&&g.version<v.version&&d(p)}else d(p);return o.get(p)}return{get:u,update:h,getWireframeAttribute:m}}function g2(n,t,e,i){const a=i.isWebGL2;let o;function c(g){o=g}let u,h;function d(g){u=g.type,h=g.bytesPerElement}function m(g,v){n.drawElements(o,v,u,g*h),e.update(v,o,1)}function p(g,v,x){if(x===0)return;let M,S;if(a)M=n,S="drawElementsInstanced";else if(M=t.get("ANGLE_instanced_arrays"),S="drawElementsInstancedANGLE",M===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}M[S](o,v,u,g*h,x),e.update(v,o,x)}this.setMode=c,this.setIndex=d,this.render=m,this.renderInstances=p}function y2(n){const t={geometries:0,textures:0},e={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,c,u){switch(e.calls++,c){case 4:e.triangles+=u*(o/3);break;case 1:e.lines+=u*(o/2);break;case 3:e.lines+=u*(o-1);break;case 2:e.lines+=u*o;break;case 0:e.points+=u*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function a(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0}return{memory:t,render:e,programs:null,autoReset:!0,reset:a,update:i}}function v2(n,t){return n[0]-t[0]}function x2(n,t){return Math.abs(t[1])-Math.abs(n[1])}function b2(n){const t={},e=new Float32Array(8),i=[];for(let o=0;o<8;o++)i[o]=[o,0];function a(o,c,u,h){const d=o.morphTargetInfluences,m=d===void 0?0:d.length;let p=t[c.id];if(p===void 0){p=[];for(let S=0;S<m;S++)p[S]=[S,0];t[c.id]=p}for(let S=0;S<m;S++){const w=p[S];w[0]=S,w[1]=d[S]}p.sort(x2);for(let S=0;S<8;S++)S<m&&p[S][1]?(i[S][0]=p[S][0],i[S][1]=p[S][1]):(i[S][0]=Number.MAX_SAFE_INTEGER,i[S][1]=0);i.sort(v2);const g=u.morphTargets&&c.morphAttributes.position,v=u.morphNormals&&c.morphAttributes.normal;let x=0;for(let S=0;S<8;S++){const w=i[S],_=w[0],L=w[1];_!==Number.MAX_SAFE_INTEGER&&L?(g&&c.getAttribute("morphTarget"+S)!==g[_]&&c.setAttribute("morphTarget"+S,g[_]),v&&c.getAttribute("morphNormal"+S)!==v[_]&&c.setAttribute("morphNormal"+S,v[_]),e[S]=L,x+=L):(g&&c.hasAttribute("morphTarget"+S)===!0&&c.deleteAttribute("morphTarget"+S),v&&c.hasAttribute("morphNormal"+S)===!0&&c.deleteAttribute("morphNormal"+S),e[S]=0)}const M=c.morphTargetsRelative?1:1-x;h.getUniforms().setValue(n,"morphTargetBaseInfluence",M),h.getUniforms().setValue(n,"morphTargetInfluences",e)}return{update:a}}function _2(n,t,e,i){let a=new WeakMap;function o(h){const d=i.render.frame,m=h.geometry,p=t.get(h,m);return a.get(p)!==d&&(m.isGeometry&&p.updateFromObject(h),t.update(p),a.set(p,d)),h.isInstancedMesh&&(h.hasEventListener("dispose",u)===!1&&h.addEventListener("dispose",u),e.update(h.instanceMatrix,34962),h.instanceColor!==null&&e.update(h.instanceColor,34962)),p}function c(){a=new WeakMap}function u(h){const d=h.target;d.removeEventListener("dispose",u),e.remove(d.instanceMatrix),d.instanceColor!==null&&e.remove(d.instanceColor)}return{update:o,dispose:c}}function yc(n=null,t=1,e=1,i=1){De.call(this,null),this.image={data:n,width:t,height:e,depth:i},this.magFilter=Rn,this.minFilter=Rn,this.wrapR=Kn,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}yc.prototype=Object.create(De.prototype);yc.prototype.constructor=yc;yc.prototype.isDataTexture2DArray=!0;function vc(n=null,t=1,e=1,i=1){De.call(this,null),this.image={data:n,width:t,height:e,depth:i},this.magFilter=Rn,this.minFilter=Rn,this.wrapR=Kn,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}vc.prototype=Object.create(De.prototype);vc.prototype.constructor=vc;vc.prototype.isDataTexture3D=!0;const N_=new De,w2=new yc,M2=new vc,z_=new wa,Fx=[],Hx=[],Gx=new Float32Array(16),Vx=new Float32Array(9),kx=new Float32Array(4);function Xo(n,t,e){const i=n[0];if(i<=0||i>0)return n;const a=t*e;let o=Fx[a];if(o===void 0&&(o=new Float32Array(a),Fx[a]=o),t!==0){i.toArray(o,0);for(let c=1,u=0;c!==t;++c)u+=e,n[c].toArray(o,u)}return o}function yi(n,t){if(n.length!==t.length)return!1;for(let e=0,i=n.length;e<i;e++)if(n[e]!==t[e])return!1;return!0}function $n(n,t){for(let e=0,i=t.length;e<i;e++)n[e]=t[e]}function B_(n,t){let e=Hx[t];e===void 0&&(e=new Int32Array(t),Hx[t]=e);for(let i=0;i!==t;++i)e[i]=n.allocateTextureUnit();return e}function S2(n,t){const e=this.cache;e[0]!==t&&(n.uniform1f(this.addr,t),e[0]=t)}function E2(n,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y)&&(n.uniform2f(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(yi(e,t))return;n.uniform2fv(this.addr,t),$n(e,t)}}function T2(n,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(n.uniform3f(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else if(t.r!==void 0)(e[0]!==t.r||e[1]!==t.g||e[2]!==t.b)&&(n.uniform3f(this.addr,t.r,t.g,t.b),e[0]=t.r,e[1]=t.g,e[2]=t.b);else{if(yi(e,t))return;n.uniform3fv(this.addr,t),$n(e,t)}}function A2(n,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(n.uniform4f(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(yi(e,t))return;n.uniform4fv(this.addr,t),$n(e,t)}}function C2(n,t){const e=this.cache,i=t.elements;if(i===void 0){if(yi(e,t))return;n.uniformMatrix2fv(this.addr,!1,t),$n(e,t)}else{if(yi(e,i))return;kx.set(i),n.uniformMatrix2fv(this.addr,!1,kx),$n(e,i)}}function L2(n,t){const e=this.cache,i=t.elements;if(i===void 0){if(yi(e,t))return;n.uniformMatrix3fv(this.addr,!1,t),$n(e,t)}else{if(yi(e,i))return;Vx.set(i),n.uniformMatrix3fv(this.addr,!1,Vx),$n(e,i)}}function R2(n,t){const e=this.cache,i=t.elements;if(i===void 0){if(yi(e,t))return;n.uniformMatrix4fv(this.addr,!1,t),$n(e,t)}else{if(yi(e,i))return;Gx.set(i),n.uniformMatrix4fv(this.addr,!1,Gx),$n(e,i)}}function N2(n,t,e){const i=this.cache,a=e.allocateTextureUnit();i[0]!==a&&(n.uniform1i(this.addr,a),i[0]=a),e.safeSetTexture2D(t||N_,a)}function z2(n,t,e){const i=this.cache,a=e.allocateTextureUnit();i[0]!==a&&(n.uniform1i(this.addr,a),i[0]=a),e.setTexture2DArray(t||w2,a)}function B2(n,t,e){const i=this.cache,a=e.allocateTextureUnit();i[0]!==a&&(n.uniform1i(this.addr,a),i[0]=a),e.setTexture3D(t||M2,a)}function D2(n,t,e){const i=this.cache,a=e.allocateTextureUnit();i[0]!==a&&(n.uniform1i(this.addr,a),i[0]=a),e.safeSetTextureCube(t||z_,a)}function O2(n,t){const e=this.cache;e[0]!==t&&(n.uniform1i(this.addr,t),e[0]=t)}function P2(n,t){const e=this.cache;yi(e,t)||(n.uniform2iv(this.addr,t),$n(e,t))}function U2(n,t){const e=this.cache;yi(e,t)||(n.uniform3iv(this.addr,t),$n(e,t))}function I2(n,t){const e=this.cache;yi(e,t)||(n.uniform4iv(this.addr,t),$n(e,t))}function F2(n,t){const e=this.cache;e[0]!==t&&(n.uniform1ui(this.addr,t),e[0]=t)}function H2(n){switch(n){case 5126:return S2;case 35664:return E2;case 35665:return T2;case 35666:return A2;case 35674:return C2;case 35675:return L2;case 35676:return R2;case 5124:case 35670:return O2;case 35667:case 35671:return P2;case 35668:case 35672:return U2;case 35669:case 35673:return I2;case 5125:return F2;case 35678:case 36198:case 36298:case 36306:case 35682:return N2;case 35679:case 36299:case 36307:return B2;case 35680:case 36300:case 36308:case 36293:return D2;case 36289:case 36303:case 36311:case 36292:return z2}}function G2(n,t){n.uniform1fv(this.addr,t)}function V2(n,t){n.uniform1iv(this.addr,t)}function k2(n,t){n.uniform2iv(this.addr,t)}function W2(n,t){n.uniform3iv(this.addr,t)}function j2(n,t){n.uniform4iv(this.addr,t)}function q2(n,t){const e=Xo(t,this.size,2);n.uniform2fv(this.addr,e)}function Y2(n,t){const e=Xo(t,this.size,3);n.uniform3fv(this.addr,e)}function X2(n,t){const e=Xo(t,this.size,4);n.uniform4fv(this.addr,e)}function Z2(n,t){const e=Xo(t,this.size,4);n.uniformMatrix2fv(this.addr,!1,e)}function Q2(n,t){const e=Xo(t,this.size,9);n.uniformMatrix3fv(this.addr,!1,e)}function J2(n,t){const e=Xo(t,this.size,16);n.uniformMatrix4fv(this.addr,!1,e)}function K2(n,t,e){const i=t.length,a=B_(e,i);n.uniform1iv(this.addr,a);for(let o=0;o!==i;++o)e.safeSetTexture2D(t[o]||N_,a[o])}function $2(n,t,e){const i=t.length,a=B_(e,i);n.uniform1iv(this.addr,a);for(let o=0;o!==i;++o)e.safeSetTextureCube(t[o]||z_,a[o])}function t3(n){switch(n){case 5126:return G2;case 35664:return q2;case 35665:return Y2;case 35666:return X2;case 35674:return Z2;case 35675:return Q2;case 35676:return J2;case 5124:case 35670:return V2;case 35667:case 35671:return k2;case 35668:case 35672:return W2;case 35669:case 35673:return j2;case 35678:case 36198:case 36298:case 36306:case 35682:return K2;case 35680:case 36300:case 36308:case 36293:return $2}}function e3(n,t,e){this.id=n,this.addr=e,this.cache=[],this.setValue=H2(t.type)}function D_(n,t,e){this.id=n,this.addr=e,this.cache=[],this.size=t.size,this.setValue=t3(t.type)}D_.prototype.updateCache=function(n){const t=this.cache;n instanceof Float32Array&&t.length!==n.length&&(this.cache=new Float32Array(n.length)),$n(t,n)};function O_(n){this.id=n,this.seq=[],this.map={}}O_.prototype.setValue=function(n,t,e){const i=this.seq;for(let a=0,o=i.length;a!==o;++a){const c=i[a];c.setValue(n,t[c.id],e)}};const qp=/(\w+)(\])?(\[|\.)?/g;function Wx(n,t){n.seq.push(t),n.map[t.id]=t}function n3(n,t,e){const i=n.name,a=i.length;for(qp.lastIndex=0;;){const o=qp.exec(i),c=qp.lastIndex;let u=o[1];const h=o[2]==="]",d=o[3];if(h&&(u=u|0),d===void 0||d==="["&&c+2===a){Wx(e,d===void 0?new e3(u,n,t):new D_(u,n,t));break}else{let p=e.map[u];p===void 0&&(p=new O_(u),Wx(e,p)),e=p}}}function va(n,t){this.seq=[],this.map={};const e=n.getProgramParameter(t,35718);for(let i=0;i<e;++i){const a=n.getActiveUniform(t,i),o=n.getUniformLocation(t,a.name);n3(a,o,this)}}va.prototype.setValue=function(n,t,e,i){const a=this.map[t];a!==void 0&&a.setValue(n,e,i)};va.prototype.setOptional=function(n,t,e){const i=t[e];i!==void 0&&this.setValue(n,e,i)};va.upload=function(n,t,e,i){for(let a=0,o=t.length;a!==o;++a){const c=t[a],u=e[c.id];u.needsUpdate!==!1&&c.setValue(n,u.value,i)}};va.seqWithValue=function(n,t){const e=[];for(let i=0,a=n.length;i!==a;++i){const o=n[i];o.id in t&&e.push(o)}return e};function jx(n,t,e){const i=n.createShader(t);return n.shaderSource(i,e),n.compileShader(i),i}let i3=0;function s3(n){const t=n.split(`
`);for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join(`
`)}function P_(n){switch(n){case Lc:return["Linear","( value )"];case Jh:return["sRGB","( value )"];case pE:return["RGBE","( value )"];case gE:return["RGBM","( value, 7.0 )"];case yE:return["RGBM","( value, 16.0 )"];case vE:return["RGBD","( value, 256.0 )"];case dE:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case mE:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function qx(n,t,e){const i=n.getShaderParameter(t,35713),a=n.getShaderInfoLog(t).trim();if(i&&a==="")return"";const o=n.getShaderSource(t);return"THREE.WebGLShader: gl.getShaderInfoLog() "+e+`
`+a+s3(o)}function Yl(n,t){const e=P_(t);return"vec4 "+n+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function a3(n,t){const e=P_(t);return"vec4 "+n+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function r3(n,t){let e;switch(t){case fS:e="Linear";break;case dS:e="Reinhard";break;case pS:e="OptimizedCineon";break;case mS:e="ACESFilmic";break;case gS:e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),e="Linear"}return"vec3 "+n+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function o3(n){return[n.extensionDerivatives||n.envMapCubeUV||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ic).join(`
`)}function l3(n){const t=[];for(const e in n){const i=n[e];i!==!1&&t.push("#define "+e+" "+i)}return t.join(`
`)}function c3(n,t){const e={},i=n.getProgramParameter(t,35721);for(let a=0;a<i;a++){const c=n.getActiveAttrib(t,a).name;e[c]=n.getAttribLocation(t,c)}return e}function ic(n){return n!==""}function Yx(n,t){return n.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Xx(n,t){return n.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const u3=/^[ \t]*#include +<([\w\d./]+)>/gm;function gm(n){return n.replace(u3,h3)}function h3(n,t){const e=he[t];if(e===void 0)throw new Error("Can not resolve #include <"+t+">");return gm(e)}const f3=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,d3=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Zx(n){return n.replace(d3,U_).replace(f3,p3)}function p3(n,t,e,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),U_(n,t,e,i)}function U_(n,t,e,i){let a="";for(let o=parseInt(t);o<parseInt(e);o++)a+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return a}function Qx(n){let t="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?t+=`
#define HIGH_PRECISION`:n.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function m3(n){let t="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===x_?t="SHADOWMAP_TYPE_PCF":n.shadowMapType===Ym?t="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===nc&&(t="SHADOWMAP_TYPE_VSM"),t}function g3(n){let t="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Xm:case Zm:t="ENVMAP_TYPE_CUBE";break;case Qm:case Jm:t="ENVMAP_TYPE_CUBE_UV";break}return t}function y3(n){let t="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Zm:case Jm:t="ENVMAP_MODE_REFRACTION";break}return t}function v3(n){let t="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Zh:t="ENVMAP_BLENDING_MULTIPLY";break;case uS:t="ENVMAP_BLENDING_MIX";break;case hS:t="ENVMAP_BLENDING_ADD";break}return t}function x3(n,t,e,i){const a=n.getContext(),o=e.defines;let c=e.vertexShader,u=e.fragmentShader;const h=m3(e),d=g3(e),m=y3(e),p=v3(e),g=n.gammaFactor>0?n.gammaFactor:1,v=e.isWebGL2?"":o3(e),x=l3(o),M=a.createProgram();let S,w,_=e.glslVersion?"#version "+e.glslVersion+`
`:"";e.isRawShaderMaterial?(S=[x].filter(ic).join(`
`),S.length>0&&(S+=`
`),w=[v,x].filter(ic).join(`
`),w.length>0&&(w+=`
`)):(S=[Qx(e),"#define SHADER_NAME "+e.shaderName,x,e.instancing?"#define USE_INSTANCING":"",e.instancingColor?"#define USE_INSTANCING_COLOR":"",e.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+e.maxBones,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+m:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.displacementMap&&e.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&e.flatShading===!1?"#define USE_MORPHNORMALS":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+h:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ic).join(`
`),w=[v,Qx(e),"#define SHADER_NAME "+e.shaderName,x,e.alphaTest?"#define ALPHATEST "+e.alphaTest+(e.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+g,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+d:"",e.envMap?"#define "+m:"",e.envMap?"#define "+p:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.sheen?"#define USE_SHEEN":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor?"#define USE_COLOR":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+h:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==rc?"#define TONE_MAPPING":"",e.toneMapping!==rc?he.tonemapping_pars_fragment:"",e.toneMapping!==rc?r3("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",he.encodings_pars_fragment,e.map?Yl("mapTexelToLinear",e.mapEncoding):"",e.matcap?Yl("matcapTexelToLinear",e.matcapEncoding):"",e.envMap?Yl("envMapTexelToLinear",e.envMapEncoding):"",e.emissiveMap?Yl("emissiveMapTexelToLinear",e.emissiveMapEncoding):"",e.lightMap?Yl("lightMapTexelToLinear",e.lightMapEncoding):"",a3("linearToOutputTexel",e.outputEncoding),e.depthPacking?"#define DEPTH_PACKING "+e.depthPacking:"",`
`].filter(ic).join(`
`)),c=gm(c),c=Yx(c,e),c=Xx(c,e),u=gm(u),u=Yx(u,e),u=Xx(u,e),c=Zx(c),u=Zx(u),e.isWebGL2&&e.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,S=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+S,w=["#define varying in",e.glslVersion===Ax?"":"out highp vec4 pc_fragColor;",e.glslVersion===Ax?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);const L=_+S+c,R=_+w+u,C=jx(a,35633,L),A=jx(a,35632,R);if(a.attachShader(M,C),a.attachShader(M,A),e.index0AttributeName!==void 0?a.bindAttribLocation(M,0,e.index0AttributeName):e.morphTargets===!0&&a.bindAttribLocation(M,0,"position"),a.linkProgram(M),n.debug.checkShaderErrors){const X=a.getProgramInfoLog(M).trim(),st=a.getShaderInfoLog(C).trim(),V=a.getShaderInfoLog(A).trim();let j=!0,I=!0;if(a.getProgramParameter(M,35714)===!1){j=!1;const H=qx(a,C,"vertex"),U=qx(a,A,"fragment");console.error("THREE.WebGLProgram: shader error: ",a.getError(),"35715",a.getProgramParameter(M,35715),"gl.getProgramInfoLog",X,H,U)}else X!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",X):(st===""||V==="")&&(I=!1);I&&(this.diagnostics={runnable:j,programLog:X,vertexShader:{log:st,prefix:S},fragmentShader:{log:V,prefix:w}})}a.deleteShader(C),a.deleteShader(A);let B;this.getUniforms=function(){return B===void 0&&(B=new va(a,M)),B};let Y;return this.getAttributes=function(){return Y===void 0&&(Y=c3(a,M)),Y},this.destroy=function(){i.releaseStatesOfProgram(this),a.deleteProgram(M),this.program=void 0},this.name=e.shaderName,this.id=i3++,this.cacheKey=t,this.usedTimes=1,this.program=M,this.vertexShader=C,this.fragmentShader=A,this}function b3(n,t,e,i,a,o){const c=[],u=i.isWebGL2,h=i.logarithmicDepthBuffer,d=i.floatVertexTextures,m=i.maxVertexUniforms,p=i.vertexTextures;let g=i.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},x=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function M(A){const Y=A.skeleton.bones;if(d)return 1024;{const st=Math.floor((m-20)/4),V=Math.min(st,Y.length);return V<Y.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Y.length+" bones. This GPU supports "+V+"."),0):V}}function S(A){let B;return A&&A.isTexture?B=A.encoding:A&&A.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),B=A.texture.encoding):B=Lc,B}function w(A,B,Y,X,st){const V=X.fog,j=A.isMeshStandardMaterial?X.environment:null,I=t.get(A.envMap||j),H=v[A.type],U=st.isSkinnedMesh?M(st):0;A.precision!==null&&(g=i.getMaxPrecision(A.precision),g!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",g,"instead."));let z,Q;if(H){const ct=Yi[H];z=ct.vertexShader,Q=ct.fragmentShader}else z=A.vertexShader,Q=A.fragmentShader;const $=n.getRenderTarget();return{isWebGL2:u,shaderID:H,shaderName:A.type,vertexShader:z,fragmentShader:Q,defines:A.defines,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:g,instancing:st.isInstancedMesh===!0,instancingColor:st.isInstancedMesh===!0&&st.instanceColor!==null,supportsVertexTextures:p,outputEncoding:$!==null?S($.texture):n.outputEncoding,map:!!A.map,mapEncoding:S(A.map),matcap:!!A.matcap,matcapEncoding:S(A.matcap),envMap:!!I,envMapMode:I&&I.mapping,envMapEncoding:S(I),envMapCubeUV:!!I&&(I.mapping===Qm||I.mapping===Jm),lightMap:!!A.lightMap,lightMapEncoding:S(A.lightMap),aoMap:!!A.aoMap,emissiveMap:!!A.emissiveMap,emissiveMapEncoding:S(A.emissiveMap),bumpMap:!!A.bumpMap,normalMap:!!A.normalMap,objectSpaceNormalMap:A.normalMapType===_E,tangentSpaceNormalMap:A.normalMapType===qo,clearcoatMap:!!A.clearcoatMap,clearcoatRoughnessMap:!!A.clearcoatRoughnessMap,clearcoatNormalMap:!!A.clearcoatNormalMap,displacementMap:!!A.displacementMap,roughnessMap:!!A.roughnessMap,metalnessMap:!!A.metalnessMap,specularMap:!!A.specularMap,alphaMap:!!A.alphaMap,gradientMap:!!A.gradientMap,sheen:!!A.sheen,transmissionMap:!!A.transmissionMap,combine:A.combine,vertexTangents:A.normalMap&&A.vertexTangents,vertexColors:A.vertexColors,vertexUvs:!!A.map||!!A.bumpMap||!!A.normalMap||!!A.specularMap||!!A.alphaMap||!!A.emissiveMap||!!A.roughnessMap||!!A.metalnessMap||!!A.clearcoatMap||!!A.clearcoatRoughnessMap||!!A.clearcoatNormalMap||!!A.displacementMap||!!A.transmissionMap,uvsVertexOnly:!(A.map||A.bumpMap||A.normalMap||A.specularMap||A.alphaMap||A.emissiveMap||A.roughnessMap||A.metalnessMap||A.clearcoatNormalMap||A.transmissionMap)&&!!A.displacementMap,fog:!!V,useFog:A.fog,fogExp2:V&&V.isFogExp2,flatShading:A.flatShading,sizeAttenuation:A.sizeAttenuation,logarithmicDepthBuffer:h,skinning:A.skinning&&U>0,maxBones:U,useVertexTexture:d,morphTargets:A.morphTargets,morphNormals:A.morphNormals,maxMorphTargets:n.maxMorphTargets,maxMorphNormals:n.maxMorphNormals,numDirLights:B.directional.length,numPointLights:B.point.length,numSpotLights:B.spot.length,numRectAreaLights:B.rectArea.length,numHemiLights:B.hemi.length,numDirLightShadows:B.directionalShadowMap.length,numPointLightShadows:B.pointShadowMap.length,numSpotLightShadows:B.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:A.dithering,shadowMapEnabled:n.shadowMap.enabled&&Y.length>0,shadowMapType:n.shadowMap.type,toneMapping:A.toneMapped?n.toneMapping:rc,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:A.premultipliedAlpha,alphaTest:A.alphaTest,doubleSided:A.side===zo,flipSided:A.side===_n,depthPacking:A.depthPacking!==void 0?A.depthPacking:!1,index0AttributeName:A.index0AttributeName,extensionDerivatives:A.extensions&&A.extensions.derivatives,extensionFragDepth:A.extensions&&A.extensions.fragDepth,extensionDrawBuffers:A.extensions&&A.extensions.drawBuffers,extensionShaderTextureLOD:A.extensions&&A.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||e.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||e.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||e.has("EXT_shader_texture_lod"),customProgramCacheKey:A.customProgramCacheKey()}}function _(A){const B=[];if(A.shaderID?B.push(A.shaderID):(B.push(A.fragmentShader),B.push(A.vertexShader)),A.defines!==void 0)for(const Y in A.defines)B.push(Y),B.push(A.defines[Y]);if(A.isRawShaderMaterial===!1){for(let Y=0;Y<x.length;Y++)B.push(A[x[Y]]);B.push(n.outputEncoding),B.push(n.gammaFactor)}return B.push(A.customProgramCacheKey),B.join()}function L(A){const B=v[A.type];let Y;if(B){const X=Yi[B];Y=UE.clone(X.uniforms)}else Y=A.uniforms;return Y}function R(A,B){let Y;for(let X=0,st=c.length;X<st;X++){const V=c[X];if(V.cacheKey===B){Y=V,++Y.usedTimes;break}}return Y===void 0&&(Y=new x3(n,B,A,a),c.push(Y)),Y}function C(A){if(--A.usedTimes===0){const B=c.indexOf(A);c[B]=c[c.length-1],c.pop(),A.destroy()}}return{getParameters:w,getProgramCacheKey:_,getUniforms:L,acquireProgram:R,releaseProgram:C,programs:c}}function _3(){let n=new WeakMap;function t(o){let c=n.get(o);return c===void 0&&(c={},n.set(o,c)),c}function e(o){n.delete(o)}function i(o,c,u){n.get(o)[c]=u}function a(){n=new WeakMap}return{get:t,remove:e,update:i,dispose:a}}function w3(n,t){return n.groupOrder!==t.groupOrder?n.groupOrder-t.groupOrder:n.renderOrder!==t.renderOrder?n.renderOrder-t.renderOrder:n.program!==t.program?n.program.id-t.program.id:n.material.id!==t.material.id?n.material.id-t.material.id:n.z!==t.z?n.z-t.z:n.id-t.id}function M3(n,t){return n.groupOrder!==t.groupOrder?n.groupOrder-t.groupOrder:n.renderOrder!==t.renderOrder?n.renderOrder-t.renderOrder:n.z!==t.z?t.z-n.z:n.id-t.id}function Jx(n){const t=[];let e=0;const i=[],a=[],o={id:-1};function c(){e=0,i.length=0,a.length=0}function u(g,v,x,M,S,w){let _=t[e];const L=n.get(x);return _===void 0?(_={id:g.id,object:g,geometry:v,material:x,program:L.program||o,groupOrder:M,renderOrder:g.renderOrder,z:S,group:w},t[e]=_):(_.id=g.id,_.object=g,_.geometry=v,_.material=x,_.program=L.program||o,_.groupOrder=M,_.renderOrder=g.renderOrder,_.z=S,_.group=w),e++,_}function h(g,v,x,M,S,w){const _=u(g,v,x,M,S,w);(x.transparent===!0?a:i).push(_)}function d(g,v,x,M,S,w){const _=u(g,v,x,M,S,w);(x.transparent===!0?a:i).unshift(_)}function m(g,v){i.length>1&&i.sort(g||w3),a.length>1&&a.sort(v||M3)}function p(){for(let g=e,v=t.length;g<v;g++){const x=t[g];if(x.id===null)break;x.id=null,x.object=null,x.geometry=null,x.material=null,x.program=null,x.group=null}}return{opaque:i,transparent:a,init:c,push:h,unshift:d,finish:p,sort:m}}function S3(n){let t=new WeakMap;function e(a,o){const c=t.get(a);let u;return c===void 0?(u=new Jx(n),t.set(a,new WeakMap),t.get(a).set(o,u)):(u=c.get(o),u===void 0&&(u=new Jx(n),c.set(o,u))),u}function i(){t=new WeakMap}return{get:e,dispose:i}}function E3(){const n={};return{get:function(t){if(n[t.id]!==void 0)return n[t.id];let e;switch(t.type){case"DirectionalLight":e={direction:new G,color:new Wt};break;case"SpotLight":e={position:new G,direction:new G,color:new Wt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new G,color:new Wt,distance:0,decay:0};break;case"HemisphereLight":e={direction:new G,skyColor:new Wt,groundColor:new Wt};break;case"RectAreaLight":e={color:new Wt,position:new G,halfWidth:new G,halfHeight:new G};break}return n[t.id]=e,e}}}function T3(){const n={};return{get:function(t){if(n[t.id]!==void 0)return n[t.id];let e;switch(t.type){case"DirectionalLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"SpotLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"PointLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[t.id]=e,e}}}let A3=0;function C3(n,t){return(t.castShadow?1:0)-(n.castShadow?1:0)}function L3(n,t){const e=new E3,i=T3(),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let m=0;m<9;m++)a.probe.push(new G);const o=new G,c=new re,u=new re;function h(m){let p=0,g=0,v=0;for(let B=0;B<9;B++)a.probe[B].set(0,0,0);let x=0,M=0,S=0,w=0,_=0,L=0,R=0,C=0;m.sort(C3);for(let B=0,Y=m.length;B<Y;B++){const X=m[B],st=X.color,V=X.intensity,j=X.distance,I=X.shadow&&X.shadow.map?X.shadow.map.texture:null;if(X.isAmbientLight)p+=st.r*V,g+=st.g*V,v+=st.b*V;else if(X.isLightProbe)for(let H=0;H<9;H++)a.probe[H].addScaledVector(X.sh.coefficients[H],V);else if(X.isDirectionalLight){const H=e.get(X);if(H.color.copy(X.color).multiplyScalar(X.intensity),X.castShadow){const U=X.shadow,z=i.get(X);z.shadowBias=U.bias,z.shadowNormalBias=U.normalBias,z.shadowRadius=U.radius,z.shadowMapSize=U.mapSize,a.directionalShadow[x]=z,a.directionalShadowMap[x]=I,a.directionalShadowMatrix[x]=X.shadow.matrix,L++}a.directional[x]=H,x++}else if(X.isSpotLight){const H=e.get(X);if(H.position.setFromMatrixPosition(X.matrixWorld),H.color.copy(st).multiplyScalar(V),H.distance=j,H.coneCos=Math.cos(X.angle),H.penumbraCos=Math.cos(X.angle*(1-X.penumbra)),H.decay=X.decay,X.castShadow){const U=X.shadow,z=i.get(X);z.shadowBias=U.bias,z.shadowNormalBias=U.normalBias,z.shadowRadius=U.radius,z.shadowMapSize=U.mapSize,a.spotShadow[S]=z,a.spotShadowMap[S]=I,a.spotShadowMatrix[S]=X.shadow.matrix,C++}a.spot[S]=H,S++}else if(X.isRectAreaLight){const H=e.get(X);H.color.copy(st).multiplyScalar(V),H.halfWidth.set(X.width*.5,0,0),H.halfHeight.set(0,X.height*.5,0),a.rectArea[w]=H,w++}else if(X.isPointLight){const H=e.get(X);if(H.color.copy(X.color).multiplyScalar(X.intensity),H.distance=X.distance,H.decay=X.decay,X.castShadow){const U=X.shadow,z=i.get(X);z.shadowBias=U.bias,z.shadowNormalBias=U.normalBias,z.shadowRadius=U.radius,z.shadowMapSize=U.mapSize,z.shadowCameraNear=U.camera.near,z.shadowCameraFar=U.camera.far,a.pointShadow[M]=z,a.pointShadowMap[M]=I,a.pointShadowMatrix[M]=X.shadow.matrix,R++}a.point[M]=H,M++}else if(X.isHemisphereLight){const H=e.get(X);H.skyColor.copy(X.color).multiplyScalar(V),H.groundColor.copy(X.groundColor).multiplyScalar(V),a.hemi[_]=H,_++}}w>0&&(t.isWebGL2||n.has("OES_texture_float_linear")===!0?(a.rectAreaLTC1=Bt.LTC_FLOAT_1,a.rectAreaLTC2=Bt.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(a.rectAreaLTC1=Bt.LTC_HALF_1,a.rectAreaLTC2=Bt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=p,a.ambient[1]=g,a.ambient[2]=v;const A=a.hash;(A.directionalLength!==x||A.pointLength!==M||A.spotLength!==S||A.rectAreaLength!==w||A.hemiLength!==_||A.numDirectionalShadows!==L||A.numPointShadows!==R||A.numSpotShadows!==C)&&(a.directional.length=x,a.spot.length=S,a.rectArea.length=w,a.point.length=M,a.hemi.length=_,a.directionalShadow.length=L,a.directionalShadowMap.length=L,a.pointShadow.length=R,a.pointShadowMap.length=R,a.spotShadow.length=C,a.spotShadowMap.length=C,a.directionalShadowMatrix.length=L,a.pointShadowMatrix.length=R,a.spotShadowMatrix.length=C,A.directionalLength=x,A.pointLength=M,A.spotLength=S,A.rectAreaLength=w,A.hemiLength=_,A.numDirectionalShadows=L,A.numPointShadows=R,A.numSpotShadows=C,a.version=A3++)}function d(m,p){let g=0,v=0,x=0,M=0,S=0;const w=p.matrixWorldInverse;for(let _=0,L=m.length;_<L;_++){const R=m[_];if(R.isDirectionalLight){const C=a.directional[g];C.direction.setFromMatrixPosition(R.matrixWorld),o.setFromMatrixPosition(R.target.matrixWorld),C.direction.sub(o),C.direction.transformDirection(w),g++}else if(R.isSpotLight){const C=a.spot[x];C.position.setFromMatrixPosition(R.matrixWorld),C.position.applyMatrix4(w),C.direction.setFromMatrixPosition(R.matrixWorld),o.setFromMatrixPosition(R.target.matrixWorld),C.direction.sub(o),C.direction.transformDirection(w),x++}else if(R.isRectAreaLight){const C=a.rectArea[M];C.position.setFromMatrixPosition(R.matrixWorld),C.position.applyMatrix4(w),u.identity(),c.copy(R.matrixWorld),c.premultiply(w),u.extractRotation(c),C.halfWidth.set(R.width*.5,0,0),C.halfHeight.set(0,R.height*.5,0),C.halfWidth.applyMatrix4(u),C.halfHeight.applyMatrix4(u),M++}else if(R.isPointLight){const C=a.point[v];C.position.setFromMatrixPosition(R.matrixWorld),C.position.applyMatrix4(w),v++}else if(R.isHemisphereLight){const C=a.hemi[S];C.direction.setFromMatrixPosition(R.matrixWorld),C.direction.transformDirection(w),C.direction.normalize(),S++}}}return{setup:h,setupView:d,state:a}}function Kx(n,t){const e=new L3(n,t),i=[],a=[];function o(){i.length=0,a.length=0}function c(p){i.push(p)}function u(p){a.push(p)}function h(){e.setup(i)}function d(p){e.setupView(i,p)}return{init:o,state:{lightsArray:i,shadowsArray:a,lights:e},setupLights:h,setupLightsView:d,pushLight:c,pushShadow:u}}function R3(n,t){let e=new WeakMap;function i(o,c=0){let u;return e.has(o)===!1?(u=new Kx(n,t),e.set(o,[]),e.get(o).push(u)):c>=e.get(o).length?(u=new Kx(n,t),e.get(o).push(u)):u=e.get(o)[c],u}function a(){e=new WeakMap}return{get:i,dispose:a}}function or(n){Jt.call(this),this.type="MeshDepthMaterial",this.depthPacking=xE,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(n)}or.prototype=Object.create(Jt.prototype);or.prototype.constructor=or;or.prototype.isMeshDepthMaterial=!0;or.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.depthPacking=n.depthPacking,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.map=n.map,this.alphaMap=n.alphaMap,this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this};function lr(n){Jt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new G,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(n)}lr.prototype=Object.create(Jt.prototype);lr.prototype.constructor=lr;lr.prototype.isMeshDistanceMaterial=!0;lr.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.referencePosition.copy(n.referencePosition),this.nearDistance=n.nearDistance,this.farDistance=n.farDistance,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.map=n.map,this.alphaMap=n.alphaMap,this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this};var N3=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,z3=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function I_(n,t,e){let i=new $h;const a=new ht,o=new ht,c=new Le,u=[],h=[],d={},m={0:_n,1:Xh,2:zo},p=new Gn({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new ht},radius:{value:4}},vertexShader:z3,fragmentShader:N3}),g=p.clone();g.defines.HORIZONTAL_PASS=1;const v=new Re;v.setAttribute("position",new ee(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new Ze(v,p),M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=x_,this.render=function(C,A,B){if(M.enabled===!1||M.autoUpdate===!1&&M.needsUpdate===!1||C.length===0)return;const Y=n.getRenderTarget(),X=n.getActiveCubeFace(),st=n.getActiveMipmapLevel(),V=n.state;V.setBlending(sc),V.buffers.color.setClear(1,1,1,1),V.buffers.depth.setTest(!0),V.setScissorTest(!1);for(let j=0,I=C.length;j<I;j++){const H=C[j],U=H.shadow;if(U===void 0){console.warn("THREE.WebGLShadowMap:",H,"has no shadow.");continue}if(U.autoUpdate===!1&&U.needsUpdate===!1)continue;a.copy(U.mapSize);const z=U.getFrameExtents();if(a.multiply(z),o.copy(U.mapSize),(a.x>e||a.y>e)&&(a.x>e&&(o.x=Math.floor(e/z.x),a.x=o.x*z.x,U.mapSize.x=o.x),a.y>e&&(o.y=Math.floor(e/z.y),a.y=o.y*z.y,U.mapSize.y=o.y)),U.map===null&&!U.isPointLightShadow&&this.type===nc){const $={minFilter:En,magFilter:En,format:zi};U.map=new Bi(a.x,a.y,$),U.map.texture.name=H.name+".shadowMap",U.mapPass=new Bi(a.x,a.y,$),U.camera.updateProjectionMatrix()}if(U.map===null){const $={minFilter:Rn,magFilter:Rn,format:zi};U.map=new Bi(a.x,a.y,$),U.map.texture.name=H.name+".shadowMap",U.camera.updateProjectionMatrix()}n.setRenderTarget(U.map),n.clear();const Q=U.getViewportCount();for(let $=0;$<Q;$++){const it=U.getViewport($);c.set(o.x*it.x,o.y*it.y,o.x*it.z,o.y*it.w),V.viewport(c),U.updateMatrices(H,$),i=U.getFrustum(),R(A,B,U.camera,H,this.type)}!U.isPointLightShadow&&this.type===nc&&S(U,B),U.needsUpdate=!1}M.needsUpdate=!1,n.setRenderTarget(Y,X,st)};function S(C,A){const B=t.update(x);p.uniforms.shadow_pass.value=C.map.texture,p.uniforms.resolution.value=C.mapSize,p.uniforms.radius.value=C.radius,n.setRenderTarget(C.mapPass),n.clear(),n.renderBufferDirect(A,null,B,p,x,null),g.uniforms.shadow_pass.value=C.mapPass.texture,g.uniforms.resolution.value=C.mapSize,g.uniforms.radius.value=C.radius,n.setRenderTarget(C.map),n.clear(),n.renderBufferDirect(A,null,B,g,x,null)}function w(C,A,B){const Y=C<<0|A<<1|B<<2;let X=u[Y];return X===void 0&&(X=new or({depthPacking:bE,morphTargets:C,skinning:A}),u[Y]=X),X}function _(C,A,B){const Y=C<<0|A<<1|B<<2;let X=h[Y];return X===void 0&&(X=new lr({morphTargets:C,skinning:A}),h[Y]=X),X}function L(C,A,B,Y,X,st,V){let j=null,I=w,H=C.customDepthMaterial;if(Y.isPointLight===!0&&(I=_,H=C.customDistanceMaterial),H===void 0){let U=!1;B.morphTargets===!0&&(U=A.morphAttributes&&A.morphAttributes.position&&A.morphAttributes.position.length>0);let z=!1;C.isSkinnedMesh===!0&&(B.skinning===!0?z=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",C));const Q=C.isInstancedMesh===!0;j=I(U,z,Q)}else j=H;if(n.localClippingEnabled&&B.clipShadows===!0&&B.clippingPlanes.length!==0){const U=j.uuid,z=B.uuid;let Q=d[U];Q===void 0&&(Q={},d[U]=Q);let $=Q[z];$===void 0&&($=j.clone(),Q[z]=$),j=$}return j.visible=B.visible,j.wireframe=B.wireframe,V===nc?j.side=B.shadowSide!==null?B.shadowSide:B.side:j.side=B.shadowSide!==null?B.shadowSide:m[B.side],j.clipShadows=B.clipShadows,j.clippingPlanes=B.clippingPlanes,j.clipIntersection=B.clipIntersection,j.wireframeLinewidth=B.wireframeLinewidth,j.linewidth=B.linewidth,Y.isPointLight===!0&&j.isMeshDistanceMaterial===!0&&(j.referencePosition.setFromMatrixPosition(Y.matrixWorld),j.nearDistance=X,j.farDistance=st),j}function R(C,A,B,Y,X){if(C.visible===!1)return;if(C.layers.test(A.layers)&&(C.isMesh||C.isLine||C.isPoints)&&(C.castShadow||C.receiveShadow&&X===nc)&&(!C.frustumCulled||i.intersectsObject(C))){C.modelViewMatrix.multiplyMatrices(B.matrixWorldInverse,C.matrixWorld);const j=t.update(C),I=C.material;if(Array.isArray(I)){const H=j.groups;for(let U=0,z=H.length;U<z;U++){const Q=H[U],$=I[Q.materialIndex];if($&&$.visible){const it=L(C,j,$,Y,B.near,B.far,X);n.renderBufferDirect(B,null,j,it,C,Q)}}}else if(I.visible){const H=L(C,j,I,Y,B.near,B.far,X);n.renderBufferDirect(B,null,j,H,C,null)}}const V=C.children;for(let j=0,I=V.length;j<I;j++)R(V[j],A,B,Y,X)}}function B3(n,t,e){const i=e.isWebGL2;function a(){let J=!1;const Mt=new Le;let Nt=null;const Ot=new Le(0,0,0,0);return{setMask:function(Tt){Nt!==Tt&&!J&&(n.colorMask(Tt,Tt,Tt,Tt),Nt=Tt)},setLocked:function(Tt){J=Tt},setClear:function(Tt,W,St,Pt,At){At===!0&&(Tt*=Pt,W*=Pt,St*=Pt),Mt.set(Tt,W,St,Pt),Ot.equals(Mt)===!1&&(n.clearColor(Tt,W,St,Pt),Ot.copy(Mt))},reset:function(){J=!1,Nt=null,Ot.set(-1,0,0,0)}}}function o(){let J=!1,Mt=null,Nt=null,Ot=null;return{setTest:function(Tt){Tt?ct(2929):D(2929)},setMask:function(Tt){Mt!==Tt&&!J&&(n.depthMask(Tt),Mt=Tt)},setFunc:function(Tt){if(Nt!==Tt){if(Tt)switch(Tt){case iS:n.depthFunc(512);break;case sS:n.depthFunc(519);break;case aS:n.depthFunc(513);break;case om:n.depthFunc(515);break;case rS:n.depthFunc(514);break;case oS:n.depthFunc(518);break;case lS:n.depthFunc(516);break;case cS:n.depthFunc(517);break;default:n.depthFunc(515)}else n.depthFunc(515);Nt=Tt}},setLocked:function(Tt){J=Tt},setClear:function(Tt){Ot!==Tt&&(n.clearDepth(Tt),Ot=Tt)},reset:function(){J=!1,Mt=null,Nt=null,Ot=null}}}function c(){let J=!1,Mt=null,Nt=null,Ot=null,Tt=null,W=null,St=null,Pt=null,At=null;return{setTest:function(Vt){J||(Vt?ct(2960):D(2960))},setMask:function(Vt){Mt!==Vt&&!J&&(n.stencilMask(Vt),Mt=Vt)},setFunc:function(Vt,ye,Qe){(Nt!==Vt||Ot!==ye||Tt!==Qe)&&(n.stencilFunc(Vt,ye,Qe),Nt=Vt,Ot=ye,Tt=Qe)},setOp:function(Vt,ye,Qe){(W!==Vt||St!==ye||Pt!==Qe)&&(n.stencilOp(Vt,ye,Qe),W=Vt,St=ye,Pt=Qe)},setLocked:function(Vt){J=Vt},setClear:function(Vt){At!==Vt&&(n.clearStencil(Vt),At=Vt)},reset:function(){J=!1,Mt=null,Nt=null,Ot=null,Tt=null,W=null,St=null,Pt=null,At=null}}}const u=new a,h=new o,d=new c;let m={},p=null,g=null,v=null,x=null,M=null,S=null,w=null,_=null,L=null,R=!1,C=null,A=null,B=null,Y=null,X=null;const st=n.getParameter(35661);let V=!1,j=0;const I=n.getParameter(7938);I.indexOf("WebGL")!==-1?(j=parseFloat(/^WebGL (\d)/.exec(I)[1]),V=j>=1):I.indexOf("OpenGL ES")!==-1&&(j=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),V=j>=2);let H=null,U={};const z=new Le,Q=new Le;function $(J,Mt,Nt){const Ot=new Uint8Array(4),Tt=n.createTexture();n.bindTexture(J,Tt),n.texParameteri(J,10241,9728),n.texParameteri(J,10240,9728);for(let W=0;W<Nt;W++)n.texImage2D(Mt+W,0,6408,1,1,0,6408,5121,Ot);return Tt}const it={};it[3553]=$(3553,3553,1),it[34067]=$(34067,34069,6),u.setClear(0,0,0,1),h.setClear(1),d.setClear(0),ct(2929),h.setFunc(om),bt(!1),Ht(ox),ct(2884),tt(sc);function ct(J){m[J]!==!0&&(n.enable(J),m[J]=!0)}function D(J){m[J]!==!1&&(n.disable(J),m[J]=!1)}function q(J){return p!==J?(n.useProgram(J),p=J,!0):!1}const ut={[vo]:32774,[qM]:32778,[YM]:32779};if(i)ut[hx]=32775,ut[fx]=32776;else{const J=t.get("EXT_blend_minmax");J!==null&&(ut[hx]=J.MIN_EXT,ut[fx]=J.MAX_EXT)}const yt={[XM]:0,[ZM]:1,[QM]:768,[__]:770,[nS]:776,[tS]:774,[KM]:772,[JM]:769,[w_]:771,[eS]:775,[$M]:773};function tt(J,Mt,Nt,Ot,Tt,W,St,Pt){if(J===sc){g&&(D(3042),g=!1);return}if(g||(ct(3042),g=!0),J!==jM){if(J!==v||Pt!==R){if((x!==vo||w!==vo)&&(n.blendEquation(32774),x=vo,w=vo),Pt)switch(J){case ac:n.blendFuncSeparate(1,771,1,771);break;case lx:n.blendFunc(1,1);break;case cx:n.blendFuncSeparate(0,0,769,771);break;case ux:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}else switch(J){case ac:n.blendFuncSeparate(770,771,1,771);break;case lx:n.blendFunc(770,1);break;case cx:n.blendFunc(0,769);break;case ux:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}M=null,S=null,_=null,L=null,v=J,R=Pt}return}Tt=Tt||Mt,W=W||Nt,St=St||Ot,(Mt!==x||Tt!==w)&&(n.blendEquationSeparate(ut[Mt],ut[Tt]),x=Mt,w=Tt),(Nt!==M||Ot!==S||W!==_||St!==L)&&(n.blendFuncSeparate(yt[Nt],yt[Ot],yt[W],yt[St]),M=Nt,S=Ot,_=W,L=St),v=J,R=null}function Ct(J,Mt){J.side===zo?D(2884):ct(2884);let Nt=J.side===_n;Mt&&(Nt=!Nt),bt(Nt),J.blending===ac&&J.transparent===!1?tt(sc):tt(J.blending,J.blendEquation,J.blendSrc,J.blendDst,J.blendEquationAlpha,J.blendSrcAlpha,J.blendDstAlpha,J.premultipliedAlpha),h.setFunc(J.depthFunc),h.setTest(J.depthTest),h.setMask(J.depthWrite),u.setMask(J.colorWrite);const Ot=J.stencilWrite;d.setTest(Ot),Ot&&(d.setMask(J.stencilWriteMask),d.setFunc(J.stencilFunc,J.stencilRef,J.stencilFuncMask),d.setOp(J.stencilFail,J.stencilZFail,J.stencilZPass)),Qt(J.polygonOffset,J.polygonOffsetFactor,J.polygonOffsetUnits)}function bt(J){C!==J&&(J?n.frontFace(2304):n.frontFace(2305),C=J)}function Ht(J){J!==kM?(ct(2884),J!==A&&(J===ox?n.cullFace(1029):J===WM?n.cullFace(1028):n.cullFace(1032))):D(2884),A=J}function Lt(J){J!==B&&(V&&n.lineWidth(J),B=J)}function Qt(J,Mt,Nt){J?(ct(32823),(Y!==Mt||X!==Nt)&&(n.polygonOffset(Mt,Nt),Y=Mt,X=Nt)):D(32823)}function kt(J){J?ct(3089):D(3089)}function vt(J){J===void 0&&(J=33984+st-1),H!==J&&(n.activeTexture(J),H=J)}function Et(J,Mt){H===null&&vt();let Nt=U[H];Nt===void 0&&(Nt={type:void 0,texture:void 0},U[H]=Nt),(Nt.type!==J||Nt.texture!==Mt)&&(n.bindTexture(J,Mt||it[J]),Nt.type=J,Nt.texture=Mt)}function wt(){const J=U[H];J!==void 0&&J.type!==void 0&&(n.bindTexture(J.type,null),J.type=void 0,J.texture=void 0)}function Ft(){try{n.compressedTexImage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Rt(){try{n.texImage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function F(){try{n.texImage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function O(J){z.equals(J)===!1&&(n.scissor(J.x,J.y,J.z,J.w),z.copy(J))}function _t(J){Q.equals(J)===!1&&(n.viewport(J.x,J.y,J.z,J.w),Q.copy(J))}function xt(){m={},H=null,U={},p=null,g=null,v=null,x=null,M=null,S=null,w=null,_=null,L=null,R=!1,C=null,A=null,B=null,Y=null,X=null,u.reset(),h.reset(),d.reset()}return{buffers:{color:u,depth:h,stencil:d},enable:ct,disable:D,useProgram:q,setBlending:tt,setMaterial:Ct,setFlipSided:bt,setCullFace:Ht,setLineWidth:Lt,setPolygonOffset:Qt,setScissorTest:kt,activeTexture:vt,bindTexture:Et,unbindTexture:wt,compressedTexImage2D:Ft,texImage2D:Rt,texImage3D:F,scissor:O,viewport:_t,reset:xt}}function D3(n,t,e,i,a,o,c){const u=a.isWebGL2,h=a.maxTextures,d=a.maxCubemapSize,m=a.maxTextureSize,p=a.maxSamples,g=new WeakMap;let v,x=!1;try{x=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function M(F,O){return x?new OffscreenCanvas(F,O):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function S(F,O,_t,xt){let J=1;if((F.width>xt||F.height>xt)&&(J=xt/Math.max(F.width,F.height)),J<1||O===!0)if(typeof HTMLImageElement<"u"&&F instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&F instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&F instanceof ImageBitmap){const Mt=O?ne.floorPowerOfTwo:Math.floor,Nt=Mt(J*F.width),Ot=Mt(J*F.height);v===void 0&&(v=M(Nt,Ot));const Tt=_t?M(Nt,Ot):v;return Tt.width=Nt,Tt.height=Ot,Tt.getContext("2d").drawImage(F,0,0,Nt,Ot),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+F.width+"x"+F.height+") to ("+Nt+"x"+Ot+")."),Tt}else return"data"in F&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+F.width+"x"+F.height+")."),F;return F}function w(F){return ne.isPowerOfTwo(F.width)&&ne.isPowerOfTwo(F.height)}function _(F){return u?!1:F.wrapS!==Kn||F.wrapT!==Kn||F.minFilter!==Rn&&F.minFilter!==En}function L(F,O){return F.generateMipmaps&&O&&F.minFilter!==Rn&&F.minFilter!==En}function R(F,O,_t,xt){n.generateMipmap(F);const J=i.get(O);J.__maxMipLevel=Math.log(Math.max(_t,xt))*Math.LOG2E}function C(F,O,_t){if(u===!1)return O;if(F!==null){if(n[F]!==void 0)return n[F];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+F+"'")}let xt=O;return O===6403&&(_t===5126&&(xt=33326),_t===5131&&(xt=33325),_t===5121&&(xt=33321)),O===6407&&(_t===5126&&(xt=34837),_t===5131&&(xt=34843),_t===5121&&(xt=32849)),O===6408&&(_t===5126&&(xt=34836),_t===5131&&(xt=34842),_t===5121&&(xt=32856)),(xt===33325||xt===33326||xt===34842||xt===34836)&&t.get("EXT_color_buffer_float"),xt}function A(F){return F===Rn||F===mx||F===gx?9728:9729}function B(F){const O=F.target;O.removeEventListener("dispose",B),X(O),O.isVideoTexture&&g.delete(O),c.memory.textures--}function Y(F){const O=F.target;O.removeEventListener("dispose",Y),st(O),c.memory.textures--}function X(F){const O=i.get(F);O.__webglInit!==void 0&&(n.deleteTexture(O.__webglTexture),i.remove(F))}function st(F){const O=i.get(F),_t=i.get(F.texture);if(F){if(_t.__webglTexture!==void 0&&n.deleteTexture(_t.__webglTexture),F.depthTexture&&F.depthTexture.dispose(),F.isWebGLCubeRenderTarget)for(let xt=0;xt<6;xt++)n.deleteFramebuffer(O.__webglFramebuffer[xt]),O.__webglDepthbuffer&&n.deleteRenderbuffer(O.__webglDepthbuffer[xt]);else n.deleteFramebuffer(O.__webglFramebuffer),O.__webglDepthbuffer&&n.deleteRenderbuffer(O.__webglDepthbuffer),O.__webglMultisampledFramebuffer&&n.deleteFramebuffer(O.__webglMultisampledFramebuffer),O.__webglColorRenderbuffer&&n.deleteRenderbuffer(O.__webglColorRenderbuffer),O.__webglDepthRenderbuffer&&n.deleteRenderbuffer(O.__webglDepthRenderbuffer);i.remove(F.texture),i.remove(F)}}let V=0;function j(){V=0}function I(){const F=V;return F>=h&&console.warn("THREE.WebGLTextures: Trying to use "+F+" texture units while this GPU supports only "+h),V+=1,F}function H(F,O){const _t=i.get(F);if(F.isVideoTexture&&vt(F),F.version>0&&_t.__version!==F.version){const xt=F.image;if(xt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(xt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{q(_t,F,O);return}}e.activeTexture(33984+O),e.bindTexture(3553,_t.__webglTexture)}function U(F,O){const _t=i.get(F);if(F.version>0&&_t.__version!==F.version){q(_t,F,O);return}e.activeTexture(33984+O),e.bindTexture(35866,_t.__webglTexture)}function z(F,O){const _t=i.get(F);if(F.version>0&&_t.__version!==F.version){q(_t,F,O);return}e.activeTexture(33984+O),e.bindTexture(32879,_t.__webglTexture)}function Q(F,O){const _t=i.get(F);if(F.version>0&&_t.__version!==F.version){ut(_t,F,O);return}e.activeTexture(33984+O),e.bindTexture(34067,_t.__webglTexture)}const $={[lm]:10497,[Kn]:33071,[cm]:33648},it={[Rn]:9728,[mx]:9984,[gx]:9986,[En]:9729,[yS]:9985,[Qh]:9987};function ct(F,O,_t){_t?(n.texParameteri(F,10242,$[O.wrapS]),n.texParameteri(F,10243,$[O.wrapT]),(F===32879||F===35866)&&n.texParameteri(F,32882,$[O.wrapR]),n.texParameteri(F,10240,it[O.magFilter]),n.texParameteri(F,10241,it[O.minFilter])):(n.texParameteri(F,10242,33071),n.texParameteri(F,10243,33071),(F===32879||F===35866)&&n.texParameteri(F,32882,33071),(O.wrapS!==Kn||O.wrapT!==Kn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(F,10240,A(O.magFilter)),n.texParameteri(F,10241,A(O.minFilter)),O.minFilter!==Rn&&O.minFilter!==En&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const xt=t.get("EXT_texture_filter_anisotropic");if(xt){if(O.type===ma&&t.get("OES_texture_float_linear")===null||O.type===Oh&&(u||t.get("OES_texture_half_float_linear"))===null)return;(O.anisotropy>1||i.get(O).__currentAnisotropy)&&(n.texParameterf(F,xt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(O.anisotropy,a.getMaxAnisotropy())),i.get(O).__currentAnisotropy=O.anisotropy)}}function D(F,O){F.__webglInit===void 0&&(F.__webglInit=!0,O.addEventListener("dispose",B),F.__webglTexture=n.createTexture(),c.memory.textures++)}function q(F,O,_t){let xt=3553;O.isDataTexture2DArray&&(xt=35866),O.isDataTexture3D&&(xt=32879),D(F,O),e.activeTexture(33984+_t),e.bindTexture(xt,F.__webglTexture),n.pixelStorei(37440,O.flipY),n.pixelStorei(37441,O.premultiplyAlpha),n.pixelStorei(3317,O.unpackAlignment);const J=_(O)&&w(O.image)===!1,Mt=S(O.image,J,!1,m),Nt=w(Mt)||u,Ot=o.convert(O.format);let Tt=o.convert(O.type),W=C(O.internalFormat,Ot,Tt);ct(xt,O,Nt);let St;const Pt=O.mipmaps;if(O.isDepthTexture)W=6402,u?O.type===ma?W=36012:O.type===zh?W=33190:O.type===oc?W=35056:W=33189:O.type===ma&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),O.format===Lo&&W===6402&&O.type!==Dh&&O.type!==zh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),O.type=Dh,Tt=o.convert(O.type)),O.format===dc&&W===6402&&(W=34041,O.type!==oc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),O.type=oc,Tt=o.convert(O.type))),e.texImage2D(3553,0,W,Mt.width,Mt.height,0,Ot,Tt,null);else if(O.isDataTexture)if(Pt.length>0&&Nt){for(let At=0,Vt=Pt.length;At<Vt;At++)St=Pt[At],e.texImage2D(3553,At,W,St.width,St.height,0,Ot,Tt,St.data);O.generateMipmaps=!1,F.__maxMipLevel=Pt.length-1}else e.texImage2D(3553,0,W,Mt.width,Mt.height,0,Ot,Tt,Mt.data),F.__maxMipLevel=0;else if(O.isCompressedTexture){for(let At=0,Vt=Pt.length;At<Vt;At++)St=Pt[At],O.format!==zi&&O.format!==sr?Ot!==null?e.compressedTexImage2D(3553,At,W,St.width,St.height,0,St.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):e.texImage2D(3553,At,W,St.width,St.height,0,Ot,Tt,St.data);F.__maxMipLevel=Pt.length-1}else if(O.isDataTexture2DArray)e.texImage3D(35866,0,W,Mt.width,Mt.height,Mt.depth,0,Ot,Tt,Mt.data),F.__maxMipLevel=0;else if(O.isDataTexture3D)e.texImage3D(32879,0,W,Mt.width,Mt.height,Mt.depth,0,Ot,Tt,Mt.data),F.__maxMipLevel=0;else if(Pt.length>0&&Nt){for(let At=0,Vt=Pt.length;At<Vt;At++)St=Pt[At],e.texImage2D(3553,At,W,Ot,Tt,St);O.generateMipmaps=!1,F.__maxMipLevel=Pt.length-1}else e.texImage2D(3553,0,W,Ot,Tt,Mt),F.__maxMipLevel=0;L(O,Nt)&&R(xt,O,Mt.width,Mt.height),F.__version=O.version,O.onUpdate&&O.onUpdate(O)}function ut(F,O,_t){if(O.image.length!==6)return;D(F,O),e.activeTexture(33984+_t),e.bindTexture(34067,F.__webglTexture),n.pixelStorei(37440,O.flipY);const xt=O&&(O.isCompressedTexture||O.image[0].isCompressedTexture),J=O.image[0]&&O.image[0].isDataTexture,Mt=[];for(let At=0;At<6;At++)!xt&&!J?Mt[At]=S(O.image[At],!1,!0,d):Mt[At]=J?O.image[At].image:O.image[At];const Nt=Mt[0],Ot=w(Nt)||u,Tt=o.convert(O.format),W=o.convert(O.type),St=C(O.internalFormat,Tt,W);ct(34067,O,Ot);let Pt;if(xt){for(let At=0;At<6;At++){Pt=Mt[At].mipmaps;for(let Vt=0;Vt<Pt.length;Vt++){const ye=Pt[Vt];O.format!==zi&&O.format!==sr?Tt!==null?e.compressedTexImage2D(34069+At,Vt,St,ye.width,ye.height,0,ye.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):e.texImage2D(34069+At,Vt,St,ye.width,ye.height,0,Tt,W,ye.data)}}F.__maxMipLevel=Pt.length-1}else{Pt=O.mipmaps;for(let At=0;At<6;At++)if(J){e.texImage2D(34069+At,0,St,Mt[At].width,Mt[At].height,0,Tt,W,Mt[At].data);for(let Vt=0;Vt<Pt.length;Vt++){const Qe=Pt[Vt].image[At].image;e.texImage2D(34069+At,Vt+1,St,Qe.width,Qe.height,0,Tt,W,Qe.data)}}else{e.texImage2D(34069+At,0,St,Tt,W,Mt[At]);for(let Vt=0;Vt<Pt.length;Vt++){const ye=Pt[Vt];e.texImage2D(34069+At,Vt+1,St,Tt,W,ye.image[At])}}F.__maxMipLevel=Pt.length}L(O,Ot)&&R(34067,O,Nt.width,Nt.height),F.__version=O.version,O.onUpdate&&O.onUpdate(O)}function yt(F,O,_t,xt){const J=o.convert(O.texture.format),Mt=o.convert(O.texture.type),Nt=C(O.texture.internalFormat,J,Mt);e.texImage2D(xt,0,Nt,O.width,O.height,0,J,Mt,null),n.bindFramebuffer(36160,F),n.framebufferTexture2D(36160,_t,xt,i.get(O.texture).__webglTexture,0),n.bindFramebuffer(36160,null)}function tt(F,O,_t){if(n.bindRenderbuffer(36161,F),O.depthBuffer&&!O.stencilBuffer){let xt=33189;if(_t){const J=O.depthTexture;J&&J.isDepthTexture&&(J.type===ma?xt=36012:J.type===zh&&(xt=33190));const Mt=kt(O);n.renderbufferStorageMultisample(36161,Mt,xt,O.width,O.height)}else n.renderbufferStorage(36161,xt,O.width,O.height);n.framebufferRenderbuffer(36160,36096,36161,F)}else if(O.depthBuffer&&O.stencilBuffer){if(_t){const xt=kt(O);n.renderbufferStorageMultisample(36161,xt,35056,O.width,O.height)}else n.renderbufferStorage(36161,34041,O.width,O.height);n.framebufferRenderbuffer(36160,33306,36161,F)}else{const xt=o.convert(O.texture.format),J=o.convert(O.texture.type),Mt=C(O.texture.internalFormat,xt,J);if(_t){const Nt=kt(O);n.renderbufferStorageMultisample(36161,Nt,Mt,O.width,O.height)}else n.renderbufferStorage(36161,Mt,O.width,O.height)}n.bindRenderbuffer(36161,null)}function Ct(F,O){if(O&&O.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,F),!(O.depthTexture&&O.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(O.depthTexture).__webglTexture||O.depthTexture.image.width!==O.width||O.depthTexture.image.height!==O.height)&&(O.depthTexture.image.width=O.width,O.depthTexture.image.height=O.height,O.depthTexture.needsUpdate=!0),H(O.depthTexture,0);const xt=i.get(O.depthTexture).__webglTexture;if(O.depthTexture.format===Lo)n.framebufferTexture2D(36160,36096,3553,xt,0);else if(O.depthTexture.format===dc)n.framebufferTexture2D(36160,33306,3553,xt,0);else throw new Error("Unknown depthTexture format")}function bt(F){const O=i.get(F),_t=F.isWebGLCubeRenderTarget===!0;if(F.depthTexture){if(_t)throw new Error("target.depthTexture not supported in Cube render targets");Ct(O.__webglFramebuffer,F)}else if(_t){O.__webglDepthbuffer=[];for(let xt=0;xt<6;xt++)n.bindFramebuffer(36160,O.__webglFramebuffer[xt]),O.__webglDepthbuffer[xt]=n.createRenderbuffer(),tt(O.__webglDepthbuffer[xt],F,!1)}else n.bindFramebuffer(36160,O.__webglFramebuffer),O.__webglDepthbuffer=n.createRenderbuffer(),tt(O.__webglDepthbuffer,F,!1);n.bindFramebuffer(36160,null)}function Ht(F){const O=i.get(F),_t=i.get(F.texture);F.addEventListener("dispose",Y),_t.__webglTexture=n.createTexture(),c.memory.textures++;const xt=F.isWebGLCubeRenderTarget===!0,J=F.isWebGLMultisampleRenderTarget===!0,Mt=w(F)||u;if(u&&F.texture.format===sr&&(F.texture.type===ma||F.texture.type===Oh)&&(F.texture.format=zi,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),xt){O.__webglFramebuffer=[];for(let Nt=0;Nt<6;Nt++)O.__webglFramebuffer[Nt]=n.createFramebuffer()}else if(O.__webglFramebuffer=n.createFramebuffer(),J)if(u){O.__webglMultisampledFramebuffer=n.createFramebuffer(),O.__webglColorRenderbuffer=n.createRenderbuffer(),n.bindRenderbuffer(36161,O.__webglColorRenderbuffer);const Nt=o.convert(F.texture.format),Ot=o.convert(F.texture.type),Tt=C(F.texture.internalFormat,Nt,Ot),W=kt(F);n.renderbufferStorageMultisample(36161,W,Tt,F.width,F.height),n.bindFramebuffer(36160,O.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064,36161,O.__webglColorRenderbuffer),n.bindRenderbuffer(36161,null),F.depthBuffer&&(O.__webglDepthRenderbuffer=n.createRenderbuffer(),tt(O.__webglDepthRenderbuffer,F,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(xt){e.bindTexture(34067,_t.__webglTexture),ct(34067,F.texture,Mt);for(let Nt=0;Nt<6;Nt++)yt(O.__webglFramebuffer[Nt],F,36064,34069+Nt);L(F.texture,Mt)&&R(34067,F.texture,F.width,F.height),e.bindTexture(34067,null)}else e.bindTexture(3553,_t.__webglTexture),ct(3553,F.texture,Mt),yt(O.__webglFramebuffer,F,36064,3553),L(F.texture,Mt)&&R(3553,F.texture,F.width,F.height),e.bindTexture(3553,null);F.depthBuffer&&bt(F)}function Lt(F){const O=F.texture,_t=w(F)||u;if(L(O,_t)){const xt=F.isWebGLCubeRenderTarget?34067:3553,J=i.get(O).__webglTexture;e.bindTexture(xt,J),R(xt,O,F.width,F.height),e.bindTexture(xt,null)}}function Qt(F){if(F.isWebGLMultisampleRenderTarget)if(u){const O=i.get(F);n.bindFramebuffer(36008,O.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,O.__webglFramebuffer);const _t=F.width,xt=F.height;let J=16384;F.depthBuffer&&(J|=256),F.stencilBuffer&&(J|=1024),n.blitFramebuffer(0,0,_t,xt,0,0,_t,xt,J,9728),n.bindFramebuffer(36160,O.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function kt(F){return u&&F.isWebGLMultisampleRenderTarget?Math.min(p,F.samples):0}function vt(F){const O=c.render.frame;g.get(F)!==O&&(g.set(F,O),F.update())}let Et=!1,wt=!1;function Ft(F,O){F&&F.isWebGLRenderTarget&&(Et===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Et=!0),F=F.texture),H(F,O)}function Rt(F,O){F&&F.isWebGLCubeRenderTarget&&(wt===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),wt=!0),F=F.texture),Q(F,O)}this.allocateTextureUnit=I,this.resetTextureUnits=j,this.setTexture2D=H,this.setTexture2DArray=U,this.setTexture3D=z,this.setTextureCube=Q,this.setupRenderTarget=Ht,this.updateRenderTargetMipmap=Lt,this.updateMultisampleRenderTarget=Qt,this.safeSetTexture2D=Ft,this.safeSetTextureCube=Rt}function O3(n,t,e){const i=e.isWebGL2;function a(o){let c;if(o===Km)return 5121;if(o===_S)return 32819;if(o===wS)return 32820;if(o===MS)return 33635;if(o===vS)return 5120;if(o===xS)return 5122;if(o===Dh)return 5123;if(o===bS)return 5124;if(o===zh)return 5125;if(o===ma)return 5126;if(o===Oh)return i?5131:(c=t.get("OES_texture_half_float"),c!==null?c.HALF_FLOAT_OES:null);if(o===SS)return 6406;if(o===sr)return 6407;if(o===zi)return 6408;if(o===ES)return 6409;if(o===TS)return 6410;if(o===Lo)return 6402;if(o===dc)return 34041;if(o===AS)return 6403;if(o===CS)return 36244;if(o===LS)return 33319;if(o===RS)return 33320;if(o===NS)return 36248;if(o===zS)return 36249;if(o===yx||o===vx||o===xx||o===bx)if(c=t.get("WEBGL_compressed_texture_s3tc"),c!==null){if(o===yx)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===vx)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===xx)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===bx)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===_x||o===wx||o===Mx||o===Sx)if(c=t.get("WEBGL_compressed_texture_pvrtc"),c!==null){if(o===_x)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===wx)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===Mx)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===Sx)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===BS)return c=t.get("WEBGL_compressed_texture_etc1"),c!==null?c.COMPRESSED_RGB_ETC1_WEBGL:null;if((o===Ex||o===Tx)&&(c=t.get("WEBGL_compressed_texture_etc"),c!==null)){if(o===Ex)return c.COMPRESSED_RGB8_ETC2;if(o===Tx)return c.COMPRESSED_RGBA8_ETC2_EAC}if(o===DS||o===OS||o===PS||o===US||o===IS||o===FS||o===HS||o===GS||o===VS||o===kS||o===WS||o===jS||o===qS||o===YS||o===ZS||o===QS||o===JS||o===KS||o===$S||o===tE||o===eE||o===nE||o===iE||o===sE||o===aE||o===rE||o===oE||o===lE)return c=t.get("WEBGL_compressed_texture_astc"),c!==null?o:null;if(o===XS)return c=t.get("EXT_texture_compression_bptc"),c!==null?o:null;if(o===oc)return i?34042:(c=t.get("WEBGL_depth_texture"),c!==null?c.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:a}}function ym(n=[]){on.call(this),this.cameras=n}ym.prototype=Object.assign(Object.create(on.prototype),{constructor:ym,isArrayCamera:!0});function Eo(){Xt.call(this),this.type="Group"}Eo.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Eo,isGroup:!0});function cc(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(cc.prototype,{constructor:cc,getHandSpace:function(){if(this._hand===null&&(this._hand=new Eo,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let n=0;n<=window.XRHand.LITTLE_PHALANX_TIP;n++){const t=new Eo;t.matrixAutoUpdate=!1,t.visible=!1,this._hand.joints.push(t),this._hand.add(t)}return this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Eo,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Eo,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(n){return this._targetRay!==null&&this._targetRay.dispatchEvent(n),this._grip!==null&&this._grip.dispatchEvent(n),this._hand!==null&&this._hand.dispatchEvent(n),this},disconnect:function(n){return this.dispatchEvent({type:"disconnected",data:n}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(n,t,e){let i=null,a=null,o=null;const c=this._targetRay,u=this._grip,h=this._hand;if(n&&t.session.visibilityState!=="visible-blurred")if(h&&n.hand){o=!0;for(let d=0;d<=window.XRHand.LITTLE_PHALANX_TIP;d++)if(n.hand[d]){const m=t.getJointPose(n.hand[d],e),p=h.joints[d];m!==null&&(p.matrix.fromArray(m.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.jointRadius=m.radius),p.visible=m!==null;const g=h.joints[window.XRHand.INDEX_PHALANX_TIP],v=h.joints[window.XRHand.THUMB_PHALANX_TIP],x=g.position.distanceTo(v.position),M=.02,S=.005;h.inputState.pinching&&x>M+S?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:n.handedness,target:this})):!h.inputState.pinching&&x<=M-S&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:n.handedness,target:this}))}}else c!==null&&(i=t.getPose(n.targetRaySpace,e),i!==null&&(c.matrix.fromArray(i.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale))),u!==null&&n.gripSpace&&(a=t.getPose(n.gripSpace,e),a!==null&&(u.matrix.fromArray(a.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale)));return c!==null&&(c.visible=i!==null),u!==null&&(u.visible=a!==null),h!==null&&(h.visible=o!==null),this}});function F_(n,t){const e=this;let i=null,a=1,o=null,c="local-floor",u=null;const h=[],d=new Map,m=new on;m.layers.enable(1),m.viewport=new Le;const p=new on;p.layers.enable(2),p.viewport=new Le;const g=[m,p],v=new ym;v.layers.enable(1),v.layers.enable(2);let x=null,M=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(V){let j=h[V];return j===void 0&&(j=new cc,h[V]=j),j.getTargetRaySpace()},this.getControllerGrip=function(V){let j=h[V];return j===void 0&&(j=new cc,h[V]=j),j.getGripSpace()},this.getHand=function(V){let j=h[V];return j===void 0&&(j=new cc,h[V]=j),j.getHandSpace()};function S(V){const j=d.get(V.inputSource);j&&j.dispatchEvent({type:V.type,data:V.inputSource})}function w(){d.forEach(function(V,j){V.disconnect(j)}),d.clear(),n.setFramebuffer(null),n.setRenderTarget(n.getRenderTarget()),st.stop(),e.isPresenting=!1,e.dispatchEvent({type:"sessionend"})}function _(V){o=V,st.setContext(i),st.start(),e.isPresenting=!0,e.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(V){a=V,e.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(V){c=V,e.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getSession=function(){return i},this.setSession=function(V){if(i=V,i!==null){i.addEventListener("select",S),i.addEventListener("selectstart",S),i.addEventListener("selectend",S),i.addEventListener("squeeze",S),i.addEventListener("squeezestart",S),i.addEventListener("squeezeend",S),i.addEventListener("end",w);const j=t.getContextAttributes();j.xrCompatible!==!0&&t.makeXRCompatible();const I={antialias:j.antialias,alpha:j.alpha,depth:j.depth,stencil:j.stencil,framebufferScaleFactor:a},H=new XRWebGLLayer(i,t,I);i.updateRenderState({baseLayer:H}),i.requestReferenceSpace(c).then(_),i.addEventListener("inputsourceschange",L)}};function L(V){const j=i.inputSources;for(let I=0;I<h.length;I++)d.set(j[I],h[I]);for(let I=0;I<V.removed.length;I++){const H=V.removed[I],U=d.get(H);U&&(U.dispatchEvent({type:"disconnected",data:H}),d.delete(H))}for(let I=0;I<V.added.length;I++){const H=V.added[I],U=d.get(H);U&&U.dispatchEvent({type:"connected",data:H})}}const R=new G,C=new G;function A(V,j,I){R.setFromMatrixPosition(j.matrixWorld),C.setFromMatrixPosition(I.matrixWorld);const H=R.distanceTo(C),U=j.projectionMatrix.elements,z=I.projectionMatrix.elements,Q=U[14]/(U[10]-1),$=U[14]/(U[10]+1),it=(U[9]+1)/U[5],ct=(U[9]-1)/U[5],D=(U[8]-1)/U[0],q=(z[8]+1)/z[0],ut=Q*D,yt=Q*q,tt=H/(-D+q),Ct=tt*-D;j.matrixWorld.decompose(V.position,V.quaternion,V.scale),V.translateX(Ct),V.translateZ(tt),V.matrixWorld.compose(V.position,V.quaternion,V.scale),V.matrixWorldInverse.copy(V.matrixWorld).invert();const bt=Q+tt,Ht=$+tt,Lt=ut-Ct,Qt=yt+(H-Ct),kt=it*$/Ht*bt,vt=ct*$/Ht*bt;V.projectionMatrix.makePerspective(Lt,Qt,kt,vt,bt,Ht)}function B(V,j){j===null?V.matrixWorld.copy(V.matrix):V.matrixWorld.multiplyMatrices(j.matrixWorld,V.matrix),V.matrixWorldInverse.copy(V.matrixWorld).invert()}this.getCamera=function(V){v.near=p.near=m.near=V.near,v.far=p.far=m.far=V.far,(x!==v.near||M!==v.far)&&(i.updateRenderState({depthNear:v.near,depthFar:v.far}),x=v.near,M=v.far);const j=V.parent,I=v.cameras;B(v,j);for(let U=0;U<I.length;U++)B(I[U],j);V.matrixWorld.copy(v.matrixWorld);const H=V.children;for(let U=0,z=H.length;U<z;U++)H[U].updateMatrixWorld(!0);return I.length===2?A(v,m,p):v.projectionMatrix.copy(m.projectionMatrix),v};let Y=null;function X(V,j){if(u=j.getViewerPose(o),u!==null){const H=u.views,U=i.renderState.baseLayer;n.setFramebuffer(U.framebuffer);let z=!1;H.length!==v.cameras.length&&(v.cameras.length=0,z=!0);for(let Q=0;Q<H.length;Q++){const $=H[Q],it=U.getViewport($),ct=g[Q];ct.matrix.fromArray($.transform.matrix),ct.projectionMatrix.fromArray($.projectionMatrix),ct.viewport.set(it.x,it.y,it.width,it.height),Q===0&&v.matrix.copy(ct.matrix),z===!0&&v.cameras.push(ct)}}const I=i.inputSources;for(let H=0;H<h.length;H++){const U=h[H],z=I[H];U.update(z,j,o)}Y&&Y(V,j)}const st=new L_;st.setAnimationLoop(X),this.setAnimationLoop=function(V){Y=V},this.dispose=function(){}}Object.assign(F_.prototype,Oi.prototype);function P3(n){function t(w,_){w.fogColor.value.copy(_.color),_.isFog?(w.fogNear.value=_.near,w.fogFar.value=_.far):_.isFogExp2&&(w.fogDensity.value=_.density)}function e(w,_,L,R){_.isMeshBasicMaterial?i(w,_):_.isMeshLambertMaterial?(i(w,_),h(w,_)):_.isMeshToonMaterial?(i(w,_),m(w,_)):_.isMeshPhongMaterial?(i(w,_),d(w,_)):_.isMeshStandardMaterial?(i(w,_),_.isMeshPhysicalMaterial?g(w,_):p(w,_)):_.isMeshMatcapMaterial?(i(w,_),v(w,_)):_.isMeshDepthMaterial?(i(w,_),x(w,_)):_.isMeshDistanceMaterial?(i(w,_),M(w,_)):_.isMeshNormalMaterial?(i(w,_),S(w,_)):_.isLineBasicMaterial?(a(w,_),_.isLineDashedMaterial&&o(w,_)):_.isPointsMaterial?c(w,_,L,R):_.isSpriteMaterial?u(w,_):_.isShadowMaterial?(w.color.value.copy(_.color),w.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}function i(w,_){w.opacity.value=_.opacity,_.color&&w.diffuse.value.copy(_.color),_.emissive&&w.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(w.map.value=_.map),_.alphaMap&&(w.alphaMap.value=_.alphaMap),_.specularMap&&(w.specularMap.value=_.specularMap);const L=n.get(_).envMap;if(L){w.envMap.value=L,w.flipEnvMap.value=L.isCubeTexture&&L._needsFlipEnvMap?-1:1,w.reflectivity.value=_.reflectivity,w.refractionRatio.value=_.refractionRatio;const A=n.get(L).__maxMipLevel;A!==void 0&&(w.maxMipLevel.value=A)}_.lightMap&&(w.lightMap.value=_.lightMap,w.lightMapIntensity.value=_.lightMapIntensity),_.aoMap&&(w.aoMap.value=_.aoMap,w.aoMapIntensity.value=_.aoMapIntensity);let R;_.map?R=_.map:_.specularMap?R=_.specularMap:_.displacementMap?R=_.displacementMap:_.normalMap?R=_.normalMap:_.bumpMap?R=_.bumpMap:_.roughnessMap?R=_.roughnessMap:_.metalnessMap?R=_.metalnessMap:_.alphaMap?R=_.alphaMap:_.emissiveMap?R=_.emissiveMap:_.clearcoatMap?R=_.clearcoatMap:_.clearcoatNormalMap?R=_.clearcoatNormalMap:_.clearcoatRoughnessMap&&(R=_.clearcoatRoughnessMap),R!==void 0&&(R.isWebGLRenderTarget&&(R=R.texture),R.matrixAutoUpdate===!0&&R.updateMatrix(),w.uvTransform.value.copy(R.matrix));let C;_.aoMap?C=_.aoMap:_.lightMap&&(C=_.lightMap),C!==void 0&&(C.isWebGLRenderTarget&&(C=C.texture),C.matrixAutoUpdate===!0&&C.updateMatrix(),w.uv2Transform.value.copy(C.matrix))}function a(w,_){w.diffuse.value.copy(_.color),w.opacity.value=_.opacity}function o(w,_){w.dashSize.value=_.dashSize,w.totalSize.value=_.dashSize+_.gapSize,w.scale.value=_.scale}function c(w,_,L,R){w.diffuse.value.copy(_.color),w.opacity.value=_.opacity,w.size.value=_.size*L,w.scale.value=R*.5,_.map&&(w.map.value=_.map),_.alphaMap&&(w.alphaMap.value=_.alphaMap);let C;_.map?C=_.map:_.alphaMap&&(C=_.alphaMap),C!==void 0&&(C.matrixAutoUpdate===!0&&C.updateMatrix(),w.uvTransform.value.copy(C.matrix))}function u(w,_){w.diffuse.value.copy(_.color),w.opacity.value=_.opacity,w.rotation.value=_.rotation,_.map&&(w.map.value=_.map),_.alphaMap&&(w.alphaMap.value=_.alphaMap);let L;_.map?L=_.map:_.alphaMap&&(L=_.alphaMap),L!==void 0&&(L.matrixAutoUpdate===!0&&L.updateMatrix(),w.uvTransform.value.copy(L.matrix))}function h(w,_){_.emissiveMap&&(w.emissiveMap.value=_.emissiveMap)}function d(w,_){w.specular.value.copy(_.specular),w.shininess.value=Math.max(_.shininess,1e-4),_.emissiveMap&&(w.emissiveMap.value=_.emissiveMap),_.bumpMap&&(w.bumpMap.value=_.bumpMap,w.bumpScale.value=_.bumpScale,_.side===_n&&(w.bumpScale.value*=-1)),_.normalMap&&(w.normalMap.value=_.normalMap,w.normalScale.value.copy(_.normalScale),_.side===_n&&w.normalScale.value.negate()),_.displacementMap&&(w.displacementMap.value=_.displacementMap,w.displacementScale.value=_.displacementScale,w.displacementBias.value=_.displacementBias)}function m(w,_){_.gradientMap&&(w.gradientMap.value=_.gradientMap),_.emissiveMap&&(w.emissiveMap.value=_.emissiveMap),_.bumpMap&&(w.bumpMap.value=_.bumpMap,w.bumpScale.value=_.bumpScale,_.side===_n&&(w.bumpScale.value*=-1)),_.normalMap&&(w.normalMap.value=_.normalMap,w.normalScale.value.copy(_.normalScale),_.side===_n&&w.normalScale.value.negate()),_.displacementMap&&(w.displacementMap.value=_.displacementMap,w.displacementScale.value=_.displacementScale,w.displacementBias.value=_.displacementBias)}function p(w,_){w.roughness.value=_.roughness,w.metalness.value=_.metalness,_.roughnessMap&&(w.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(w.metalnessMap.value=_.metalnessMap),_.emissiveMap&&(w.emissiveMap.value=_.emissiveMap),_.bumpMap&&(w.bumpMap.value=_.bumpMap,w.bumpScale.value=_.bumpScale,_.side===_n&&(w.bumpScale.value*=-1)),_.normalMap&&(w.normalMap.value=_.normalMap,w.normalScale.value.copy(_.normalScale),_.side===_n&&w.normalScale.value.negate()),_.displacementMap&&(w.displacementMap.value=_.displacementMap,w.displacementScale.value=_.displacementScale,w.displacementBias.value=_.displacementBias),n.get(_).envMap&&(w.envMapIntensity.value=_.envMapIntensity)}function g(w,_){p(w,_),w.reflectivity.value=_.reflectivity,w.clearcoat.value=_.clearcoat,w.clearcoatRoughness.value=_.clearcoatRoughness,_.sheen&&w.sheen.value.copy(_.sheen),_.clearcoatMap&&(w.clearcoatMap.value=_.clearcoatMap),_.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=_.clearcoatRoughnessMap),_.clearcoatNormalMap&&(w.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),w.clearcoatNormalMap.value=_.clearcoatNormalMap,_.side===_n&&w.clearcoatNormalScale.value.negate()),w.transmission.value=_.transmission,_.transmissionMap&&(w.transmissionMap.value=_.transmissionMap)}function v(w,_){_.matcap&&(w.matcap.value=_.matcap),_.bumpMap&&(w.bumpMap.value=_.bumpMap,w.bumpScale.value=_.bumpScale,_.side===_n&&(w.bumpScale.value*=-1)),_.normalMap&&(w.normalMap.value=_.normalMap,w.normalScale.value.copy(_.normalScale),_.side===_n&&w.normalScale.value.negate()),_.displacementMap&&(w.displacementMap.value=_.displacementMap,w.displacementScale.value=_.displacementScale,w.displacementBias.value=_.displacementBias)}function x(w,_){_.displacementMap&&(w.displacementMap.value=_.displacementMap,w.displacementScale.value=_.displacementScale,w.displacementBias.value=_.displacementBias)}function M(w,_){_.displacementMap&&(w.displacementMap.value=_.displacementMap,w.displacementScale.value=_.displacementScale,w.displacementBias.value=_.displacementBias),w.referencePosition.value.copy(_.referencePosition),w.nearDistance.value=_.nearDistance,w.farDistance.value=_.farDistance}function S(w,_){_.bumpMap&&(w.bumpMap.value=_.bumpMap,w.bumpScale.value=_.bumpScale,_.side===_n&&(w.bumpScale.value*=-1)),_.normalMap&&(w.normalMap.value=_.normalMap,w.normalScale.value.copy(_.normalScale),_.side===_n&&w.normalScale.value.negate()),_.displacementMap&&(w.displacementMap.value=_.displacementMap,w.displacementScale.value=_.displacementScale,w.displacementBias.value=_.displacementBias)}return{refreshFogUniforms:t,refreshMaterialUniforms:e}}function U3(){const n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.style.display="block",n}function mr(n){n=n||{};const t=n.canvas!==void 0?n.canvas:U3(),e=n.context!==void 0?n.context:null,i=n.alpha!==void 0?n.alpha:!1,a=n.depth!==void 0?n.depth:!0,o=n.stencil!==void 0?n.stencil:!0,c=n.antialias!==void 0?n.antialias:!1,u=n.premultipliedAlpha!==void 0?n.premultipliedAlpha:!0,h=n.preserveDrawingBuffer!==void 0?n.preserveDrawingBuffer:!1,d=n.powerPreference!==void 0?n.powerPreference:"default",m=n.failIfMajorPerformanceCaveat!==void 0?n.failIfMajorPerformanceCaveat:!1;let p=null,g=null;const v=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Lc,this.physicallyCorrectLights=!1,this.toneMapping=rc,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const x=this;let M=!1,S=null,w=0,_=0,L=null,R=null,C=-1,A=null;const B=new Le,Y=new Le;let X=null,st=t.width,V=t.height,j=1,I=null,H=null;const U=new Le(0,0,st,V),z=new Le(0,0,st,V);let Q=!1;const $=new $h;let it=!1,ct=!1;const D=new re,q=new G,ut={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function yt(){return L===null?j:1}let tt=e;function Ct(P,ft){for(let lt=0;lt<P.length;lt++){const gt=P[lt],zt=t.getContext(gt,ft);if(zt!==null)return zt}return null}try{const P={alpha:i,depth:a,stencil:o,antialias:c,premultipliedAlpha:u,preserveDrawingBuffer:h,powerPreference:d,failIfMajorPerformanceCaveat:m};if(t.addEventListener("webglcontextlost",ye,!1),t.addEventListener("webglcontextrestored",Qe,!1),tt===null){const ft=["webgl2","webgl","experimental-webgl"];if(x.isWebGL1Renderer===!0&&ft.shift(),tt=Ct(ft,P),tt===null)throw Ct(ft)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}tt.getShaderPrecisionFormat===void 0&&(tt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(P){throw console.error("THREE.WebGLRenderer: "+P.message),P}let bt,Ht,Lt,Qt,kt,vt,Et,wt,Ft,Rt,F,O,_t,xt,J,Mt,Nt,Ot,Tt,W,St;function Pt(){bt=new p2(tt),Ht=new h2(tt,bt,n),Ht.isWebGL2===!1&&(bt.get("WEBGL_depth_texture"),bt.get("OES_texture_float"),bt.get("OES_texture_half_float"),bt.get("OES_texture_half_float_linear"),bt.get("OES_standard_derivatives"),bt.get("OES_element_index_uint"),bt.get("OES_vertex_array_object"),bt.get("ANGLE_instanced_arrays")),bt.get("OES_texture_float_linear"),W=new O3(tt,bt,Ht),Lt=new B3(tt,bt,Ht),Lt.scissor(Y.copy(z).multiplyScalar(j).floor()),Lt.viewport(B.copy(U).multiplyScalar(j).floor()),Qt=new y2,kt=new _3,vt=new D3(tt,bt,Lt,kt,Ht,W,Qt),Et=new d2(x),wt=new HE(tt,Ht),St=new c2(tt,bt,wt,Ht),Ft=new m2(tt,wt,Qt,St),Rt=new _2(tt,Ft,wt,Qt),Nt=new b2(tt),J=new f2(kt),F=new b3(x,Et,bt,Ht,St,J),O=new P3(kt),_t=new S3(kt),xt=new R3(bt,Ht),Mt=new l2(x,Et,Lt,Rt,u),Ot=new u2(tt,bt,Qt,Ht),Tt=new g2(tt,bt,Qt,Ht),Qt.programs=F.programs,x.capabilities=Ht,x.extensions=bt,x.properties=kt,x.renderLists=_t,x.state=Lt,x.info=Qt}Pt();const At=new F_(x,tt);this.xr=At;const Vt=new I_(x,Rt,Ht.maxTextureSize);this.shadowMap=Vt,this.getContext=function(){return tt},this.getContextAttributes=function(){return tt.getContextAttributes()},this.forceContextLoss=function(){const P=bt.get("WEBGL_lose_context");P&&P.loseContext()},this.forceContextRestore=function(){const P=bt.get("WEBGL_lose_context");P&&P.restoreContext()},this.getPixelRatio=function(){return j},this.setPixelRatio=function(P){P!==void 0&&(j=P,this.setSize(st,V,!1))},this.getSize=function(P){return P===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),P=new ht),P.set(st,V)},this.setSize=function(P,ft,lt){if(At.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}st=P,V=ft,t.width=Math.floor(P*j),t.height=Math.floor(ft*j),lt!==!1&&(t.style.width=P+"px",t.style.height=ft+"px"),this.setViewport(0,0,P,ft)},this.getDrawingBufferSize=function(P){return P===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),P=new ht),P.set(st*j,V*j).floor()},this.setDrawingBufferSize=function(P,ft,lt){st=P,V=ft,j=lt,t.width=Math.floor(P*lt),t.height=Math.floor(ft*lt),this.setViewport(0,0,P,ft)},this.getCurrentViewport=function(P){return P===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),P=new Le),P.copy(B)},this.getViewport=function(P){return P.copy(U)},this.setViewport=function(P,ft,lt,gt){P.isVector4?U.set(P.x,P.y,P.z,P.w):U.set(P,ft,lt,gt),Lt.viewport(B.copy(U).multiplyScalar(j).floor())},this.getScissor=function(P){return P.copy(z)},this.setScissor=function(P,ft,lt,gt){P.isVector4?z.set(P.x,P.y,P.z,P.w):z.set(P,ft,lt,gt),Lt.scissor(Y.copy(z).multiplyScalar(j).floor())},this.getScissorTest=function(){return Q},this.setScissorTest=function(P){Lt.setScissorTest(Q=P)},this.setOpaqueSort=function(P){I=P},this.setTransparentSort=function(P){H=P},this.getClearColor=function(P){return P===void 0&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),P=new Wt),P.copy(Mt.getClearColor())},this.setClearColor=function(){Mt.setClearColor.apply(Mt,arguments)},this.getClearAlpha=function(){return Mt.getClearAlpha()},this.setClearAlpha=function(){Mt.setClearAlpha.apply(Mt,arguments)},this.clear=function(P,ft,lt){let gt=0;(P===void 0||P)&&(gt|=16384),(ft===void 0||ft)&&(gt|=256),(lt===void 0||lt)&&(gt|=1024),tt.clear(gt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ye,!1),t.removeEventListener("webglcontextrestored",Qe,!1),_t.dispose(),xt.dispose(),kt.dispose(),Et.dispose(),Rt.dispose(),St.dispose(),At.dispose(),Aa.stop()};function ye(P){P.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),M=!0}function Qe(){console.log("THREE.WebGLRenderer: Context Restored."),M=!1,Pt()}function bi(P){const ft=P.target;ft.removeEventListener("dispose",bi),Oe(ft)}function Oe(P){Je(P),kt.remove(P)}function Je(P){const ft=kt.get(P).program;ft!==void 0&&F.releaseProgram(ft)}function Cn(P,ft){P.render(function(lt){x.renderBufferImmediate(lt,ft)})}this.renderBufferImmediate=function(P,ft){St.initAttributes();const lt=kt.get(P);P.hasPositions&&!lt.position&&(lt.position=tt.createBuffer()),P.hasNormals&&!lt.normal&&(lt.normal=tt.createBuffer()),P.hasUvs&&!lt.uv&&(lt.uv=tt.createBuffer()),P.hasColors&&!lt.color&&(lt.color=tt.createBuffer());const gt=ft.getAttributes();P.hasPositions&&(tt.bindBuffer(34962,lt.position),tt.bufferData(34962,P.positionArray,35048),St.enableAttribute(gt.position),tt.vertexAttribPointer(gt.position,3,5126,!1,0,0)),P.hasNormals&&(tt.bindBuffer(34962,lt.normal),tt.bufferData(34962,P.normalArray,35048),St.enableAttribute(gt.normal),tt.vertexAttribPointer(gt.normal,3,5126,!1,0,0)),P.hasUvs&&(tt.bindBuffer(34962,lt.uv),tt.bufferData(34962,P.uvArray,35048),St.enableAttribute(gt.uv),tt.vertexAttribPointer(gt.uv,2,5126,!1,0,0)),P.hasColors&&(tt.bindBuffer(34962,lt.color),tt.bufferData(34962,P.colorArray,35048),St.enableAttribute(gt.color),tt.vertexAttribPointer(gt.color,3,5126,!1,0,0)),St.disableUnusedAttributes(),tt.drawArrays(4,0,P.count),P.count=0},this.renderBufferDirect=function(P,ft,lt,gt,zt,oe){ft===null&&(ft=ut);const ie=zt.isMesh&&zt.matrixWorld.determinant()<0,le=Na(P,ft,gt,zt);Lt.setMaterial(gt,ie);let te=lt.index;const We=lt.attributes.position;if(te===null){if(We===void 0||We.count===0)return}else if(te.count===0)return;let He=1;gt.wireframe===!0&&(te=Ft.getWireframeAttribute(lt),He=2),(gt.morphTargets||gt.morphNormals)&&Nt.update(zt,lt,gt,le),St.setup(zt,gt,le,lt,te);let Zt,Kt=Ot;te!==null&&(Zt=wt.get(te),Kt=Tt,Kt.setIndex(Zt));const Ge=te!==null?te.count:We.count,ge=lt.drawRange.start*He,_i=lt.drawRange.count*He,en=oe!==null?oe.start*He:0,Ko=oe!==null?oe.count*He:1/0,pn=Math.max(ge,en),wi=Math.min(Ge,ge+_i,en+Ko)-1,Pi=Math.max(0,wi-pn+1);if(Pi!==0){if(zt.isMesh)gt.wireframe===!0?(Lt.setLineWidth(gt.wireframeLinewidth*yt()),Kt.setMode(1)):Kt.setMode(4);else if(zt.isLine){let ni=gt.linewidth;ni===void 0&&(ni=1),Lt.setLineWidth(ni*yt()),zt.isLineSegments?Kt.setMode(1):zt.isLineLoop?Kt.setMode(2):Kt.setMode(3)}else zt.isPoints?Kt.setMode(0):zt.isSprite&&Kt.setMode(4);if(zt.isInstancedMesh)Kt.renderInstances(pn,Pi,zt.count);else if(lt.isInstancedBufferGeometry){const ni=Math.min(lt.instanceCount,lt._maxInstanceCount);Kt.renderInstances(pn,Pi,ni)}else Kt.render(pn,Pi)}},this.compile=function(P,ft){g=xt.get(P),g.init(),P.traverseVisible(function(gt){gt.isLight&&gt.layers.test(ft.layers)&&(g.pushLight(gt),gt.castShadow&&g.pushShadow(gt))}),g.setupLights();const lt=new WeakMap;P.traverse(function(gt){const zt=gt.material;if(zt)if(Array.isArray(zt))for(let oe=0;oe<zt.length;oe++){const ie=zt[oe];lt.has(ie)===!1&&(dn(ie,P,gt),lt.set(ie))}else lt.has(zt)===!1&&(dn(zt,P,gt),lt.set(zt))})};let Jo=null;function cf(P){At.isPresenting||Jo&&Jo(P)}const Aa=new L_;Aa.setAnimationLoop(cf),typeof window<"u"&&Aa.setContext(window),this.setAnimationLoop=function(P){Jo=P,At.setAnimationLoop(P),P===null?Aa.stop():Aa.start()},this.render=function(P,ft){let lt,gt;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),lt=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),gt=arguments[3]),ft!==void 0&&ft.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(M===!0)return;St.resetDefaultState(),C=-1,A=null,P.autoUpdate===!0&&P.updateMatrixWorld(),ft.parent===null&&ft.updateMatrixWorld(),At.enabled===!0&&At.isPresenting===!0&&(ft=At.getCamera(ft)),P.isScene===!0&&P.onBeforeRender(x,P,ft,lt||L),g=xt.get(P,v.length),g.init(),v.push(g),D.multiplyMatrices(ft.projectionMatrix,ft.matrixWorldInverse),$.setFromProjectionMatrix(D),ct=this.localClippingEnabled,it=J.init(this.clippingPlanes,ct,ft),p=_t.get(P,ft),p.init(),Ca(P,ft,0,x.sortObjects),p.finish(),x.sortObjects===!0&&p.sort(I,H),it===!0&&J.beginShadows();const zt=g.state.shadowsArray;Vt.render(zt,P,ft),g.setupLights(),g.setupLightsView(ft),it===!0&&J.endShadows(),this.info.autoReset===!0&&this.info.reset(),lt!==void 0&&this.setRenderTarget(lt),Mt.render(p,P,ft,gt);const oe=p.opaque,ie=p.transparent;oe.length>0&&La(oe,P,ft),ie.length>0&&La(ie,P,ft),P.isScene===!0&&P.onAfterRender(x,P,ft),L!==null&&(vt.updateRenderTargetMipmap(L),vt.updateMultisampleRenderTarget(L)),Lt.buffers.depth.setTest(!0),Lt.buffers.depth.setMask(!0),Lt.buffers.color.setMask(!0),Lt.setPolygonOffset(!1),v.pop(),v.length>0?g=v[v.length-1]:g=null,p=null};function Ca(P,ft,lt,gt){if(P.visible===!1)return;if(P.layers.test(ft.layers)){if(P.isGroup)lt=P.renderOrder;else if(P.isLOD)P.autoUpdate===!0&&P.update(ft);else if(P.isLight)g.pushLight(P),P.castShadow&&g.pushShadow(P);else if(P.isSprite){if(!P.frustumCulled||$.intersectsSprite(P)){gt&&q.setFromMatrixPosition(P.matrixWorld).applyMatrix4(D);const ie=Rt.update(P),le=P.material;le.visible&&p.push(P,ie,le,lt,q.z,null)}}else if(P.isImmediateRenderObject)gt&&q.setFromMatrixPosition(P.matrixWorld).applyMatrix4(D),p.push(P,null,P.material,lt,q.z,null);else if((P.isMesh||P.isLine||P.isPoints)&&(P.isSkinnedMesh&&P.skeleton.frame!==Qt.render.frame&&(P.skeleton.update(),P.skeleton.frame=Qt.render.frame),!P.frustumCulled||$.intersectsObject(P))){gt&&q.setFromMatrixPosition(P.matrixWorld).applyMatrix4(D);const ie=Rt.update(P),le=P.material;if(Array.isArray(le)){const te=ie.groups;for(let We=0,He=te.length;We<He;We++){const Zt=te[We],Kt=le[Zt.materialIndex];Kt&&Kt.visible&&p.push(P,ie,Kt,lt,q.z,Zt)}}else le.visible&&p.push(P,ie,le,lt,q.z,null)}}const oe=P.children;for(let ie=0,le=oe.length;ie<le;ie++)Ca(oe[ie],ft,lt,gt)}function La(P,ft,lt){const gt=ft.isScene===!0?ft.overrideMaterial:null;for(let zt=0,oe=P.length;zt<oe;zt++){const ie=P[zt],le=ie.object,te=ie.geometry,We=gt===null?ie.material:gt,He=ie.group;if(lt.isArrayCamera){const Zt=lt.cameras;for(let Kt=0,Ge=Zt.length;Kt<Ge;Kt++){const ge=Zt[Kt];le.layers.test(ge.layers)&&(Lt.viewport(B.copy(ge.viewport)),g.setupLightsView(ge),Ra(le,ft,ge,te,We,He))}}else Ra(le,ft,lt,te,We,He)}}function Ra(P,ft,lt,gt,zt,oe){if(P.onBeforeRender(x,ft,lt,gt,zt,oe),P.modelViewMatrix.multiplyMatrices(lt.matrixWorldInverse,P.matrixWorld),P.normalMatrix.getNormalMatrix(P.modelViewMatrix),P.isImmediateRenderObject){const ie=Na(lt,ft,zt,P);Lt.setMaterial(zt),St.reset(),Cn(P,ie)}else x.renderBufferDirect(lt,ft,gt,zt,P,oe);P.onAfterRender(x,ft,lt,gt,zt,oe)}function dn(P,ft,lt){ft.isScene!==!0&&(ft=ut);const gt=kt.get(P),zt=g.state.lights,oe=g.state.shadowsArray,ie=zt.state.version,le=F.getParameters(P,zt.state,oe,ft,lt),te=F.getProgramCacheKey(le);let We=gt.program,He=!0;if(We===void 0)P.addEventListener("dispose",bi);else if(We.cacheKey!==te)Je(P);else if(gt.lightsStateVersion!==ie)He=!1;else if(le.shaderID!==void 0){const ge=P.isMeshStandardMaterial?ft.environment:null;gt.envMap=Et.get(P.envMap||ge);return}else He=!1;He&&(le.uniforms=F.getUniforms(P),P.onBeforeCompile(le,x),We=F.acquireProgram(le,te),gt.program=We,gt.uniforms=le.uniforms,gt.outputEncoding=le.outputEncoding);const Zt=gt.uniforms;(!P.isShaderMaterial&&!P.isRawShaderMaterial||P.clipping===!0)&&(gt.numClippingPlanes=J.numPlanes,gt.numIntersection=J.numIntersection,Zt.clippingPlanes=J.uniform),gt.environment=P.isMeshStandardMaterial?ft.environment:null,gt.fog=ft.fog,gt.envMap=Et.get(P.envMap||gt.environment),gt.needsLights=uf(P),gt.lightsStateVersion=ie,gt.needsLights&&(Zt.ambientLightColor.value=zt.state.ambient,Zt.lightProbe.value=zt.state.probe,Zt.directionalLights.value=zt.state.directional,Zt.directionalLightShadows.value=zt.state.directionalShadow,Zt.spotLights.value=zt.state.spot,Zt.spotLightShadows.value=zt.state.spotShadow,Zt.rectAreaLights.value=zt.state.rectArea,Zt.ltc_1.value=zt.state.rectAreaLTC1,Zt.ltc_2.value=zt.state.rectAreaLTC2,Zt.pointLights.value=zt.state.point,Zt.pointLightShadows.value=zt.state.pointShadow,Zt.hemisphereLights.value=zt.state.hemi,Zt.directionalShadowMap.value=zt.state.directionalShadowMap,Zt.directionalShadowMatrix.value=zt.state.directionalShadowMatrix,Zt.spotShadowMap.value=zt.state.spotShadowMap,Zt.spotShadowMatrix.value=zt.state.spotShadowMatrix,Zt.pointShadowMap.value=zt.state.pointShadowMap,Zt.pointShadowMatrix.value=zt.state.pointShadowMatrix);const Kt=gt.program.getUniforms(),Ge=va.seqWithValue(Kt.seq,Zt);gt.uniformsList=Ge}function Na(P,ft,lt,gt){ft.isScene!==!0&&(ft=ut),vt.resetTextureUnits();const zt=ft.fog,oe=lt.isMeshStandardMaterial?ft.environment:null,ie=L===null?x.outputEncoding:L.texture.encoding,le=Et.get(lt.envMap||oe),te=kt.get(lt),We=g.state.lights;if(it===!0&&(ct===!0||P!==A)){const en=P===A&&lt.id===C;J.setState(lt,P,en)}lt.version===te.__version?(lt.fog&&te.fog!==zt||te.environment!==oe||te.needsLights&&te.lightsStateVersion!==We.state.version||te.numClippingPlanes!==void 0&&(te.numClippingPlanes!==J.numPlanes||te.numIntersection!==J.numIntersection)||te.outputEncoding!==ie||te.envMap!==le)&&dn(lt,ft,gt):(dn(lt,ft,gt),te.__version=lt.version);let He=!1,Zt=!1,Kt=!1;const Ge=te.program,ge=Ge.getUniforms(),_i=te.uniforms;if(Lt.useProgram(Ge.program)&&(He=!0,Zt=!0,Kt=!0),lt.id!==C&&(C=lt.id,Zt=!0),He||A!==P){if(ge.setValue(tt,"projectionMatrix",P.projectionMatrix),Ht.logarithmicDepthBuffer&&ge.setValue(tt,"logDepthBufFC",2/(Math.log(P.far+1)/Math.LN2)),A!==P&&(A=P,Zt=!0,Kt=!0),lt.isShaderMaterial||lt.isMeshPhongMaterial||lt.isMeshToonMaterial||lt.isMeshStandardMaterial||lt.envMap){const en=ge.map.cameraPosition;en!==void 0&&en.setValue(tt,q.setFromMatrixPosition(P.matrixWorld))}(lt.isMeshPhongMaterial||lt.isMeshToonMaterial||lt.isMeshLambertMaterial||lt.isMeshBasicMaterial||lt.isMeshStandardMaterial||lt.isShaderMaterial)&&ge.setValue(tt,"isOrthographic",P.isOrthographicCamera===!0),(lt.isMeshPhongMaterial||lt.isMeshToonMaterial||lt.isMeshLambertMaterial||lt.isMeshBasicMaterial||lt.isMeshStandardMaterial||lt.isShaderMaterial||lt.isShadowMaterial||lt.skinning)&&ge.setValue(tt,"viewMatrix",P.matrixWorldInverse)}if(lt.skinning){ge.setOptional(tt,gt,"bindMatrix"),ge.setOptional(tt,gt,"bindMatrixInverse");const en=gt.skeleton;if(en){const Ko=en.bones;if(Ht.floatVertexTextures){if(en.boneTexture===null){let pn=Math.sqrt(Ko.length*4);pn=ne.ceilPowerOfTwo(pn),pn=Math.max(pn,4);const wi=new Float32Array(pn*pn*4);wi.set(en.boneMatrices);const Pi=new Oo(wi,pn,pn,zi,ma);en.boneMatrices=wi,en.boneTexture=Pi,en.boneTextureSize=pn}ge.setValue(tt,"boneTexture",en.boneTexture,vt),ge.setValue(tt,"boneTextureSize",en.boneTextureSize)}else ge.setOptional(tt,en,"boneMatrices")}}return(Zt||te.receiveShadow!==gt.receiveShadow)&&(te.receiveShadow=gt.receiveShadow,ge.setValue(tt,"receiveShadow",gt.receiveShadow)),Zt&&(ge.setValue(tt,"toneMappingExposure",x.toneMappingExposure),te.needsLights&&za(_i,Kt),zt&&lt.fog&&O.refreshFogUniforms(_i,zt),O.refreshMaterialUniforms(_i,lt,j,V),va.upload(tt,te.uniformsList,_i,vt)),lt.isShaderMaterial&&lt.uniformsNeedUpdate===!0&&(va.upload(tt,te.uniformsList,_i,vt),lt.uniformsNeedUpdate=!1),lt.isSpriteMaterial&&ge.setValue(tt,"center",gt.center),ge.setValue(tt,"modelViewMatrix",gt.modelViewMatrix),ge.setValue(tt,"normalMatrix",gt.normalMatrix),ge.setValue(tt,"modelMatrix",gt.matrixWorld),Ge}function za(P,ft){P.ambientLightColor.needsUpdate=ft,P.lightProbe.needsUpdate=ft,P.directionalLights.needsUpdate=ft,P.directionalLightShadows.needsUpdate=ft,P.pointLights.needsUpdate=ft,P.pointLightShadows.needsUpdate=ft,P.spotLights.needsUpdate=ft,P.spotLightShadows.needsUpdate=ft,P.rectAreaLights.needsUpdate=ft,P.hemisphereLights.needsUpdate=ft}function uf(P){return P.isMeshLambertMaterial||P.isMeshToonMaterial||P.isMeshPhongMaterial||P.isMeshStandardMaterial||P.isShadowMaterial||P.isShaderMaterial&&P.lights===!0}this.setFramebuffer=function(P){S!==P&&L===null&&tt.bindFramebuffer(36160,P),S=P},this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return _},this.getRenderList=function(){return p},this.setRenderList=function(P){p=P},this.getRenderTarget=function(){return L},this.setRenderTarget=function(P,ft=0,lt=0){L=P,w=ft,_=lt,P&&kt.get(P).__webglFramebuffer===void 0&&vt.setupRenderTarget(P);let gt=S,zt=!1;if(P){const oe=kt.get(P).__webglFramebuffer;P.isWebGLCubeRenderTarget?(gt=oe[ft],zt=!0):P.isWebGLMultisampleRenderTarget?gt=kt.get(P).__webglMultisampledFramebuffer:gt=oe,B.copy(P.viewport),Y.copy(P.scissor),X=P.scissorTest}else B.copy(U).multiplyScalar(j).floor(),Y.copy(z).multiplyScalar(j).floor(),X=Q;if(R!==gt&&(tt.bindFramebuffer(36160,gt),R=gt),Lt.viewport(B),Lt.scissor(Y),Lt.setScissorTest(X),zt){const oe=kt.get(P.texture);tt.framebufferTexture2D(36160,36064,34069+ft,oe.__webglTexture,lt)}},this.readRenderTargetPixels=function(P,ft,lt,gt,zt,oe,ie){if(!(P&&P.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let le=kt.get(P).__webglFramebuffer;if(P.isWebGLCubeRenderTarget&&ie!==void 0&&(le=le[ie]),le){let te=!1;le!==R&&(tt.bindFramebuffer(36160,le),te=!0);try{const We=P.texture,He=We.format,Zt=We.type;if(He!==zi&&W.convert(He)!==tt.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(Zt!==Km&&W.convert(Zt)!==tt.getParameter(35738)&&!(Zt===ma&&(Ht.isWebGL2||bt.get("OES_texture_float")||bt.get("WEBGL_color_buffer_float")))&&!(Zt===Oh&&(Ht.isWebGL2?bt.get("EXT_color_buffer_float"):bt.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}tt.checkFramebufferStatus(36160)===36053?ft>=0&&ft<=P.width-gt&&lt>=0&&lt<=P.height-zt&&tt.readPixels(ft,lt,gt,zt,W.convert(He),W.convert(Zt),oe):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{te&&tt.bindFramebuffer(36160,R)}}},this.copyFramebufferToTexture=function(P,ft,lt=0){const gt=Math.pow(2,-lt),zt=Math.floor(ft.image.width*gt),oe=Math.floor(ft.image.height*gt),ie=W.convert(ft.format);vt.setTexture2D(ft,0),tt.copyTexImage2D(3553,lt,ie,P.x,P.y,zt,oe,0),Lt.unbindTexture()},this.copyTextureToTexture=function(P,ft,lt,gt=0){const zt=ft.image.width,oe=ft.image.height,ie=W.convert(lt.format),le=W.convert(lt.type);vt.setTexture2D(lt,0),tt.pixelStorei(37440,lt.flipY),tt.pixelStorei(37441,lt.premultiplyAlpha),tt.pixelStorei(3317,lt.unpackAlignment),ft.isDataTexture?tt.texSubImage2D(3553,gt,P.x,P.y,zt,oe,ie,le,ft.image.data):ft.isCompressedTexture?tt.compressedTexSubImage2D(3553,gt,P.x,P.y,ft.mipmaps[0].width,ft.mipmaps[0].height,ie,ft.mipmaps[0].data):tt.texSubImage2D(3553,gt,P.x,P.y,ie,le,ft.image),gt===0&&lt.generateMipmaps&&tt.generateMipmap(3553),Lt.unbindTexture()},this.initTexture=function(P){vt.setTexture2D(P,0),Lt.unbindTexture()},this.resetState=function(){Lt.reset(),St.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function $x(n){mr.call(this,n)}$x.prototype=Object.assign(Object.create(mr.prototype),{constructor:$x,isWebGL1Renderer:!0});class tf extends Xt{constructor(){super(),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return this.background!==null&&(e.object.background=this.background.toJSON(t)),this.environment!==null&&(e.object.environment=this.environment.toJSON(t)),this.fog!==null&&(e.object.fog=this.fog.toJSON()),e}}function di(n,t){this.array=n,this.stride=t,this.count=n!==void 0?n.length/t:0,this.usage=Kh,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ne.generateUUID()}Object.defineProperty(di.prototype,"needsUpdate",{set:function(n){n===!0&&this.version++}});Object.assign(di.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(n){return this.usage=n,this},copy:function(n){return this.array=new n.array.constructor(n.array),this.count=n.count,this.stride=n.stride,this.usage=n.usage,this},copyAt:function(n,t,e){n*=this.stride,e*=t.stride;for(let i=0,a=this.stride;i<a;i++)this.array[n+i]=t.array[e+i];return this},set:function(n,t=0){return this.array.set(n,t),this},clone:function(n){n.arrayBuffers===void 0&&(n.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ne.generateUUID()),n.arrayBuffers[this.array.buffer._uuid]===void 0&&(n.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(n.arrayBuffers[this.array.buffer._uuid]),e=new di(t,this.stride);return e.setUsage(this.usage),e},onUpload:function(n){return this.onUploadCallback=n,this},toJSON:function(n){return n.arrayBuffers===void 0&&(n.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ne.generateUUID()),n.arrayBuffers[this.array.buffer._uuid]===void 0&&(n.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const $a=new G;function cr(n,t,e,i){this.name="",this.data=n,this.itemSize=t,this.offset=e,this.normalized=i===!0}Object.defineProperties(cr.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(n){this.data.needsUpdate=n}}});Object.assign(cr.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(n){for(let t=0,e=this.data.count;t<e;t++)$a.x=this.getX(t),$a.y=this.getY(t),$a.z=this.getZ(t),$a.applyMatrix4(n),this.setXYZ(t,$a.x,$a.y,$a.z);return this},setX:function(n,t){return this.data.array[n*this.data.stride+this.offset]=t,this},setY:function(n,t){return this.data.array[n*this.data.stride+this.offset+1]=t,this},setZ:function(n,t){return this.data.array[n*this.data.stride+this.offset+2]=t,this},setW:function(n,t){return this.data.array[n*this.data.stride+this.offset+3]=t,this},getX:function(n){return this.data.array[n*this.data.stride+this.offset]},getY:function(n){return this.data.array[n*this.data.stride+this.offset+1]},getZ:function(n){return this.data.array[n*this.data.stride+this.offset+2]},getW:function(n){return this.data.array[n*this.data.stride+this.offset+3]},setXY:function(n,t,e){return n=n*this.data.stride+this.offset,this.data.array[n+0]=t,this.data.array[n+1]=e,this},setXYZ:function(n,t,e,i){return n=n*this.data.stride+this.offset,this.data.array[n+0]=t,this.data.array[n+1]=e,this.data.array[n+2]=i,this},setXYZW:function(n,t,e,i,a){return n=n*this.data.stride+this.offset,this.data.array[n+0]=t,this.data.array[n+1]=e,this.data.array[n+2]=i,this.data.array[n+3]=a,this},clone:function(n){if(n===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const i=e*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[i+a])}return new ee(new this.array.constructor(t),this.itemSize,this.normalized)}else return n.interleavedBuffers===void 0&&(n.interleavedBuffers={}),n.interleavedBuffers[this.data.uuid]===void 0&&(n.interleavedBuffers[this.data.uuid]=this.data.clone(n)),new cr(n.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(n){if(n===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const i=e*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[i+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return n.interleavedBuffers===void 0&&(n.interleavedBuffers={}),n.interleavedBuffers[this.data.uuid]===void 0&&(n.interleavedBuffers[this.data.uuid]=this.data.toJSON(n)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function ur(n){Jt.call(this),this.type="SpriteMaterial",this.color=new Wt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(n)}ur.prototype=Object.create(Jt.prototype);ur.prototype.constructor=ur;ur.prototype.isSpriteMaterial=!0;ur.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.color.copy(n.color),this.map=n.map,this.alphaMap=n.alphaMap,this.rotation=n.rotation,this.sizeAttenuation=n.sizeAttenuation,this};let ho;const Xl=new G,fo=new G,po=new G,mo=new ht,Zl=new ht,H_=new re,rh=new G,Ql=new G,oh=new G,tb=new ht,Yp=new ht,eb=new ht;function nb(n){if(Xt.call(this),this.type="Sprite",ho===void 0){ho=new Re;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new di(t,5);ho.setIndex([0,1,2,0,2,3]),ho.setAttribute("position",new cr(e,3,0,!1)),ho.setAttribute("uv",new cr(e,2,3,!1))}this.geometry=ho,this.material=n!==void 0?n:new ur,this.center=new ht(.5,.5)}nb.prototype=Object.assign(Object.create(Xt.prototype),{constructor:nb,isSprite:!0,raycast:function(n,t){n.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),fo.setFromMatrixScale(this.matrixWorld),H_.copy(n.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(n.camera.matrixWorldInverse,this.matrixWorld),po.setFromMatrixPosition(this.modelViewMatrix),n.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&fo.multiplyScalar(-po.z);const e=this.material.rotation;let i,a;e!==0&&(a=Math.cos(e),i=Math.sin(e));const o=this.center;lh(rh.set(-.5,-.5,0),po,o,fo,i,a),lh(Ql.set(.5,-.5,0),po,o,fo,i,a),lh(oh.set(.5,.5,0),po,o,fo,i,a),tb.set(0,0),Yp.set(1,0),eb.set(1,1);let c=n.ray.intersectTriangle(rh,Ql,oh,!1,Xl);if(c===null&&(lh(Ql.set(-.5,.5,0),po,o,fo,i,a),Yp.set(0,1),c=n.ray.intersectTriangle(rh,oh,Ql,!1,Xl),c===null))return;const u=n.ray.origin.distanceTo(Xl);u<n.near||u>n.far||t.push({distance:u,point:Xl.clone(),uv:Sn.getUV(Xl,rh,Ql,oh,tb,Yp,eb,new ht),face:null,object:this})},copy:function(n){return Xt.prototype.copy.call(this,n),n.center!==void 0&&this.center.copy(n.center),this.material=n.material,this}});function lh(n,t,e,i,a,o){mo.subVectors(n,e).addScalar(.5).multiply(i),a!==void 0?(Zl.x=o*mo.x-a*mo.y,Zl.y=a*mo.x+o*mo.y):Zl.copy(mo),n.copy(t),n.x+=Zl.x,n.y+=Zl.y,n.applyMatrix4(H_)}const ch=new G,ib=new G;function vm(){Xt.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}vm.prototype=Object.assign(Object.create(Xt.prototype),{constructor:vm,isLOD:!0,copy:function(n){Xt.prototype.copy.call(this,n,!1);const t=n.levels;for(let e=0,i=t.length;e<i;e++){const a=t[e];this.addLevel(a.object.clone(),a.distance)}return this.autoUpdate=n.autoUpdate,this},addLevel:function(n,t=0){t=Math.abs(t);const e=this.levels;let i;for(i=0;i<e.length&&!(t<e[i].distance);i++);return e.splice(i,0,{distance:t,object:n}),this.add(n),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(n){const t=this.levels;if(t.length>0){let e,i;for(e=1,i=t.length;e<i&&!(n<t[e].distance);e++);return t[e-1].object}return null},raycast:function(n,t){if(this.levels.length>0){ch.setFromMatrixPosition(this.matrixWorld);const i=n.ray.origin.distanceTo(ch);this.getObjectForDistance(i).raycast(n,t)}},update:function(n){const t=this.levels;if(t.length>1){ch.setFromMatrixPosition(n.matrixWorld),ib.setFromMatrixPosition(this.matrixWorld);const e=ch.distanceTo(ib)/n.zoom;t[0].object.visible=!0;let i,a;for(i=1,a=t.length;i<a&&e>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(this._currentLevel=i-1;i<a;i++)t[i].object.visible=!1}},toJSON:function(n){const t=Xt.prototype.toJSON.call(this,n);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const e=this.levels;for(let i=0,a=e.length;i<a;i++){const o=e[i];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}});const sb=new G,ab=new Le,rb=new Le,I3=new G,ob=new re;function xm(n,t){n&&n.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Ze.call(this,n,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new re,this.bindMatrixInverse=new re}xm.prototype=Object.assign(Object.create(Ze.prototype),{constructor:xm,isSkinnedMesh:!0,copy:function(n){return Ze.prototype.copy.call(this,n),this.bindMode=n.bindMode,this.bindMatrix.copy(n.bindMatrix),this.bindMatrixInverse.copy(n.bindMatrixInverse),this.skeleton=n.skeleton,this},bind:function(n,t){this.skeleton=n,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const n=new Le,t=this.geometry.attributes.skinWeight;for(let e=0,i=t.count;e<i;e++){n.x=t.getX(e),n.y=t.getY(e),n.z=t.getZ(e),n.w=t.getW(e);const a=1/n.manhattanLength();a!==1/0?n.multiplyScalar(a):n.set(1,0,0,0),t.setXYZW(e,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(n){Ze.prototype.updateMatrixWorld.call(this,n),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(n,t){const e=this.skeleton,i=this.geometry;ab.fromBufferAttribute(i.attributes.skinIndex,n),rb.fromBufferAttribute(i.attributes.skinWeight,n),sb.fromBufferAttribute(i.attributes.position,n).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){const o=rb.getComponent(a);if(o!==0){const c=ab.getComponent(a);ob.multiplyMatrices(e.bones[c].matrixWorld,e.boneInverses[c]),t.addScaledVector(I3.copy(sb).applyMatrix4(ob),o)}}return t.applyMatrix4(this.bindMatrixInverse)}});function bm(){Xt.call(this),this.type="Bone"}bm.prototype=Object.assign(Object.create(Xt.prototype),{constructor:bm,isBone:!0});const lb=new re,F3=new re;function _m(n=[],t=[]){this.uuid=ne.generateUUID(),this.bones=n.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(_m.prototype,{init:function(){const n=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(n.length*16),t.length===0)this.calculateInverses();else if(n.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,i=this.bones.length;e<i;e++)this.boneInverses.push(new re)}},calculateInverses:function(){this.boneInverses.length=0;for(let n=0,t=this.bones.length;n<t;n++){const e=new re;this.bones[n]&&e.copy(this.bones[n].matrixWorld).invert(),this.boneInverses.push(e)}},pose:function(){for(let n=0,t=this.bones.length;n<t;n++){const e=this.bones[n];e&&e.matrixWorld.copy(this.boneInverses[n]).invert()}for(let n=0,t=this.bones.length;n<t;n++){const e=this.bones[n];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}},update:function(){const n=this.bones,t=this.boneInverses,e=this.boneMatrices,i=this.boneTexture;for(let a=0,o=n.length;a<o;a++){const c=n[a]?n[a].matrixWorld:F3;lb.multiplyMatrices(c,t[a]),lb.toArray(e,a*16)}i!==null&&(i.needsUpdate=!0)},clone:function(){return new _m(this.bones,this.boneInverses)},getBoneByName:function(n){for(let t=0,e=this.bones.length;t<e;t++){const i=this.bones[t];if(i.name===n)return i}},dispose:function(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(n,t){this.uuid=n.uuid;for(let e=0,i=n.bones.length;e<i;e++){const a=n.bones[e];let o=t[a];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),o=new bm),this.bones.push(o),this.boneInverses.push(new re().fromArray(n.boneInverses[e]))}return this.init(),this},toJSON:function(){const n={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};n.uuid=this.uuid;const t=this.bones,e=this.boneInverses;for(let i=0,a=t.length;i<a;i++){const o=t[i];n.bones.push(o.uuid);const c=e[i];n.boneInverses.push(c.toArray())}return n}});const cb=new re,ub=new re,uh=[],Jl=new Ze;function hb(n,t,e){Ze.call(this,n,t),this.instanceMatrix=new ee(new Float32Array(e*16),16),this.instanceColor=null,this.count=e,this.frustumCulled=!1}hb.prototype=Object.assign(Object.create(Ze.prototype),{constructor:hb,isInstancedMesh:!0,copy:function(n){return Ze.prototype.copy.call(this,n),this.instanceMatrix.copy(n.instanceMatrix),this.count=n.count,this},getColorAt:function(n,t){t.fromArray(this.instanceColor.array,n*3)},getMatrixAt:function(n,t){t.fromArray(this.instanceMatrix.array,n*16)},raycast:function(n,t){const e=this.matrixWorld,i=this.count;if(Jl.geometry=this.geometry,Jl.material=this.material,Jl.material!==void 0)for(let a=0;a<i;a++){this.getMatrixAt(a,cb),ub.multiplyMatrices(e,cb),Jl.matrixWorld=ub,Jl.raycast(n,uh);for(let o=0,c=uh.length;o<c;o++){const u=uh[o];u.instanceId=a,u.object=this,t.push(u)}uh.length=0}},setColorAt:function(n,t){this.instanceColor===null&&(this.instanceColor=new ee(new Float32Array(this.count*3),3)),t.toArray(this.instanceColor.array,n*3)},setMatrixAt:function(n,t){t.toArray(this.instanceMatrix.array,n*16)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});function vi(n){Jt.call(this),this.type="LineBasicMaterial",this.color=new Wt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(n)}vi.prototype=Object.create(Jt.prototype);vi.prototype.constructor=vi;vi.prototype.isLineBasicMaterial=!0;vi.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.color.copy(n.color),this.linewidth=n.linewidth,this.linecap=n.linecap,this.linejoin=n.linejoin,this.morphTargets=n.morphTargets,this};const fb=new G,db=new G,pb=new re,hh=new Rc,fh=new Di;function Po(n=new Re,t=new vi){Xt.call(this),this.type="Line",this.geometry=n,this.material=t,this.updateMorphTargets()}Po.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Po,isLine:!0,copy:function(n){return Xt.prototype.copy.call(this,n),this.material=n.material,this.geometry=n.geometry,this},computeLineDistances:function(){const n=this.geometry;if(n.isBufferGeometry)if(n.index===null){const t=n.attributes.position,e=[0];for(let i=1,a=t.count;i<a;i++)fb.fromBufferAttribute(t,i-1),db.fromBufferAttribute(t,i),e[i]=e[i-1],e[i]+=fb.distanceTo(db);n.setAttribute("lineDistance",new we(e,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){const t=n.vertices,e=n.lineDistances;e[0]=0;for(let i=1,a=t.length;i<a;i++)e[i]=e[i-1],e[i]+=t[i-1].distanceTo(t[i])}return this},raycast:function(n,t){const e=this.geometry,i=this.matrixWorld,a=n.params.Line.threshold;if(e.boundingSphere===null&&e.computeBoundingSphere(),fh.copy(e.boundingSphere),fh.applyMatrix4(i),fh.radius+=a,n.ray.intersectsSphere(fh)===!1)return;pb.copy(i).invert(),hh.copy(n.ray).applyMatrix4(pb);const o=a/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,u=new G,h=new G,d=new G,m=new G,p=this.isLineSegments?2:1;if(e.isBufferGeometry){const g=e.index,x=e.attributes.position;if(g!==null){const M=g.array;for(let S=0,w=M.length-1;S<w;S+=p){const _=M[S],L=M[S+1];if(u.fromBufferAttribute(x,_),h.fromBufferAttribute(x,L),hh.distanceSqToSegment(u,h,m,d)>c)continue;m.applyMatrix4(this.matrixWorld);const C=n.ray.origin.distanceTo(m);C<n.near||C>n.far||t.push({distance:C,point:d.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}else for(let M=0,S=x.count-1;M<S;M+=p){if(u.fromBufferAttribute(x,M),h.fromBufferAttribute(x,M+1),hh.distanceSqToSegment(u,h,m,d)>c)continue;m.applyMatrix4(this.matrixWorld);const _=n.ray.origin.distanceTo(m);_<n.near||_>n.far||t.push({distance:_,point:d.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}else if(e.isGeometry){const g=e.vertices,v=g.length;for(let x=0;x<v-1;x+=p){if(hh.distanceSqToSegment(g[x],g[x+1],m,d)>c)continue;m.applyMatrix4(this.matrixWorld);const S=n.ray.origin.distanceTo(m);S<n.near||S>n.far||t.push({distance:S,point:d.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const n=this.geometry;if(n.isBufferGeometry){const t=n.morphAttributes,e=Object.keys(t);if(e.length>0){const i=t[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,o=i.length;a<o;a++){const c=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=a}}}}else{const t=n.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const dh=new G,ph=new G;function Fh(n,t){Po.call(this,n,t),this.type="LineSegments"}Fh.prototype=Object.assign(Object.create(Po.prototype),{constructor:Fh,isLineSegments:!0,computeLineDistances:function(){const n=this.geometry;if(n.isBufferGeometry)if(n.index===null){const t=n.attributes.position,e=[];for(let i=0,a=t.count;i<a;i+=2)dh.fromBufferAttribute(t,i),ph.fromBufferAttribute(t,i+1),e[i]=i===0?0:e[i-1],e[i+1]=e[i]+dh.distanceTo(ph);n.setAttribute("lineDistance",new we(e,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){const t=n.vertices,e=n.lineDistances;for(let i=0,a=t.length;i<a;i+=2)dh.copy(t[i]),ph.copy(t[i+1]),e[i]=i===0?0:e[i-1],e[i+1]=e[i]+dh.distanceTo(ph)}return this}});function mb(n,t){Po.call(this,n,t),this.type="LineLoop"}mb.prototype=Object.assign(Object.create(Po.prototype),{constructor:mb,isLineLoop:!0});function hr(n){Jt.call(this),this.type="PointsMaterial",this.color=new Wt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(n)}hr.prototype=Object.create(Jt.prototype);hr.prototype.constructor=hr;hr.prototype.isPointsMaterial=!0;hr.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.color.copy(n.color),this.map=n.map,this.alphaMap=n.alphaMap,this.size=n.size,this.sizeAttenuation=n.sizeAttenuation,this.morphTargets=n.morphTargets,this};const gb=new re,wm=new Rc,mh=new Di,gh=new G;function yb(n=new Re,t=new hr){Xt.call(this),this.type="Points",this.geometry=n,this.material=t,this.updateMorphTargets()}yb.prototype=Object.assign(Object.create(Xt.prototype),{constructor:yb,isPoints:!0,copy:function(n){return Xt.prototype.copy.call(this,n),this.material=n.material,this.geometry=n.geometry,this},raycast:function(n,t){const e=this.geometry,i=this.matrixWorld,a=n.params.Points.threshold;if(e.boundingSphere===null&&e.computeBoundingSphere(),mh.copy(e.boundingSphere),mh.applyMatrix4(i),mh.radius+=a,n.ray.intersectsSphere(mh)===!1)return;gb.copy(i).invert(),wm.copy(n.ray).applyMatrix4(gb);const o=a/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o;if(e.isBufferGeometry){const u=e.index,d=e.attributes.position;if(u!==null){const m=u.array;for(let p=0,g=m.length;p<g;p++){const v=m[p];gh.fromBufferAttribute(d,v),Xp(gh,v,c,i,n,t,this)}}else for(let m=0,p=d.count;m<p;m++)gh.fromBufferAttribute(d,m),Xp(gh,m,c,i,n,t,this)}else{const u=e.vertices;for(let h=0,d=u.length;h<d;h++)Xp(u[h],h,c,i,n,t,this)}},updateMorphTargets:function(){const n=this.geometry;if(n.isBufferGeometry){const t=n.morphAttributes,e=Object.keys(t);if(e.length>0){const i=t[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,o=i.length;a<o;a++){const c=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=a}}}}else{const t=n.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function Xp(n,t,e,i,a,o,c){const u=wm.distanceSqToPoint(n);if(u<e){const h=new G;wm.closestPointToPoint(n,h),h.applyMatrix4(i);const d=a.ray.origin.distanceTo(h);if(d<a.near||d>a.far)return;o.push({distance:d,distanceToRay:Math.sqrt(u),point:h,index:t,face:null,object:c})}}function vb(n,t,e,i,a,o,c,u,h){De.call(this,n,t,e,i,a,o,c,u,h),this.format=c!==void 0?c:sr,this.minFilter=o!==void 0?o:En,this.magFilter=a!==void 0?a:En,this.generateMipmaps=!1;const d=this;function m(){d.needsUpdate=!0,n.requestVideoFrameCallback(m)}"requestVideoFrameCallback"in n&&n.requestVideoFrameCallback(m)}vb.prototype=Object.assign(Object.create(De.prototype),{constructor:vb,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){const n=this.image;"requestVideoFrameCallback"in n===!1&&n.readyState>=n.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function xc(n,t,e,i,a,o,c,u,h,d,m,p){De.call(this,null,o,c,u,h,d,i,a,m,p),this.image={width:t,height:e},this.mipmaps=n,this.flipY=!1,this.generateMipmaps=!1}xc.prototype=Object.create(De.prototype);xc.prototype.constructor=xc;xc.prototype.isCompressedTexture=!0;function Uo(n,t,e,i,a,o,c,u,h){De.call(this,n,t,e,i,a,o,c,u,h),this.needsUpdate=!0}Uo.prototype=Object.create(De.prototype);Uo.prototype.constructor=Uo;Uo.prototype.isCanvasTexture=!0;function Hh(n,t,e,i,a,o,c,u,h,d){if(d=d!==void 0?d:Lo,d!==Lo&&d!==dc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");e===void 0&&d===Lo&&(e=Dh),e===void 0&&d===dc&&(e=oc),De.call(this,null,i,a,o,c,u,d,e,h),this.image={width:n,height:t},this.magFilter=c!==void 0?c:Rn,this.minFilter=u!==void 0?u:Rn,this.flipY=!1,this.generateMipmaps=!1}Hh.prototype=Object.create(De.prototype);Hh.prototype.constructor=Hh;Hh.prototype.isDepthTexture=!0;let H3=0;const Vi=new re,Zp=new Xt,yh=new G;function Tn(){Object.defineProperty(this,"id",{value:H3+=2}),this.uuid=ne.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Tn.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Tn,isGeometry:!0,applyMatrix4:function(n){const t=new Hn().getNormalMatrix(n);for(let e=0,i=this.vertices.length;e<i;e++)this.vertices[e].applyMatrix4(n);for(let e=0,i=this.faces.length;e<i;e++){const a=this.faces[e];a.normal.applyMatrix3(t).normalize();for(let o=0,c=a.vertexNormals.length;o<c;o++)a.vertexNormals[o].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(n){return Vi.makeRotationX(n),this.applyMatrix4(Vi),this},rotateY:function(n){return Vi.makeRotationY(n),this.applyMatrix4(Vi),this},rotateZ:function(n){return Vi.makeRotationZ(n),this.applyMatrix4(Vi),this},translate:function(n,t,e){return Vi.makeTranslation(n,t,e),this.applyMatrix4(Vi),this},scale:function(n,t,e){return Vi.makeScale(n,t,e),this.applyMatrix4(Vi),this},lookAt:function(n){return Zp.lookAt(n),Zp.updateMatrix(),this.applyMatrix4(Zp.matrix),this},fromBufferGeometry:function(n){const t=this,e=n.index!==null?n.index:void 0,i=n.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const a=i.position,o=i.normal,c=i.color,u=i.uv,h=i.uv2;h!==void 0&&(this.faceVertexUvs[1]=[]);for(let p=0;p<a.count;p++)t.vertices.push(new G().fromBufferAttribute(a,p)),c!==void 0&&t.colors.push(new Wt().fromBufferAttribute(c,p));function d(p,g,v,x){const M=c===void 0?[]:[t.colors[p].clone(),t.colors[g].clone(),t.colors[v].clone()],S=o===void 0?[]:[new G().fromBufferAttribute(o,p),new G().fromBufferAttribute(o,g),new G().fromBufferAttribute(o,v)],w=new Jn(p,g,v,S,M,x);t.faces.push(w),u!==void 0&&t.faceVertexUvs[0].push([new ht().fromBufferAttribute(u,p),new ht().fromBufferAttribute(u,g),new ht().fromBufferAttribute(u,v)]),h!==void 0&&t.faceVertexUvs[1].push([new ht().fromBufferAttribute(h,p),new ht().fromBufferAttribute(h,g),new ht().fromBufferAttribute(h,v)])}const m=n.groups;if(m.length>0)for(let p=0;p<m.length;p++){const g=m[p],v=g.start,x=g.count;for(let M=v,S=v+x;M<S;M+=3)e!==void 0?d(e.getX(M),e.getX(M+1),e.getX(M+2),g.materialIndex):d(M,M+1,M+2,g.materialIndex)}else if(e!==void 0)for(let p=0;p<e.count;p+=3)d(e.getX(p),e.getX(p+1),e.getX(p+2));else for(let p=0;p<a.count;p+=3)d(p,p+1,p+2);return this.computeFaceNormals(),n.boundingBox!==null&&(this.boundingBox=n.boundingBox.clone()),n.boundingSphere!==null&&(this.boundingSphere=n.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(yh).negate(),this.translate(yh.x,yh.y,yh.z),this},normalize:function(){this.computeBoundingSphere();const n=this.boundingSphere.center,t=this.boundingSphere.radius,e=t===0?1:1/t,i=new re;return i.set(e,0,0,-e*n.x,0,e,0,-e*n.y,0,0,e,-e*n.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){const n=new G,t=new G;for(let e=0,i=this.faces.length;e<i;e++){const a=this.faces[e],o=this.vertices[a.a],c=this.vertices[a.b],u=this.vertices[a.c];n.subVectors(u,c),t.subVectors(o,c),n.cross(t),n.normalize(),a.normal.copy(n)}},computeVertexNormals:function(n=!0){const t=new Array(this.vertices.length);for(let e=0,i=this.vertices.length;e<i;e++)t[e]=new G;if(n){const e=new G,i=new G;for(let a=0,o=this.faces.length;a<o;a++){const c=this.faces[a],u=this.vertices[c.a],h=this.vertices[c.b],d=this.vertices[c.c];e.subVectors(d,h),i.subVectors(u,h),e.cross(i),t[c.a].add(e),t[c.b].add(e),t[c.c].add(e)}}else{this.computeFaceNormals();for(let e=0,i=this.faces.length;e<i;e++){const a=this.faces[e];t[a.a].add(a.normal),t[a.b].add(a.normal),t[a.c].add(a.normal)}}for(let e=0,i=this.vertices.length;e<i;e++)t[e].normalize();for(let e=0,i=this.faces.length;e<i;e++){const a=this.faces[e],o=a.vertexNormals;o.length===3?(o[0].copy(t[a.a]),o[1].copy(t[a.b]),o[2].copy(t[a.c])):(o[0]=t[a.a].clone(),o[1]=t[a.b].clone(),o[2]=t[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let n=0,t=this.faces.length;n<t;n++){const e=this.faces[n],i=e.vertexNormals;i.length===3?(i[0].copy(e.normal),i[1].copy(e.normal),i[2].copy(e.normal)):(i[0]=e.normal.clone(),i[1]=e.normal.clone(),i[2]=e.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let t=0,e=this.faces.length;t<e;t++){const i=this.faces[t];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let a=0,o=i.vertexNormals.length;a<o;a++)i.__originalVertexNormals[a]?i.__originalVertexNormals[a].copy(i.vertexNormals[a]):i.__originalVertexNormals[a]=i.vertexNormals[a].clone()}const n=new Tn;n.faces=this.faces;for(let t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];const a=this.morphNormals[t].faceNormals,o=this.morphNormals[t].vertexNormals;for(let c=0,u=this.faces.length;c<u;c++){const h=new G,d={a:new G,b:new G,c:new G};a.push(h),o.push(d)}}const i=this.morphNormals[t];n.vertices=this.morphTargets[t].vertices,n.computeFaceNormals(),n.computeVertexNormals();for(let a=0,o=this.faces.length;a<o;a++){const c=this.faces[a],u=i.faceNormals[a],h=i.vertexNormals[a];u.copy(c.normal),h.a.copy(c.vertexNormals[0]),h.b.copy(c.vertexNormals[1]),h.c.copy(c.vertexNormals[2])}}for(let t=0,e=this.faces.length;t<e;t++){const i=this.faces[t];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Ta),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Di),this.boundingSphere.setFromPoints(this.vertices)},merge:function(n,t,e=0){if(!(n&&n.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",n);return}let i;const a=this.vertices.length,o=this.vertices,c=n.vertices,u=this.faces,h=n.faces,d=this.colors,m=n.colors;t!==void 0&&(i=new Hn().getNormalMatrix(t));for(let p=0,g=c.length;p<g;p++){const x=c[p].clone();t!==void 0&&x.applyMatrix4(t),o.push(x)}for(let p=0,g=m.length;p<g;p++)d.push(m[p].clone());for(let p=0,g=h.length;p<g;p++){const v=h[p];let x,M;const S=v.vertexNormals,w=v.vertexColors,_=new Jn(v.a+a,v.b+a,v.c+a);_.normal.copy(v.normal),i!==void 0&&_.normal.applyMatrix3(i).normalize();for(let L=0,R=S.length;L<R;L++)x=S[L].clone(),i!==void 0&&x.applyMatrix3(i).normalize(),_.vertexNormals.push(x);_.color.copy(v.color);for(let L=0,R=w.length;L<R;L++)M=w[L],_.vertexColors.push(M.clone());_.materialIndex=v.materialIndex+e,u.push(_)}for(let p=0,g=n.faceVertexUvs.length;p<g;p++){const v=n.faceVertexUvs[p];this.faceVertexUvs[p]===void 0&&(this.faceVertexUvs[p]=[]);for(let x=0,M=v.length;x<M;x++){const S=v[x],w=[];for(let _=0,L=S.length;_<L;_++)w.push(S[_].clone());this.faceVertexUvs[p].push(w)}}},mergeMesh:function(n){if(!(n&&n.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",n);return}n.matrixAutoUpdate&&n.updateMatrix(),this.merge(n.geometry,n.matrix)},mergeVertices:function(n=4){const t={},e=[],i=[],a=Math.pow(10,n);for(let u=0,h=this.vertices.length;u<h;u++){const d=this.vertices[u],m=Math.round(d.x*a)+"_"+Math.round(d.y*a)+"_"+Math.round(d.z*a);t[m]===void 0?(t[m]=u,e.push(this.vertices[u]),i[u]=e.length-1):i[u]=i[t[m]]}const o=[];for(let u=0,h=this.faces.length;u<h;u++){const d=this.faces[u];d.a=i[d.a],d.b=i[d.b],d.c=i[d.c];const m=[d.a,d.b,d.c];for(let p=0;p<3;p++)if(m[p]===m[(p+1)%3]){o.push(u);break}}for(let u=o.length-1;u>=0;u--){const h=o[u];this.faces.splice(h,1);for(let d=0,m=this.faceVertexUvs.length;d<m;d++)this.faceVertexUvs[d].splice(h,1)}const c=this.vertices.length-e.length;return this.vertices=e,c},setFromPoints:function(n){this.vertices=[];for(let t=0,e=n.length;t<e;t++){const i=n[t];this.vertices.push(new G(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){const n=this.faces,t=n.length;for(let u=0;u<t;u++)n[u]._id=u;function e(u,h){return u.materialIndex-h.materialIndex}n.sort(e);const i=this.faceVertexUvs[0],a=this.faceVertexUvs[1];let o,c;i&&i.length===t&&(o=[]),a&&a.length===t&&(c=[]);for(let u=0;u<t;u++){const h=n[u]._id;o&&o.push(i[h]),c&&c.push(a[h])}o&&(this.faceVertexUvs[0]=o),c&&(this.faceVertexUvs[1]=c)},toJSON:function(){const n={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.parameters!==void 0){const v=this.parameters;for(const x in v)v[x]!==void 0&&(n[x]=v[x]);return n}const t=[];for(let v=0;v<this.vertices.length;v++){const x=this.vertices[v];t.push(x.x,x.y,x.z)}const e=[],i=[],a={},o=[],c={},u=[],h={};for(let v=0;v<this.faces.length;v++){const x=this.faces[v],M=!0,S=!1,w=this.faceVertexUvs[0][v]!==void 0,_=x.normal.length()>0,L=x.vertexNormals.length>0,R=x.color.r!==1||x.color.g!==1||x.color.b!==1,C=x.vertexColors.length>0;let A=0;if(A=d(A,0,0),A=d(A,1,M),A=d(A,2,S),A=d(A,3,w),A=d(A,4,_),A=d(A,5,L),A=d(A,6,R),A=d(A,7,C),e.push(A),e.push(x.a,x.b,x.c),e.push(x.materialIndex),w){const B=this.faceVertexUvs[0][v];e.push(g(B[0]),g(B[1]),g(B[2]))}if(_&&e.push(m(x.normal)),L){const B=x.vertexNormals;e.push(m(B[0]),m(B[1]),m(B[2]))}if(R&&e.push(p(x.color)),C){const B=x.vertexColors;e.push(p(B[0]),p(B[1]),p(B[2]))}}function d(v,x,M){return M?v|1<<x:v&~(1<<x)}function m(v){const x=v.x.toString()+v.y.toString()+v.z.toString();return a[x]!==void 0||(a[x]=i.length/3,i.push(v.x,v.y,v.z)),a[x]}function p(v){const x=v.r.toString()+v.g.toString()+v.b.toString();return c[x]!==void 0||(c[x]=o.length,o.push(v.getHex())),c[x]}function g(v){const x=v.x.toString()+v.y.toString();return h[x]!==void 0||(h[x]=u.length/2,u.push(v.x,v.y)),h[x]}return n.data={},n.data.vertices=t,n.data.normals=i,o.length>0&&(n.data.colors=o),u.length>0&&(n.data.uvs=[u]),n.data.faces=e,n},clone:function(){return new Tn().copy(this)},copy:function(n){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=n.name;const t=n.vertices;for(let p=0,g=t.length;p<g;p++)this.vertices.push(t[p].clone());const e=n.colors;for(let p=0,g=e.length;p<g;p++)this.colors.push(e[p].clone());const i=n.faces;for(let p=0,g=i.length;p<g;p++)this.faces.push(i[p].clone());for(let p=0,g=n.faceVertexUvs.length;p<g;p++){const v=n.faceVertexUvs[p];this.faceVertexUvs[p]===void 0&&(this.faceVertexUvs[p]=[]);for(let x=0,M=v.length;x<M;x++){const S=v[x],w=[];for(let _=0,L=S.length;_<L;_++){const R=S[_];w.push(R.clone())}this.faceVertexUvs[p].push(w)}}const a=n.morphTargets;for(let p=0,g=a.length;p<g;p++){const v={};if(v.name=a[p].name,a[p].vertices!==void 0){v.vertices=[];for(let x=0,M=a[p].vertices.length;x<M;x++)v.vertices.push(a[p].vertices[x].clone())}if(a[p].normals!==void 0){v.normals=[];for(let x=0,M=a[p].normals.length;x<M;x++)v.normals.push(a[p].normals[x].clone())}this.morphTargets.push(v)}const o=n.morphNormals;for(let p=0,g=o.length;p<g;p++){const v={};if(o[p].vertexNormals!==void 0){v.vertexNormals=[];for(let x=0,M=o[p].vertexNormals.length;x<M;x++){const S=o[p].vertexNormals[x],w={};w.a=S.a.clone(),w.b=S.b.clone(),w.c=S.c.clone(),v.vertexNormals.push(w)}}if(o[p].faceNormals!==void 0){v.faceNormals=[];for(let x=0,M=o[p].faceNormals.length;x<M;x++)v.faceNormals.push(o[p].faceNormals[x].clone())}this.morphNormals.push(v)}const c=n.skinWeights;for(let p=0,g=c.length;p<g;p++)this.skinWeights.push(c[p].clone());const u=n.skinIndices;for(let p=0,g=u.length;p<g;p++)this.skinIndices.push(u[p].clone());const h=n.lineDistances;for(let p=0,g=h.length;p<g;p++)this.lineDistances.push(h[p]);const d=n.boundingBox;d!==null&&(this.boundingBox=d.clone());const m=n.boundingSphere;return m!==null&&(this.boundingSphere=m.clone()),this.elementsNeedUpdate=n.elementsNeedUpdate,this.verticesNeedUpdate=n.verticesNeedUpdate,this.uvsNeedUpdate=n.uvsNeedUpdate,this.normalsNeedUpdate=n.normalsNeedUpdate,this.colorsNeedUpdate=n.colorsNeedUpdate,this.lineDistancesNeedUpdate=n.lineDistancesNeedUpdate,this.groupsNeedUpdate=n.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class xb extends Tn{constructor(t,e,i,a,o,c){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:a,heightSegments:o,depthSegments:c},this.fromBufferGeometry(new tg(t,e,i,a,o,c)),this.mergeVertices()}}new G;new G;new G;new Sn;const G3={triangulate:function(n,t,e){e=e||2;const i=t&&t.length,a=i?t[0]*e:n.length;let o=G_(n,0,a,e,!0);const c=[];if(!o||o.next===o.prev)return c;let u,h,d,m,p,g,v;if(i&&(o=q3(n,t,o,e)),n.length>80*e){u=d=n[0],h=m=n[1];for(let x=e;x<a;x+=e)p=n[x],g=n[x+1],p<u&&(u=p),g<h&&(h=g),p>d&&(d=p),g>m&&(m=g);v=Math.max(d-u,m-h),v=v!==0?1/v:0}return bc(o,c,e,u,h,v),c}};function G_(n,t,e,i,a){let o,c;if(a===iC(n,t,e,i)>0)for(o=t;o<e;o+=i)c=bb(o,n[o],n[o+1],c);else for(o=e-i;o>=t;o-=i)c=bb(o,n[o],n[o+1],c);return c&&ef(c,c.next)&&(wc(c),c=c.next),c}function Ma(n,t){if(!n)return n;t||(t=n);let e=n,i;do if(i=!1,!e.steiner&&(ef(e,e.next)||qe(e.prev,e,e.next)===0)){if(wc(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function bc(n,t,e,i,a,o,c){if(!n)return;!c&&o&&J3(n,i,a,o);let u=n,h,d;for(;n.prev!==n.next;){if(h=n.prev,d=n.next,o?k3(n,i,a,o):V3(n)){t.push(h.i/e),t.push(n.i/e),t.push(d.i/e),wc(n),n=d.next,u=d.next;continue}if(n=d,n===u){c?c===1?(n=W3(Ma(n),t,e),bc(n,t,e,i,a,o,2)):c===2&&j3(n,t,e,i,a,o):bc(Ma(n),t,e,i,a,o,1);break}}}function V3(n){const t=n.prev,e=n,i=n.next;if(qe(t,e,i)>=0)return!1;let a=n.next.next;for(;a!==n.prev;){if(To(t.x,t.y,e.x,e.y,i.x,i.y,a.x,a.y)&&qe(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function k3(n,t,e,i){const a=n.prev,o=n,c=n.next;if(qe(a,o,c)>=0)return!1;const u=a.x<o.x?a.x<c.x?a.x:c.x:o.x<c.x?o.x:c.x,h=a.y<o.y?a.y<c.y?a.y:c.y:o.y<c.y?o.y:c.y,d=a.x>o.x?a.x>c.x?a.x:c.x:o.x>c.x?o.x:c.x,m=a.y>o.y?a.y>c.y?a.y:c.y:o.y>c.y?o.y:c.y,p=Mm(u,h,t,e,i),g=Mm(d,m,t,e,i);let v=n.prevZ,x=n.nextZ;for(;v&&v.z>=p&&x&&x.z<=g;){if(v!==n.prev&&v!==n.next&&To(a.x,a.y,o.x,o.y,c.x,c.y,v.x,v.y)&&qe(v.prev,v,v.next)>=0||(v=v.prevZ,x!==n.prev&&x!==n.next&&To(a.x,a.y,o.x,o.y,c.x,c.y,x.x,x.y)&&qe(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;v&&v.z>=p;){if(v!==n.prev&&v!==n.next&&To(a.x,a.y,o.x,o.y,c.x,c.y,v.x,v.y)&&qe(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;x&&x.z<=g;){if(x!==n.prev&&x!==n.next&&To(a.x,a.y,o.x,o.y,c.x,c.y,x.x,x.y)&&qe(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function W3(n,t,e){let i=n;do{const a=i.prev,o=i.next.next;!ef(a,o)&&V_(a,i,i.next,o)&&_c(a,o)&&_c(o,a)&&(t.push(a.i/e),t.push(i.i/e),t.push(o.i/e),wc(i),wc(i.next),i=n=o),i=i.next}while(i!==n);return Ma(i)}function j3(n,t,e,i,a,o){let c=n;do{let u=c.next.next;for(;u!==c.prev;){if(c.i!==u.i&&tC(c,u)){let h=k_(c,u);c=Ma(c,c.next),h=Ma(h,h.next),bc(c,t,e,i,a,o),bc(h,t,e,i,a,o);return}u=u.next}c=c.next}while(c!==n)}function q3(n,t,e,i){const a=[];let o,c,u,h,d;for(o=0,c=t.length;o<c;o++)u=t[o]*i,h=o<c-1?t[o+1]*i:n.length,d=G_(n,u,h,i,!1),d===d.next&&(d.steiner=!0),a.push($3(d));for(a.sort(Y3),o=0;o<a.length;o++)X3(a[o],e),e=Ma(e,e.next);return e}function Y3(n,t){return n.x-t.x}function X3(n,t){if(t=Z3(n,t),t){const e=k_(t,n);Ma(t,t.next),Ma(e,e.next)}}function Z3(n,t){let e=t;const i=n.x,a=n.y;let o=-1/0,c;do{if(a<=e.y&&a>=e.next.y&&e.next.y!==e.y){const g=e.x+(a-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(g<=i&&g>o){if(o=g,g===i){if(a===e.y)return e;if(a===e.next.y)return e.next}c=e.x<e.next.x?e:e.next}}e=e.next}while(e!==t);if(!c)return null;if(i===o)return c;const u=c,h=c.x,d=c.y;let m=1/0,p;e=c;do i>=e.x&&e.x>=h&&i!==e.x&&To(a<d?i:o,a,h,d,a<d?o:i,a,e.x,e.y)&&(p=Math.abs(a-e.y)/(i-e.x),_c(e,n)&&(p<m||p===m&&(e.x>c.x||e.x===c.x&&Q3(c,e)))&&(c=e,m=p)),e=e.next;while(e!==u);return c}function Q3(n,t){return qe(n.prev,n,t.prev)<0&&qe(t.next,n,n.next)<0}function J3(n,t,e,i){let a=n;do a.z===null&&(a.z=Mm(a.x,a.y,t,e,i)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==n);a.prevZ.nextZ=null,a.prevZ=null,K3(a)}function K3(n){let t,e,i,a,o,c,u,h,d=1;do{for(e=n,n=null,o=null,c=0;e;){for(c++,i=e,u=0,t=0;t<d&&(u++,i=i.nextZ,!!i);t++);for(h=d;u>0||h>0&&i;)u!==0&&(h===0||!i||e.z<=i.z)?(a=e,e=e.nextZ,u--):(a=i,i=i.nextZ,h--),o?o.nextZ=a:n=a,a.prevZ=o,o=a;e=i}o.nextZ=null,d*=2}while(c>1);return n}function Mm(n,t,e,i,a){return n=32767*(n-e)*a,t=32767*(t-i)*a,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,n|t<<1}function $3(n){let t=n,e=n;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==n);return e}function To(n,t,e,i,a,o,c,u){return(a-c)*(t-u)-(n-c)*(o-u)>=0&&(n-c)*(i-u)-(e-c)*(t-u)>=0&&(e-c)*(o-u)-(a-c)*(i-u)>=0}function tC(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!eC(n,t)&&(_c(n,t)&&_c(t,n)&&nC(n,t)&&(qe(n.prev,n,t.prev)||qe(n,t.prev,t))||ef(n,t)&&qe(n.prev,n,n.next)>0&&qe(t.prev,t,t.next)>0)}function qe(n,t,e){return(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y)}function ef(n,t){return n.x===t.x&&n.y===t.y}function V_(n,t,e,i){const a=xh(qe(n,t,e)),o=xh(qe(n,t,i)),c=xh(qe(e,i,n)),u=xh(qe(e,i,t));return!!(a!==o&&c!==u||a===0&&vh(n,e,t)||o===0&&vh(n,i,t)||c===0&&vh(e,n,i)||u===0&&vh(e,t,i))}function vh(n,t,e){return t.x<=Math.max(n.x,e.x)&&t.x>=Math.min(n.x,e.x)&&t.y<=Math.max(n.y,e.y)&&t.y>=Math.min(n.y,e.y)}function xh(n){return n>0?1:n<0?-1:0}function eC(n,t){let e=n;do{if(e.i!==n.i&&e.next.i!==n.i&&e.i!==t.i&&e.next.i!==t.i&&V_(e,e.next,n,t))return!0;e=e.next}while(e!==n);return!1}function _c(n,t){return qe(n.prev,n,n.next)<0?qe(n,t,n.next)>=0&&qe(n,n.prev,t)>=0:qe(n,t,n.prev)<0||qe(n,n.next,t)<0}function nC(n,t){let e=n,i=!1;const a=(n.x+t.x)/2,o=(n.y+t.y)/2;do e.y>o!=e.next.y>o&&e.next.y!==e.y&&a<(e.next.x-e.x)*(o-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==n);return i}function k_(n,t){const e=new Sm(n.i,n.x,n.y),i=new Sm(t.i,t.x,t.y),a=n.next,o=t.prev;return n.next=t,t.prev=n,e.next=a,a.prev=e,i.next=e,e.prev=i,o.next=i,i.prev=o,i}function bb(n,t,e,i){const a=new Sm(n,t,e);return i?(a.next=i.next,a.prev=i,i.next.prev=a,i.next=a):(a.prev=a,a.next=a),a}function wc(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Sm(n,t,e){this.i=n,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function iC(n,t,e,i){let a=0;for(let o=t,c=e-i;o<e;o+=i)a+=(n[c]-n[o])*(n[o+1]+n[c+1]),c=o;return a}const xa={area:function(n){const t=n.length;let e=0;for(let i=t-1,a=0;a<t;i=a++)e+=n[i].x*n[a].y-n[a].x*n[i].y;return e*.5},isClockWise:function(n){return xa.area(n)<0},triangulateShape:function(n,t){const e=[],i=[],a=[];_b(n),wb(e,n);let o=n.length;t.forEach(_b);for(let u=0;u<t.length;u++)i.push(o),o+=t[u].length,wb(e,t[u]);const c=G3.triangulate(e,i);for(let u=0;u<c.length;u+=3)a.push(c.slice(u,u+3));return a}};function _b(n){const t=n.length;t>2&&n[t-1].equals(n[0])&&n.pop()}function wb(n,t){for(let e=0;e<t.length;e++)n.push(t[e].x),n.push(t[e].y)}class W_ extends Re{constructor(t,e){super(),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const i=this,a=[],o=[];for(let u=0,h=t.length;u<h;u++){const d=t[u];c(d)}this.setAttribute("position",new we(a,3)),this.setAttribute("uv",new we(o,2)),this.computeVertexNormals();function c(u){const h=[],d=e.curveSegments!==void 0?e.curveSegments:12,m=e.steps!==void 0?e.steps:1;let p=e.depth!==void 0?e.depth:100,g=e.bevelEnabled!==void 0?e.bevelEnabled:!0,v=e.bevelThickness!==void 0?e.bevelThickness:6,x=e.bevelSize!==void 0?e.bevelSize:v-2,M=e.bevelOffset!==void 0?e.bevelOffset:0,S=e.bevelSegments!==void 0?e.bevelSegments:3;const w=e.extrudePath,_=e.UVGenerator!==void 0?e.UVGenerator:sC;e.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),p=e.amount);let L,R=!1,C,A,B,Y;w&&(L=w.getSpacedPoints(m),R=!0,g=!1,C=w.computeFrenetFrames(m,!1),A=new G,B=new G,Y=new G),g||(S=0,v=0,x=0,M=0);const X=u.extractPoints(d);let st=X.shape;const V=X.holes;if(!xa.isClockWise(st)){st=st.reverse();for(let vt=0,Et=V.length;vt<Et;vt++){const wt=V[vt];xa.isClockWise(wt)&&(V[vt]=wt.reverse())}}const I=xa.triangulateShape(st,V),H=st;for(let vt=0,Et=V.length;vt<Et;vt++){const wt=V[vt];st=st.concat(wt)}function U(vt,Et,wt){return Et||console.error("THREE.ExtrudeGeometry: vec does not exist"),Et.clone().multiplyScalar(wt).add(vt)}const z=st.length,Q=I.length;function $(vt,Et,wt){let Ft,Rt,F;const O=vt.x-Et.x,_t=vt.y-Et.y,xt=wt.x-vt.x,J=wt.y-vt.y,Mt=O*O+_t*_t,Nt=O*J-_t*xt;if(Math.abs(Nt)>Number.EPSILON){const Ot=Math.sqrt(Mt),Tt=Math.sqrt(xt*xt+J*J),W=Et.x-_t/Ot,St=Et.y+O/Ot,Pt=wt.x-J/Tt,At=wt.y+xt/Tt,Vt=((Pt-W)*J-(At-St)*xt)/(O*J-_t*xt);Ft=W+O*Vt-vt.x,Rt=St+_t*Vt-vt.y;const ye=Ft*Ft+Rt*Rt;if(ye<=2)return new ht(Ft,Rt);F=Math.sqrt(ye/2)}else{let Ot=!1;O>Number.EPSILON?xt>Number.EPSILON&&(Ot=!0):O<-Number.EPSILON?xt<-Number.EPSILON&&(Ot=!0):Math.sign(_t)===Math.sign(J)&&(Ot=!0),Ot?(Ft=-_t,Rt=O,F=Math.sqrt(Mt)):(Ft=O,Rt=_t,F=Math.sqrt(Mt/2))}return new ht(Ft/F,Rt/F)}const it=[];for(let vt=0,Et=H.length,wt=Et-1,Ft=vt+1;vt<Et;vt++,wt++,Ft++)wt===Et&&(wt=0),Ft===Et&&(Ft=0),it[vt]=$(H[vt],H[wt],H[Ft]);const ct=[];let D,q=it.concat();for(let vt=0,Et=V.length;vt<Et;vt++){const wt=V[vt];D=[];for(let Ft=0,Rt=wt.length,F=Rt-1,O=Ft+1;Ft<Rt;Ft++,F++,O++)F===Rt&&(F=0),O===Rt&&(O=0),D[Ft]=$(wt[Ft],wt[F],wt[O]);ct.push(D),q=q.concat(D)}for(let vt=0;vt<S;vt++){const Et=vt/S,wt=v*Math.cos(Et*Math.PI/2),Ft=x*Math.sin(Et*Math.PI/2)+M;for(let Rt=0,F=H.length;Rt<F;Rt++){const O=U(H[Rt],it[Rt],Ft);bt(O.x,O.y,-wt)}for(let Rt=0,F=V.length;Rt<F;Rt++){const O=V[Rt];D=ct[Rt];for(let _t=0,xt=O.length;_t<xt;_t++){const J=U(O[_t],D[_t],Ft);bt(J.x,J.y,-wt)}}}const ut=x+M;for(let vt=0;vt<z;vt++){const Et=g?U(st[vt],q[vt],ut):st[vt];R?(B.copy(C.normals[0]).multiplyScalar(Et.x),A.copy(C.binormals[0]).multiplyScalar(Et.y),Y.copy(L[0]).add(B).add(A),bt(Y.x,Y.y,Y.z)):bt(Et.x,Et.y,0)}for(let vt=1;vt<=m;vt++)for(let Et=0;Et<z;Et++){const wt=g?U(st[Et],q[Et],ut):st[Et];R?(B.copy(C.normals[vt]).multiplyScalar(wt.x),A.copy(C.binormals[vt]).multiplyScalar(wt.y),Y.copy(L[vt]).add(B).add(A),bt(Y.x,Y.y,Y.z)):bt(wt.x,wt.y,p/m*vt)}for(let vt=S-1;vt>=0;vt--){const Et=vt/S,wt=v*Math.cos(Et*Math.PI/2),Ft=x*Math.sin(Et*Math.PI/2)+M;for(let Rt=0,F=H.length;Rt<F;Rt++){const O=U(H[Rt],it[Rt],Ft);bt(O.x,O.y,p+wt)}for(let Rt=0,F=V.length;Rt<F;Rt++){const O=V[Rt];D=ct[Rt];for(let _t=0,xt=O.length;_t<xt;_t++){const J=U(O[_t],D[_t],Ft);R?bt(J.x,J.y+L[m-1].y,L[m-1].x+wt):bt(J.x,J.y,p+wt)}}}yt(),tt();function yt(){const vt=a.length/3;if(g){let Et=0,wt=z*Et;for(let Ft=0;Ft<Q;Ft++){const Rt=I[Ft];Ht(Rt[2]+wt,Rt[1]+wt,Rt[0]+wt)}Et=m+S*2,wt=z*Et;for(let Ft=0;Ft<Q;Ft++){const Rt=I[Ft];Ht(Rt[0]+wt,Rt[1]+wt,Rt[2]+wt)}}else{for(let Et=0;Et<Q;Et++){const wt=I[Et];Ht(wt[2],wt[1],wt[0])}for(let Et=0;Et<Q;Et++){const wt=I[Et];Ht(wt[0]+z*m,wt[1]+z*m,wt[2]+z*m)}}i.addGroup(vt,a.length/3-vt,0)}function tt(){const vt=a.length/3;let Et=0;Ct(H,Et),Et+=H.length;for(let wt=0,Ft=V.length;wt<Ft;wt++){const Rt=V[wt];Ct(Rt,Et),Et+=Rt.length}i.addGroup(vt,a.length/3-vt,1)}function Ct(vt,Et){let wt=vt.length;for(;--wt>=0;){const Ft=wt;let Rt=wt-1;Rt<0&&(Rt=vt.length-1);for(let F=0,O=m+S*2;F<O;F++){const _t=z*F,xt=z*(F+1),J=Et+Ft+_t,Mt=Et+Rt+_t,Nt=Et+Rt+xt,Ot=Et+Ft+xt;Lt(J,Mt,Nt,Ot)}}}function bt(vt,Et,wt){h.push(vt),h.push(Et),h.push(wt)}function Ht(vt,Et,wt){Qt(vt),Qt(Et),Qt(wt);const Ft=a.length/3,Rt=_.generateTopUV(i,a,Ft-3,Ft-2,Ft-1);kt(Rt[0]),kt(Rt[1]),kt(Rt[2])}function Lt(vt,Et,wt,Ft){Qt(vt),Qt(Et),Qt(Ft),Qt(Et),Qt(wt),Qt(Ft);const Rt=a.length/3,F=_.generateSideWallUV(i,a,Rt-6,Rt-3,Rt-2,Rt-1);kt(F[0]),kt(F[1]),kt(F[3]),kt(F[1]),kt(F[2]),kt(F[3])}function Qt(vt){a.push(h[vt*3+0]),a.push(h[vt*3+1]),a.push(h[vt*3+2])}function kt(vt){o.push(vt.x),o.push(vt.y)}}}toJSON(){const t=Re.prototype.toJSON.call(this),e=this.parameters.shapes,i=this.parameters.options;return aC(e,i,t)}}const sC={generateTopUV:function(n,t,e,i,a){const o=t[e*3],c=t[e*3+1],u=t[i*3],h=t[i*3+1],d=t[a*3],m=t[a*3+1];return[new ht(o,c),new ht(u,h),new ht(d,m)]},generateSideWallUV:function(n,t,e,i,a,o){const c=t[e*3],u=t[e*3+1],h=t[e*3+2],d=t[i*3],m=t[i*3+1],p=t[i*3+2],g=t[a*3],v=t[a*3+1],x=t[a*3+2],M=t[o*3],S=t[o*3+1],w=t[o*3+2];return Math.abs(u-m)<.01?[new ht(c,1-h),new ht(d,1-p),new ht(g,1-x),new ht(M,1-w)]:[new ht(u,1-h),new ht(m,1-p),new ht(v,1-x),new ht(S,1-w)]}};function aC(n,t,e){if(e.shapes=[],Array.isArray(n))for(let i=0,a=n.length;i<a;i++){const o=n[i];e.shapes.push(o.uuid)}else e.shapes.push(n.uuid);return t.extrudePath!==void 0&&(e.options.extrudePath=t.extrudePath.toJSON()),e}class rC extends Tn{constructor(t,e){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new W_(t,e)),this.mergeVertices()}toJSON(){const t=super.toJSON(),e=this.parameters.shapes,i=this.parameters.options;return oC(e,i,t)}}function oC(n,t,e){if(e.shapes=[],Array.isArray(n))for(let i=0,a=n.length;i<a;i++){const o=n[i];e.shapes.push(o.uuid)}else e.shapes.push(n.uuid);return t.extrudePath!==void 0&&(e.options.extrudePath=t.extrudePath.toJSON()),e}function Gh(n,t,e){Re.call(this),this.type="ParametricBufferGeometry",this.parameters={func:n,slices:t,stacks:e};const i=[],a=[],o=[],c=[],u=1e-5,h=new G,d=new G,m=new G,p=new G,g=new G;n.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const v=t+1;for(let x=0;x<=e;x++){const M=x/e;for(let S=0;S<=t;S++){const w=S/t;n(w,M,d),a.push(d.x,d.y,d.z),w-u>=0?(n(w-u,M,m),p.subVectors(d,m)):(n(w+u,M,m),p.subVectors(m,d)),M-u>=0?(n(w,M-u,m),g.subVectors(d,m)):(n(w,M+u,m),g.subVectors(m,d)),h.crossVectors(p,g).normalize(),o.push(h.x,h.y,h.z),c.push(w,M)}}for(let x=0;x<e;x++)for(let M=0;M<t;M++){const S=x*v+M,w=x*v+M+1,_=(x+1)*v+M+1,L=(x+1)*v+M;i.push(S,w,L),i.push(w,_,L)}this.setIndex(i),this.setAttribute("position",new we(a,3)),this.setAttribute("normal",new we(o,3)),this.setAttribute("uv",new we(c,2))}Gh.prototype=Object.create(Re.prototype);Gh.prototype.constructor=Gh;function Em(n,t,e){Tn.call(this),this.type="ParametricGeometry",this.parameters={func:n,slices:t,stacks:e},this.fromBufferGeometry(new Gh(n,t,e)),this.mergeVertices()}Em.prototype=Object.create(Tn.prototype);Em.prototype.constructor=Em;class lC extends Tn{constructor(t,e,i,a){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:a},this.fromBufferGeometry(new R_(t,e,i,a)),this.mergeVertices()}}class cC extends Re{constructor(t,e=12){super(),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e};const i=[],a=[],o=[],c=[];let u=0,h=0;if(Array.isArray(t)===!1)d(t);else for(let m=0;m<t.length;m++)d(t[m]),this.addGroup(u,h,m),u+=h,h=0;this.setIndex(i),this.setAttribute("position",new we(a,3)),this.setAttribute("normal",new we(o,3)),this.setAttribute("uv",new we(c,2));function d(m){const p=a.length/3,g=m.extractPoints(e);let v=g.shape;const x=g.holes;xa.isClockWise(v)===!1&&(v=v.reverse());for(let S=0,w=x.length;S<w;S++){const _=x[S];xa.isClockWise(_)===!0&&(x[S]=_.reverse())}const M=xa.triangulateShape(v,x);for(let S=0,w=x.length;S<w;S++){const _=x[S];v=v.concat(_)}for(let S=0,w=v.length;S<w;S++){const _=v[S];a.push(_.x,_.y,0),o.push(0,0,1),c.push(_.x,_.y)}for(let S=0,w=M.length;S<w;S++){const _=M[S],L=_[0]+p,R=_[1]+p,C=_[2]+p;i.push(L,R,C),h+=3}}}toJSON(){const t=Re.prototype.toJSON.call(this),e=this.parameters.shapes;return uC(e,t)}}function uC(n,t){if(t.shapes=[],Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const a=n[e];t.shapes.push(a.uuid)}else t.shapes.push(n.uuid);return t}class hC extends Tn{constructor(t,e){super(),this.type="ShapeGeometry",typeof e=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new cC(t,e)),this.mergeVertices()}toJSON(){const t=Tn.prototype.toJSON.call(this),e=this.parameters.shapes;return fC(e,t)}}function fC(n,t){if(t.shapes=[],Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const a=n[e];t.shapes.push(a.uuid)}else t.shapes.push(n.uuid);return t}function fr(n){Jt.call(this),this.type="ShadowMaterial",this.color=new Wt(0),this.transparent=!0,this.setValues(n)}fr.prototype=Object.create(Jt.prototype);fr.prototype.constructor=fr;fr.prototype.isShadowMaterial=!0;fr.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.color.copy(n.color),this};function Mc(n){Gn.call(this,n),this.type="RawShaderMaterial"}Mc.prototype=Object.create(Gn.prototype);Mc.prototype.constructor=Mc;Mc.prototype.isRawShaderMaterial=!0;function Qi(n){Jt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Wt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qo,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(n)}Qi.prototype=Object.create(Jt.prototype);Qi.prototype.constructor=Qi;Qi.prototype.isMeshStandardMaterial=!0;Qi.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.defines={STANDARD:""},this.color.copy(n.color),this.roughness=n.roughness,this.metalness=n.metalness,this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.roughnessMap=n.roughnessMap,this.metalnessMap=n.metalnessMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.envMapIntensity=n.envMapIntensity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.morphNormals=n.morphNormals,this.vertexTangents=n.vertexTangents,this};function Sa(n){Qi.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ht(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(t){this.reflectivity=ne.clamp(2.5*(t-1)/(t+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(n)}Sa.prototype=Object.create(Qi.prototype);Sa.prototype.constructor=Sa;Sa.prototype.isMeshPhysicalMaterial=!0;Sa.prototype.copy=function(n){return Qi.prototype.copy.call(this,n),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=n.clearcoat,this.clearcoatMap=n.clearcoatMap,this.clearcoatRoughness=n.clearcoatRoughness,this.clearcoatRoughnessMap=n.clearcoatRoughnessMap,this.clearcoatNormalMap=n.clearcoatNormalMap,this.clearcoatNormalScale.copy(n.clearcoatNormalScale),this.reflectivity=n.reflectivity,n.sheen?this.sheen=(this.sheen||new Wt).copy(n.sheen):this.sheen=null,this.transmission=n.transmission,this.transmissionMap=n.transmissionMap,this};function dr(n){Jt.call(this),this.type="MeshPhongMaterial",this.color=new Wt(16777215),this.specular=new Wt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qo,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(n)}dr.prototype=Object.create(Jt.prototype);dr.prototype.constructor=dr;dr.prototype.isMeshPhongMaterial=!0;dr.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.color.copy(n.color),this.specular.copy(n.specular),this.shininess=n.shininess,this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.morphNormals=n.morphNormals,this};function Io(n){Jt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Wt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qo,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(n)}Io.prototype=Object.create(Jt.prototype);Io.prototype.constructor=Io;Io.prototype.isMeshToonMaterial=!0;Io.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.color.copy(n.color),this.map=n.map,this.gradientMap=n.gradientMap,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.alphaMap=n.alphaMap,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.morphNormals=n.morphNormals,this};function Fo(n){Jt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qo,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(n)}Fo.prototype=Object.create(Jt.prototype);Fo.prototype.constructor=Fo;Fo.prototype.isMeshNormalMaterial=!0;Fo.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.morphNormals=n.morphNormals,this};function Ho(n){Jt.call(this),this.type="MeshLambertMaterial",this.color=new Wt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(n)}Ho.prototype=Object.create(Jt.prototype);Ho.prototype.constructor=Ho;Ho.prototype.isMeshLambertMaterial=!0;Ho.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.color.copy(n.color),this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.morphNormals=n.morphNormals,this};function Go(n){Jt.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Wt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qo,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(n)}Go.prototype=Object.create(Jt.prototype);Go.prototype.constructor=Go;Go.prototype.isMeshMatcapMaterial=!0;Go.prototype.copy=function(n){return Jt.prototype.copy.call(this,n),this.defines={MATCAP:""},this.color.copy(n.color),this.matcap=n.matcap,this.map=n.map,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.alphaMap=n.alphaMap,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.morphNormals=n.morphNormals,this};function Vo(n){vi.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(n)}Vo.prototype=Object.create(vi.prototype);Vo.prototype.constructor=Vo;Vo.prototype.isLineDashedMaterial=!0;Vo.prototype.copy=function(n){return vi.prototype.copy.call(this,n),this.scale=n.scale,this.dashSize=n.dashSize,this.gapSize=n.gapSize,this};var dC=Object.freeze({__proto__:null,ShadowMaterial:fr,SpriteMaterial:ur,RawShaderMaterial:Mc,ShaderMaterial:Gn,PointsMaterial:hr,MeshPhysicalMaterial:Sa,MeshStandardMaterial:Qi,MeshPhongMaterial:dr,MeshToonMaterial:Io,MeshNormalMaterial:Fo,MeshLambertMaterial:Ho,MeshDepthMaterial:or,MeshDistanceMaterial:lr,MeshBasicMaterial:ba,MeshMatcapMaterial:Go,LineDashedMaterial:Vo,LineBasicMaterial:vi,Material:Jt});const ke={arraySlice:function(n,t,e){return ke.isTypedArray(n)?new n.constructor(n.subarray(t,e!==void 0?e:n.length)):n.slice(t,e)},convertArray:function(n,t,e){return!n||!e&&n.constructor===t?n:typeof t.BYTES_PER_ELEMENT=="number"?new t(n):Array.prototype.slice.call(n)},isTypedArray:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)},getKeyframeOrder:function(n){function t(a,o){return n[a]-n[o]}const e=n.length,i=new Array(e);for(let a=0;a!==e;++a)i[a]=a;return i.sort(t),i},sortedArray:function(n,t,e){const i=n.length,a=new n.constructor(i);for(let o=0,c=0;c!==i;++o){const u=e[o]*t;for(let h=0;h!==t;++h)a[c++]=n[u+h]}return a},flattenJSON:function(n,t,e,i){let a=1,o=n[0];for(;o!==void 0&&o[i]===void 0;)o=n[a++];if(o===void 0)return;let c=o[i];if(c!==void 0)if(Array.isArray(c))do c=o[i],c!==void 0&&(t.push(o.time),e.push.apply(e,c)),o=n[a++];while(o!==void 0);else if(c.toArray!==void 0)do c=o[i],c!==void 0&&(t.push(o.time),c.toArray(e,e.length)),o=n[a++];while(o!==void 0);else do c=o[i],c!==void 0&&(t.push(o.time),e.push(c)),o=n[a++];while(o!==void 0)},subclip:function(n,t,e,i,a=30){const o=n.clone();o.name=t;const c=[];for(let h=0;h<o.tracks.length;++h){const d=o.tracks[h],m=d.getValueSize(),p=[],g=[];for(let v=0;v<d.times.length;++v){const x=d.times[v]*a;if(!(x<e||x>=i)){p.push(d.times[v]);for(let M=0;M<m;++M)g.push(d.values[v*m+M])}}p.length!==0&&(d.times=ke.convertArray(p,d.times.constructor),d.values=ke.convertArray(g,d.values.constructor),c.push(d))}o.tracks=c;let u=1/0;for(let h=0;h<o.tracks.length;++h)u>o.tracks[h].times[0]&&(u=o.tracks[h].times[0]);for(let h=0;h<o.tracks.length;++h)o.tracks[h].shift(-1*u);return o.resetDuration(),o},makeClipAdditive:function(n,t=0,e=n,i=30){i<=0&&(i=30);const a=e.tracks.length,o=t/i;for(let c=0;c<a;++c){const u=e.tracks[c],h=u.ValueTypeName;if(h==="bool"||h==="string")continue;const d=n.tracks.find(function(w){return w.name===u.name&&w.ValueTypeName===h});if(d===void 0)continue;let m=0;const p=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=p/3);let g=0;const v=d.getValueSize();d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=v/3);const x=u.times.length-1;let M;if(o<=u.times[0]){const w=m,_=p-m;M=ke.arraySlice(u.values,w,_)}else if(o>=u.times[x]){const w=x*p+m,_=w+p-m;M=ke.arraySlice(u.values,w,_)}else{const w=u.createInterpolant(),_=m,L=p-m;w.evaluate(o),M=ke.arraySlice(w.resultBuffer,_,L)}h==="quaternion"&&new Nn().fromArray(M).normalize().conjugate().toArray(M);const S=d.times.length;for(let w=0;w<S;++w){const _=w*v+g;if(h==="quaternion")Nn.multiplyQuaternionsFlat(d.values,_,M,0,d.values,_);else{const L=v-g*2;for(let R=0;R<L;++R)d.values[_+R]-=M[R]}}}return n.blendMode=S_,n}};function mi(n,t,e,i){this.parameterPositions=n,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(e),this.sampleValues=t,this.valueSize=e}Object.assign(mi.prototype,{evaluate:function(n){const t=this.parameterPositions;let e=this._cachedIndex,i=t[e],a=t[e-1];t:{e:{let o;n:{i:if(!(n<i)){for(let c=e+2;;){if(i===void 0){if(n<a)break i;return e=t.length,this._cachedIndex=e,this.afterEnd_(e-1,n,a)}if(e===c)break;if(a=i,i=t[++e],n<i)break e}o=t.length;break n}if(!(n>=a)){const c=t[1];n<c&&(e=2,a=c);for(let u=e-2;;){if(a===void 0)return this._cachedIndex=0,this.beforeStart_(0,n,i);if(e===u)break;if(i=a,a=t[--e-1],n>=a)break e}o=e,e=0;break n}break t}for(;e<o;){const c=e+o>>>1;n<t[c]?o=c:e=c+1}if(i=t[e],a=t[e-1],a===void 0)return this._cachedIndex=0,this.beforeStart_(0,n,i);if(i===void 0)return e=t.length,this._cachedIndex=e,this.afterEnd_(e-1,a,n)}this._cachedIndex=e,this.intervalChanged_(e,a,i)}return this.interpolate_(e,a,n,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(n){const t=this.resultBuffer,e=this.sampleValues,i=this.valueSize,a=n*i;for(let o=0;o!==i;++o)t[o]=e[a+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}});Object.assign(mi.prototype,{beforeStart_:mi.prototype.copySampleValue_,afterEnd_:mi.prototype.copySampleValue_});function Tm(n,t,e,i){mi.call(this,n,t,e,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}Tm.prototype=Object.assign(Object.create(mi.prototype),{constructor:Tm,DefaultSettings_:{endingStart:bo,endingEnd:bo},intervalChanged_:function(n,t,e){const i=this.parameterPositions;let a=n-2,o=n+1,c=i[a],u=i[o];if(c===void 0)switch(this.getSettings_().endingStart){case _o:a=n,c=2*t-e;break;case Uh:a=i.length-2,c=t+i[a]-i[a+1];break;default:a=n,c=e}if(u===void 0)switch(this.getSettings_().endingEnd){case _o:o=n,u=2*e-t;break;case Uh:o=1,u=e+i[1]-i[0];break;default:o=n-1,u=t}const h=(e-t)*.5,d=this.valueSize;this._weightPrev=h/(t-c),this._weightNext=h/(u-e),this._offsetPrev=a*d,this._offsetNext=o*d},interpolate_:function(n,t,e,i){const a=this.resultBuffer,o=this.sampleValues,c=this.valueSize,u=n*c,h=u-c,d=this._offsetPrev,m=this._offsetNext,p=this._weightPrev,g=this._weightNext,v=(e-t)/(i-t),x=v*v,M=x*v,S=-p*M+2*p*x-p*v,w=(1+p)*M+(-1.5-2*p)*x+(-.5+p)*v+1,_=(-1-g)*M+(1.5+g)*x+.5*v,L=g*M-g*x;for(let R=0;R!==c;++R)a[R]=S*o[d+R]+w*o[h+R]+_*o[u+R]+L*o[m+R];return a}});function Vh(n,t,e,i){mi.call(this,n,t,e,i)}Vh.prototype=Object.assign(Object.create(mi.prototype),{constructor:Vh,interpolate_:function(n,t,e,i){const a=this.resultBuffer,o=this.sampleValues,c=this.valueSize,u=n*c,h=u-c,d=(e-t)/(i-t),m=1-d;for(let p=0;p!==c;++p)a[p]=o[h+p]*m+o[u+p]*d;return a}});function Am(n,t,e,i){mi.call(this,n,t,e,i)}Am.prototype=Object.assign(Object.create(mi.prototype),{constructor:Am,interpolate_:function(n){return this.copySampleValue_(n-1)}});function An(n,t,e,i){if(n===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+n);this.name=n,this.times=ke.convertArray(t,this.TimeBufferType),this.values=ke.convertArray(e,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}Object.assign(An,{toJSON:function(n){const t=n.constructor;let e;if(t.toJSON!==void 0)e=t.toJSON(n);else{e={name:n.name,times:ke.convertArray(n.times,Array),values:ke.convertArray(n.values,Array)};const i=n.getInterpolation();i!==n.DefaultInterpolation&&(e.interpolation=i)}return e.type=n.ValueTypeName,e}});Object.assign(An.prototype,{constructor:An,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Bh,InterpolantFactoryMethodDiscrete:function(n){return new Am(this.times,this.values,this.getValueSize(),n)},InterpolantFactoryMethodLinear:function(n){return new Vh(this.times,this.values,this.getValueSize(),n)},InterpolantFactoryMethodSmooth:function(n){return new Tm(this.times,this.values,this.getValueSize(),n)},setInterpolation:function(n){let t;switch(n){case Ph:t=this.InterpolantFactoryMethodDiscrete;break;case Bh:t=this.InterpolantFactoryMethodLinear;break;case Sp:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(n!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(e);return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ph;case this.InterpolantFactoryMethodLinear:return Bh;case this.InterpolantFactoryMethodSmooth:return Sp}},getValueSize:function(){return this.values.length/this.times.length},shift:function(n){if(n!==0){const t=this.times;for(let e=0,i=t.length;e!==i;++e)t[e]+=n}return this},scale:function(n){if(n!==1){const t=this.times;for(let e=0,i=t.length;e!==i;++e)t[e]*=n}return this},trim:function(n,t){const e=this.times,i=e.length;let a=0,o=i-1;for(;a!==i&&e[a]<n;)++a;for(;o!==-1&&e[o]>t;)--o;if(++o,a!==0||o!==i){a>=o&&(o=Math.max(o,1),a=o-1);const c=this.getValueSize();this.times=ke.arraySlice(e,a,o),this.values=ke.arraySlice(this.values,a*c,o*c)}return this},validate:function(){let n=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),n=!1);const e=this.times,i=this.values,a=e.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),n=!1);let o=null;for(let c=0;c!==a;c++){const u=e[c];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,u),n=!1;break}if(o!==null&&o>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,u,o),n=!1;break}o=u}if(i!==void 0&&ke.isTypedArray(i))for(let c=0,u=i.length;c!==u;++c){const h=i[c];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,h),n=!1;break}}return n},optimize:function(){const n=ke.arraySlice(this.times),t=ke.arraySlice(this.values),e=this.getValueSize(),i=this.getInterpolation()===Sp,a=n.length-1;let o=1;for(let c=1;c<a;++c){let u=!1;const h=n[c],d=n[c+1];if(h!==d&&(c!==1||h!==h[0]))if(i)u=!0;else{const m=c*e,p=m-e,g=m+e;for(let v=0;v!==e;++v){const x=t[m+v];if(x!==t[p+v]||x!==t[g+v]){u=!0;break}}}if(u){if(c!==o){n[o]=n[c];const m=c*e,p=o*e;for(let g=0;g!==e;++g)t[p+g]=t[m+g]}++o}}if(a>0){n[o]=n[a];for(let c=a*e,u=o*e,h=0;h!==e;++h)t[u+h]=t[c+h];++o}return o!==n.length?(this.times=ke.arraySlice(n,0,o),this.values=ke.arraySlice(t,0,o*e)):(this.times=n,this.values=t),this},clone:function(){const n=ke.arraySlice(this.times,0),t=ke.arraySlice(this.values,0),e=this.constructor,i=new e(this.name,n,t);return i.createInterpolant=this.createInterpolant,i}});function Cm(n,t,e){An.call(this,n,t,e)}Cm.prototype=Object.assign(Object.create(An.prototype),{constructor:Cm,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Ph,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Lm(n,t,e,i){An.call(this,n,t,e,i)}Lm.prototype=Object.assign(Object.create(An.prototype),{constructor:Lm,ValueTypeName:"color"});function Sc(n,t,e,i){An.call(this,n,t,e,i)}Sc.prototype=Object.assign(Object.create(An.prototype),{constructor:Sc,ValueTypeName:"number"});function Rm(n,t,e,i){mi.call(this,n,t,e,i)}Rm.prototype=Object.assign(Object.create(mi.prototype),{constructor:Rm,interpolate_:function(n,t,e,i){const a=this.resultBuffer,o=this.sampleValues,c=this.valueSize,u=(e-t)/(i-t);let h=n*c;for(let d=h+c;h!==d;h+=4)Nn.slerpFlat(a,0,o,h-c,o,h,u);return a}});function kh(n,t,e,i){An.call(this,n,t,e,i)}kh.prototype=Object.assign(Object.create(An.prototype),{constructor:kh,ValueTypeName:"quaternion",DefaultInterpolation:Bh,InterpolantFactoryMethodLinear:function(n){return new Rm(this.times,this.values,this.getValueSize(),n)},InterpolantFactoryMethodSmooth:void 0});function Nm(n,t,e,i){An.call(this,n,t,e,i)}Nm.prototype=Object.assign(Object.create(An.prototype),{constructor:Nm,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Ph,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Ec(n,t,e,i){An.call(this,n,t,e,i)}Ec.prototype=Object.assign(Object.create(An.prototype),{constructor:Ec,ValueTypeName:"vector"});function Ni(n,t=-1,e,i=$m){this.name=n,this.tracks=e,this.duration=t,this.blendMode=i,this.uuid=ne.generateUUID(),this.duration<0&&this.resetDuration()}function pC(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Sc;case"vector":case"vector2":case"vector3":case"vector4":return Ec;case"color":return Lm;case"quaternion":return kh;case"bool":case"boolean":return Cm;case"string":return Nm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function mC(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=pC(n.type);if(n.times===void 0){const e=[],i=[];ke.flattenJSON(n.keys,e,i,"value"),n.times=e,n.values=i}return t.parse!==void 0?t.parse(n):new t(n.name,n.times,n.values,n.interpolation)}Object.assign(Ni,{parse:function(n){const t=[],e=n.tracks,i=1/(n.fps||1);for(let o=0,c=e.length;o!==c;++o)t.push(mC(e[o]).scale(i));const a=new Ni(n.name,n.duration,t,n.blendMode);return a.uuid=n.uuid,a},toJSON:function(n){const t=[],e=n.tracks,i={name:n.name,duration:n.duration,tracks:t,uuid:n.uuid,blendMode:n.blendMode};for(let a=0,o=e.length;a!==o;++a)t.push(An.toJSON(e[a]));return i},CreateFromMorphTargetSequence:function(n,t,e,i){const a=t.length,o=[];for(let c=0;c<a;c++){let u=[],h=[];u.push((c+a-1)%a,c,(c+1)%a),h.push(0,1,0);const d=ke.getKeyframeOrder(u);u=ke.sortedArray(u,1,d),h=ke.sortedArray(h,1,d),!i&&u[0]===0&&(u.push(a),h.push(h[0])),o.push(new Sc(".morphTargetInfluences["+t[c].name+"]",u,h).scale(1/e))}return new Ni(n,-1,o)},findByName:function(n,t){let e=n;if(!Array.isArray(n)){const i=n;e=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<e.length;i++)if(e[i].name===t)return e[i];return null},CreateClipsFromMorphTargetSequences:function(n,t,e){const i={},a=/^([\w-]*?)([\d]+)$/;for(let c=0,u=n.length;c<u;c++){const h=n[c],d=h.name.match(a);if(d&&d.length>1){const m=d[1];let p=i[m];p||(i[m]=p=[]),p.push(h)}}const o=[];for(const c in i)o.push(Ni.CreateFromMorphTargetSequence(c,i[c],t,e));return o},parseAnimation:function(n,t){if(!n)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const e=function(m,p,g,v,x){if(g.length!==0){const M=[],S=[];ke.flattenJSON(g,M,S,v),M.length!==0&&x.push(new m(p,M,S))}},i=[],a=n.name||"default",o=n.fps||30,c=n.blendMode;let u=n.length||-1;const h=n.hierarchy||[];for(let m=0;m<h.length;m++){const p=h[m].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const g={};let v;for(v=0;v<p.length;v++)if(p[v].morphTargets)for(let x=0;x<p[v].morphTargets.length;x++)g[p[v].morphTargets[x]]=-1;for(const x in g){const M=[],S=[];for(let w=0;w!==p[v].morphTargets.length;++w){const _=p[v];M.push(_.time),S.push(_.morphTarget===x?1:0)}i.push(new Sc(".morphTargetInfluence["+x+"]",M,S))}u=g.length*o}else{const g=".bones["+t[m].name+"]";e(Ec,g+".position",p,"pos",i),e(kh,g+".quaternion",p,"rot",i),e(Ec,g+".scale",p,"scl",i)}}return i.length===0?null:new Ni(a,u,i,c)}});Object.assign(Ni.prototype,{resetDuration:function(){const n=this.tracks;let t=0;for(let e=0,i=n.length;e!==i;++e){const a=this.tracks[e];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this},trim:function(){for(let n=0;n<this.tracks.length;n++)this.tracks[n].trim(0,this.duration);return this},validate:function(){let n=!0;for(let t=0;t<this.tracks.length;t++)n=n&&this.tracks[t].validate();return n},optimize:function(){for(let n=0;n<this.tracks.length;n++)this.tracks[n].optimize();return this},clone:function(){const n=[];for(let t=0;t<this.tracks.length;t++)n.push(this.tracks[t].clone());return new Ni(this.name,this.duration,n,this.blendMode)},toJSON:function(){return Ni.toJSON(this)}});const ko={enabled:!1,files:{},add:function(n,t){this.enabled!==!1&&(this.files[n]=t)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};function gC(n,t,e){const i=this;let a=!1,o=0,c=0,u;const h=[];this.onStart=void 0,this.onLoad=n,this.onProgress=t,this.onError=e,this.itemStart=function(d){c++,a===!1&&i.onStart!==void 0&&i.onStart(d,o,c),a=!0},this.itemEnd=function(d){o++,i.onProgress!==void 0&&i.onProgress(d,o,c),o===c&&(a=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(d){i.onError!==void 0&&i.onError(d)},this.resolveURL=function(d){return u?u(d):d},this.setURLModifier=function(d){return u=d,this},this.addHandler=function(d,m){return h.push(d,m),this},this.removeHandler=function(d){const m=h.indexOf(d);return m!==-1&&h.splice(m,2),this},this.getHandler=function(d){for(let m=0,p=h.length;m<p;m+=2){const g=h[m],v=h[m+1];if(g.global&&(g.lastIndex=0),g.test(d))return v}return null}}const yC=new gC;function Ne(n){this.manager=n!==void 0?n:yC,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Ne.prototype,{load:function(){},loadAsync:function(n,t){const e=this;return new Promise(function(i,a){e.load(n,i,t,a)})},parse:function(){},setCrossOrigin:function(n){return this.crossOrigin=n,this},setWithCredentials:function(n){return this.withCredentials=n,this},setPath:function(n){return this.path=n,this},setResourcePath:function(n){return this.resourcePath=n,this},setRequestHeader:function(n){return this.requestHeader=n,this}});const Li={};function Rs(n){Ne.call(this,n)}Rs.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Rs,load:function(n,t,e,i){n===void 0&&(n=""),this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const a=this,o=ko.get(n);if(o!==void 0)return a.manager.itemStart(n),setTimeout(function(){t&&t(o),a.manager.itemEnd(n)},0),o;if(Li[n]!==void 0){Li[n].push({onLoad:t,onProgress:e,onError:i});return}const c=/^data:(.*?)(;base64)?,(.*)$/,u=n.match(c);let h;if(u){const d=u[1],m=!!u[2];let p=u[3];p=decodeURIComponent(p),m&&(p=atob(p));try{let g;const v=(this.responseType||"").toLowerCase();switch(v){case"arraybuffer":case"blob":const x=new Uint8Array(p.length);for(let S=0;S<p.length;S++)x[S]=p.charCodeAt(S);v==="blob"?g=new Blob([x.buffer],{type:d}):g=x.buffer;break;case"document":g=new DOMParser().parseFromString(p,d);break;case"json":g=JSON.parse(p);break;default:g=p;break}setTimeout(function(){t&&t(g),a.manager.itemEnd(n)},0)}catch(g){setTimeout(function(){i&&i(g),a.manager.itemError(n),a.manager.itemEnd(n)},0)}}else{Li[n]=[],Li[n].push({onLoad:t,onProgress:e,onError:i}),h=new XMLHttpRequest,h.open("GET",n,!0),h.addEventListener("load",function(d){const m=this.response,p=Li[n];if(delete Li[n],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ko.add(n,m);for(let g=0,v=p.length;g<v;g++){const x=p[g];x.onLoad&&x.onLoad(m)}a.manager.itemEnd(n)}else{for(let g=0,v=p.length;g<v;g++){const x=p[g];x.onError&&x.onError(d)}a.manager.itemError(n),a.manager.itemEnd(n)}},!1),h.addEventListener("progress",function(d){const m=Li[n];for(let p=0,g=m.length;p<g;p++){const v=m[p];v.onProgress&&v.onProgress(d)}},!1),h.addEventListener("error",function(d){const m=Li[n];delete Li[n];for(let p=0,g=m.length;p<g;p++){const v=m[p];v.onError&&v.onError(d)}a.manager.itemError(n),a.manager.itemEnd(n)},!1),h.addEventListener("abort",function(d){const m=Li[n];delete Li[n];for(let p=0,g=m.length;p<g;p++){const v=m[p];v.onError&&v.onError(d)}a.manager.itemError(n),a.manager.itemEnd(n)},!1),this.responseType!==void 0&&(h.responseType=this.responseType),this.withCredentials!==void 0&&(h.withCredentials=this.withCredentials),h.overrideMimeType&&h.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const d in this.requestHeader)h.setRequestHeader(d,this.requestHeader[d]);h.send(null)}return a.manager.itemStart(n),h},setResponseType:function(n){return this.responseType=n,this},setMimeType:function(n){return this.mimeType=n,this}});function Mb(n){Ne.call(this,n)}Mb.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Mb,load:function(n,t,e,i){const a=this,o=new Rs(a.manager);o.setPath(a.path),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(n,function(c){try{t(a.parse(JSON.parse(c)))}catch(u){i?i(u):console.error(u),a.manager.itemError(n)}},e,i)},parse:function(n){const t=[];for(let e=0;e<n.length;e++){const i=Ni.parse(n[e]);t.push(i)}return t}});function Sb(n){Ne.call(this,n)}Sb.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Sb,load:function(n,t,e,i){const a=this,o=[],c=new xc,u=new Rs(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(a.withCredentials);let h=0;function d(m){u.load(n[m],function(p){const g=a.parse(p,!0);o[m]={width:g.width,height:g.height,format:g.format,mipmaps:g.mipmaps},h+=1,h===6&&(g.mipmapCount===1&&(c.minFilter=En),c.image=o,c.format=g.format,c.needsUpdate=!0,t&&t(c))},e,i)}if(Array.isArray(n))for(let m=0,p=n.length;m<p;++m)d(m);else u.load(n,function(m){const p=a.parse(m,!0);if(p.isCubemap){const g=p.mipmaps.length/p.mipmapCount;for(let v=0;v<g;v++){o[v]={mipmaps:[]};for(let x=0;x<p.mipmapCount;x++)o[v].mipmaps.push(p.mipmaps[v*p.mipmapCount+x]),o[v].format=p.format,o[v].width=p.width,o[v].height=p.height}c.image=o}else c.image.width=p.width,c.image.height=p.height,c.mipmaps=p.mipmaps;p.mipmapCount===1&&(c.minFilter=En),c.format=p.format,c.needsUpdate=!0,t&&t(c)},e,i);return c}});function Wh(n){Ne.call(this,n)}Wh.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Wh,load:function(n,t,e,i){this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const a=this,o=ko.get(n);if(o!==void 0)return a.manager.itemStart(n),setTimeout(function(){t&&t(o),a.manager.itemEnd(n)},0),o;const c=document.createElementNS("http://www.w3.org/1999/xhtml","img");function u(){c.removeEventListener("load",u,!1),c.removeEventListener("error",h,!1),ko.add(n,this),t&&t(this),a.manager.itemEnd(n)}function h(d){c.removeEventListener("load",u,!1),c.removeEventListener("error",h,!1),i&&i(d),a.manager.itemError(n),a.manager.itemEnd(n)}return c.addEventListener("load",u,!1),c.addEventListener("error",h,!1),n.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),a.manager.itemStart(n),c.src=n,c}});function zm(n){Ne.call(this,n)}zm.prototype=Object.assign(Object.create(Ne.prototype),{constructor:zm,load:function(n,t,e,i){const a=new wa,o=new Wh(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let c=0;function u(h){o.load(n[h],function(d){a.images[h]=d,c++,c===6&&(a.needsUpdate=!0,t&&t(a))},void 0,i)}for(let h=0;h<n.length;++h)u(h);return a}});function Eb(n){Ne.call(this,n)}Eb.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Eb,load:function(n,t,e,i){const a=this,o=new Oo,c=new Rs(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(a.withCredentials),c.load(n,function(u){const h=a.parse(u);h&&(h.image!==void 0?o.image=h.image:h.data!==void 0&&(o.image.width=h.width,o.image.height=h.height,o.image.data=h.data),o.wrapS=h.wrapS!==void 0?h.wrapS:Kn,o.wrapT=h.wrapT!==void 0?h.wrapT:Kn,o.magFilter=h.magFilter!==void 0?h.magFilter:En,o.minFilter=h.minFilter!==void 0?h.minFilter:En,o.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.format!==void 0&&(o.format=h.format),h.type!==void 0&&(o.type=h.type),h.mipmaps!==void 0&&(o.mipmaps=h.mipmaps,o.minFilter=Qh),h.mipmapCount===1&&(o.minFilter=En),o.needsUpdate=!0,t&&t(o,h))},e,i),o}});function Bm(n){Ne.call(this,n)}Bm.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Bm,load:function(n,t,e,i){const a=new De,o=new Wh(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(n,function(c){a.image=c;const u=n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0;a.format=u?sr:zi,a.needsUpdate=!0,t!==void 0&&t(a)},e,i),a}});function qt(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(qt.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(n,t){const e=this.getUtoTmapping(n);return this.getPoint(e,t)},getPoints:function(n=5){const t=[];for(let e=0;e<=n;e++)t.push(this.getPoint(e/n));return t},getSpacedPoints:function(n=5){const t=[];for(let e=0;e<=n;e++)t.push(this.getPointAt(e/n));return t},getLength:function(){const n=this.getLengths();return n[n.length-1]},getLengths:function(n){if(n===void 0&&(n=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===n+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let e,i=this.getPoint(0),a=0;t.push(0);for(let o=1;o<=n;o++)e=this.getPoint(o/n),a+=e.distanceTo(i),t.push(a),i=e;return this.cacheArcLengths=t,t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(n,t){const e=this.getLengths();let i=0;const a=e.length;let o;t?o=t:o=n*e[a-1];let c=0,u=a-1,h;for(;c<=u;)if(i=Math.floor(c+(u-c)/2),h=e[i]-o,h<0)c=i+1;else if(h>0)u=i-1;else{u=i;break}if(i=u,e[i]===o)return i/(a-1);const d=e[i],p=e[i+1]-d,g=(o-d)/p;return(i+g)/(a-1)},getTangent:function(n,t){let i=n-1e-4,a=n+1e-4;i<0&&(i=0),a>1&&(a=1);const o=this.getPoint(i),c=this.getPoint(a),u=t||(o.isVector2?new ht:new G);return u.copy(c).sub(o).normalize(),u},getTangentAt:function(n,t){const e=this.getUtoTmapping(n);return this.getTangent(e,t)},computeFrenetFrames:function(n,t){const e=new G,i=[],a=[],o=[],c=new G,u=new re;for(let g=0;g<=n;g++){const v=g/n;i[g]=this.getTangentAt(v,new G),i[g].normalize()}a[0]=new G,o[0]=new G;let h=Number.MAX_VALUE;const d=Math.abs(i[0].x),m=Math.abs(i[0].y),p=Math.abs(i[0].z);d<=h&&(h=d,e.set(1,0,0)),m<=h&&(h=m,e.set(0,1,0)),p<=h&&e.set(0,0,1),c.crossVectors(i[0],e).normalize(),a[0].crossVectors(i[0],c),o[0].crossVectors(i[0],a[0]);for(let g=1;g<=n;g++){if(a[g]=a[g-1].clone(),o[g]=o[g-1].clone(),c.crossVectors(i[g-1],i[g]),c.length()>Number.EPSILON){c.normalize();const v=Math.acos(ne.clamp(i[g-1].dot(i[g]),-1,1));a[g].applyMatrix4(u.makeRotationAxis(c,v))}o[g].crossVectors(i[g],a[g])}if(t===!0){let g=Math.acos(ne.clamp(a[0].dot(a[n]),-1,1));g/=n,i[0].dot(c.crossVectors(a[0],a[n]))>0&&(g=-g);for(let v=1;v<=n;v++)a[v].applyMatrix4(u.makeRotationAxis(i[v],g*v)),o[v].crossVectors(i[v],a[v])}return{tangents:i,normals:a,binormals:o}},clone:function(){return new this.constructor().copy(this)},copy:function(n){return this.arcLengthDivisions=n.arcLengthDivisions,this},toJSON:function(){const n={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return n.arcLengthDivisions=this.arcLengthDivisions,n.type=this.type,n},fromJSON:function(n){return this.arcLengthDivisions=n.arcLengthDivisions,this}});function xi(n,t,e,i,a,o,c,u){qt.call(this),this.type="EllipseCurve",this.aX=n||0,this.aY=t||0,this.xRadius=e||1,this.yRadius=i||1,this.aStartAngle=a||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=c||!1,this.aRotation=u||0}xi.prototype=Object.create(qt.prototype);xi.prototype.constructor=xi;xi.prototype.isEllipseCurve=!0;xi.prototype.getPoint=function(n,t){const e=t||new ht,i=Math.PI*2;let a=this.aEndAngle-this.aStartAngle;const o=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=i;for(;a>i;)a-=i;a<Number.EPSILON&&(o?a=0:a=i),this.aClockwise===!0&&!o&&(a===i?a=-i:a=a-i);const c=this.aStartAngle+n*a;let u=this.aX+this.xRadius*Math.cos(c),h=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const d=Math.cos(this.aRotation),m=Math.sin(this.aRotation),p=u-this.aX,g=h-this.aY;u=p*d-g*m+this.aX,h=p*m+g*d+this.aY}return e.set(u,h)};xi.prototype.copy=function(n){return qt.prototype.copy.call(this,n),this.aX=n.aX,this.aY=n.aY,this.xRadius=n.xRadius,this.yRadius=n.yRadius,this.aStartAngle=n.aStartAngle,this.aEndAngle=n.aEndAngle,this.aClockwise=n.aClockwise,this.aRotation=n.aRotation,this};xi.prototype.toJSON=function(){const n=qt.prototype.toJSON.call(this);return n.aX=this.aX,n.aY=this.aY,n.xRadius=this.xRadius,n.yRadius=this.yRadius,n.aStartAngle=this.aStartAngle,n.aEndAngle=this.aEndAngle,n.aClockwise=this.aClockwise,n.aRotation=this.aRotation,n};xi.prototype.fromJSON=function(n){return qt.prototype.fromJSON.call(this,n),this.aX=n.aX,this.aY=n.aY,this.xRadius=n.xRadius,this.yRadius=n.yRadius,this.aStartAngle=n.aStartAngle,this.aEndAngle=n.aEndAngle,this.aClockwise=n.aClockwise,this.aRotation=n.aRotation,this};function Tc(n,t,e,i,a,o){xi.call(this,n,t,e,e,i,a,o),this.type="ArcCurve"}Tc.prototype=Object.create(xi.prototype);Tc.prototype.constructor=Tc;Tc.prototype.isArcCurve=!0;function eg(){let n=0,t=0,e=0,i=0;function a(o,c,u,h){n=o,t=u,e=-3*o+3*c-2*u-h,i=2*o-2*c+u+h}return{initCatmullRom:function(o,c,u,h,d){a(c,u,d*(u-o),d*(h-c))},initNonuniformCatmullRom:function(o,c,u,h,d,m,p){let g=(c-o)/d-(u-o)/(d+m)+(u-c)/m,v=(u-c)/m-(h-c)/(m+p)+(h-u)/p;g*=m,v*=m,a(c,u,g,v)},calc:function(o){const c=o*o,u=c*o;return n+t*o+e*c+i*u}}}const bh=new G,Qp=new eg,Jp=new eg,Kp=new eg;function ti(n=[],t=!1,e="centripetal",i=.5){qt.call(this),this.type="CatmullRomCurve3",this.points=n,this.closed=t,this.curveType=e,this.tension=i}ti.prototype=Object.create(qt.prototype);ti.prototype.constructor=ti;ti.prototype.isCatmullRomCurve3=!0;ti.prototype.getPoint=function(n,t=new G){const e=t,i=this.points,a=i.length,o=(a-(this.closed?0:1))*n;let c=Math.floor(o),u=o-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/a)+1)*a:u===0&&c===a-1&&(c=a-2,u=1);let h,d;this.closed||c>0?h=i[(c-1)%a]:(bh.subVectors(i[0],i[1]).add(i[0]),h=bh);const m=i[c%a],p=i[(c+1)%a];if(this.closed||c+2<a?d=i[(c+2)%a]:(bh.subVectors(i[a-1],i[a-2]).add(i[a-1]),d=bh),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let v=Math.pow(h.distanceToSquared(m),g),x=Math.pow(m.distanceToSquared(p),g),M=Math.pow(p.distanceToSquared(d),g);x<1e-4&&(x=1),v<1e-4&&(v=x),M<1e-4&&(M=x),Qp.initNonuniformCatmullRom(h.x,m.x,p.x,d.x,v,x,M),Jp.initNonuniformCatmullRom(h.y,m.y,p.y,d.y,v,x,M),Kp.initNonuniformCatmullRom(h.z,m.z,p.z,d.z,v,x,M)}else this.curveType==="catmullrom"&&(Qp.initCatmullRom(h.x,m.x,p.x,d.x,this.tension),Jp.initCatmullRom(h.y,m.y,p.y,d.y,this.tension),Kp.initCatmullRom(h.z,m.z,p.z,d.z,this.tension));return e.set(Qp.calc(u),Jp.calc(u),Kp.calc(u)),e};ti.prototype.copy=function(n){qt.prototype.copy.call(this,n),this.points=[];for(let t=0,e=n.points.length;t<e;t++){const i=n.points[t];this.points.push(i.clone())}return this.closed=n.closed,this.curveType=n.curveType,this.tension=n.tension,this};ti.prototype.toJSON=function(){const n=qt.prototype.toJSON.call(this);n.points=[];for(let t=0,e=this.points.length;t<e;t++){const i=this.points[t];n.points.push(i.toArray())}return n.closed=this.closed,n.curveType=this.curveType,n.tension=this.tension,n};ti.prototype.fromJSON=function(n){qt.prototype.fromJSON.call(this,n),this.points=[];for(let t=0,e=n.points.length;t<e;t++){const i=n.points[t];this.points.push(new G().fromArray(i))}return this.closed=n.closed,this.curveType=n.curveType,this.tension=n.tension,this};function Tb(n,t,e,i,a){const o=(i-t)*.5,c=(a-e)*.5,u=n*n,h=n*u;return(2*e-2*i+o+c)*h+(-3*e+3*i-2*o-c)*u+o*n+e}function vC(n,t){const e=1-n;return e*e*t}function xC(n,t){return 2*(1-n)*n*t}function bC(n,t){return n*n*t}function uc(n,t,e,i){return vC(n,t)+xC(n,e)+bC(n,i)}function _C(n,t){const e=1-n;return e*e*e*t}function wC(n,t){const e=1-n;return 3*e*e*n*t}function MC(n,t){return 3*(1-n)*n*n*t}function SC(n,t){return n*n*n*t}function hc(n,t,e,i,a){return _C(n,t)+wC(n,e)+MC(n,i)+SC(n,a)}function Ji(n=new ht,t=new ht,e=new ht,i=new ht){qt.call(this),this.type="CubicBezierCurve",this.v0=n,this.v1=t,this.v2=e,this.v3=i}Ji.prototype=Object.create(qt.prototype);Ji.prototype.constructor=Ji;Ji.prototype.isCubicBezierCurve=!0;Ji.prototype.getPoint=function(n,t=new ht){const e=t,i=this.v0,a=this.v1,o=this.v2,c=this.v3;return e.set(hc(n,i.x,a.x,o.x,c.x),hc(n,i.y,a.y,o.y,c.y)),e};Ji.prototype.copy=function(n){return qt.prototype.copy.call(this,n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this.v3.copy(n.v3),this};Ji.prototype.toJSON=function(){const n=qt.prototype.toJSON.call(this);return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n.v3=this.v3.toArray(),n};Ji.prototype.fromJSON=function(n){return qt.prototype.fromJSON.call(this,n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this.v3.fromArray(n.v3),this};function Ns(n=new G,t=new G,e=new G,i=new G){qt.call(this),this.type="CubicBezierCurve3",this.v0=n,this.v1=t,this.v2=e,this.v3=i}Ns.prototype=Object.create(qt.prototype);Ns.prototype.constructor=Ns;Ns.prototype.isCubicBezierCurve3=!0;Ns.prototype.getPoint=function(n,t=new G){const e=t,i=this.v0,a=this.v1,o=this.v2,c=this.v3;return e.set(hc(n,i.x,a.x,o.x,c.x),hc(n,i.y,a.y,o.y,c.y),hc(n,i.z,a.z,o.z,c.z)),e};Ns.prototype.copy=function(n){return qt.prototype.copy.call(this,n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this.v3.copy(n.v3),this};Ns.prototype.toJSON=function(){const n=qt.prototype.toJSON.call(this);return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n.v3=this.v3.toArray(),n};Ns.prototype.fromJSON=function(n){return qt.prototype.fromJSON.call(this,n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this.v3.fromArray(n.v3),this};function ei(n=new ht,t=new ht){qt.call(this),this.type="LineCurve",this.v1=n,this.v2=t}ei.prototype=Object.create(qt.prototype);ei.prototype.constructor=ei;ei.prototype.isLineCurve=!0;ei.prototype.getPoint=function(n,t=new ht){const e=t;return n===1?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(n).add(this.v1)),e};ei.prototype.getPointAt=function(n,t){return this.getPoint(n,t)};ei.prototype.getTangent=function(n,t){const e=t||new ht;return e.copy(this.v2).sub(this.v1).normalize(),e};ei.prototype.copy=function(n){return qt.prototype.copy.call(this,n),this.v1.copy(n.v1),this.v2.copy(n.v2),this};ei.prototype.toJSON=function(){const n=qt.prototype.toJSON.call(this);return n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n};ei.prototype.fromJSON=function(n){return qt.prototype.fromJSON.call(this,n),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this};function Ki(n=new G,t=new G){qt.call(this),this.type="LineCurve3",this.v1=n,this.v2=t}Ki.prototype=Object.create(qt.prototype);Ki.prototype.constructor=Ki;Ki.prototype.isLineCurve3=!0;Ki.prototype.getPoint=function(n,t=new G){const e=t;return n===1?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(n).add(this.v1)),e};Ki.prototype.getPointAt=function(n,t){return this.getPoint(n,t)};Ki.prototype.copy=function(n){return qt.prototype.copy.call(this,n),this.v1.copy(n.v1),this.v2.copy(n.v2),this};Ki.prototype.toJSON=function(){const n=qt.prototype.toJSON.call(this);return n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n};Ki.prototype.fromJSON=function(n){return qt.prototype.fromJSON.call(this,n),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this};function $i(n=new ht,t=new ht,e=new ht){qt.call(this),this.type="QuadraticBezierCurve",this.v0=n,this.v1=t,this.v2=e}$i.prototype=Object.create(qt.prototype);$i.prototype.constructor=$i;$i.prototype.isQuadraticBezierCurve=!0;$i.prototype.getPoint=function(n,t=new ht){const e=t,i=this.v0,a=this.v1,o=this.v2;return e.set(uc(n,i.x,a.x,o.x),uc(n,i.y,a.y,o.y)),e};$i.prototype.copy=function(n){return qt.prototype.copy.call(this,n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this};$i.prototype.toJSON=function(){const n=qt.prototype.toJSON.call(this);return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n};$i.prototype.fromJSON=function(n){return qt.prototype.fromJSON.call(this,n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this};function zs(n=new G,t=new G,e=new G){qt.call(this),this.type="QuadraticBezierCurve3",this.v0=n,this.v1=t,this.v2=e}zs.prototype=Object.create(qt.prototype);zs.prototype.constructor=zs;zs.prototype.isQuadraticBezierCurve3=!0;zs.prototype.getPoint=function(n,t=new G){const e=t,i=this.v0,a=this.v1,o=this.v2;return e.set(uc(n,i.x,a.x,o.x),uc(n,i.y,a.y,o.y),uc(n,i.z,a.z,o.z)),e};zs.prototype.copy=function(n){return qt.prototype.copy.call(this,n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this};zs.prototype.toJSON=function(){const n=qt.prototype.toJSON.call(this);return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n};zs.prototype.fromJSON=function(n){return qt.prototype.fromJSON.call(this,n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this};function ts(n=[]){qt.call(this),this.type="SplineCurve",this.points=n}ts.prototype=Object.create(qt.prototype);ts.prototype.constructor=ts;ts.prototype.isSplineCurve=!0;ts.prototype.getPoint=function(n,t=new ht){const e=t,i=this.points,a=(i.length-1)*n,o=Math.floor(a),c=a-o,u=i[o===0?o:o-1],h=i[o],d=i[o>i.length-2?i.length-1:o+1],m=i[o>i.length-3?i.length-1:o+2];return e.set(Tb(c,u.x,h.x,d.x,m.x),Tb(c,u.y,h.y,d.y,m.y)),e};ts.prototype.copy=function(n){qt.prototype.copy.call(this,n),this.points=[];for(let t=0,e=n.points.length;t<e;t++){const i=n.points[t];this.points.push(i.clone())}return this};ts.prototype.toJSON=function(){const n=qt.prototype.toJSON.call(this);n.points=[];for(let t=0,e=this.points.length;t<e;t++){const i=this.points[t];n.points.push(i.toArray())}return n};ts.prototype.fromJSON=function(n){qt.prototype.fromJSON.call(this,n),this.points=[];for(let t=0,e=n.points.length;t<e;t++){const i=n.points[t];this.points.push(new ht().fromArray(i))}return this};var EC=Object.freeze({__proto__:null,ArcCurve:Tc,CatmullRomCurve3:ti,CubicBezierCurve:Ji,CubicBezierCurve3:Ns,EllipseCurve:xi,LineCurve:ei,LineCurve3:Ki,QuadraticBezierCurve:$i,QuadraticBezierCurve3:zs,SplineCurve:ts});function ga(){qt.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}ga.prototype=Object.assign(Object.create(qt.prototype),{constructor:ga,add:function(n){this.curves.push(n)},closePath:function(){const n=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);n.equals(t)||this.curves.push(new ei(t,n))},getPoint:function(n){const t=n*this.getLength(),e=this.getCurveLengths();let i=0;for(;i<e.length;){if(e[i]>=t){const a=e[i]-t,o=this.curves[i],c=o.getLength(),u=c===0?0:1-a/c;return o.getPointAt(u)}i++}return null},getLength:function(){const n=this.getCurveLengths();return n[n.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const n=[];let t=0;for(let e=0,i=this.curves.length;e<i;e++)t+=this.curves[e].getLength(),n.push(t);return this.cacheLengths=n,n},getSpacedPoints:function(n=40){const t=[];for(let e=0;e<=n;e++)t.push(this.getPoint(e/n));return this.autoClose&&t.push(t[0]),t},getPoints:function(n=12){const t=[];let e;for(let i=0,a=this.curves;i<a.length;i++){const o=a[i],c=o&&o.isEllipseCurve?n*2:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?n*o.points.length:n,u=o.getPoints(c);for(let h=0;h<u.length;h++){const d=u[h];e&&e.equals(d)||(t.push(d),e=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t},copy:function(n){qt.prototype.copy.call(this,n),this.curves=[];for(let t=0,e=n.curves.length;t<e;t++){const i=n.curves[t];this.curves.push(i.clone())}return this.autoClose=n.autoClose,this},toJSON:function(){const n=qt.prototype.toJSON.call(this);n.autoClose=this.autoClose,n.curves=[];for(let t=0,e=this.curves.length;t<e;t++){const i=this.curves[t];n.curves.push(i.toJSON())}return n},fromJSON:function(n){qt.prototype.fromJSON.call(this,n),this.autoClose=n.autoClose,this.curves=[];for(let t=0,e=n.curves.length;t<e;t++){const i=n.curves[t];this.curves.push(new EC[i.type]().fromJSON(i))}return this}});function Xi(n){ga.call(this),this.type="Path",this.currentPoint=new ht,n&&this.setFromPoints(n)}Xi.prototype=Object.assign(Object.create(ga.prototype),{constructor:Xi,setFromPoints:function(n){this.moveTo(n[0].x,n[0].y);for(let t=1,e=n.length;t<e;t++)this.lineTo(n[t].x,n[t].y);return this},moveTo:function(n,t){return this.currentPoint.set(n,t),this},lineTo:function(n,t){const e=new ei(this.currentPoint.clone(),new ht(n,t));return this.curves.push(e),this.currentPoint.set(n,t),this},quadraticCurveTo:function(n,t,e,i){const a=new $i(this.currentPoint.clone(),new ht(n,t),new ht(e,i));return this.curves.push(a),this.currentPoint.set(e,i),this},bezierCurveTo:function(n,t,e,i,a,o){const c=new Ji(this.currentPoint.clone(),new ht(n,t),new ht(e,i),new ht(a,o));return this.curves.push(c),this.currentPoint.set(a,o),this},splineThru:function(n){const t=[this.currentPoint.clone()].concat(n),e=new ts(t);return this.curves.push(e),this.currentPoint.copy(n[n.length-1]),this},arc:function(n,t,e,i,a,o){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(n+c,t+u,e,i,a,o),this},absarc:function(n,t,e,i,a,o){return this.absellipse(n,t,e,e,i,a,o),this},ellipse:function(n,t,e,i,a,o,c,u){const h=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(n+h,t+d,e,i,a,o,c,u),this},absellipse:function(n,t,e,i,a,o,c,u){const h=new xi(n,t,e,i,a,o,c,u);if(this.curves.length>0){const m=h.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(h);const d=h.getPoint(1);return this.currentPoint.copy(d),this},copy:function(n){return ga.prototype.copy.call(this,n),this.currentPoint.copy(n.currentPoint),this},toJSON:function(){const n=ga.prototype.toJSON.call(this);return n.currentPoint=this.currentPoint.toArray(),n},fromJSON:function(n){return ga.prototype.fromJSON.call(this,n),this.currentPoint.fromArray(n.currentPoint),this}});function Ro(n){Xi.call(this,n),this.uuid=ne.generateUUID(),this.type="Shape",this.holes=[]}Ro.prototype=Object.assign(Object.create(Xi.prototype),{constructor:Ro,getPointsHoles:function(n){const t=[];for(let e=0,i=this.holes.length;e<i;e++)t[e]=this.holes[e].getPoints(n);return t},extractPoints:function(n){return{shape:this.getPoints(n),holes:this.getPointsHoles(n)}},copy:function(n){Xi.prototype.copy.call(this,n),this.holes=[];for(let t=0,e=n.holes.length;t<e;t++){const i=n.holes[t];this.holes.push(i.clone())}return this},toJSON:function(){const n=Xi.prototype.toJSON.call(this);n.uuid=this.uuid,n.holes=[];for(let t=0,e=this.holes.length;t<e;t++){const i=this.holes[t];n.holes.push(i.toJSON())}return n},fromJSON:function(n){Xi.prototype.fromJSON.call(this,n),this.uuid=n.uuid,this.holes=[];for(let t=0,e=n.holes.length;t<e;t++){const i=n.holes[t];this.holes.push(new Xi().fromJSON(i))}return this}});function Fe(n,t=1){Xt.call(this),this.type="Light",this.color=new Wt(n),this.intensity=t}Fe.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Fe,isLight:!0,copy:function(n){return Xt.prototype.copy.call(this,n),this.color.copy(n.color),this.intensity=n.intensity,this},toJSON:function(n){const t=Xt.prototype.toJSON.call(this,n);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}});function Ab(n,t,e){Fe.call(this,n,e),this.type="HemisphereLight",this.position.copy(Xt.DefaultUp),this.updateMatrix(),this.groundColor=new Wt(t)}Ab.prototype=Object.assign(Object.create(Fe.prototype),{constructor:Ab,isHemisphereLight:!0,copy:function(n){return Fe.prototype.copy.call(this,n),this.groundColor.copy(n.groundColor),this}});function Bs(n){this.camera=n,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new ht(512,512),this.map=null,this.mapPass=null,this.matrix=new re,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new $h,this._frameExtents=new ht(1,1),this._viewportCount=1,this._viewports=[new Le(0,0,1,1)]}Object.assign(Bs.prototype,{_projScreenMatrix:new re,_lightPositionWorld:new G,_lookTarget:new G,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(n){const t=this.camera,e=this.matrix,i=this._projScreenMatrix,a=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(n.matrixWorld),t.position.copy(o),a.setFromMatrixPosition(n.target.matrixWorld),t.lookAt(a),t.updateMatrixWorld(),i.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i),e.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),e.multiply(t.projectionMatrix),e.multiply(t.matrixWorldInverse)},getViewport:function(n){return this._viewports[n]},getFrameExtents:function(){return this._frameExtents},copy:function(n){return this.camera=n.camera.clone(),this.bias=n.bias,this.radius=n.radius,this.mapSize.copy(n.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const n={};return this.bias!==0&&(n.bias=this.bias),this.normalBias!==0&&(n.normalBias=this.normalBias),this.radius!==1&&(n.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(n.mapSize=this.mapSize.toArray()),n.camera=this.camera.toJSON(!1).object,delete n.camera.matrix,n}});function Dm(){Bs.call(this,new on(50,1,.5,500)),this.focus=1}Dm.prototype=Object.assign(Object.create(Bs.prototype),{constructor:Dm,isSpotLightShadow:!0,updateMatrices:function(n){const t=this.camera,e=ne.RAD2DEG*2*n.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=n.distance||t.far;(e!==t.fov||i!==t.aspect||a!==t.far)&&(t.fov=e,t.aspect=i,t.far=a,t.updateProjectionMatrix()),Bs.prototype.updateMatrices.call(this,n)}});function Cb(n,t,e,i,a,o){Fe.call(this,n,t),this.type="SpotLight",this.position.copy(Xt.DefaultUp),this.updateMatrix(),this.target=new Xt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(c){this.intensity=c/Math.PI}}),this.distance=e!==void 0?e:0,this.angle=i!==void 0?i:Math.PI/3,this.penumbra=a!==void 0?a:0,this.decay=o!==void 0?o:1,this.shadow=new Dm}Cb.prototype=Object.assign(Object.create(Fe.prototype),{constructor:Cb,isSpotLight:!0,copy:function(n){return Fe.prototype.copy.call(this,n),this.distance=n.distance,this.angle=n.angle,this.penumbra=n.penumbra,this.decay=n.decay,this.target=n.target.clone(),this.shadow=n.shadow.clone(),this}});function Om(){Bs.call(this,new on(90,1,.5,500)),this._frameExtents=new ht(4,2),this._viewportCount=6,this._viewports=[new Le(2,1,1,1),new Le(0,1,1,1),new Le(3,1,1,1),new Le(1,1,1,1),new Le(3,0,1,1),new Le(1,0,1,1)],this._cubeDirections=[new G(1,0,0),new G(-1,0,0),new G(0,0,1),new G(0,0,-1),new G(0,1,0),new G(0,-1,0)],this._cubeUps=[new G(0,1,0),new G(0,1,0),new G(0,1,0),new G(0,1,0),new G(0,0,1),new G(0,0,-1)]}Om.prototype=Object.assign(Object.create(Bs.prototype),{constructor:Om,isPointLightShadow:!0,updateMatrices:function(n,t=0){const e=this.camera,i=this.matrix,a=this._lightPositionWorld,o=this._lookTarget,c=this._projScreenMatrix;a.setFromMatrixPosition(n.matrixWorld),e.position.copy(a),o.copy(e.position),o.add(this._cubeDirections[t]),e.up.copy(this._cubeUps[t]),e.lookAt(o),e.updateMatrixWorld(),i.makeTranslation(-a.x,-a.y,-a.z),c.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(c)}});function Lb(n,t,e,i){Fe.call(this,n,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}}),this.distance=e!==void 0?e:0,this.decay=i!==void 0?i:1,this.shadow=new Om}Lb.prototype=Object.assign(Object.create(Fe.prototype),{constructor:Lb,isPointLight:!0,copy:function(n){return Fe.prototype.copy.call(this,n),this.distance=n.distance,this.decay=n.decay,this.shadow=n.shadow.clone(),this}});function Pm(n=-1,t=1,e=1,i=-1,a=.1,o=2e3){_a.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=n,this.right=t,this.top=e,this.bottom=i,this.near=a,this.far=o,this.updateProjectionMatrix()}Pm.prototype=Object.assign(Object.create(_a.prototype),{constructor:Pm,isOrthographicCamera:!0,copy:function(n,t){return _a.prototype.copy.call(this,n,t),this.left=n.left,this.right=n.right,this.top=n.top,this.bottom=n.bottom,this.near=n.near,this.far=n.far,this.zoom=n.zoom,this.view=n.view===null?null:Object.assign({},n.view),this},setViewOffset:function(n,t,e,i,a,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=t,this.view.offsetX=e,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const n=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),e=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=e-n,o=e+n,c=i+t,u=i-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=h*this.view.offsetX,o=a+h*this.view.width,c-=d*this.view.offsetY,u=c-d*this.view.height}this.projectionMatrix.makeOrthographic(a,o,c,u,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(n){const t=Xt.prototype.toJSON.call(this,n);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}});function Um(){Bs.call(this,new Pm(-5,5,5,-5,.5,500))}Um.prototype=Object.assign(Object.create(Bs.prototype),{constructor:Um,isDirectionalLightShadow:!0,updateMatrices:function(n){Bs.prototype.updateMatrices.call(this,n)}});function Ea(n,t){Fe.call(this,n,t),this.type="DirectionalLight",this.position.copy(Xt.DefaultUp),this.updateMatrix(),this.target=new Xt,this.shadow=new Um}Ea.prototype=Object.assign(Object.create(Fe.prototype),{constructor:Ea,isDirectionalLight:!0,copy:function(n){return Fe.prototype.copy.call(this,n),this.target=n.target.clone(),this.shadow=n.shadow.clone(),this}});function Ac(n,t){Fe.call(this,n,t),this.type="AmbientLight"}Ac.prototype=Object.assign(Object.create(Fe.prototype),{constructor:Ac,isAmbientLight:!0});function Rb(n,t,e,i){Fe.call(this,n,t),this.type="RectAreaLight",this.width=e!==void 0?e:10,this.height=i!==void 0?i:10}Rb.prototype=Object.assign(Object.create(Fe.prototype),{constructor:Rb,isRectAreaLight:!0,copy:function(n){return Fe.prototype.copy.call(this,n),this.width=n.width,this.height=n.height,this},toJSON:function(n){const t=Fe.prototype.toJSON.call(this,n);return t.object.width=this.width,t.object.height=this.height,t}});class TC{constructor(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new G)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const i=t.x,a=t.y,o=t.z,c=this.coefficients;return e.copy(c[0]).multiplyScalar(.282095),e.addScaledVector(c[1],.488603*a),e.addScaledVector(c[2],.488603*o),e.addScaledVector(c[3],.488603*i),e.addScaledVector(c[4],1.092548*(i*a)),e.addScaledVector(c[5],1.092548*(a*o)),e.addScaledVector(c[6],.315392*(3*o*o-1)),e.addScaledVector(c[7],1.092548*(i*o)),e.addScaledVector(c[8],.546274*(i*i-a*a)),e}getIrradianceAt(t,e){const i=t.x,a=t.y,o=t.z,c=this.coefficients;return e.copy(c[0]).multiplyScalar(.886227),e.addScaledVector(c[1],2*.511664*a),e.addScaledVector(c[2],2*.511664*o),e.addScaledVector(c[3],2*.511664*i),e.addScaledVector(c[4],2*.429043*i*a),e.addScaledVector(c[5],2*.429043*a*o),e.addScaledVector(c[6],.743125*o*o-.247708),e.addScaledVector(c[7],2*.429043*i*o),e.addScaledVector(c[8],.429043*(i*i-a*a)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(t.coefficients[i],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let i=0;i<9;i++)this.coefficients[i].lerp(t.coefficients[i],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,e=0){const i=this.coefficients;for(let a=0;a<9;a++)i[a].fromArray(t,e+a*3);return this}toArray(t=[],e=0){const i=this.coefficients;for(let a=0;a<9;a++)i[a].toArray(t,e+a*3);return t}static getBasisAt(t,e){const i=t.x,a=t.y,o=t.z;e[0]=.282095,e[1]=.488603*a,e[2]=.488603*o,e[3]=.488603*i,e[4]=1.092548*i*a,e[5]=1.092548*a*o,e[6]=.315392*(3*o*o-1),e[7]=1.092548*i*o,e[8]=.546274*(i*i-a*a)}}function Zi(n,t){Fe.call(this,void 0,t),this.type="LightProbe",this.sh=n!==void 0?n:new TC}Zi.prototype=Object.assign(Object.create(Fe.prototype),{constructor:Zi,isLightProbe:!0,copy:function(n){return Fe.prototype.copy.call(this,n),this.sh.copy(n.sh),this},fromJSON:function(n){return this.intensity=n.intensity,this.sh.fromArray(n.sh),this},toJSON:function(n){const t=Fe.prototype.toJSON.call(this,n);return t.object.sh=this.sh.toArray(),t}});function Nb(n){Ne.call(this,n),this.textures={}}Nb.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Nb,load:function(n,t,e,i){const a=this,o=new Rs(a.manager);o.setPath(a.path),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(n,function(c){try{t(a.parse(JSON.parse(c)))}catch(u){i?i(u):console.error(u),a.manager.itemError(n)}},e,i)},parse:function(n){const t=this.textures;function e(a){return t[a]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",a),t[a]}const i=new dC[n.type];if(n.uuid!==void 0&&(i.uuid=n.uuid),n.name!==void 0&&(i.name=n.name),n.color!==void 0&&i.color!==void 0&&i.color.setHex(n.color),n.roughness!==void 0&&(i.roughness=n.roughness),n.metalness!==void 0&&(i.metalness=n.metalness),n.sheen!==void 0&&(i.sheen=new Wt().setHex(n.sheen)),n.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(n.emissive),n.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(n.specular),n.shininess!==void 0&&(i.shininess=n.shininess),n.clearcoat!==void 0&&(i.clearcoat=n.clearcoat),n.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=n.clearcoatRoughness),n.fog!==void 0&&(i.fog=n.fog),n.flatShading!==void 0&&(i.flatShading=n.flatShading),n.blending!==void 0&&(i.blending=n.blending),n.combine!==void 0&&(i.combine=n.combine),n.side!==void 0&&(i.side=n.side),n.opacity!==void 0&&(i.opacity=n.opacity),n.transparent!==void 0&&(i.transparent=n.transparent),n.alphaTest!==void 0&&(i.alphaTest=n.alphaTest),n.depthTest!==void 0&&(i.depthTest=n.depthTest),n.depthWrite!==void 0&&(i.depthWrite=n.depthWrite),n.colorWrite!==void 0&&(i.colorWrite=n.colorWrite),n.stencilWrite!==void 0&&(i.stencilWrite=n.stencilWrite),n.stencilWriteMask!==void 0&&(i.stencilWriteMask=n.stencilWriteMask),n.stencilFunc!==void 0&&(i.stencilFunc=n.stencilFunc),n.stencilRef!==void 0&&(i.stencilRef=n.stencilRef),n.stencilFuncMask!==void 0&&(i.stencilFuncMask=n.stencilFuncMask),n.stencilFail!==void 0&&(i.stencilFail=n.stencilFail),n.stencilZFail!==void 0&&(i.stencilZFail=n.stencilZFail),n.stencilZPass!==void 0&&(i.stencilZPass=n.stencilZPass),n.wireframe!==void 0&&(i.wireframe=n.wireframe),n.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=n.wireframeLinewidth),n.wireframeLinecap!==void 0&&(i.wireframeLinecap=n.wireframeLinecap),n.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=n.wireframeLinejoin),n.rotation!==void 0&&(i.rotation=n.rotation),n.linewidth!==1&&(i.linewidth=n.linewidth),n.dashSize!==void 0&&(i.dashSize=n.dashSize),n.gapSize!==void 0&&(i.gapSize=n.gapSize),n.scale!==void 0&&(i.scale=n.scale),n.polygonOffset!==void 0&&(i.polygonOffset=n.polygonOffset),n.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=n.polygonOffsetFactor),n.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=n.polygonOffsetUnits),n.skinning!==void 0&&(i.skinning=n.skinning),n.morphTargets!==void 0&&(i.morphTargets=n.morphTargets),n.morphNormals!==void 0&&(i.morphNormals=n.morphNormals),n.dithering!==void 0&&(i.dithering=n.dithering),n.vertexTangents!==void 0&&(i.vertexTangents=n.vertexTangents),n.visible!==void 0&&(i.visible=n.visible),n.toneMapped!==void 0&&(i.toneMapped=n.toneMapped),n.userData!==void 0&&(i.userData=n.userData),n.vertexColors!==void 0&&(typeof n.vertexColors=="number"?i.vertexColors=n.vertexColors>0:i.vertexColors=n.vertexColors),n.uniforms!==void 0)for(const a in n.uniforms){const o=n.uniforms[a];switch(i.uniforms[a]={},o.type){case"t":i.uniforms[a].value=e(o.value);break;case"c":i.uniforms[a].value=new Wt().setHex(o.value);break;case"v2":i.uniforms[a].value=new ht().fromArray(o.value);break;case"v3":i.uniforms[a].value=new G().fromArray(o.value);break;case"v4":i.uniforms[a].value=new Le().fromArray(o.value);break;case"m3":i.uniforms[a].value=new Hn().fromArray(o.value);break;case"m4":i.uniforms[a].value=new re().fromArray(o.value);break;default:i.uniforms[a].value=o.value}}if(n.defines!==void 0&&(i.defines=n.defines),n.vertexShader!==void 0&&(i.vertexShader=n.vertexShader),n.fragmentShader!==void 0&&(i.fragmentShader=n.fragmentShader),n.extensions!==void 0)for(const a in n.extensions)i.extensions[a]=n.extensions[a];if(n.shading!==void 0&&(i.flatShading=n.shading===1),n.size!==void 0&&(i.size=n.size),n.sizeAttenuation!==void 0&&(i.sizeAttenuation=n.sizeAttenuation),n.map!==void 0&&(i.map=e(n.map)),n.matcap!==void 0&&(i.matcap=e(n.matcap)),n.alphaMap!==void 0&&(i.alphaMap=e(n.alphaMap)),n.bumpMap!==void 0&&(i.bumpMap=e(n.bumpMap)),n.bumpScale!==void 0&&(i.bumpScale=n.bumpScale),n.normalMap!==void 0&&(i.normalMap=e(n.normalMap)),n.normalMapType!==void 0&&(i.normalMapType=n.normalMapType),n.normalScale!==void 0){let a=n.normalScale;Array.isArray(a)===!1&&(a=[a,a]),i.normalScale=new ht().fromArray(a)}return n.displacementMap!==void 0&&(i.displacementMap=e(n.displacementMap)),n.displacementScale!==void 0&&(i.displacementScale=n.displacementScale),n.displacementBias!==void 0&&(i.displacementBias=n.displacementBias),n.roughnessMap!==void 0&&(i.roughnessMap=e(n.roughnessMap)),n.metalnessMap!==void 0&&(i.metalnessMap=e(n.metalnessMap)),n.emissiveMap!==void 0&&(i.emissiveMap=e(n.emissiveMap)),n.emissiveIntensity!==void 0&&(i.emissiveIntensity=n.emissiveIntensity),n.specularMap!==void 0&&(i.specularMap=e(n.specularMap)),n.envMap!==void 0&&(i.envMap=e(n.envMap)),n.envMapIntensity!==void 0&&(i.envMapIntensity=n.envMapIntensity),n.reflectivity!==void 0&&(i.reflectivity=n.reflectivity),n.refractionRatio!==void 0&&(i.refractionRatio=n.refractionRatio),n.lightMap!==void 0&&(i.lightMap=e(n.lightMap)),n.lightMapIntensity!==void 0&&(i.lightMapIntensity=n.lightMapIntensity),n.aoMap!==void 0&&(i.aoMap=e(n.aoMap)),n.aoMapIntensity!==void 0&&(i.aoMapIntensity=n.aoMapIntensity),n.gradientMap!==void 0&&(i.gradientMap=e(n.gradientMap)),n.clearcoatMap!==void 0&&(i.clearcoatMap=e(n.clearcoatMap)),n.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=e(n.clearcoatRoughnessMap)),n.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=e(n.clearcoatNormalMap)),n.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new ht().fromArray(n.clearcoatNormalScale)),n.transmission!==void 0&&(i.transmission=n.transmission),n.transmissionMap!==void 0&&(i.transmissionMap=e(n.transmissionMap)),i},setTextures:function(n){return this.textures=n,this}});const AC={decodeText:function(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let t="";for(let e=0,i=n.length;e<i;e++)t+=String.fromCharCode(n[e]);try{return decodeURIComponent(escape(t))}catch{return t}},extractUrlBase:function(n){const t=n.lastIndexOf("/");return t===-1?"./":n.substr(0,t+1)}};function jh(){Re.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}jh.prototype=Object.assign(Object.create(Re.prototype),{constructor:jh,isInstancedBufferGeometry:!0,copy:function(n){return Re.prototype.copy.call(this,n),this.instanceCount=n.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const n=Re.prototype.toJSON.call(this);return n.instanceCount=this.instanceCount,n.isInstancedBufferGeometry=!0,n}});function Im(n,t,e,i){typeof e=="number"&&(i=e,e=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),ee.call(this,n,t,e),this.meshPerAttribute=i||1}Im.prototype=Object.assign(Object.create(ee.prototype),{constructor:Im,isInstancedBufferAttribute:!0,copy:function(n){return ee.prototype.copy.call(this,n),this.meshPerAttribute=n.meshPerAttribute,this},toJSON:function(){const n=ee.prototype.toJSON.call(this);return n.meshPerAttribute=this.meshPerAttribute,n.isInstancedBufferAttribute=!0,n}});function zb(n){Ne.call(this,n)}zb.prototype=Object.assign(Object.create(Ne.prototype),{constructor:zb,load:function(n,t,e,i){const a=this,o=new Rs(a.manager);o.setPath(a.path),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(n,function(c){try{t(a.parse(JSON.parse(c)))}catch(u){i?i(u):console.error(u),a.manager.itemError(n)}},e,i)},parse:function(n){const t={},e={};function i(g,v){if(t[v]!==void 0)return t[v];const M=g.interleavedBuffers[v],S=a(g,M.buffer),w=$u(M.type,S),_=new di(w,M.stride);return _.uuid=M.uuid,t[v]=_,_}function a(g,v){if(e[v]!==void 0)return e[v];const M=g.arrayBuffers[v],S=new Uint32Array(M).buffer;return e[v]=S,S}const o=n.isInstancedBufferGeometry?new jh:new Re,c=n.data.index;if(c!==void 0){const g=$u(c.type,c.array);o.setIndex(new ee(g,1))}const u=n.data.attributes;for(const g in u){const v=u[g];let x;if(v.isInterleavedBufferAttribute){const M=i(n.data,v.data);x=new cr(M,v.itemSize,v.offset,v.normalized)}else{const M=$u(v.type,v.array),S=v.isInstancedBufferAttribute?Im:ee;x=new S(M,v.itemSize,v.normalized)}v.name!==void 0&&(x.name=v.name),o.setAttribute(g,x)}const h=n.data.morphAttributes;if(h)for(const g in h){const v=h[g],x=[];for(let M=0,S=v.length;M<S;M++){const w=v[M];let _;if(w.isInterleavedBufferAttribute){const L=i(n.data,w.data);_=new cr(L,w.itemSize,w.offset,w.normalized)}else{const L=$u(w.type,w.array);_=new ee(L,w.itemSize,w.normalized)}w.name!==void 0&&(_.name=w.name),x.push(_)}o.morphAttributes[g]=x}n.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const m=n.data.groups||n.data.drawcalls||n.data.offsets;if(m!==void 0)for(let g=0,v=m.length;g!==v;++g){const x=m[g];o.addGroup(x.start,x.count,x.materialIndex)}const p=n.data.boundingSphere;if(p!==void 0){const g=new G;p.center!==void 0&&g.fromArray(p.center),o.boundingSphere=new Di(g,p.radius)}return n.name&&(o.name=n.name),n.userData&&(o.userData=n.userData),o}});function Bb(n){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Ne.call(this,n),this.options={premultiplyAlpha:"none"}}Bb.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Bb,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(n,t,e,i){n===void 0&&(n=""),this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const a=this,o=ko.get(n);if(o!==void 0)return a.manager.itemStart(n),setTimeout(function(){t&&t(o),a.manager.itemEnd(n)},0),o;const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(n,c).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,a.options)}).then(function(u){ko.add(n,u),t&&t(u),a.manager.itemEnd(n)}).catch(function(u){i&&i(u),a.manager.itemError(n),a.manager.itemEnd(n)}),a.manager.itemStart(n)}});function j_(){this.type="ShapePath",this.color=new Wt,this.subPaths=[],this.currentPath=null}Object.assign(j_.prototype,{moveTo:function(n,t){return this.currentPath=new Xi,this.subPaths.push(this.currentPath),this.currentPath.moveTo(n,t),this},lineTo:function(n,t){return this.currentPath.lineTo(n,t),this},quadraticCurveTo:function(n,t,e,i){return this.currentPath.quadraticCurveTo(n,t,e,i),this},bezierCurveTo:function(n,t,e,i,a,o){return this.currentPath.bezierCurveTo(n,t,e,i,a,o),this},splineThru:function(n){return this.currentPath.splineThru(n),this},toShapes:function(n,t){function e(w){const _=[];for(let L=0,R=w.length;L<R;L++){const C=w[L],A=new Ro;A.curves=C.curves,_.push(A)}return _}function i(w,_){const L=_.length;let R=!1;for(let C=L-1,A=0;A<L;C=A++){let B=_[C],Y=_[A],X=Y.x-B.x,st=Y.y-B.y;if(Math.abs(st)>Number.EPSILON){if(st<0&&(B=_[A],X=-X,Y=_[C],st=-st),w.y<B.y||w.y>Y.y)continue;if(w.y===B.y){if(w.x===B.x)return!0}else{const V=st*(w.x-B.x)-X*(w.y-B.y);if(V===0)return!0;if(V<0)continue;R=!R}}else{if(w.y!==B.y)continue;if(Y.x<=w.x&&w.x<=B.x||B.x<=w.x&&w.x<=Y.x)return!0}}return R}const a=xa.isClockWise,o=this.subPaths;if(o.length===0)return[];if(t===!0)return e(o);let c,u,h;const d=[];if(o.length===1)return u=o[0],h=new Ro,h.curves=u.curves,d.push(h),d;let m=!a(o[0].getPoints());m=n?!m:m;const p=[],g=[];let v=[],x=0,M;g[x]=void 0,v[x]=[];for(let w=0,_=o.length;w<_;w++)u=o[w],M=u.getPoints(),c=a(M),c=n?!c:c,c?(!m&&g[x]&&x++,g[x]={s:new Ro,p:M},g[x].s.curves=u.curves,m&&x++,v[x]=[]):v[x].push({h:u,p:M[0]});if(!g[0])return e(o);if(g.length>1){let w=!1;const _=[];for(let L=0,R=g.length;L<R;L++)p[L]=[];for(let L=0,R=g.length;L<R;L++){const C=v[L];for(let A=0;A<C.length;A++){const B=C[A];let Y=!0;for(let X=0;X<g.length;X++)i(B.p,g[X].p)&&(L!==X&&_.push({froms:L,tos:X,hole:A}),Y?(Y=!1,p[X].push(B)):w=!0);Y&&p[L].push(B)}}_.length>0&&(w||(v=p))}let S;for(let w=0,_=g.length;w<_;w++){h=g[w].s,d.push(h),S=v[w];for(let L=0,R=S.length;L<R;L++)h.holes.push(S[L].h)}return d}});function q_(n){this.type="Font",this.data=n}Object.assign(q_.prototype,{isFont:!0,generateShapes:function(n,t=100){const e=[],i=CC(n,t,this.data);for(let a=0,o=i.length;a<o;a++)Array.prototype.push.apply(e,i[a].toShapes());return e}});function CC(n,t,e){const i=Array.from?Array.from(n):String(n).split(""),a=t/e.resolution,o=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*a,c=[];let u=0,h=0;for(let d=0;d<i.length;d++){const m=i[d];if(m===`
`)u=0,h-=o;else{const p=LC(m,a,u,h,e);u+=p.offsetX,c.push(p.path)}}return c}function LC(n,t,e,i,a){const o=a.glyphs[n]||a.glyphs["?"];if(!o){console.error('THREE.Font: character "'+n+'" does not exists in font family '+a.familyName+".");return}const c=new j_;let u,h,d,m,p,g,v,x;if(o.o){const M=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let S=0,w=M.length;S<w;)switch(M[S++]){case"m":u=M[S++]*t+e,h=M[S++]*t+i,c.moveTo(u,h);break;case"l":u=M[S++]*t+e,h=M[S++]*t+i,c.lineTo(u,h);break;case"q":d=M[S++]*t+e,m=M[S++]*t+i,p=M[S++]*t+e,g=M[S++]*t+i,c.quadraticCurveTo(p,g,d,m);break;case"b":d=M[S++]*t+e,m=M[S++]*t+i,p=M[S++]*t+e,g=M[S++]*t+i,v=M[S++]*t+e,x=M[S++]*t+i,c.bezierCurveTo(p,g,v,x,d,m);break}}return{offsetX:o.ha*t,path:c}}function Db(n){Ne.call(this,n)}Db.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Db,load:function(n,t,e,i){const a=this,o=new Rs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(a.withCredentials),o.load(n,function(c){let u;try{u=JSON.parse(c)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),u=JSON.parse(c.substring(65,c.length-2))}const h=a.parse(u);t&&t(h)},e,i)},parse:function(n){return new q_(n)}});let _h;const RC={getContext:function(){return _h===void 0&&(_h=new(window.AudioContext||window.webkitAudioContext)),_h},setContext:function(n){_h=n}};function Ob(n){Ne.call(this,n)}Ob.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Ob,load:function(n,t,e,i){const a=this,o=new Rs(a.manager);o.setResponseType("arraybuffer"),o.setPath(a.path),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(n,function(c){try{const u=c.slice(0);RC.getContext().decodeAudioData(u,function(d){t(d)})}catch(u){i?i(u):console.error(u),a.manager.itemError(n)}},e,i)}});function Pb(n,t,e){Zi.call(this,void 0,e);const i=new Wt().set(n),a=new Wt().set(t),o=new G(i.r,i.g,i.b),c=new G(a.r,a.g,a.b),u=Math.sqrt(Math.PI),h=u*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(c).multiplyScalar(u),this.sh.coefficients[1].copy(o).sub(c).multiplyScalar(h)}Pb.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Pb,isHemisphereLightProbe:!0,copy:function(n){return Zi.prototype.copy.call(this,n),this},toJSON:function(n){return Zi.prototype.toJSON.call(this,n)}});function Ub(n,t){Zi.call(this,void 0,t);const e=new Wt().set(n);this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI))}Ub.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Ub,isAmbientLightProbe:!0,copy:function(n){return Zi.prototype.copy.call(this,n),this},toJSON:function(n){return Zi.prototype.toJSON.call(this,n)}});const Ib=new re,Fb=new re;function NC(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new on,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new on,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(NC.prototype,{update:function(n){const t=this._cache;if(t.focus!==n.focus||t.fov!==n.fov||t.aspect!==n.aspect*this.aspect||t.near!==n.near||t.far!==n.far||t.zoom!==n.zoom||t.eyeSep!==this.eyeSep){t.focus=n.focus,t.fov=n.fov,t.aspect=n.aspect*this.aspect,t.near=n.near,t.far=n.far,t.zoom=n.zoom,t.eyeSep=this.eyeSep;const i=n.projectionMatrix.clone(),a=t.eyeSep/2,o=a*t.near/t.focus,c=t.near*Math.tan(ne.DEG2RAD*t.fov*.5)/t.zoom;let u,h;Fb.elements[12]=-a,Ib.elements[12]=a,u=-c*t.aspect+o,h=c*t.aspect+o,i.elements[0]=2*t.near/(h-u),i.elements[8]=(h+u)/(h-u),this.cameraL.projectionMatrix.copy(i),u=-c*t.aspect-o,h=c*t.aspect-o,i.elements[0]=2*t.near/(h-u),i.elements[8]=(h+u)/(h-u),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(n.matrixWorld).multiply(Fb),this.cameraR.matrixWorld.copy(n.matrixWorld).multiply(Ib)}});function Y_(n,t,e){this.binding=n,this.valueSize=e;let i,a,o;switch(t){case"quaternion":i=this._slerp,a=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(e*6),this._workIndex=5;break;case"string":case"bool":i=this._select,a=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(e*5);break;default:i=this._lerp,a=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(e*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=a,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(Y_.prototype,{accumulate:function(n,t){const e=this.buffer,i=this.valueSize,a=n*i+i;let o=this.cumulativeWeight;if(o===0){for(let c=0;c!==i;++c)e[a+c]=e[c];o=t}else{o+=t;const c=t/o;this._mixBufferRegion(e,a,0,c,i)}this.cumulativeWeight=o},accumulateAdditive:function(n){const t=this.buffer,e=this.valueSize,i=e*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,n,e),this.cumulativeWeightAdditive+=n},apply:function(n){const t=this.valueSize,e=this.buffer,i=n*t+t,a=this.cumulativeWeight,o=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){const u=t*this._origIndex;this._mixBufferRegion(e,i,u,1-a,t)}o>0&&this._mixBufferRegionAdditive(e,i,this._addIndex*t,1,t);for(let u=t,h=t+t;u!==h;++u)if(e[u]!==e[u+t]){c.setValue(e,i);break}},saveOriginalState:function(){const n=this.binding,t=this.buffer,e=this.valueSize,i=e*this._origIndex;n.getValue(t,i);for(let a=e,o=i;a!==o;++a)t[a]=t[i+a%e];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const n=this.valueSize*3;this.binding.setValue(this.buffer,n)},_setAdditiveIdentityNumeric:function(){const n=this._addIndex*this.valueSize,t=n+this.valueSize;for(let e=n;e<t;e++)this.buffer[e]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){const n=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let e=0;e<this.valueSize;e++)this.buffer[t+e]=this.buffer[n+e]},_select:function(n,t,e,i,a){if(i>=.5)for(let o=0;o!==a;++o)n[t+o]=n[e+o]},_slerp:function(n,t,e,i){Nn.slerpFlat(n,t,n,t,n,e,i)},_slerpAdditive:function(n,t,e,i,a){const o=this._workIndex*a;Nn.multiplyQuaternionsFlat(n,o,n,t,n,e),Nn.slerpFlat(n,t,n,t,n,o,i)},_lerp:function(n,t,e,i,a){const o=1-i;for(let c=0;c!==a;++c){const u=t+c;n[u]=n[u]*o+n[e+c]*i}},_lerpAdditive:function(n,t,e,i,a){for(let o=0;o!==a;++o){const c=t+o;n[c]=n[c]+n[e+o]*i}}});const ng="\\[\\]\\.:\\/",zC=new RegExp("["+ng+"]","g"),ig="[^"+ng+"]",BC="[^"+ng.replace("\\.","")+"]",DC=/((?:WC+[\/:])*)/.source.replace("WC",ig),OC=/(WCOD+)?/.source.replace("WCOD",BC),PC=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ig),UC=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ig),IC=new RegExp("^"+DC+OC+PC+UC+"$"),FC=["material","materials","bones"];function X_(n,t,e){const i=e||zn.parseTrackName(t);this._targetGroup=n,this._bindings=n.subscribe_(t,i)}Object.assign(X_.prototype,{getValue:function(n,t){this.bind();const e=this._targetGroup.nCachedObjects_,i=this._bindings[e];i!==void 0&&i.getValue(n,t)},setValue:function(n,t){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,a=e.length;i!==a;++i)e[i].setValue(n,t)},bind:function(){const n=this._bindings;for(let t=this._targetGroup.nCachedObjects_,e=n.length;t!==e;++t)n[t].bind()},unbind:function(){const n=this._bindings;for(let t=this._targetGroup.nCachedObjects_,e=n.length;t!==e;++t)n[t].unbind()}});function zn(n,t,e){this.path=t,this.parsedPath=e||zn.parseTrackName(t),this.node=zn.findNode(n,this.parsedPath.nodeName)||n,this.rootNode=n}Object.assign(zn,{Composite:X_,create:function(n,t,e){return n&&n.isAnimationObjectGroup?new zn.Composite(n,t,e):new zn(n,t,e)},sanitizeNodeName:function(n){return n.replace(/\s/g,"_").replace(zC,"")},parseTrackName:function(n){const t=IC.exec(n);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+n);const e={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=e.nodeName&&e.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const a=e.nodeName.substring(i+1);FC.indexOf(a)!==-1&&(e.nodeName=e.nodeName.substring(0,i),e.objectName=a)}if(e.propertyName===null||e.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+n);return e},findNode:function(n,t){if(!t||t===""||t==="."||t===-1||t===n.name||t===n.uuid)return n;if(n.skeleton){const e=n.skeleton.getBoneByName(t);if(e!==void 0)return e}if(n.children){const e=function(a){for(let o=0;o<a.length;o++){const c=a[o];if(c.name===t||c.uuid===t)return c;const u=e(c.children);if(u)return u}return null},i=e(n.children);if(i)return i}return null}});Object.assign(zn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){const i=this.resolvedProperty;for(let a=0,o=i.length;a!==o;++a)t[e++]=i[a]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){const i=this.resolvedProperty;for(let a=0,o=i.length;a!==o;++a)i[a]=t[e++]},function(t,e){const i=this.resolvedProperty;for(let a=0,o=i.length;a!==o;++a)i[a]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){const i=this.resolvedProperty;for(let a=0,o=i.length;a!==o;++a)i[a]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){let n=this.node;const t=this.parsedPath,e=t.objectName,i=t.propertyName;let a=t.propertyIndex;if(n||(n=zn.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=n),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!n){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(e){let h=t.objectIndex;switch(e){case"materials":if(!n.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!n.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}n=n.material.materials;break;case"bones":if(!n.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}n=n.skeleton.bones;for(let d=0;d<n.length;d++)if(n[d].name===h){h=d;break}break;default:if(n[e]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}n=n[e]}if(h!==void 0){if(n[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,n);return}n=n[h]}}const o=n[i];if(o===void 0){const h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",n);return}let c=this.Versioning.None;this.targetObject=n,n.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:n.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(a!==void 0){if(i==="morphTargetInfluences"){if(!n.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(n.geometry.isBufferGeometry){if(!n.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}n.morphTargetDictionary[a]!==void 0&&(a=n.morphTargetDictionary[a])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}u=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else o.fromArray!==void 0&&o.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(u=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}});Object.assign(zn.prototype,{_getValue_unbound:zn.prototype.getValue,_setValue_unbound:zn.prototype.setValue});function HC(){this.uuid=ne.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const n={};this._indicesByUUID=n;for(let e=0,i=arguments.length;e!==i;++e)n[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}Object.assign(HC.prototype,{isAnimationObjectGroup:!0,add:function(){const n=this._objects,t=this._indicesByUUID,e=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length;let c,u=n.length,h=this.nCachedObjects_;for(let d=0,m=arguments.length;d!==m;++d){const p=arguments[d],g=p.uuid;let v=t[g];if(v===void 0){v=u++,t[g]=v,n.push(p);for(let x=0,M=o;x!==M;++x)a[x].push(new zn(p,e[x],i[x]))}else if(v<h){c=n[v];const x=--h,M=n[x];t[M.uuid]=v,n[v]=M,t[g]=x,n[x]=p;for(let S=0,w=o;S!==w;++S){const _=a[S],L=_[x];let R=_[v];_[v]=L,R===void 0&&(R=new zn(p,e[S],i[S])),_[x]=R}}else n[v]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h},remove:function(){const n=this._objects,t=this._indicesByUUID,e=this._bindings,i=e.length;let a=this.nCachedObjects_;for(let o=0,c=arguments.length;o!==c;++o){const u=arguments[o],h=u.uuid,d=t[h];if(d!==void 0&&d>=a){const m=a++,p=n[m];t[p.uuid]=d,n[d]=p,t[h]=m,n[m]=u;for(let g=0,v=i;g!==v;++g){const x=e[g],M=x[m],S=x[d];x[d]=M,x[m]=S}}}this.nCachedObjects_=a},uncache:function(){const n=this._objects,t=this._indicesByUUID,e=this._bindings,i=e.length;let a=this.nCachedObjects_,o=n.length;for(let c=0,u=arguments.length;c!==u;++c){const h=arguments[c],d=h.uuid,m=t[d];if(m!==void 0)if(delete t[d],m<a){const p=--a,g=n[p],v=--o,x=n[v];t[g.uuid]=m,n[m]=g,t[x.uuid]=p,n[p]=x,n.pop();for(let M=0,S=i;M!==S;++M){const w=e[M],_=w[p],L=w[v];w[m]=_,w[p]=L,w.pop()}}else{const p=--o,g=n[p];p>0&&(t[g.uuid]=m),n[m]=g,n.pop();for(let v=0,x=i;v!==x;++v){const M=e[v];M[m]=M[p],M.pop()}}}this.nCachedObjects_=a},subscribe_:function(n,t){const e=this._bindingsIndicesByPath;let i=e[n];const a=this._bindings;if(i!==void 0)return a[i];const o=this._paths,c=this._parsedPaths,u=this._objects,h=u.length,d=this.nCachedObjects_,m=new Array(h);i=a.length,e[n]=i,o.push(n),c.push(t),a.push(m);for(let p=d,g=u.length;p!==g;++p){const v=u[p];m[p]=new zn(v,n,t)}return m},unsubscribe_:function(n){const t=this._bindingsIndicesByPath,e=t[n];if(e!==void 0){const i=this._paths,a=this._parsedPaths,o=this._bindings,c=o.length-1,u=o[c],h=n[c];t[h]=e,o[e]=u,o.pop(),a[e]=a[c],a.pop(),i[e]=i[c],i.pop()}}});class GC{constructor(t,e,i=null,a=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=i,this.blendMode=a;const o=e.tracks,c=o.length,u=new Array(c),h={endingStart:bo,endingEnd:bo};for(let d=0;d!==c;++d){const m=o[d].createInterpolant(null);u[d]=m,m.settings=h}this._interpolantSettings=h,this._interpolants=u,this._propertyBindings=new Array(c),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=uE,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){const a=this._clip.duration,o=t._clip.duration,c=o/a,u=a/o;t.warp(1,c,e),this.warp(u,1,e)}return this}crossFadeTo(t,e,i){return t.crossFadeFrom(this,e,i)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,i){const a=this._mixer,o=a.time,c=this.timeScale;let u=this._timeScaleInterpolant;u===null&&(u=a._lendControlInterpolant(),this._timeScaleInterpolant=u);const h=u.parameterPositions,d=u.sampleValues;return h[0]=o,h[1]=o+i,d[0]=t/c,d[1]=e/c,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,i,a){if(!this.enabled){this._updateWeight(t);return}const o=this._startTime;if(o!==null){const h=(t-o)*i;if(h<0||i===0)return;this._startTime=null,e=i*h}e*=this._updateTimeScale(t);const c=this._updateTime(e),u=this._updateWeight(t);if(u>0){const h=this._interpolants,d=this._propertyBindings;switch(this.blendMode){case S_:for(let m=0,p=h.length;m!==p;++m)h[m].evaluate(c),d[m].accumulateAdditive(u);break;case $m:default:for(let m=0,p=h.length;m!==p;++m)h[m].evaluate(c),d[m].accumulate(a,u)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const i=this._weightInterpolant;if(i!==null){const a=i.evaluate(t)[0];e*=a,t>i.parameterPositions[1]&&(this.stopFading(),a===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const a=i.evaluate(t)[0];e*=a,t>i.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,i=this.loop;let a=this.time+t,o=this._loopCount;const c=i===hE;if(t===0)return o===-1?a:c&&(o&1)===1?e-a:a;if(i===cE){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(a>=e)a=e;else if(a<0)a=0;else{this.time=a;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(o===-1&&(t>=0?(o=0,this._setEndings(!0,this.repetitions===0,c)):this._setEndings(this.repetitions===0,!0,c)),a>=e||a<0){const u=Math.floor(a/e);a-=e*u,o+=Math.abs(u);const h=this.repetitions-o;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a=t>0?e:0,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(h===1){const d=t<0;this._setEndings(d,!d,c)}else this._setEndings(!1,!1,c);this._loopCount=o,this.time=a,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:u})}}else this.time=a;if(c&&(o&1)===1)return e-a}return a}_setEndings(t,e,i){const a=this._interpolantSettings;i?(a.endingStart=_o,a.endingEnd=_o):(t?a.endingStart=this.zeroSlopeAtStart?_o:bo:a.endingStart=Uh,e?a.endingEnd=this.zeroSlopeAtEnd?_o:bo:a.endingEnd=Uh)}_scheduleFading(t,e,i){const a=this._mixer,o=a.time;let c=this._weightInterpolant;c===null&&(c=a._lendControlInterpolant(),this._weightInterpolant=c);const u=c.parameterPositions,h=c.sampleValues;return u[0]=o,h[0]=e,u[1]=o+t,h[1]=i,this}}function Hb(n){this._root=n,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Hb.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Hb,_bindAction:function(n,t){const e=n._localRoot||this._root,i=n._clip.tracks,a=i.length,o=n._propertyBindings,c=n._interpolants,u=e.uuid,h=this._bindingsByRootAndName;let d=h[u];d===void 0&&(d={},h[u]=d);for(let m=0;m!==a;++m){const p=i[m],g=p.name;let v=d[g];if(v!==void 0)o[m]=v;else{if(v=o[m],v!==void 0){v._cacheIndex===null&&(++v.referenceCount,this._addInactiveBinding(v,u,g));continue}const x=t&&t._propertyBindings[m].binding.parsedPath;v=new Y_(zn.create(e,g,x),p.ValueTypeName,p.getValueSize()),++v.referenceCount,this._addInactiveBinding(v,u,g),o[m]=v}c[m].resultBuffer=v.buffer}},_activateAction:function(n){if(!this._isActiveAction(n)){if(n._cacheIndex===null){const e=(n._localRoot||this._root).uuid,i=n._clip.uuid,a=this._actionsByClip[i];this._bindAction(n,a&&a.knownActions[0]),this._addInactiveAction(n,i,e)}const t=n._propertyBindings;for(let e=0,i=t.length;e!==i;++e){const a=t[e];a.useCount++===0&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(n)}},_deactivateAction:function(n){if(this._isActiveAction(n)){const t=n._propertyBindings;for(let e=0,i=t.length;e!==i;++e){const a=t[e];--a.useCount===0&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(n)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const n=this;this.stats={actions:{get total(){return n._actions.length},get inUse(){return n._nActiveActions}},bindings:{get total(){return n._bindings.length},get inUse(){return n._nActiveBindings}},controlInterpolants:{get total(){return n._controlInterpolants.length},get inUse(){return n._nActiveControlInterpolants}}}},_isActiveAction:function(n){const t=n._cacheIndex;return t!==null&&t<this._nActiveActions},_addInactiveAction:function(n,t,e){const i=this._actions,a=this._actionsByClip;let o=a[t];if(o===void 0)o={knownActions:[n],actionByRoot:{}},n._byClipCacheIndex=0,a[t]=o;else{const c=o.knownActions;n._byClipCacheIndex=c.length,c.push(n)}n._cacheIndex=i.length,i.push(n),o.actionByRoot[e]=n},_removeInactiveAction:function(n){const t=this._actions,e=t[t.length-1],i=n._cacheIndex;e._cacheIndex=i,t[i]=e,t.pop(),n._cacheIndex=null;const a=n._clip.uuid,o=this._actionsByClip,c=o[a],u=c.knownActions,h=u[u.length-1],d=n._byClipCacheIndex;h._byClipCacheIndex=d,u[d]=h,u.pop(),n._byClipCacheIndex=null;const m=c.actionByRoot,p=(n._localRoot||this._root).uuid;delete m[p],u.length===0&&delete o[a],this._removeInactiveBindingsForAction(n)},_removeInactiveBindingsForAction:function(n){const t=n._propertyBindings;for(let e=0,i=t.length;e!==i;++e){const a=t[e];--a.referenceCount===0&&this._removeInactiveBinding(a)}},_lendAction:function(n){const t=this._actions,e=n._cacheIndex,i=this._nActiveActions++,a=t[i];n._cacheIndex=i,t[i]=n,a._cacheIndex=e,t[e]=a},_takeBackAction:function(n){const t=this._actions,e=n._cacheIndex,i=--this._nActiveActions,a=t[i];n._cacheIndex=i,t[i]=n,a._cacheIndex=e,t[e]=a},_addInactiveBinding:function(n,t,e){const i=this._bindingsByRootAndName,a=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[e]=n,n._cacheIndex=a.length,a.push(n)},_removeInactiveBinding:function(n){const t=this._bindings,e=n.binding,i=e.rootNode.uuid,a=e.path,o=this._bindingsByRootAndName,c=o[i],u=t[t.length-1],h=n._cacheIndex;u._cacheIndex=h,t[h]=u,t.pop(),delete c[a],Object.keys(c).length===0&&delete o[i]},_lendBinding:function(n){const t=this._bindings,e=n._cacheIndex,i=this._nActiveBindings++,a=t[i];n._cacheIndex=i,t[i]=n,a._cacheIndex=e,t[e]=a},_takeBackBinding:function(n){const t=this._bindings,e=n._cacheIndex,i=--this._nActiveBindings,a=t[i];n._cacheIndex=i,t[i]=n,a._cacheIndex=e,t[e]=a},_lendControlInterpolant:function(){const n=this._controlInterpolants,t=this._nActiveControlInterpolants++;let e=n[t];return e===void 0&&(e=new Vh(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),e.__cacheIndex=t,n[t]=e),e},_takeBackControlInterpolant:function(n){const t=this._controlInterpolants,e=n.__cacheIndex,i=--this._nActiveControlInterpolants,a=t[i];n.__cacheIndex=i,t[i]=n,a.__cacheIndex=e,t[e]=a},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(n,t,e){const i=t||this._root,a=i.uuid;let o=typeof n=="string"?Ni.findByName(i,n):n;const c=o!==null?o.uuid:n,u=this._actionsByClip[c];let h=null;if(e===void 0&&(o!==null?e=o.blendMode:e=$m),u!==void 0){const m=u.actionByRoot[a];if(m!==void 0&&m.blendMode===e)return m;h=u.knownActions[0],o===null&&(o=h._clip)}if(o===null)return null;const d=new GC(this,o,t,e);return this._bindAction(d,h),this._addInactiveAction(d,c,a),d},existingAction:function(n,t){const e=t||this._root,i=e.uuid,a=typeof n=="string"?Ni.findByName(e,n):n,o=a?a.uuid:n,c=this._actionsByClip[o];return c!==void 0&&c.actionByRoot[i]||null},stopAllAction:function(){const n=this._actions,t=this._nActiveActions;for(let e=t-1;e>=0;--e)n[e].stop();return this},update:function(n){n*=this.timeScale;const t=this._actions,e=this._nActiveActions,i=this.time+=n,a=Math.sign(n),o=this._accuIndex^=1;for(let h=0;h!==e;++h)t[h]._update(i,n,a,o);const c=this._bindings,u=this._nActiveBindings;for(let h=0;h!==u;++h)c[h].apply(o);return this},setTime:function(n){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(n)},getRoot:function(){return this._root},uncacheClip:function(n){const t=this._actions,e=n.uuid,i=this._actionsByClip,a=i[e];if(a!==void 0){const o=a.knownActions;for(let c=0,u=o.length;c!==u;++c){const h=o[c];this._deactivateAction(h);const d=h._cacheIndex,m=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,m._cacheIndex=d,t[d]=m,t.pop(),this._removeInactiveBindingsForAction(h)}delete i[e]}},uncacheRoot:function(n){const t=n.uuid,e=this._actionsByClip;for(const o in e){const c=e[o].actionByRoot,u=c[t];u!==void 0&&(this._deactivateAction(u),this._removeInactiveAction(u))}const i=this._bindingsByRootAndName,a=i[t];if(a!==void 0)for(const o in a){const c=a[o];c.restoreOriginalState(),this._removeInactiveBinding(c)}},uncacheAction:function(n,t){const e=this.existingAction(n,t);e!==null&&(this._deactivateAction(e),this._removeInactiveAction(e))}});function Gb(n,t,e){di.call(this,n,t),this.meshPerAttribute=e||1}Gb.prototype=Object.assign(Object.create(di.prototype),{constructor:Gb,isInstancedInterleavedBuffer:!0,copy:function(n){return di.prototype.copy.call(this,n),this.meshPerAttribute=n.meshPerAttribute,this},clone:function(n){const t=di.prototype.clone.call(this,n);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(n){const t=di.prototype.toJSON.call(this,n);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}});function Z_(n,t,e,i,a){this.buffer=n,this.type=t,this.itemSize=e,this.elementSize=i,this.count=a,this.version=0}Object.defineProperty(Z_.prototype,"needsUpdate",{set:function(n){n===!0&&this.version++}});Object.assign(Z_.prototype,{isGLBufferAttribute:!0,setBuffer:function(n){return this.buffer=n,this},setType:function(n,t){return this.type=n,this.elementSize=t,this},setItemSize:function(n){return this.itemSize=n,this},setCount:function(n){return this.count=n,this}});function Q_(n,t,e,i){this.ray=new Rc(n,t),this.near=e||0,this.far=i||1/0,this.camera=null,this.layers=new E_,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Vb(n,t){return n.distance-t.distance}function Fm(n,t,e,i){if(n.layers.test(t.layers)&&n.raycast(t,e),i===!0){const a=n.children;for(let o=0,c=a.length;o<c;o++)Fm(a[o],t,e,!0)}}Object.assign(Q_.prototype,{set:function(n,t){this.ray.set(n,t)},setFromCamera:function(n,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(n.x,n.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(n.x,n.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)},intersectObject:function(n,t,e){const i=e||[];return Fm(n,this,i,t),i.sort(Vb),i},intersectObjects:function(n,t,e){const i=e||[];if(Array.isArray(n)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(let a=0,o=n.length;a<o;a++)Fm(n[a],this,i,t);return i.sort(Vb),i}});class kb{constructor(t=1,e=0,i=0){return this.radius=t,this.phi=e,this.theta=i,this}set(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this}clone(){return new this.constructor().copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(ne.clamp(e/this.radius,-1,1))),this}}const Wb=new ht;class VC{constructor(t,e){Object.defineProperty(this,"isBox2",{value:!0}),this.min=t!==void 0?t:new ht(1/0,1/0),this.max=e!==void 0?e:new ht(-1/0,-1/0)}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=Wb.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return t===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new ht),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return t===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new ht),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new ht),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new ht),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Wb.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}function qh(n){Xt.call(this),this.material=n,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}qh.prototype=Object.create(Xt.prototype);qh.prototype.constructor=qh;qh.prototype.isImmediateRenderObject=!0;const ha=new G,wh=new re,$p=new re;class kC extends Fh{constructor(t){const e=J_(t),i=new Re,a=[],o=[],c=new Wt(0,0,1),u=new Wt(0,1,0);for(let d=0;d<e.length;d++){const m=e[d];m.parent&&m.parent.isBone&&(a.push(0,0,0),a.push(0,0,0),o.push(c.r,c.g,c.b),o.push(u.r,u.g,u.b))}i.setAttribute("position",new we(a,3)),i.setAttribute("color",new we(o,3));const h=new vi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,h),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,i=this.geometry,a=i.getAttribute("position");$p.copy(this.root.matrixWorld).invert();for(let o=0,c=0;o<e.length;o++){const u=e[o];u.parent&&u.parent.isBone&&(wh.multiplyMatrices($p,u.matrixWorld),ha.setFromMatrixPosition(wh),a.setXYZ(c,ha.x,ha.y,ha.z),wh.multiplyMatrices($p,u.parent.matrixWorld),ha.setFromMatrixPosition(wh),a.setXYZ(c+1,ha.x,ha.y,ha.z),c+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}function J_(n){const t=[];n&&n.isBone&&t.push(n);for(let e=0;e<n.children.length;e++)t.push.apply(t,J_(n.children[e]));return t}class K_ extends Fh{constructor(t=10,e=10,i=4473924,a=8947848){i=new Wt(i),a=new Wt(a);const o=e/2,c=t/e,u=t/2,h=[],d=[];for(let g=0,v=0,x=-u;g<=e;g++,x+=c){h.push(-u,0,x,u,0,x),h.push(x,0,-u,x,0,u);const M=g===o?i:a;M.toArray(d,v),v+=3,M.toArray(d,v),v+=3,M.toArray(d,v),v+=3,M.toArray(d,v),v+=3}const m=new Re;m.setAttribute("position",new we(h,3)),m.setAttribute("color",new we(d,3));const p=new vi({vertexColors:!0,toneMapped:!1});super(m,p),this.type="GridHelper"}}const WC=new Float32Array(1);new Int32Array(WC.buffer);qt.create=function(n,t){return console.log("THREE.Curve.create() has been deprecated"),n.prototype=Object.create(qt.prototype),n.prototype.constructor=n,n.prototype.getPoint=t,n};Object.assign(ga.prototype,{createPointsGeometry:function(n){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=this.getPoints(n);return this.createGeometry(t)},createSpacedPointsGeometry:function(n){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=this.getSpacedPoints(n);return this.createGeometry(t)},createGeometry:function(n){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=new Tn;for(let e=0,i=n.length;e<i;e++){const a=n[e];t.vertices.push(new G(a.x,a.y,a.z||0))}return t}});Object.assign(Xi.prototype,{fromPoints:function(n){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(n)}});Object.create(ti.prototype);Object.create(ti.prototype);function $_(n){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ti.call(this,n),this.type="catmullrom"}$_.prototype=Object.create(ti.prototype);Object.assign($_.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});K_.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};kC.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Object.assign(Ne.prototype,{extractUrlBase:function(n){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),AC.extractUrlBase(n)}});Ne.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};Object.assign(VC.prototype,{center:function(n){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(n)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(n){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},size:function(n){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(n)}});Object.assign(Ta.prototype,{center:function(n){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(n)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(n){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},isIntersectionSphere:function(n){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},size:function(n){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(n)}});Object.assign(Di.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}});$h.prototype.setFromMatrix=function(n){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(n)};Object.assign(ne,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(n){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ne.floorPowerOfTwo(n)},nextPowerOfTwo:function(n){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ne.ceilPowerOfTwo(n)}});Object.assign(Hn.prototype,{flattenToArrayOffset:function(n,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,t)},multiplyVector3:function(n){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(n){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(n){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()}});Object.assign(re.prototype,{extractPosition:function(n){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(n)},flattenToArrayOffset:function(n,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new G().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(n){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(n)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(n){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},multiplyVector4:function(n){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(n){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),n.transformDirection(this)},crossVector:function(n){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(n){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(n,t,e,i,a,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(n,t,i,e,a,o)},getInverse:function(n){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()}});Ls.prototype.isIntersectionLine=function(n){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(n)};Object.assign(Nn.prototype,{multiplyVector3:function(n){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),n.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}});Object.assign(Rc.prototype,{isIntersectionBox:function(n){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},isIntersectionPlane:function(n){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(n)},isIntersectionSphere:function(n){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)}});Object.assign(Sn.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(n,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(n,t)},midpoint:function(n){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(n)},normal:function(n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(n)},plane:function(n){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(n)}});Object.assign(Sn,{barycoordFromPoint:function(n,t,e,i,a){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Sn.getBarycoord(n,t,e,i,a)},normal:function(n,t,e,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Sn.getNormal(n,t,e,i)}});Object.assign(Ro.prototype,{extractAllPoints:function(n){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(n)},extrude:function(n){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new rC(this,n)},makeGeometry:function(n){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new hC(this,n)}});Object.assign(ht.prototype,{fromAttribute:function(n,t,e){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,t,e)},distanceToManhattan:function(n){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(G.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(n){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(n)},getScaleFromMatrix:function(n){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(n)},getColumnFromMatrix:function(n,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,n)},applyProjection:function(n){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(n)},fromAttribute:function(n,t,e){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,t,e)},distanceToManhattan:function(n){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(Le.prototype,{fromAttribute:function(n,t,e){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,t,e)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(Tn.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(n){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)}});Object.assign(Xt.prototype,{getChildByName:function(n){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(n)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(n,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,n)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(n){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)}});Object.defineProperties(Xt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(n){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=n}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Object.assign(Ze.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}});Object.defineProperties(Ze.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),fE},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});Object.defineProperties(vm.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}});Object.defineProperty(_m.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});xm.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};Object.defineProperty(qt.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(n){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=n}});on.prototype.setLens=function(n,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(n)};Object.defineProperties(Fe.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(n){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=n}},shadowCameraLeft:{set:function(n){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=n}},shadowCameraRight:{set:function(n){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=n}},shadowCameraTop:{set:function(n){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=n}},shadowCameraBottom:{set:function(n){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=n}},shadowCameraNear:{set:function(n){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=n}},shadowCameraFar:{set:function(n){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=n}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(n){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=n}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(n){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=n}},shadowMapHeight:{set:function(n){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=n}}});Object.defineProperties(ee.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===pc},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(pc)}}});Object.assign(ee.prototype,{setDynamic:function(n){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(n===!0?pc:Kh),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}});Object.assign(Re.prototype,{addIndex:function(n){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(n)},addAttribute:function(n,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(t&&t.isBufferAttribute)&&!(t&&t.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(n,new ee(arguments[1],arguments[2]))):n==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(n,t)},addDrawCall:function(n,t,e){e!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(n,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(n){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(n)},applyMatrix:function(n){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)}});Object.defineProperties(Re.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});Object.defineProperties(jh.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(n){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=n}}});Object.defineProperties(Q_.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(n){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=n}}});Object.defineProperties(di.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===pc},set:function(n){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(n)}}});Object.assign(di.prototype,{setDynamic:function(n){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(n===!0?pc:Kh),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}});Object.assign(W_.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}});Object.assign(tf.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}});Object.defineProperties(Jt.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Wt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===b_}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(n){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=n}}});Object.defineProperties(dr.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});Object.defineProperties(Sa.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(n){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=n}}});Object.defineProperties(Gn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(n){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=n}}});Object.assign(mr.prototype,{clearTarget:function(n,t,e,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(n),this.clear(t,e,i)},animate:function(n){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(n)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(n){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(n)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}});Object.defineProperties(mr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=n}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=n}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(n){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=n===!0?Jh:Lc}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}});Object.defineProperties(I_.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(Bi.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=n}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=n}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=n}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=n}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(n){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=n}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(n){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=n}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(n){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=n}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(n){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=n}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(n){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=n}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(n){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=n}}});Do.prototype.updateCubeMap=function(n,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(n,t)};Do.prototype.clear=function(n,t,e,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(n,t,e,i)};Yo.crossOrigin=void 0;Yo.loadTexture=function(n,t,e,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const a=new Bm;a.setCrossOrigin(this.crossOrigin);const o=a.load(n,e,void 0,i);return t&&(o.mapping=t),o};Yo.loadTextureCube=function(n,t,e,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const a=new zm;a.setCrossOrigin(this.crossOrigin);const o=a.load(n,e,void 0,i);return t&&(o.mapping=t),o};Yo.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};Yo.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:VM}}));var Wo=function(n,t){t===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=n,this.domElement=t,this.enabled=!0,this.target=new G,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:da.ROTATE,MIDDLE:da.DOLLY,RIGHT:da.PAN},this.touches={ONE:pa.ROTATE,TWO:pa.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return d.phi},this.getAzimuthalAngle=function(){return d.theta},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(i),e.update(),u=c.NONE},this.update=(function(){var W=new G,St=new Nn().setFromUnitVectors(n.up,new G(0,1,0)),Pt=St.clone().invert(),At=new G,Vt=new Nn,ye=2*Math.PI;return function(){var bi=e.object.position;W.copy(bi).sub(e.target),W.applyQuaternion(St),d.setFromVector3(W),e.autoRotate&&u===c.NONE&&X(B()),e.enableDamping?(d.theta+=m.theta*e.dampingFactor,d.phi+=m.phi*e.dampingFactor):(d.theta+=m.theta,d.phi+=m.phi);var Oe=e.minAzimuthAngle,Je=e.maxAzimuthAngle;return isFinite(Oe)&&isFinite(Je)&&(Oe<-Math.PI?Oe+=ye:Oe>Math.PI&&(Oe-=ye),Je<-Math.PI?Je+=ye:Je>Math.PI&&(Je-=ye),Oe<=Je?d.theta=Math.max(Oe,Math.min(Je,d.theta)):d.theta=d.theta>(Oe+Je)/2?Math.max(Oe,d.theta):Math.min(Je,d.theta)),d.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,d.phi)),d.makeSafe(),d.radius*=p,d.radius=Math.max(e.minDistance,Math.min(e.maxDistance,d.radius)),e.enableDamping===!0?e.target.addScaledVector(g,e.dampingFactor):e.target.add(g),W.setFromSpherical(d),W.applyQuaternion(Pt),bi.copy(e.target).add(W),e.object.lookAt(e.target),e.enableDamping===!0?(m.theta*=1-e.dampingFactor,m.phi*=1-e.dampingFactor,g.multiplyScalar(1-e.dampingFactor)):(m.set(0,0,0),g.set(0,0,0)),p=1,v||At.distanceToSquared(e.object.position)>h||8*(1-Vt.dot(e.object.quaternion))>h?(e.dispatchEvent(i),At.copy(e.object.position),Vt.copy(e.object.quaternion),v=!1,!0):!1}})(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",Tt,!1),e.domElement.removeEventListener("pointerdown",wt,!1),e.domElement.removeEventListener("wheel",xt,!1),e.domElement.removeEventListener("touchstart",Mt,!1),e.domElement.removeEventListener("touchend",Ot,!1),e.domElement.removeEventListener("touchmove",Nt,!1),e.domElement.ownerDocument.removeEventListener("pointermove",Ft,!1),e.domElement.ownerDocument.removeEventListener("pointerup",Rt,!1),e.domElement.removeEventListener("keydown",J,!1)};var e=this,i={type:"change"},a={type:"start"},o={type:"end"},c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},u=c.NONE,h=1e-6,d=new kb,m=new kb,p=1,g=new G,v=!1,x=new ht,M=new ht,S=new ht,w=new ht,_=new ht,L=new ht,R=new ht,C=new ht,A=new ht;function B(){return 2*Math.PI/60/60*e.autoRotateSpeed}function Y(){return Math.pow(.95,e.zoomSpeed)}function X(W){m.theta-=W}function st(W){m.phi-=W}var V=(function(){var W=new G;return function(Pt,At){W.setFromMatrixColumn(At,0),W.multiplyScalar(-Pt),g.add(W)}})(),j=(function(){var W=new G;return function(Pt,At){e.screenSpacePanning===!0?W.setFromMatrixColumn(At,1):(W.setFromMatrixColumn(At,0),W.crossVectors(e.object.up,W)),W.multiplyScalar(Pt),g.add(W)}})(),I=(function(){var W=new G;return function(Pt,At){var Vt=e.domElement;if(e.object.isPerspectiveCamera){var ye=e.object.position;W.copy(ye).sub(e.target);var Qe=W.length();Qe*=Math.tan(e.object.fov/2*Math.PI/180),V(2*Pt*Qe/Vt.clientHeight,e.object.matrix),j(2*At*Qe/Vt.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(V(Pt*(e.object.right-e.object.left)/e.object.zoom/Vt.clientWidth,e.object.matrix),j(At*(e.object.top-e.object.bottom)/e.object.zoom/Vt.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}})();function H(W){e.object.isPerspectiveCamera?p/=W:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom*W)),e.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function U(W){e.object.isPerspectiveCamera?p*=W:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/W)),e.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function z(W){x.set(W.clientX,W.clientY)}function Q(W){R.set(W.clientX,W.clientY)}function $(W){w.set(W.clientX,W.clientY)}function it(W){M.set(W.clientX,W.clientY),S.subVectors(M,x).multiplyScalar(e.rotateSpeed);var St=e.domElement;X(2*Math.PI*S.x/St.clientHeight),st(2*Math.PI*S.y/St.clientHeight),x.copy(M),e.update()}function ct(W){C.set(W.clientX,W.clientY),A.subVectors(C,R),A.y>0?H(Y()):A.y<0&&U(Y()),R.copy(C),e.update()}function D(W){_.set(W.clientX,W.clientY),L.subVectors(_,w).multiplyScalar(e.panSpeed),I(L.x,L.y),w.copy(_),e.update()}function q(W){W.deltaY<0?U(Y()):W.deltaY>0&&H(Y()),e.update()}function ut(W){var St=!1;switch(W.keyCode){case e.keys.UP:I(0,e.keyPanSpeed),St=!0;break;case e.keys.BOTTOM:I(0,-e.keyPanSpeed),St=!0;break;case e.keys.LEFT:I(e.keyPanSpeed,0),St=!0;break;case e.keys.RIGHT:I(-e.keyPanSpeed,0),St=!0;break}St&&(W.preventDefault(),e.update())}function yt(W){if(W.touches.length==1)x.set(W.touches[0].pageX,W.touches[0].pageY);else{var St=.5*(W.touches[0].pageX+W.touches[1].pageX),Pt=.5*(W.touches[0].pageY+W.touches[1].pageY);x.set(St,Pt)}}function tt(W){if(W.touches.length==1)w.set(W.touches[0].pageX,W.touches[0].pageY);else{var St=.5*(W.touches[0].pageX+W.touches[1].pageX),Pt=.5*(W.touches[0].pageY+W.touches[1].pageY);w.set(St,Pt)}}function Ct(W){var St=W.touches[0].pageX-W.touches[1].pageX,Pt=W.touches[0].pageY-W.touches[1].pageY,At=Math.sqrt(St*St+Pt*Pt);R.set(0,At)}function bt(W){e.enableZoom&&Ct(W),e.enablePan&&tt(W)}function Ht(W){e.enableZoom&&Ct(W),e.enableRotate&&yt(W)}function Lt(W){if(W.touches.length==1)M.set(W.touches[0].pageX,W.touches[0].pageY);else{var St=.5*(W.touches[0].pageX+W.touches[1].pageX),Pt=.5*(W.touches[0].pageY+W.touches[1].pageY);M.set(St,Pt)}S.subVectors(M,x).multiplyScalar(e.rotateSpeed);var At=e.domElement;X(2*Math.PI*S.x/At.clientHeight),st(2*Math.PI*S.y/At.clientHeight),x.copy(M)}function Qt(W){if(W.touches.length==1)_.set(W.touches[0].pageX,W.touches[0].pageY);else{var St=.5*(W.touches[0].pageX+W.touches[1].pageX),Pt=.5*(W.touches[0].pageY+W.touches[1].pageY);_.set(St,Pt)}L.subVectors(_,w).multiplyScalar(e.panSpeed),I(L.x,L.y),w.copy(_)}function kt(W){var St=W.touches[0].pageX-W.touches[1].pageX,Pt=W.touches[0].pageY-W.touches[1].pageY,At=Math.sqrt(St*St+Pt*Pt);C.set(0,At),A.set(0,Math.pow(C.y/R.y,e.zoomSpeed)),H(A.y),R.copy(C)}function vt(W){e.enableZoom&&kt(W),e.enablePan&&Qt(W)}function Et(W){e.enableZoom&&kt(W),e.enableRotate&&Lt(W)}function wt(W){if(e.enabled!==!1)switch(W.pointerType){case"mouse":case"pen":F(W);break}}function Ft(W){if(e.enabled!==!1)switch(W.pointerType){case"mouse":case"pen":O(W);break}}function Rt(W){switch(W.pointerType){case"mouse":case"pen":_t();break}}function F(W){W.preventDefault(),e.domElement.focus?e.domElement.focus():window.focus();var St;switch(W.button){case 0:St=e.mouseButtons.LEFT;break;case 1:St=e.mouseButtons.MIDDLE;break;case 2:St=e.mouseButtons.RIGHT;break;default:St=-1}switch(St){case da.DOLLY:if(e.enableZoom===!1)return;Q(W),u=c.DOLLY;break;case da.ROTATE:if(W.ctrlKey||W.metaKey||W.shiftKey){if(e.enablePan===!1)return;$(W),u=c.PAN}else{if(e.enableRotate===!1)return;z(W),u=c.ROTATE}break;case da.PAN:if(W.ctrlKey||W.metaKey||W.shiftKey){if(e.enableRotate===!1)return;z(W),u=c.ROTATE}else{if(e.enablePan===!1)return;$(W),u=c.PAN}break;default:u=c.NONE}u!==c.NONE&&(e.domElement.ownerDocument.addEventListener("pointermove",Ft,!1),e.domElement.ownerDocument.addEventListener("pointerup",Rt,!1),e.dispatchEvent(a))}function O(W){if(e.enabled!==!1)switch(W.preventDefault(),u){case c.ROTATE:if(e.enableRotate===!1)return;it(W);break;case c.DOLLY:if(e.enableZoom===!1)return;ct(W);break;case c.PAN:if(e.enablePan===!1)return;D(W);break}}function _t(W){e.domElement.ownerDocument.removeEventListener("pointermove",Ft,!1),e.domElement.ownerDocument.removeEventListener("pointerup",Rt,!1),e.enabled!==!1&&(e.dispatchEvent(o),u=c.NONE)}function xt(W){e.enabled===!1||e.enableZoom===!1||u!==c.NONE&&u!==c.ROTATE||(W.preventDefault(),W.stopPropagation(),e.dispatchEvent(a),q(W),e.dispatchEvent(o))}function J(W){e.enabled===!1||e.enableKeys===!1||e.enablePan===!1||ut(W)}function Mt(W){if(e.enabled!==!1){switch(W.preventDefault(),W.touches.length){case 1:switch(e.touches.ONE){case pa.ROTATE:if(e.enableRotate===!1)return;yt(W),u=c.TOUCH_ROTATE;break;case pa.PAN:if(e.enablePan===!1)return;tt(W),u=c.TOUCH_PAN;break;default:u=c.NONE}break;case 2:switch(e.touches.TWO){case pa.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;bt(W),u=c.TOUCH_DOLLY_PAN;break;case pa.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Ht(W),u=c.TOUCH_DOLLY_ROTATE;break;default:u=c.NONE}break;default:u=c.NONE}u!==c.NONE&&e.dispatchEvent(a)}}function Nt(W){if(e.enabled!==!1)switch(W.preventDefault(),W.stopPropagation(),u){case c.TOUCH_ROTATE:if(e.enableRotate===!1)return;Lt(W),e.update();break;case c.TOUCH_PAN:if(e.enablePan===!1)return;Qt(W),e.update();break;case c.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;vt(W),e.update();break;case c.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Et(W),e.update();break;default:u=c.NONE}}function Ot(W){e.enabled!==!1&&(e.dispatchEvent(o),u=c.NONE)}function Tt(W){e.enabled!==!1&&W.preventDefault()}e.domElement.addEventListener("contextmenu",Tt,!1),e.domElement.addEventListener("pointerdown",wt,!1),e.domElement.addEventListener("wheel",xt,!1),e.domElement.addEventListener("touchstart",Mt,!1),e.domElement.addEventListener("touchend",Ot,!1),e.domElement.addEventListener("touchmove",Nt,!1),e.domElement.addEventListener("keydown",J,!1),this.update()};Wo.prototype=Object.create(Oi.prototype);Wo.prototype.constructor=Wo;var Hm=function(n,t){Wo.call(this,n,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=da.PAN,this.mouseButtons.RIGHT=da.ROTATE,this.touches.ONE=pa.PAN,this.touches.TWO=pa.DOLLY_ROTATE};Hm.prototype=Object.create(Oi.prototype);Hm.prototype.constructor=Hm;class jC{scene;camera;controls;ambientLight;directionalLight;constructor(t){this.scene=new tf,this.camera=new on(45,window.innerWidth/window.innerHeight,1,1e3),this.camera.position.set(0,25,0),this.camera.lookAt(0,0,0),this.controls=new Wo(this.camera,t),this.controls.enableDamping=!0,this.controls.enableRotate=!1,this.controls.enableZoom=!1,this.controls.enablePan=!1,this.ambientLight=new Ac(16777215,.7),this.scene.add(this.ambientLight),this.directionalLight=new Ea(16777215,1.2),this.directionalLight.position.set(5,50,5),this.directionalLight.castShadow=!0,this.directionalLight.shadow.mapSize.width=2048,this.directionalLight.shadow.mapSize.height=2048,this.scene.add(this.directionalLight);const e=new Ea(16777215,.5);e.position.set(-5,20,-5),this.scene.add(e),this.createTray()}createTray(){const t=new lC(100,100),e=new fr({opacity:.5}),i=new Ze(t,e);i.rotation.x=-Math.PI/2,i.receiveShadow=!0,this.scene.add(i),this.updateDebugBounds(44,28)}debugWalls=[];updateDebugBounds(t,e){this.debugWalls.forEach(_=>{this.scene.remove(_),_.geometry&&_.geometry.dispose()}),this.debugWalls=[];const i=new ba({color:16711680,opacity:.3,transparent:!0}),a=t/2,o=e/2,c=10,u=20,h=a+c/2,d=o+c/2,m=t+c*2+20,p=new xb(m,u,c),g=e+c*2,v=new xb(c,u,g),x=new Ze(p,i);x.position.set(0,0,-d),x.visible=!1,this.scene.add(x),this.debugWalls.push(x);const M=new Ze(p,i);M.position.set(0,0,d),M.visible=!1,this.scene.add(M),this.debugWalls.push(M);const S=new Ze(v,i);S.position.set(-h,0,0),S.visible=!1,this.scene.add(S),this.debugWalls.push(S);const w=new Ze(v,i);w.position.set(h,0,0),w.visible=!1,this.scene.add(w),this.debugWalls.push(w)}getVisibleBounds(){const t=this.camera.position.y,e=ne.degToRad(this.camera.fov),i=2*Math.tan(e/2)*t;return{width:i*this.camera.aspect,depth:i}}setDebugVisibility(t){this.debugWalls.forEach(e=>{e.visible=t})}getScene(){return this.scene}getCamera(){return this.camera}updateCamera(t,e){this.camera.aspect=t/e,this.camera.updateProjectionMatrix()}}class qC{constructor(){this.matrix={}}get(t,e){let{id:i}=t,{id:a}=e;if(a>i){const o=a;a=i,i=o}return`${i}-${a}`in this.matrix}set(t,e,i){let{id:a}=t,{id:o}=e;if(o>a){const c=o;o=a,a=c}i?this.matrix[`${a}-${o}`]=!0:delete this.matrix[`${a}-${o}`]}reset(){this.matrix={}}setNumObjects(t){}}class pi{constructor(t){t===void 0&&(t=[0,0,0,0,0,0,0,0,0]),this.elements=t}identity(){const t=this.elements;t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1}setZero(){const t=this.elements;t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0}setTrace(t){const e=this.elements;e[0]=t.x,e[4]=t.y,e[8]=t.z}getTrace(t){t===void 0&&(t=new T);const e=this.elements;return t.x=e[0],t.y=e[4],t.z=e[8],t}vmult(t,e){e===void 0&&(e=new T);const i=this.elements,a=t.x,o=t.y,c=t.z;return e.x=i[0]*a+i[1]*o+i[2]*c,e.y=i[3]*a+i[4]*o+i[5]*c,e.z=i[6]*a+i[7]*o+i[8]*c,e}smult(t){for(let e=0;e<this.elements.length;e++)this.elements[e]*=t}mmult(t,e){e===void 0&&(e=new pi);const i=this.elements,a=t.elements,o=e.elements,c=i[0],u=i[1],h=i[2],d=i[3],m=i[4],p=i[5],g=i[6],v=i[7],x=i[8],M=a[0],S=a[1],w=a[2],_=a[3],L=a[4],R=a[5],C=a[6],A=a[7],B=a[8];return o[0]=c*M+u*_+h*C,o[1]=c*S+u*L+h*A,o[2]=c*w+u*R+h*B,o[3]=d*M+m*_+p*C,o[4]=d*S+m*L+p*A,o[5]=d*w+m*R+p*B,o[6]=g*M+v*_+x*C,o[7]=g*S+v*L+x*A,o[8]=g*w+v*R+x*B,e}scale(t,e){e===void 0&&(e=new pi);const i=this.elements,a=e.elements;for(let o=0;o!==3;o++)a[3*o+0]=t.x*i[3*o+0],a[3*o+1]=t.y*i[3*o+1],a[3*o+2]=t.z*i[3*o+2];return e}solve(t,e){e===void 0&&(e=new T);const i=3,a=4,o=[];let c,u;for(c=0;c<i*a;c++)o.push(0);for(c=0;c<3;c++)for(u=0;u<3;u++)o[c+a*u]=this.elements[c+3*u];o[3]=t.x,o[7]=t.y,o[11]=t.z;let h=3;const d=h;let m;const p=4;let g;do{if(c=d-h,o[c+a*c]===0){for(u=c+1;u<d;u++)if(o[c+a*u]!==0){m=p;do g=p-m,o[g+a*c]+=o[g+a*u];while(--m);break}}if(o[c+a*c]!==0)for(u=c+1;u<d;u++){const v=o[c+a*u]/o[c+a*c];m=p;do g=p-m,o[g+a*u]=g<=c?0:o[g+a*u]-o[g+a*c]*v;while(--m)}}while(--h);if(e.z=o[2*a+3]/o[2*a+2],e.y=(o[1*a+3]-o[1*a+2]*e.z)/o[1*a+1],e.x=(o[0*a+3]-o[0*a+2]*e.z-o[0*a+1]*e.y)/o[0*a+0],isNaN(e.x)||isNaN(e.y)||isNaN(e.z)||e.x===1/0||e.y===1/0||e.z===1/0)throw`Could not solve equation! Got x=[${e.toString()}], b=[${t.toString()}], A=[${this.toString()}]`;return e}e(t,e,i){if(i===void 0)return this.elements[e+3*t];this.elements[e+3*t]=i}copy(t){for(let e=0;e<t.elements.length;e++)this.elements[e]=t.elements[e];return this}toString(){let t="";for(let i=0;i<9;i++)t+=this.elements[i]+",";return t}reverse(t){t===void 0&&(t=new pi);const e=3,i=6,a=YC;let o,c;for(o=0;o<3;o++)for(c=0;c<3;c++)a[o+i*c]=this.elements[o+3*c];a[3]=1,a[9]=0,a[15]=0,a[4]=0,a[10]=1,a[16]=0,a[5]=0,a[11]=0,a[17]=1;let u=3;const h=u;let d;const m=i;let p;do{if(o=h-u,a[o+i*o]===0){for(c=o+1;c<h;c++)if(a[o+i*c]!==0){d=m;do p=m-d,a[p+i*o]+=a[p+i*c];while(--d);break}}if(a[o+i*o]!==0)for(c=o+1;c<h;c++){const g=a[o+i*c]/a[o+i*o];d=m;do p=m-d,a[p+i*c]=p<=o?0:a[p+i*c]-a[p+i*o]*g;while(--d)}}while(--u);o=2;do{c=o-1;do{const g=a[o+i*c]/a[o+i*o];d=i;do p=i-d,a[p+i*c]=a[p+i*c]-a[p+i*o]*g;while(--d)}while(c--)}while(--o);o=2;do{const g=1/a[o+i*o];d=i;do p=i-d,a[p+i*o]=a[p+i*o]*g;while(--d)}while(o--);o=2;do{c=2;do{if(p=a[e+c+i*o],isNaN(p)||p===1/0)throw`Could not reverse! A=[${this.toString()}]`;t.e(o,c,p)}while(c--)}while(o--);return t}setRotationFromQuaternion(t){const e=t.x,i=t.y,a=t.z,o=t.w,c=e+e,u=i+i,h=a+a,d=e*c,m=e*u,p=e*h,g=i*u,v=i*h,x=a*h,M=o*c,S=o*u,w=o*h,_=this.elements;return _[0]=1-(g+x),_[1]=m-w,_[2]=p+S,_[3]=m+w,_[4]=1-(d+x),_[5]=v-M,_[6]=p-S,_[7]=v+M,_[8]=1-(d+g),this}transpose(t){t===void 0&&(t=new pi);const e=this.elements,i=t.elements;let a;return i[0]=e[0],i[4]=e[4],i[8]=e[8],a=e[1],i[1]=e[3],i[3]=a,a=e[2],i[2]=e[6],i[6]=a,a=e[5],i[5]=e[7],i[7]=a,t}}const YC=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class T{constructor(t,e,i){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=0),this.x=t,this.y=e,this.z=i}cross(t,e){e===void 0&&(e=new T);const i=t.x,a=t.y,o=t.z,c=this.x,u=this.y,h=this.z;return e.x=u*o-h*a,e.y=h*i-c*o,e.z=c*a-u*i,e}set(t,e,i){return this.x=t,this.y=e,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(t,e){if(e)e.x=t.x+this.x,e.y=t.y+this.y,e.z=t.z+this.z;else return new T(this.x+t.x,this.y+t.y,this.z+t.z)}vsub(t,e){if(e)e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z;else return new T(this.x-t.x,this.y-t.y,this.z-t.z)}crossmat(){return new pi([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const t=this.x,e=this.y,i=this.z,a=Math.sqrt(t*t+e*e+i*i);if(a>0){const o=1/a;this.x*=o,this.y*=o,this.z*=o}else this.x=0,this.y=0,this.z=0;return a}unit(t){t===void 0&&(t=new T);const e=this.x,i=this.y,a=this.z;let o=Math.sqrt(e*e+i*i+a*a);return o>0?(o=1/o,t.x=e*o,t.y=i*o,t.z=a*o):(t.x=1,t.y=0,t.z=0),t}length(){const t=this.x,e=this.y,i=this.z;return Math.sqrt(t*t+e*e+i*i)}lengthSquared(){return this.dot(this)}distanceTo(t){const e=this.x,i=this.y,a=this.z,o=t.x,c=t.y,u=t.z;return Math.sqrt((o-e)*(o-e)+(c-i)*(c-i)+(u-a)*(u-a))}distanceSquared(t){const e=this.x,i=this.y,a=this.z,o=t.x,c=t.y,u=t.z;return(o-e)*(o-e)+(c-i)*(c-i)+(u-a)*(u-a)}scale(t,e){e===void 0&&(e=new T);const i=this.x,a=this.y,o=this.z;return e.x=t*i,e.y=t*a,e.z=t*o,e}vmul(t,e){return e===void 0&&(e=new T),e.x=t.x*this.x,e.y=t.y*this.y,e.z=t.z*this.z,e}addScaledVector(t,e,i){return i===void 0&&(i=new T),i.x=this.x+t*e.x,i.y=this.y+t*e.y,i.z=this.z+t*e.z,i}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(t){return t===void 0&&(t=new T),t.x=-this.x,t.y=-this.y,t.z=-this.z,t}tangents(t,e){const i=this.length();if(i>0){const a=XC,o=1/i;a.set(this.x*o,this.y*o,this.z*o);const c=ZC;Math.abs(a.x)<.9?(c.set(1,0,0),a.cross(c,t)):(c.set(0,1,0),a.cross(c,t)),a.cross(t,e)}else t.set(1,0,0),e.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}lerp(t,e,i){const a=this.x,o=this.y,c=this.z;i.x=a+(t.x-a)*e,i.y=o+(t.y-o)*e,i.z=c+(t.z-c)*e}almostEquals(t,e){return e===void 0&&(e=1e-6),!(Math.abs(this.x-t.x)>e||Math.abs(this.y-t.y)>e||Math.abs(this.z-t.z)>e)}almostZero(t){return t===void 0&&(t=1e-6),!(Math.abs(this.x)>t||Math.abs(this.y)>t||Math.abs(this.z)>t)}isAntiparallelTo(t,e){return this.negate(jb),jb.almostEquals(t,e)}clone(){return new T(this.x,this.y,this.z)}}T.ZERO=new T(0,0,0);T.UNIT_X=new T(1,0,0);T.UNIT_Y=new T(0,1,0);T.UNIT_Z=new T(0,0,1);const XC=new T,ZC=new T,jb=new T;class Ie{constructor(t){t===void 0&&(t={}),this.lowerBound=new T,this.upperBound=new T,t.lowerBound&&this.lowerBound.copy(t.lowerBound),t.upperBound&&this.upperBound.copy(t.upperBound)}setFromPoints(t,e,i,a){const o=this.lowerBound,c=this.upperBound,u=i;o.copy(t[0]),u&&u.vmult(o,o),c.copy(o);for(let h=1;h<t.length;h++){let d=t[h];u&&(u.vmult(d,qb),d=qb),d.x>c.x&&(c.x=d.x),d.x<o.x&&(o.x=d.x),d.y>c.y&&(c.y=d.y),d.y<o.y&&(o.y=d.y),d.z>c.z&&(c.z=d.z),d.z<o.z&&(o.z=d.z)}return e&&(e.vadd(o,o),e.vadd(c,c)),a&&(o.x-=a,o.y-=a,o.z-=a,c.x+=a,c.y+=a,c.z+=a),this}copy(t){return this.lowerBound.copy(t.lowerBound),this.upperBound.copy(t.upperBound),this}clone(){return new Ie().copy(this)}extend(t){this.lowerBound.x=Math.min(this.lowerBound.x,t.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,t.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,t.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,t.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,t.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,t.upperBound.z)}overlaps(t){const e=this.lowerBound,i=this.upperBound,a=t.lowerBound,o=t.upperBound,c=a.x<=i.x&&i.x<=o.x||e.x<=o.x&&o.x<=i.x,u=a.y<=i.y&&i.y<=o.y||e.y<=o.y&&o.y<=i.y,h=a.z<=i.z&&i.z<=o.z||e.z<=o.z&&o.z<=i.z;return c&&u&&h}volume(){const t=this.lowerBound,e=this.upperBound;return(e.x-t.x)*(e.y-t.y)*(e.z-t.z)}contains(t){const e=this.lowerBound,i=this.upperBound,a=t.lowerBound,o=t.upperBound;return e.x<=a.x&&i.x>=o.x&&e.y<=a.y&&i.y>=o.y&&e.z<=a.z&&i.z>=o.z}getCorners(t,e,i,a,o,c,u,h){const d=this.lowerBound,m=this.upperBound;t.copy(d),e.set(m.x,d.y,d.z),i.set(m.x,m.y,d.z),a.set(d.x,m.y,m.z),o.set(m.x,d.y,m.z),c.set(d.x,m.y,d.z),u.set(d.x,d.y,m.z),h.copy(m)}toLocalFrame(t,e){const i=Yb,a=i[0],o=i[1],c=i[2],u=i[3],h=i[4],d=i[5],m=i[6],p=i[7];this.getCorners(a,o,c,u,h,d,m,p);for(let g=0;g!==8;g++){const v=i[g];t.pointToLocal(v,v)}return e.setFromPoints(i)}toWorldFrame(t,e){const i=Yb,a=i[0],o=i[1],c=i[2],u=i[3],h=i[4],d=i[5],m=i[6],p=i[7];this.getCorners(a,o,c,u,h,d,m,p);for(let g=0;g!==8;g++){const v=i[g];t.pointToWorld(v,v)}return e.setFromPoints(i)}overlapsRay(t){const{direction:e,from:i}=t,a=1/e.x,o=1/e.y,c=1/e.z,u=(this.lowerBound.x-i.x)*a,h=(this.upperBound.x-i.x)*a,d=(this.lowerBound.y-i.y)*o,m=(this.upperBound.y-i.y)*o,p=(this.lowerBound.z-i.z)*c,g=(this.upperBound.z-i.z)*c,v=Math.max(Math.max(Math.min(u,h),Math.min(d,m)),Math.min(p,g)),x=Math.min(Math.min(Math.max(u,h),Math.max(d,m)),Math.max(p,g));return!(x<0||v>x)}}const qb=new T,Yb=[new T,new T,new T,new T,new T,new T,new T,new T];class Gm{constructor(){this.matrix=[]}get(t,e){let{index:i}=t,{index:a}=e;if(a>i){const o=a;a=i,i=o}return this.matrix[(i*(i+1)>>1)+a-1]}set(t,e,i){let{index:a}=t,{index:o}=e;if(o>a){const c=o;o=a,a=c}this.matrix[(a*(a+1)>>1)+o-1]=i?1:0}reset(){for(let t=0,e=this.matrix.length;t!==e;t++)this.matrix[t]=0}setNumObjects(t){this.matrix.length=t*(t-1)>>1}}class sg{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const i=this._listeners;return i[t]===void 0&&(i[t]=[]),i[t].includes(e)||i[t].push(e),this}hasEventListener(t,e){if(this._listeners===void 0)return!1;const i=this._listeners;return!!(i[t]!==void 0&&i[t].includes(e))}hasAnyEventListener(t){return this._listeners===void 0?!1:this._listeners[t]!==void 0}removeEventListener(t,e){if(this._listeners===void 0)return this;const i=this._listeners;if(i[t]===void 0)return this;const a=i[t].indexOf(e);return a!==-1&&i[t].splice(a,1),this}dispatchEvent(t){if(this._listeners===void 0)return this;const i=this._listeners[t.type];if(i!==void 0){t.target=this;for(let a=0,o=i.length;a<o;a++)i[a].call(this,t)}return this}}class je{constructor(t,e,i,a){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=0),a===void 0&&(a=1),this.x=t,this.y=e,this.z=i,this.w=a}set(t,e,i,a){return this.x=t,this.y=e,this.z=i,this.w=a,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(t,e){const i=Math.sin(e*.5);return this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this.w=Math.cos(e*.5),this}toAxisAngle(t){t===void 0&&(t=new T),this.normalize();const e=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(t.x=this.x,t.y=this.y,t.z=this.z):(t.x=this.x/i,t.y=this.y/i,t.z=this.z/i),[t,e]}setFromVectors(t,e){if(t.isAntiparallelTo(e)){const i=QC,a=JC;t.tangents(i,a),this.setFromAxisAngle(i,Math.PI)}else{const i=t.cross(e);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(t.length()**2*e.length()**2)+t.dot(e),this.normalize()}return this}mult(t,e){e===void 0&&(e=new je);const i=this.x,a=this.y,o=this.z,c=this.w,u=t.x,h=t.y,d=t.z,m=t.w;return e.x=i*m+c*u+a*d-o*h,e.y=a*m+c*h+o*u-i*d,e.z=o*m+c*d+i*h-a*u,e.w=c*m-i*u-a*h-o*d,e}inverse(t){t===void 0&&(t=new je);const e=this.x,i=this.y,a=this.z,o=this.w;this.conjugate(t);const c=1/(e*e+i*i+a*a+o*o);return t.x*=c,t.y*=c,t.z*=c,t.w*=c,t}conjugate(t){return t===void 0&&(t=new je),t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=this.w,t}normalize(){let t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return t===0?(this.x=0,this.y=0,this.z=0,this.w=0):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}normalizeFast(){const t=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return t===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}vmult(t,e){e===void 0&&(e=new T);const i=t.x,a=t.y,o=t.z,c=this.x,u=this.y,h=this.z,d=this.w,m=d*i+u*o-h*a,p=d*a+h*i-c*o,g=d*o+c*a-u*i,v=-c*i-u*a-h*o;return e.x=m*d+v*-c+p*-h-g*-u,e.y=p*d+v*-u+g*-c-m*-h,e.z=g*d+v*-h+m*-u-p*-c,e}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}toEuler(t,e){e===void 0&&(e="YZX");let i,a,o;const c=this.x,u=this.y,h=this.z,d=this.w;switch(e){case"YZX":const m=c*u+h*d;if(m>.499&&(i=2*Math.atan2(c,d),a=Math.PI/2,o=0),m<-.499&&(i=-2*Math.atan2(c,d),a=-Math.PI/2,o=0),i===void 0){const p=c*c,g=u*u,v=h*h;i=Math.atan2(2*u*d-2*c*h,1-2*g-2*v),a=Math.asin(2*m),o=Math.atan2(2*c*d-2*u*h,1-2*p-2*v)}break;default:throw new Error(`Euler order ${e} not supported yet.`)}t.y=i,t.z=a,t.x=o}setFromEuler(t,e,i,a){a===void 0&&(a="XYZ");const o=Math.cos(t/2),c=Math.cos(e/2),u=Math.cos(i/2),h=Math.sin(t/2),d=Math.sin(e/2),m=Math.sin(i/2);return a==="XYZ"?(this.x=h*c*u+o*d*m,this.y=o*d*u-h*c*m,this.z=o*c*m+h*d*u,this.w=o*c*u-h*d*m):a==="YXZ"?(this.x=h*c*u+o*d*m,this.y=o*d*u-h*c*m,this.z=o*c*m-h*d*u,this.w=o*c*u+h*d*m):a==="ZXY"?(this.x=h*c*u-o*d*m,this.y=o*d*u+h*c*m,this.z=o*c*m+h*d*u,this.w=o*c*u-h*d*m):a==="ZYX"?(this.x=h*c*u-o*d*m,this.y=o*d*u+h*c*m,this.z=o*c*m-h*d*u,this.w=o*c*u+h*d*m):a==="YZX"?(this.x=h*c*u+o*d*m,this.y=o*d*u+h*c*m,this.z=o*c*m-h*d*u,this.w=o*c*u-h*d*m):a==="XZY"&&(this.x=h*c*u-o*d*m,this.y=o*d*u-h*c*m,this.z=o*c*m+h*d*u,this.w=o*c*u+h*d*m),this}clone(){return new je(this.x,this.y,this.z,this.w)}slerp(t,e,i){i===void 0&&(i=new je);const a=this.x,o=this.y,c=this.z,u=this.w;let h=t.x,d=t.y,m=t.z,p=t.w,g,v,x,M,S;return v=a*h+o*d+c*m+u*p,v<0&&(v=-v,h=-h,d=-d,m=-m,p=-p),1-v>1e-6?(g=Math.acos(v),x=Math.sin(g),M=Math.sin((1-e)*g)/x,S=Math.sin(e*g)/x):(M=1-e,S=e),i.x=M*a+S*h,i.y=M*o+S*d,i.z=M*c+S*m,i.w=M*u+S*p,i}integrate(t,e,i,a){a===void 0&&(a=new je);const o=t.x*i.x,c=t.y*i.y,u=t.z*i.z,h=this.x,d=this.y,m=this.z,p=this.w,g=e*.5;return a.x+=g*(o*p+c*m-u*d),a.y+=g*(c*p+u*h-o*m),a.z+=g*(u*p+o*d-c*h),a.w+=g*(-o*h-c*d-u*m),a}}const QC=new T,JC=new T,t1={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class Dt{constructor(t){t===void 0&&(t={}),this.id=Dt.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=t.collisionResponse?t.collisionResponse:!0,this.collisionFilterGroup=t.collisionFilterGroup!==void 0?t.collisionFilterGroup:1,this.collisionFilterMask=t.collisionFilterMask!==void 0?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(t,e){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(t,e,i,a){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}Dt.idCounter=0;Dt.types=t1;class me{constructor(t){t===void 0&&(t={}),this.position=new T,this.quaternion=new je,t.position&&this.position.copy(t.position),t.quaternion&&this.quaternion.copy(t.quaternion)}pointToLocal(t,e){return me.pointToLocalFrame(this.position,this.quaternion,t,e)}pointToWorld(t,e){return me.pointToWorldFrame(this.position,this.quaternion,t,e)}vectorToWorldFrame(t,e){return e===void 0&&(e=new T),this.quaternion.vmult(t,e),e}static pointToLocalFrame(t,e,i,a){return a===void 0&&(a=new T),i.vsub(t,a),e.conjugate(Xb),Xb.vmult(a,a),a}static pointToWorldFrame(t,e,i,a){return a===void 0&&(a=new T),e.vmult(i,a),a.vadd(t,a),a}static vectorToWorldFrame(t,e,i){return i===void 0&&(i=new T),t.vmult(e,i),i}static vectorToLocalFrame(t,e,i,a){return a===void 0&&(a=new T),e.w*=-1,e.vmult(i,a),e.w*=-1,a}}const Xb=new je;class gi extends Dt{constructor(t){t===void 0&&(t={});const{vertices:e=[],faces:i=[],normals:a=[],axes:o,boundingSphereRadius:c}=t;super({type:Dt.types.CONVEXPOLYHEDRON}),this.vertices=e,this.faces=i,this.faceNormals=a,this.faceNormals.length===0&&this.computeNormals(),c?this.boundingSphereRadius=c:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=o?o.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const t=this.faces,e=this.vertices,i=this.uniqueEdges;i.length=0;const a=new T;for(let o=0;o!==t.length;o++){const c=t[o],u=c.length;for(let h=0;h!==u;h++){const d=(h+1)%u;e[c[h]].vsub(e[c[d]],a),a.normalize();let m=!1;for(let p=0;p!==i.length;p++)if(i[p].almostEquals(a)||i[p].almostEquals(a)){m=!0;break}m||i.push(a.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let t=0;t<this.faces.length;t++){for(let a=0;a<this.faces[t].length;a++)if(!this.vertices[this.faces[t][a]])throw new Error(`Vertex ${this.faces[t][a]} not found!`);const e=this.faceNormals[t]||new T;this.getFaceNormal(t,e),e.negate(e),this.faceNormals[t]=e;const i=this.vertices[this.faces[t][0]];if(e.dot(i)<0){console.error(`.faceNormals[${t}] = Vec3(${e.toString()}) looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.`);for(let a=0;a<this.faces[t].length;a++)console.warn(`.vertices[${this.faces[t][a]}] = Vec3(${this.vertices[this.faces[t][a]].toString()})`)}}}getFaceNormal(t,e){const i=this.faces[t],a=this.vertices[i[0]],o=this.vertices[i[1]],c=this.vertices[i[2]];gi.computeNormal(a,o,c,e)}static computeNormal(t,e,i,a){const o=new T,c=new T;e.vsub(t,c),i.vsub(e,o),o.cross(c,a),a.isZero()||a.normalize()}clipAgainstHull(t,e,i,a,o,c,u,h,d){const m=new T;let p=-1,g=-Number.MAX_VALUE;for(let x=0;x<i.faces.length;x++){m.copy(i.faceNormals[x]),o.vmult(m,m);const M=m.dot(c);M>g&&(g=M,p=x)}const v=[];for(let x=0;x<i.faces[p].length;x++){const M=i.vertices[i.faces[p][x]],S=new T;S.copy(M),o.vmult(S,S),a.vadd(S,S),v.push(S)}p>=0&&this.clipFaceAgainstHull(c,t,e,v,u,h,d)}findSeparatingAxis(t,e,i,a,o,c,u,h){const d=new T,m=new T,p=new T,g=new T,v=new T,x=new T;let M=Number.MAX_VALUE;const S=this;if(S.uniqueAxes)for(let w=0;w!==S.uniqueAxes.length;w++){i.vmult(S.uniqueAxes[w],d);const _=S.testSepAxis(d,t,e,i,a,o);if(_===!1)return!1;_<M&&(M=_,c.copy(d))}else{const w=u?u.length:S.faces.length;for(let _=0;_<w;_++){const L=u?u[_]:_;d.copy(S.faceNormals[L]),i.vmult(d,d);const R=S.testSepAxis(d,t,e,i,a,o);if(R===!1)return!1;R<M&&(M=R,c.copy(d))}}if(t.uniqueAxes)for(let w=0;w!==t.uniqueAxes.length;w++){o.vmult(t.uniqueAxes[w],m);const _=S.testSepAxis(m,t,e,i,a,o);if(_===!1)return!1;_<M&&(M=_,c.copy(m))}else{const w=h?h.length:t.faces.length;for(let _=0;_<w;_++){const L=h?h[_]:_;m.copy(t.faceNormals[L]),o.vmult(m,m);const R=S.testSepAxis(m,t,e,i,a,o);if(R===!1)return!1;R<M&&(M=R,c.copy(m))}}for(let w=0;w!==S.uniqueEdges.length;w++){i.vmult(S.uniqueEdges[w],g);for(let _=0;_!==t.uniqueEdges.length;_++)if(o.vmult(t.uniqueEdges[_],v),g.cross(v,x),!x.almostZero()){x.normalize();const L=S.testSepAxis(x,t,e,i,a,o);if(L===!1)return!1;L<M&&(M=L,c.copy(x))}}return a.vsub(e,p),p.dot(c)>0&&c.negate(c),!0}testSepAxis(t,e,i,a,o,c){const u=this;gi.project(u,t,i,a,tm),gi.project(e,t,o,c,em);const h=tm[0],d=tm[1],m=em[0],p=em[1];if(h<p||m<d)return!1;const g=h-p,v=m-d;return g<v?g:v}calculateLocalInertia(t,e){const i=new T,a=new T;this.computeLocalAABB(a,i);const o=i.x-a.x,c=i.y-a.y,u=i.z-a.z;e.x=1/12*t*(2*c*2*c+2*u*2*u),e.y=1/12*t*(2*o*2*o+2*u*2*u),e.z=1/12*t*(2*c*2*c+2*o*2*o)}getPlaneConstantOfFace(t){const e=this.faces[t],i=this.faceNormals[t],a=this.vertices[e[0]];return-i.dot(a)}clipFaceAgainstHull(t,e,i,a,o,c,u){const h=new T,d=new T,m=new T,p=new T,g=new T,v=new T,x=new T,M=new T,S=this,w=[],_=a,L=w;let R=-1,C=Number.MAX_VALUE;for(let st=0;st<S.faces.length;st++){h.copy(S.faceNormals[st]),i.vmult(h,h);const V=h.dot(t);V<C&&(C=V,R=st)}if(R<0)return;const A=S.faces[R];A.connectedFaces=[];for(let st=0;st<S.faces.length;st++)for(let V=0;V<S.faces[st].length;V++)A.indexOf(S.faces[st][V])!==-1&&st!==R&&A.connectedFaces.indexOf(st)===-1&&A.connectedFaces.push(st);const B=A.length;for(let st=0;st<B;st++){const V=S.vertices[A[st]],j=S.vertices[A[(st+1)%B]];V.vsub(j,d),m.copy(d),i.vmult(m,m),e.vadd(m,m),p.copy(this.faceNormals[R]),i.vmult(p,p),e.vadd(p,p),m.cross(p,g),g.negate(g),v.copy(V),i.vmult(v,v),e.vadd(v,v);const I=A.connectedFaces[st];x.copy(this.faceNormals[I]);const H=this.getPlaneConstantOfFace(I);M.copy(x),i.vmult(M,M);const U=H-M.dot(e);for(this.clipFaceAgainstPlane(_,L,M,U);_.length;)_.shift();for(;L.length;)_.push(L.shift())}x.copy(this.faceNormals[R]);const Y=this.getPlaneConstantOfFace(R);M.copy(x),i.vmult(M,M);const X=Y-M.dot(e);for(let st=0;st<_.length;st++){let V=M.dot(_[st])+X;if(V<=o&&(console.log(`clamped: depth=${V} to minDist=${o}`),V=o),V<=c){const j=_[st];if(V<=1e-6){const I={point:j,normal:M,depth:V};u.push(I)}}}}clipFaceAgainstPlane(t,e,i,a){let o,c;const u=t.length;if(u<2)return e;let h=t[t.length-1],d=t[0];o=i.dot(h)+a;for(let m=0;m<u;m++){if(d=t[m],c=i.dot(d)+a,o<0)if(c<0){const p=new T;p.copy(d),e.push(p)}else{const p=new T;h.lerp(d,o/(o-c),p),e.push(p)}else if(c<0){const p=new T;h.lerp(d,o/(o-c),p),e.push(p),e.push(d)}h=d,o=c}return e}computeWorldVertices(t,e){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new T);const i=this.vertices,a=this.worldVertices;for(let o=0;o!==this.vertices.length;o++)e.vmult(i[o],a[o]),t.vadd(a[o],a[o]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(t,e){const i=this.vertices;t.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let a=0;a<this.vertices.length;a++){const o=i[a];o.x<t.x?t.x=o.x:o.x>e.x&&(e.x=o.x),o.y<t.y?t.y=o.y:o.y>e.y&&(e.y=o.y),o.z<t.z?t.z=o.z:o.z>e.z&&(e.z=o.z)}}computeWorldFaceNormals(t){const e=this.faceNormals.length;for(;this.worldFaceNormals.length<e;)this.worldFaceNormals.push(new T);const i=this.faceNormals,a=this.worldFaceNormals;for(let o=0;o!==e;o++)t.vmult(i[o],a[o]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let t=0;const e=this.vertices;for(let i=0;i!==e.length;i++){const a=e[i].lengthSquared();a>t&&(t=a)}this.boundingSphereRadius=Math.sqrt(t)}calculateWorldAABB(t,e,i,a){const o=this.vertices;let c,u,h,d,m,p,g=new T;for(let v=0;v<o.length;v++){g.copy(o[v]),e.vmult(g,g),t.vadd(g,g);const x=g;(c===void 0||x.x<c)&&(c=x.x),(d===void 0||x.x>d)&&(d=x.x),(u===void 0||x.y<u)&&(u=x.y),(m===void 0||x.y>m)&&(m=x.y),(h===void 0||x.z<h)&&(h=x.z),(p===void 0||x.z>p)&&(p=x.z)}i.set(c,u,h),a.set(d,m,p)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(t){t===void 0&&(t=new T);const e=this.vertices;for(let i=0;i<e.length;i++)t.vadd(e[i],t);return t.scale(1/e.length,t),t}transformAllPoints(t,e){const i=this.vertices.length,a=this.vertices;if(e){for(let o=0;o<i;o++){const c=a[o];e.vmult(c,c)}for(let o=0;o<this.faceNormals.length;o++){const c=this.faceNormals[o];e.vmult(c,c)}}if(t)for(let o=0;o<i;o++){const c=a[o];c.vadd(t,c)}}pointIsInside(t){const e=this.vertices,i=this.faces,a=this.faceNormals,o=new T;this.getAveragePointLocal(o);for(let c=0;c<this.faces.length;c++){let u=a[c];const h=e[i[c][0]],d=new T;t.vsub(h,d);const m=u.dot(d),p=new T;o.vsub(h,p);const g=u.dot(p);if(m<0&&g>0||m>0&&g<0)return!1}return-1}static project(t,e,i,a,o){const c=t.vertices.length,u=KC;let h=0,d=0;const m=$C,p=t.vertices;m.setZero(),me.vectorToLocalFrame(i,a,e,u),me.pointToLocalFrame(i,a,m,m);const g=m.dot(u);d=h=p[0].dot(u);for(let v=1;v<c;v++){const x=p[v].dot(u);x>h&&(h=x),x<d&&(d=x)}if(d-=g,h-=g,d>h){const v=d;d=h,h=v}o[0]=h,o[1]=d}}const tm=[],em=[];new T;const KC=new T,$C=new T;class gr extends Dt{constructor(t){super({type:Dt.types.BOX}),this.halfExtents=t,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const t=this.halfExtents.x,e=this.halfExtents.y,i=this.halfExtents.z,a=T,o=[new a(-t,-e,-i),new a(t,-e,-i),new a(t,e,-i),new a(-t,e,-i),new a(-t,-e,i),new a(t,-e,i),new a(t,e,i),new a(-t,e,i)],c=[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],u=[new a(0,0,1),new a(0,1,0),new a(1,0,0)],h=new gi({vertices:o,faces:c,axes:u});this.convexPolyhedronRepresentation=h,h.material=this.material}calculateLocalInertia(t,e){return e===void 0&&(e=new T),gr.calculateInertia(this.halfExtents,t,e),e}static calculateInertia(t,e,i){const a=t;i.x=1/12*e*(2*a.y*2*a.y+2*a.z*2*a.z),i.y=1/12*e*(2*a.x*2*a.x+2*a.z*2*a.z),i.z=1/12*e*(2*a.y*2*a.y+2*a.x*2*a.x)}getSideNormals(t,e){const i=t,a=this.halfExtents;if(i[0].set(a.x,0,0),i[1].set(0,a.y,0),i[2].set(0,0,a.z),i[3].set(-a.x,0,0),i[4].set(0,-a.y,0),i[5].set(0,0,-a.z),e!==void 0)for(let o=0;o!==i.length;o++)e.vmult(i[o],i[o]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(t,e,i){const a=this.halfExtents,o=[[a.x,a.y,a.z],[-a.x,a.y,a.z],[-a.x,-a.y,a.z],[-a.x,-a.y,-a.z],[a.x,-a.y,-a.z],[a.x,a.y,-a.z],[-a.x,a.y,-a.z],[a.x,-a.y,a.z]];for(let c=0;c<o.length;c++)fa.set(o[c][0],o[c][1],o[c][2]),e.vmult(fa,fa),t.vadd(fa,fa),i(fa.x,fa.y,fa.z)}calculateWorldAABB(t,e,i,a){const o=this.halfExtents;ki[0].set(o.x,o.y,o.z),ki[1].set(-o.x,o.y,o.z),ki[2].set(-o.x,-o.y,o.z),ki[3].set(-o.x,-o.y,-o.z),ki[4].set(o.x,-o.y,-o.z),ki[5].set(o.x,o.y,-o.z),ki[6].set(-o.x,o.y,-o.z),ki[7].set(o.x,-o.y,o.z);const c=ki[0];e.vmult(c,c),t.vadd(c,c),a.copy(c),i.copy(c);for(let u=1;u<8;u++){const h=ki[u];e.vmult(h,h),t.vadd(h,h);const d=h.x,m=h.y,p=h.z;d>a.x&&(a.x=d),m>a.y&&(a.y=m),p>a.z&&(a.z=p),d<i.x&&(i.x=d),m<i.y&&(i.y=m),p<i.z&&(i.z=p)}}}const fa=new T,ki=[new T,new T,new T,new T,new T,new T,new T,new T],nf={DYNAMIC:1,STATIC:2,KINEMATIC:4},sf={AWAKE:0,SLEEPY:1,SLEEPING:2};class Ut extends sg{constructor(t){t===void 0&&(t={}),super(),this.id=Ut.idCounter++,this.index=-1,this.world=null,this.vlambda=new T,this.collisionFilterGroup=typeof t.collisionFilterGroup=="number"?t.collisionFilterGroup:1,this.collisionFilterMask=typeof t.collisionFilterMask=="number"?t.collisionFilterMask:-1,this.collisionResponse=typeof t.collisionResponse=="boolean"?t.collisionResponse:!0,this.position=new T,this.previousPosition=new T,this.interpolatedPosition=new T,this.initPosition=new T,t.position&&(this.position.copy(t.position),this.previousPosition.copy(t.position),this.interpolatedPosition.copy(t.position),this.initPosition.copy(t.position)),this.velocity=new T,t.velocity&&this.velocity.copy(t.velocity),this.initVelocity=new T,this.force=new T;const e=typeof t.mass=="number"?t.mass:0;this.mass=e,this.invMass=e>0?1/e:0,this.material=t.material||null,this.linearDamping=typeof t.linearDamping=="number"?t.linearDamping:.01,this.type=e<=0?Ut.STATIC:Ut.DYNAMIC,typeof t.type==typeof Ut.STATIC&&(this.type=t.type),this.allowSleep=typeof t.allowSleep<"u"?t.allowSleep:!0,this.sleepState=Ut.AWAKE,this.sleepSpeedLimit=typeof t.sleepSpeedLimit<"u"?t.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof t.sleepTimeLimit<"u"?t.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new T,this.quaternion=new je,this.initQuaternion=new je,this.previousQuaternion=new je,this.interpolatedQuaternion=new je,t.quaternion&&(this.quaternion.copy(t.quaternion),this.initQuaternion.copy(t.quaternion),this.previousQuaternion.copy(t.quaternion),this.interpolatedQuaternion.copy(t.quaternion)),this.angularVelocity=new T,t.angularVelocity&&this.angularVelocity.copy(t.angularVelocity),this.initAngularVelocity=new T,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new T,this.invInertia=new T,this.invInertiaWorld=new pi,this.invMassSolve=0,this.invInertiaSolve=new T,this.invInertiaWorldSolve=new pi,this.fixedRotation=typeof t.fixedRotation<"u"?t.fixedRotation:!1,this.angularDamping=typeof t.angularDamping<"u"?t.angularDamping:.01,this.linearFactor=new T(1,1,1),t.linearFactor&&this.linearFactor.copy(t.linearFactor),this.angularFactor=new T(1,1,1),t.angularFactor&&this.angularFactor.copy(t.angularFactor),this.aabb=new Ie,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new T,this.isTrigger=!!t.isTrigger,t.shape&&this.addShape(t.shape),this.updateMassProperties()}wakeUp(){const t=this.sleepState;this.sleepState=Ut.AWAKE,this.wakeUpAfterNarrowphase=!1,t===Ut.SLEEPING&&this.dispatchEvent(Ut.wakeupEvent)}sleep(){this.sleepState=Ut.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(t){if(this.allowSleep){const e=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),a=this.sleepSpeedLimit**2;e===Ut.AWAKE&&i<a?(this.sleepState=Ut.SLEEPY,this.timeLastSleepy=t,this.dispatchEvent(Ut.sleepyEvent)):e===Ut.SLEEPY&&i>a?this.wakeUp():e===Ut.SLEEPY&&t-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(Ut.sleepEvent))}}updateSolveMassProperties(){this.sleepState===Ut.SLEEPING||this.type===Ut.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(t,e){return e===void 0&&(e=new T),t.vsub(this.position,e),this.quaternion.conjugate().vmult(e,e),e}vectorToLocalFrame(t,e){return e===void 0&&(e=new T),this.quaternion.conjugate().vmult(t,e),e}pointToWorldFrame(t,e){return e===void 0&&(e=new T),this.quaternion.vmult(t,e),e.vadd(this.position,e),e}vectorToWorldFrame(t,e){return e===void 0&&(e=new T),this.quaternion.vmult(t,e),e}addShape(t,e,i){const a=new T,o=new je;return e&&a.copy(e),i&&o.copy(i),this.shapes.push(t),this.shapeOffsets.push(a),this.shapeOrientations.push(o),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,t.body=this,this}removeShape(t){const e=this.shapes.indexOf(t);return e===-1?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(e,1),this.shapeOffsets.splice(e,1),this.shapeOrientations.splice(e,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,t.body=null,this)}updateBoundingRadius(){const t=this.shapes,e=this.shapeOffsets,i=t.length;let a=0;for(let o=0;o!==i;o++){const c=t[o];c.updateBoundingSphereRadius();const u=e[o].length(),h=c.boundingSphereRadius;u+h>a&&(a=u+h)}this.boundingRadius=a}updateAABB(){const t=this.shapes,e=this.shapeOffsets,i=this.shapeOrientations,a=t.length,o=tL,c=eL,u=this.quaternion,h=this.aabb,d=nL;for(let m=0;m!==a;m++){const p=t[m];u.vmult(e[m],o),o.vadd(this.position,o),u.mult(i[m],c),p.calculateWorldAABB(o,c,d.lowerBound,d.upperBound),m===0?h.copy(d):h.extend(d)}this.aabbNeedsUpdate=!1}updateInertiaWorld(t){const e=this.invInertia;if(!(e.x===e.y&&e.y===e.z&&!t)){const i=iL,a=sL;i.setRotationFromQuaternion(this.quaternion),i.transpose(a),i.scale(e,i),i.mmult(a,this.invInertiaWorld)}}applyForce(t,e){if(e===void 0&&(e=new T),this.type!==Ut.DYNAMIC)return;this.sleepState===Ut.SLEEPING&&this.wakeUp();const i=aL;e.cross(t,i),this.force.vadd(t,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(t,e){if(e===void 0&&(e=new T),this.type!==Ut.DYNAMIC)return;const i=rL,a=oL;this.vectorToWorldFrame(t,i),this.vectorToWorldFrame(e,a),this.applyForce(i,a)}applyTorque(t){this.type===Ut.DYNAMIC&&(this.sleepState===Ut.SLEEPING&&this.wakeUp(),this.torque.vadd(t,this.torque))}applyImpulse(t,e){if(e===void 0&&(e=new T),this.type!==Ut.DYNAMIC)return;this.sleepState===Ut.SLEEPING&&this.wakeUp();const i=e,a=lL;a.copy(t),a.scale(this.invMass,a),this.velocity.vadd(a,this.velocity);const o=cL;i.cross(t,o),this.invInertiaWorld.vmult(o,o),this.angularVelocity.vadd(o,this.angularVelocity)}applyLocalImpulse(t,e){if(e===void 0&&(e=new T),this.type!==Ut.DYNAMIC)return;const i=uL,a=hL;this.vectorToWorldFrame(t,i),this.vectorToWorldFrame(e,a),this.applyImpulse(i,a)}updateMassProperties(){const t=fL;this.invMass=this.mass>0?1/this.mass:0;const e=this.inertia,i=this.fixedRotation;this.updateAABB(),t.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),gr.calculateInertia(t,this.mass,e),this.invInertia.set(e.x>0&&!i?1/e.x:0,e.y>0&&!i?1/e.y:0,e.z>0&&!i?1/e.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(t,e){const i=new T;return t.vsub(this.position,i),this.angularVelocity.cross(i,e),this.velocity.vadd(e,e),e}integrate(t,e,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),!(this.type===Ut.DYNAMIC||this.type===Ut.KINEMATIC)||this.sleepState===Ut.SLEEPING)return;const a=this.velocity,o=this.angularVelocity,c=this.position,u=this.force,h=this.torque,d=this.quaternion,m=this.invMass,p=this.invInertiaWorld,g=this.linearFactor,v=m*t;a.x+=u.x*v*g.x,a.y+=u.y*v*g.y,a.z+=u.z*v*g.z;const x=p.elements,M=this.angularFactor,S=h.x*M.x,w=h.y*M.y,_=h.z*M.z;o.x+=t*(x[0]*S+x[1]*w+x[2]*_),o.y+=t*(x[3]*S+x[4]*w+x[5]*_),o.z+=t*(x[6]*S+x[7]*w+x[8]*_),c.x+=a.x*t,c.y+=a.y*t,c.z+=a.z*t,d.integrate(this.angularVelocity,t,this.angularFactor,d),e&&(i?d.normalizeFast():d.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}Ut.idCounter=0;Ut.COLLIDE_EVENT_NAME="collide";Ut.DYNAMIC=nf.DYNAMIC;Ut.STATIC=nf.STATIC;Ut.KINEMATIC=nf.KINEMATIC;Ut.AWAKE=sf.AWAKE;Ut.SLEEPY=sf.SLEEPY;Ut.SLEEPING=sf.SLEEPING;Ut.wakeupEvent={type:"wakeup"};Ut.sleepyEvent={type:"sleepy"};Ut.sleepEvent={type:"sleep"};const tL=new T,eL=new je,nL=new Ie,iL=new pi,sL=new pi;new pi;const aL=new T,rL=new T,oL=new T,lL=new T,cL=new T,uL=new T,hL=new T,fL=new T;class af{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(t,e,i){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(t,e){return!((t.collisionFilterGroup&e.collisionFilterMask)===0||(e.collisionFilterGroup&t.collisionFilterMask)===0||((t.type&Ut.STATIC)!==0||t.sleepState===Ut.SLEEPING)&&((e.type&Ut.STATIC)!==0||e.sleepState===Ut.SLEEPING))}intersectionTest(t,e,i,a){this.useBoundingBoxes?this.doBoundingBoxBroadphase(t,e,i,a):this.doBoundingSphereBroadphase(t,e,i,a)}doBoundingSphereBroadphase(t,e,i,a){const o=dL;e.position.vsub(t.position,o);const c=(t.boundingRadius+e.boundingRadius)**2;o.lengthSquared()<c&&(i.push(t),a.push(e))}doBoundingBoxBroadphase(t,e,i,a){t.aabbNeedsUpdate&&t.updateAABB(),e.aabbNeedsUpdate&&e.updateAABB(),t.aabb.overlaps(e.aabb)&&(i.push(t),a.push(e))}makePairsUnique(t,e){const i=pL,a=mL,o=gL,c=t.length;for(let u=0;u!==c;u++)a[u]=t[u],o[u]=e[u];t.length=0,e.length=0;for(let u=0;u!==c;u++){const h=a[u].id,d=o[u].id,m=h<d?`${h},${d}`:`${d},${h}`;i[m]=u,i.keys.push(m)}for(let u=0;u!==i.keys.length;u++){const h=i.keys.pop(),d=i[h];t.push(a[d]),e.push(o[d]),delete i[h]}}setWorld(t){}static boundingSphereCheck(t,e){const i=new T;t.position.vsub(e.position,i);const a=t.shapes[0],o=e.shapes[0];return Math.pow(a.boundingSphereRadius+o.boundingSphereRadius,2)>i.lengthSquared()}aabbQuery(t,e,i){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}const dL=new T;new T;new je;new T;const pL={keys:[]},mL=[],gL=[];new T;class yL extends af{constructor(t,e,i,a,o){t===void 0&&(t=new T(100,100,100)),e===void 0&&(e=new T(-100,-100,-100)),i===void 0&&(i=10),a===void 0&&(a=10),o===void 0&&(o=10),super(),this.nx=i,this.ny=a,this.nz=o,this.aabbMin=t,this.aabbMax=e;const c=this.nx*this.ny*this.nz;if(c<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=c,this.binLengths.length=c;for(let u=0;u<c;u++)this.bins[u]=[],this.binLengths[u]=0}collisionPairs(t,e,i){const a=t.bodies.length,o=t.bodies,c=this.aabbMax,u=this.aabbMin,h=this.nx,d=this.ny,m=this.nz,p=d*m,g=m,v=1,x=c.x,M=c.y,S=c.z,w=u.x,_=u.y,L=u.z,R=h/(x-w),C=d/(M-_),A=m/(S-L),B=(x-w)/h,Y=(M-_)/d,X=(S-L)/m,st=Math.sqrt(B*B+Y*Y+X*X)*.5,V=Dt.types,j=V.SPHERE,I=V.PLANE;V.BOX,V.COMPOUND,V.CONVEXPOLYHEDRON;const H=this.bins,U=this.binLengths,z=this.bins.length;for(let it=0;it!==z;it++)U[it]=0;const Q=Math.ceil;function $(it,ct,D,q,ut,yt,tt){let Ct=(it-w)*R|0,bt=(ct-_)*C|0,Ht=(D-L)*A|0,Lt=Q((q-w)*R),Qt=Q((ut-_)*C),kt=Q((yt-L)*A);Ct<0?Ct=0:Ct>=h&&(Ct=h-1),bt<0?bt=0:bt>=d&&(bt=d-1),Ht<0?Ht=0:Ht>=m&&(Ht=m-1),Lt<0?Lt=0:Lt>=h&&(Lt=h-1),Qt<0?Qt=0:Qt>=d&&(Qt=d-1),kt<0?kt=0:kt>=m&&(kt=m-1),Ct*=p,bt*=g,Ht*=v,Lt*=p,Qt*=g,kt*=v;for(let vt=Ct;vt<=Lt;vt+=p)for(let Et=bt;Et<=Qt;Et+=g)for(let wt=Ht;wt<=kt;wt+=v){const Ft=vt+Et+wt;H[Ft][U[Ft]++]=tt}}for(let it=0;it!==a;it++){const ct=o[it],D=ct.shapes[0];switch(D.type){case j:{const q=D,ut=ct.position.x,yt=ct.position.y,tt=ct.position.z,Ct=q.radius;$(ut-Ct,yt-Ct,tt-Ct,ut+Ct,yt+Ct,tt+Ct,ct);break}case I:{const q=D;q.worldNormalNeedsUpdate&&q.computeWorldNormal(ct.quaternion);const ut=q.worldNormal,yt=w+B*.5-ct.position.x,tt=_+Y*.5-ct.position.y,Ct=L+X*.5-ct.position.z,bt=vL;bt.set(yt,tt,Ct);for(let Ht=0,Lt=0;Ht!==h;Ht++,Lt+=p,bt.y=tt,bt.x+=B)for(let Qt=0,kt=0;Qt!==d;Qt++,kt+=g,bt.z=Ct,bt.y+=Y)for(let vt=0,Et=0;vt!==m;vt++,Et+=v,bt.z+=X)if(bt.dot(ut)<st){const wt=Lt+kt+Et;H[wt][U[wt]++]=ct}break}default:{ct.aabbNeedsUpdate&&ct.updateAABB(),$(ct.aabb.lowerBound.x,ct.aabb.lowerBound.y,ct.aabb.lowerBound.z,ct.aabb.upperBound.x,ct.aabb.upperBound.y,ct.aabb.upperBound.z,ct);break}}}for(let it=0;it!==z;it++){const ct=U[it];if(ct>1){const D=H[it];for(let q=0;q!==ct;q++){const ut=D[q];for(let yt=0;yt!==q;yt++){const tt=D[yt];this.needBroadphaseCollision(ut,tt)&&this.intersectionTest(ut,tt,e,i)}}}}this.makePairsUnique(e,i)}}const vL=new T;new T;class ag extends af{constructor(){super()}collisionPairs(t,e,i){const a=t.bodies,o=a.length;let c,u;for(let h=0;h!==o;h++)for(let d=0;d!==h;d++)c=a[h],u=a[d],this.needBroadphaseCollision(c,u)&&this.intersectionTest(c,u,e,i)}aabbQuery(t,e,i){i===void 0&&(i=[]);for(let a=0;a<t.bodies.length;a++){const o=t.bodies[a];o.aabbNeedsUpdate&&o.updateAABB(),o.aabb.overlaps(e)&&i.push(o)}return i}}class jo{constructor(){this.rayFromWorld=new T,this.rayToWorld=new T,this.hitNormalWorld=new T,this.hitPointWorld=new T,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(t,e,i,a,o,c,u){this.rayFromWorld.copy(t),this.rayToWorld.copy(e),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(a),this.shape=o,this.body=c,this.distance=u}}let e1,n1,i1,s1,a1,r1,o1;const rf={CLOSEST:1,ANY:2,ALL:4};e1=Dt.types.SPHERE;n1=Dt.types.PLANE;i1=Dt.types.BOX;s1=Dt.types.CYLINDER;a1=Dt.types.CONVEXPOLYHEDRON;r1=Dt.types.HEIGHTFIELD;o1=Dt.types.TRIMESH;class tn{get[e1](){return this._intersectSphere}get[n1](){return this._intersectPlane}get[i1](){return this._intersectBox}get[s1](){return this._intersectConvex}get[a1](){return this._intersectConvex}get[r1](){return this._intersectHeightfield}get[o1](){return this._intersectTrimesh}constructor(t,e){t===void 0&&(t=new T),e===void 0&&(e=new T),this.from=t.clone(),this.to=e.clone(),this.direction=new T,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=tn.ANY,this.result=new jo,this.hasHit=!1,this.callback=i=>{}}intersectWorld(t,e){return this.mode=e.mode||tn.ANY,this.result=e.result||new jo,this.skipBackfaces=!!e.skipBackfaces,this.collisionFilterMask=typeof e.collisionFilterMask<"u"?e.collisionFilterMask:-1,this.collisionFilterGroup=typeof e.collisionFilterGroup<"u"?e.collisionFilterGroup:-1,this.checkCollisionResponse=typeof e.checkCollisionResponse<"u"?e.checkCollisionResponse:!0,e.from&&this.from.copy(e.from),e.to&&this.to.copy(e.to),this.callback=e.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(Zb),nm.length=0,t.broadphase.aabbQuery(t,Zb,nm),this.intersectBodies(nm),this.hasHit}intersectBody(t,e){e&&(this.result=e,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!t.collisionResponse||(this.collisionFilterGroup&t.collisionFilterMask)===0||(t.collisionFilterGroup&this.collisionFilterMask)===0)return;const a=xL,o=bL;for(let c=0,u=t.shapes.length;c<u;c++){const h=t.shapes[c];if(!(i&&!h.collisionResponse)&&(t.quaternion.mult(t.shapeOrientations[c],o),t.quaternion.vmult(t.shapeOffsets[c],a),a.vadd(t.position,a),this.intersectShape(h,o,a,t),this.result.shouldStop))break}}intersectBodies(t,e){e&&(this.result=e,this.updateDirection());for(let i=0,a=t.length;!this.result.shouldStop&&i<a;i++)this.intersectBody(t[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(t,e,i,a){const o=this.from;if(DL(o,this.direction,i)>t.boundingSphereRadius)return;const u=this[t.type];u&&u.call(this,t,e,i,a,t)}_intersectBox(t,e,i,a,o){return this._intersectConvex(t.convexPolyhedronRepresentation,e,i,a,o)}_intersectPlane(t,e,i,a,o){const c=this.from,u=this.to,h=this.direction,d=new T(0,0,1);e.vmult(d,d);const m=new T;c.vsub(i,m);const p=m.dot(d);u.vsub(i,m);const g=m.dot(d);if(p*g>0||c.distanceTo(u)<p)return;const v=d.dot(h);if(Math.abs(v)<this.precision)return;const x=new T,M=new T,S=new T;c.vsub(i,x);const w=-d.dot(x)/v;h.scale(w,M),c.vadd(M,S),this.reportIntersection(d,S,o,a,-1)}getAABB(t){const{lowerBound:e,upperBound:i}=t,a=this.to,o=this.from;e.x=Math.min(a.x,o.x),e.y=Math.min(a.y,o.y),e.z=Math.min(a.z,o.z),i.x=Math.max(a.x,o.x),i.y=Math.max(a.y,o.y),i.z=Math.max(a.z,o.z)}_intersectHeightfield(t,e,i,a,o){t.data,t.elementSize;const c=_L;c.from.copy(this.from),c.to.copy(this.to),me.pointToLocalFrame(i,e,c.from,c.from),me.pointToLocalFrame(i,e,c.to,c.to),c.updateDirection();const u=wL;let h,d,m,p;h=d=0,m=p=t.data.length-1;const g=new Ie;c.getAABB(g),t.getIndexOfPosition(g.lowerBound.x,g.lowerBound.y,u,!0),h=Math.max(h,u[0]),d=Math.max(d,u[1]),t.getIndexOfPosition(g.upperBound.x,g.upperBound.y,u,!0),m=Math.min(m,u[0]+1),p=Math.min(p,u[1]+1);for(let v=h;v<m;v++)for(let x=d;x<p;x++){if(this.result.shouldStop)return;if(t.getAabbAtIndex(v,x,g),!!g.overlapsRay(c)){if(t.getConvexTrianglePillar(v,x,!1),me.pointToWorldFrame(i,e,t.pillarOffset,Mh),this._intersectConvex(t.pillarConvex,e,Mh,a,o,Qb),this.result.shouldStop)return;t.getConvexTrianglePillar(v,x,!0),me.pointToWorldFrame(i,e,t.pillarOffset,Mh),this._intersectConvex(t.pillarConvex,e,Mh,a,o,Qb)}}}_intersectSphere(t,e,i,a,o){const c=this.from,u=this.to,h=t.radius,d=(u.x-c.x)**2+(u.y-c.y)**2+(u.z-c.z)**2,m=2*((u.x-c.x)*(c.x-i.x)+(u.y-c.y)*(c.y-i.y)+(u.z-c.z)*(c.z-i.z)),p=(c.x-i.x)**2+(c.y-i.y)**2+(c.z-i.z)**2-h**2,g=m**2-4*d*p,v=ML,x=SL;if(!(g<0))if(g===0)c.lerp(u,g,v),v.vsub(i,x),x.normalize(),this.reportIntersection(x,v,o,a,-1);else{const M=(-m-Math.sqrt(g))/(2*d),S=(-m+Math.sqrt(g))/(2*d);if(M>=0&&M<=1&&(c.lerp(u,M,v),v.vsub(i,x),x.normalize(),this.reportIntersection(x,v,o,a,-1)),this.result.shouldStop)return;S>=0&&S<=1&&(c.lerp(u,S,v),v.vsub(i,x),x.normalize(),this.reportIntersection(x,v,o,a,-1))}}_intersectConvex(t,e,i,a,o,c){const u=EL,h=Jb,d=c&&c.faceList||null,m=t.faces,p=t.vertices,g=t.faceNormals,v=this.direction,x=this.from,M=this.to,S=x.distanceTo(M),w=d?d.length:m.length,_=this.result;for(let L=0;!_.shouldStop&&L<w;L++){const R=d?d[L]:L,C=m[R],A=g[R],B=e,Y=i;h.copy(p[C[0]]),B.vmult(h,h),h.vadd(Y,h),h.vsub(x,h),B.vmult(A,u);const X=v.dot(u);if(Math.abs(X)<this.precision)continue;const st=u.dot(h)/X;if(!(st<0)){v.scale(st,Fn),Fn.vadd(x,Fn),Ri.copy(p[C[0]]),B.vmult(Ri,Ri),Y.vadd(Ri,Ri);for(let V=1;!_.shouldStop&&V<C.length-1;V++){Wi.copy(p[C[V]]),ji.copy(p[C[V+1]]),B.vmult(Wi,Wi),B.vmult(ji,ji),Y.vadd(Wi,Wi),Y.vadd(ji,ji);const j=Fn.distanceTo(x);!(tn.pointInTriangle(Fn,Ri,Wi,ji)||tn.pointInTriangle(Fn,Wi,Ri,ji))||j>S||this.reportIntersection(u,Fn,o,a,R)}}}}_intersectTrimesh(t,e,i,a,o,c){const u=TL,h=zL,d=BL,m=Jb,p=AL,g=CL,v=LL,x=NL,M=RL,S=t.indices;t.vertices;const w=this.from,_=this.to,L=this.direction;d.position.copy(i),d.quaternion.copy(e),me.vectorToLocalFrame(i,e,L,p),me.pointToLocalFrame(i,e,w,g),me.pointToLocalFrame(i,e,_,v),v.x*=t.scale.x,v.y*=t.scale.y,v.z*=t.scale.z,g.x*=t.scale.x,g.y*=t.scale.y,g.z*=t.scale.z,v.vsub(g,p),p.normalize();const R=g.distanceSquared(v);t.tree.rayQuery(this,d,h);for(let C=0,A=h.length;!this.result.shouldStop&&C!==A;C++){const B=h[C];t.getNormal(B,u),t.getVertex(S[B*3],Ri),Ri.vsub(g,m);const Y=p.dot(u),X=u.dot(m)/Y;if(X<0)continue;p.scale(X,Fn),Fn.vadd(g,Fn),t.getVertex(S[B*3+1],Wi),t.getVertex(S[B*3+2],ji);const st=Fn.distanceSquared(g);!(tn.pointInTriangle(Fn,Wi,Ri,ji)||tn.pointInTriangle(Fn,Ri,Wi,ji))||st>R||(me.vectorToWorldFrame(e,u,M),me.pointToWorldFrame(i,e,Fn,x),this.reportIntersection(M,x,o,a,B))}h.length=0}reportIntersection(t,e,i,a,o){const c=this.from,u=this.to,h=c.distanceTo(e),d=this.result;if(!(this.skipBackfaces&&t.dot(this.direction)>0))switch(d.hitFaceIndex=typeof o<"u"?o:-1,this.mode){case tn.ALL:this.hasHit=!0,d.set(c,u,t,e,i,a,h),d.hasHit=!0,this.callback(d);break;case tn.CLOSEST:(h<d.distance||!d.hasHit)&&(this.hasHit=!0,d.hasHit=!0,d.set(c,u,t,e,i,a,h));break;case tn.ANY:this.hasHit=!0,d.hasHit=!0,d.set(c,u,t,e,i,a,h),d.shouldStop=!0;break}}static pointInTriangle(t,e,i,a){a.vsub(e,ir),i.vsub(e,Kl),t.vsub(e,im);const o=ir.dot(ir),c=ir.dot(Kl),u=ir.dot(im),h=Kl.dot(Kl),d=Kl.dot(im);let m,p;return(m=h*u-c*d)>=0&&(p=o*d-c*u)>=0&&m+p<o*h-c*c}}tn.CLOSEST=rf.CLOSEST;tn.ANY=rf.ANY;tn.ALL=rf.ALL;const Zb=new Ie,nm=[],Kl=new T,im=new T,xL=new T,bL=new je,Fn=new T,Ri=new T,Wi=new T,ji=new T;new T;new jo;const Qb={faceList:[0]},Mh=new T,_L=new tn,wL=[],ML=new T,SL=new T,EL=new T;new T;new T;const Jb=new T,TL=new T,AL=new T,CL=new T,LL=new T,RL=new T,NL=new T;new Ie;const zL=[],BL=new me,ir=new T,Sh=new T;function DL(n,t,e){e.vsub(n,ir);const i=ir.dot(t);return t.scale(i,Sh),Sh.vadd(n,Sh),e.distanceTo(Sh)}class Ao extends af{static checkBounds(t,e,i){let a,o;i===0?(a=t.position.x,o=e.position.x):i===1?(a=t.position.y,o=e.position.y):i===2&&(a=t.position.z,o=e.position.z);const c=t.boundingRadius,u=e.boundingRadius,h=a+c;return o-u<h}static insertionSortX(t){for(let e=1,i=t.length;e<i;e++){const a=t[e];let o;for(o=e-1;o>=0&&!(t[o].aabb.lowerBound.x<=a.aabb.lowerBound.x);o--)t[o+1]=t[o];t[o+1]=a}return t}static insertionSortY(t){for(let e=1,i=t.length;e<i;e++){const a=t[e];let o;for(o=e-1;o>=0&&!(t[o].aabb.lowerBound.y<=a.aabb.lowerBound.y);o--)t[o+1]=t[o];t[o+1]=a}return t}static insertionSortZ(t){for(let e=1,i=t.length;e<i;e++){const a=t[e];let o;for(o=e-1;o>=0&&!(t[o].aabb.lowerBound.z<=a.aabb.lowerBound.z);o--)t[o+1]=t[o];t[o+1]=a}return t}constructor(t){super(),this.axisList=[],this.world=null,this.axisIndex=0;const e=this.axisList;this._addBodyHandler=i=>{e.push(i.body)},this._removeBodyHandler=i=>{const a=e.indexOf(i.body);a!==-1&&e.splice(a,1)},t&&this.setWorld(t)}setWorld(t){this.axisList.length=0;for(let e=0;e<t.bodies.length;e++)this.axisList.push(t.bodies[e]);t.removeEventListener("addBody",this._addBodyHandler),t.removeEventListener("removeBody",this._removeBodyHandler),t.addEventListener("addBody",this._addBodyHandler),t.addEventListener("removeBody",this._removeBodyHandler),this.world=t,this.dirty=!0}collisionPairs(t,e,i){const a=this.axisList,o=a.length,c=this.axisIndex;let u,h;for(this.dirty&&(this.sortList(),this.dirty=!1),u=0;u!==o;u++){const d=a[u];for(h=u+1;h<o;h++){const m=a[h];if(this.needBroadphaseCollision(d,m)){if(!Ao.checkBounds(d,m,c))break;this.intersectionTest(d,m,e,i)}}}}sortList(){const t=this.axisList,e=this.axisIndex,i=t.length;for(let a=0;a!==i;a++){const o=t[a];o.aabbNeedsUpdate&&o.updateAABB()}e===0?Ao.insertionSortX(t):e===1?Ao.insertionSortY(t):e===2&&Ao.insertionSortZ(t)}autoDetectAxis(){let t=0,e=0,i=0,a=0,o=0,c=0;const u=this.axisList,h=u.length,d=1/h;for(let v=0;v!==h;v++){const x=u[v],M=x.position.x;t+=M,e+=M*M;const S=x.position.y;i+=S,a+=S*S;const w=x.position.z;o+=w,c+=w*w}const m=e-t*t*d,p=a-i*i*d,g=c-o*o*d;m>p?m>g?this.axisIndex=0:this.axisIndex=2:p>g?this.axisIndex=1:this.axisIndex=2}aabbQuery(t,e,i){i===void 0&&(i=[]),this.dirty&&(this.sortList(),this.dirty=!1);const a=this.axisIndex;let o="x";a===1&&(o="y"),a===2&&(o="z");const c=this.axisList;e.lowerBound[o],e.upperBound[o];for(let u=0;u<c.length;u++){const h=c[u];h.aabbNeedsUpdate&&h.updateAABB(),h.aabb.overlaps(e)&&i.push(h)}return i}}class of{static defaults(t,e){t===void 0&&(t={});for(let i in e)i in t||(t[i]=e[i]);return t}}class Zo{constructor(t,e,i){i===void 0&&(i={}),i=of.defaults(i,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.id=Zo.idCounter++,this.collideConnected=i.collideConnected,i.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}update(){throw new Error("method update() not implmemented in this Constraint subclass!")}enable(){const t=this.equations;for(let e=0;e<t.length;e++)t[e].enabled=!0}disable(){const t=this.equations;for(let e=0;e<t.length;e++)t[e].enabled=!1}}Zo.idCounter=0;class Vm{constructor(){this.spatial=new T,this.rotational=new T}multiplyElement(t){return t.spatial.dot(this.spatial)+t.rotational.dot(this.rotational)}multiplyVectors(t,e){return t.dot(this.spatial)+e.dot(this.rotational)}}class Ds{constructor(t,e,i,a){i===void 0&&(i=-1e6),a===void 0&&(a=1e6),this.id=Ds.idCounter++,this.minForce=i,this.maxForce=a,this.bi=t,this.bj=e,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new Vm,this.jacobianElementB=new Vm,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(t,e,i){const a=e,o=t,c=i;this.a=4/(c*(1+4*a)),this.b=4*a/(1+4*a),this.eps=4/(c*c*o*(1+4*a))}computeB(t,e,i){const a=this.computeGW(),o=this.computeGq(),c=this.computeGiMf();return-o*t-a*e-c*i}computeGq(){const t=this.jacobianElementA,e=this.jacobianElementB,i=this.bi,a=this.bj,o=i.position,c=a.position;return t.spatial.dot(o)+e.spatial.dot(c)}computeGW(){const t=this.jacobianElementA,e=this.jacobianElementB,i=this.bi,a=this.bj,o=i.velocity,c=a.velocity,u=i.angularVelocity,h=a.angularVelocity;return t.multiplyVectors(o,u)+e.multiplyVectors(c,h)}computeGWlambda(){const t=this.jacobianElementA,e=this.jacobianElementB,i=this.bi,a=this.bj,o=i.vlambda,c=a.vlambda,u=i.wlambda,h=a.wlambda;return t.multiplyVectors(o,u)+e.multiplyVectors(c,h)}computeGiMf(){const t=this.jacobianElementA,e=this.jacobianElementB,i=this.bi,a=this.bj,o=i.force,c=i.torque,u=a.force,h=a.torque,d=i.invMassSolve,m=a.invMassSolve;return o.scale(d,Kb),u.scale(m,$b),i.invInertiaWorldSolve.vmult(c,t_),a.invInertiaWorldSolve.vmult(h,e_),t.multiplyVectors(Kb,t_)+e.multiplyVectors($b,e_)}computeGiMGt(){const t=this.jacobianElementA,e=this.jacobianElementB,i=this.bi,a=this.bj,o=i.invMassSolve,c=a.invMassSolve,u=i.invInertiaWorldSolve,h=a.invInertiaWorldSolve;let d=o+c;return u.vmult(t.rotational,Eh),d+=Eh.dot(t.rotational),h.vmult(e.rotational,Eh),d+=Eh.dot(e.rotational),d}addToWlambda(t){const e=this.jacobianElementA,i=this.jacobianElementB,a=this.bi,o=this.bj,c=OL;a.vlambda.addScaledVector(a.invMassSolve*t,e.spatial,a.vlambda),o.vlambda.addScaledVector(o.invMassSolve*t,i.spatial,o.vlambda),a.invInertiaWorldSolve.vmult(e.rotational,c),a.wlambda.addScaledVector(t,c,a.wlambda),o.invInertiaWorldSolve.vmult(i.rotational,c),o.wlambda.addScaledVector(t,c,o.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}Ds.idCounter=0;const Kb=new T,$b=new T,t_=new T,e_=new T,Eh=new T,OL=new T;class No extends Ds{constructor(t,e,i){i===void 0&&(i=1e6),super(t,e,0,i),this.restitution=0,this.ri=new T,this.rj=new T,this.ni=new T}computeB(t){const e=this.a,i=this.b,a=this.bi,o=this.bj,c=this.ri,u=this.rj,h=PL,d=UL,m=a.velocity,p=a.angularVelocity;a.force,a.torque;const g=o.velocity,v=o.angularVelocity;o.force,o.torque;const x=IL,M=this.jacobianElementA,S=this.jacobianElementB,w=this.ni;c.cross(w,h),u.cross(w,d),w.negate(M.spatial),h.negate(M.rotational),S.spatial.copy(w),S.rotational.copy(d),x.copy(o.position),x.vadd(u,x),x.vsub(a.position,x),x.vsub(c,x);const _=w.dot(x),L=this.restitution+1,R=L*g.dot(w)-L*m.dot(w)+v.dot(d)-p.dot(h),C=this.computeGiMf();return-_*e-R*i-t*C}getImpactVelocityAlongNormal(){const t=FL,e=HL,i=GL,a=VL,o=kL;return this.bi.position.vadd(this.ri,i),this.bj.position.vadd(this.rj,a),this.bi.getVelocityAtWorldPoint(i,t),this.bj.getVelocityAtWorldPoint(a,e),t.vsub(e,o),this.ni.dot(o)}}const PL=new T,UL=new T,IL=new T,FL=new T,HL=new T,GL=new T,VL=new T,kL=new T;class lf extends Zo{constructor(t,e,i,a,o){e===void 0&&(e=new T),a===void 0&&(a=new T),o===void 0&&(o=1e6),super(t,i),this.pivotA=e.clone(),this.pivotB=a.clone();const c=this.equationX=new No(t,i),u=this.equationY=new No(t,i),h=this.equationZ=new No(t,i);this.equations.push(c,u,h),c.minForce=u.minForce=h.minForce=-o,c.maxForce=u.maxForce=h.maxForce=o,c.ni.set(1,0,0),u.ni.set(0,1,0),h.ni.set(0,0,1)}update(){const t=this.bodyA,e=this.bodyB,i=this.equationX,a=this.equationY,o=this.equationZ;t.quaternion.vmult(this.pivotA,i.ri),e.quaternion.vmult(this.pivotB,i.rj),a.ri.copy(i.ri),a.rj.copy(i.rj),o.ri.copy(i.ri),o.rj.copy(i.rj)}}class WL extends Ds{constructor(t,e,i){i===void 0&&(i={});const a=typeof i.maxForce<"u"?i.maxForce:1e6;super(t,e,-a,a),this.axisA=i.axisA?i.axisA.clone():new T(1,0,0),this.axisB=i.axisB?i.axisB.clone():new T(0,1,0),this.angle=typeof i.angle<"u"?i.angle:0}computeB(t){const e=this.a,i=this.b,a=this.axisA,o=this.axisB,c=jL,u=qL,h=this.jacobianElementA,d=this.jacobianElementB;a.cross(o,c),o.cross(a,u),h.rotational.copy(u),d.rotational.copy(c);const m=Math.cos(this.angle)-a.dot(o),p=this.computeGW(),g=this.computeGiMf();return-m*e-p*i-t*g}}const jL=new T,qL=new T;class ar extends Ds{constructor(t,e,i){i===void 0&&(i={});const a=typeof i.maxForce<"u"?i.maxForce:1e6;super(t,e,-a,a),this.axisA=i.axisA?i.axisA.clone():new T(1,0,0),this.axisB=i.axisB?i.axisB.clone():new T(0,1,0),this.maxAngle=Math.PI/2}computeB(t){const e=this.a,i=this.b,a=this.axisA,o=this.axisB,c=YL,u=XL,h=this.jacobianElementA,d=this.jacobianElementB;a.cross(o,c),o.cross(a,u),h.rotational.copy(u),d.rotational.copy(c);const m=Math.cos(this.maxAngle)-a.dot(o),p=this.computeGW(),g=this.computeGiMf();return-m*e-p*i-t*g}}const YL=new T,XL=new T;class ZL extends lf{constructor(t,e,i){i===void 0&&(i={});const a=typeof i.maxForce<"u"?i.maxForce:1e6,o=i.pivotA?i.pivotA.clone():new T,c=i.pivotB?i.pivotB.clone():new T;super(t,o,e,c,a),this.axisA=i.axisA?i.axisA.clone():new T,this.axisB=i.axisB?i.axisB.clone():new T,this.collideConnected=!!i.collideConnected,this.angle=typeof i.angle<"u"?i.angle:0;const u=this.coneEquation=new WL(t,e,i),h=this.twistEquation=new ar(t,e,i);this.twistAngle=typeof i.twistAngle<"u"?i.twistAngle:0,u.maxForce=0,u.minForce=-a,h.maxForce=0,h.minForce=-a,this.equations.push(u,h)}update(){const t=this.bodyA,e=this.bodyB,i=this.coneEquation,a=this.twistEquation;super.update(),t.vectorToWorldFrame(this.axisA,i.axisA),e.vectorToWorldFrame(this.axisB,i.axisB),this.axisA.tangents(a.axisA,a.axisA),t.vectorToWorldFrame(a.axisA,a.axisA),this.axisB.tangents(a.axisB,a.axisB),e.vectorToWorldFrame(a.axisB,a.axisB),i.angle=this.angle,a.maxAngle=this.twistAngle}}new T;new T;class QL extends Zo{constructor(t,e,i,a){a===void 0&&(a=1e6),super(t,e),typeof i>"u"&&(i=t.position.distanceTo(e.position)),this.distance=i;const o=this.distanceEquation=new No(t,e);this.equations.push(o),o.minForce=-a,o.maxForce=a}update(){const t=this.bodyA,e=this.bodyB,i=this.distanceEquation,a=this.distance*.5,o=i.ni;e.position.vsub(t.position,o),o.normalize(),o.scale(a,i.ri),o.scale(-a,i.rj)}}class JL extends lf{constructor(t,e,i){i===void 0&&(i={});const a=typeof i.maxForce<"u"?i.maxForce:1e6,o=new T,c=new T,u=new T;t.position.vadd(e.position,u),u.scale(.5,u),e.pointToLocalFrame(u,c),t.pointToLocalFrame(u,o),super(t,o,e,c,a),this.xA=t.vectorToLocalFrame(T.UNIT_X),this.xB=e.vectorToLocalFrame(T.UNIT_X),this.yA=t.vectorToLocalFrame(T.UNIT_Y),this.yB=e.vectorToLocalFrame(T.UNIT_Y),this.zA=t.vectorToLocalFrame(T.UNIT_Z),this.zB=e.vectorToLocalFrame(T.UNIT_Z);const h=this.rotationalEquation1=new ar(t,e,i),d=this.rotationalEquation2=new ar(t,e,i),m=this.rotationalEquation3=new ar(t,e,i);this.equations.push(h,d,m)}update(){const t=this.bodyA,e=this.bodyB;this.motorEquation;const i=this.rotationalEquation1,a=this.rotationalEquation2,o=this.rotationalEquation3;super.update(),t.vectorToWorldFrame(this.xA,i.axisA),e.vectorToWorldFrame(this.yB,i.axisB),t.vectorToWorldFrame(this.yA,a.axisA),e.vectorToWorldFrame(this.zB,a.axisB),t.vectorToWorldFrame(this.zA,o.axisA),e.vectorToWorldFrame(this.xB,o.axisB)}}new T;new T;class l1 extends Ds{constructor(t,e,i){i===void 0&&(i=1e6),super(t,e,-i,i),this.axisA=new T,this.axisB=new T,this.targetVelocity=0}computeB(t){this.a;const e=this.b;this.bi,this.bj;const i=this.axisA,a=this.axisB,o=this.jacobianElementA,c=this.jacobianElementB;o.rotational.copy(i),a.negate(c.rotational);const u=this.computeGW()-this.targetVelocity,h=this.computeGiMf();return-u*e-t*h}}class c1 extends lf{constructor(t,e,i){i===void 0&&(i={});const a=typeof i.maxForce<"u"?i.maxForce:1e6,o=i.pivotA?i.pivotA.clone():new T,c=i.pivotB?i.pivotB.clone():new T;super(t,o,e,c,a),(this.axisA=i.axisA?i.axisA.clone():new T(1,0,0)).normalize(),(this.axisB=i.axisB?i.axisB.clone():new T(1,0,0)).normalize(),this.collideConnected=!!i.collideConnected;const d=this.rotationalEquation1=new ar(t,e,i),m=this.rotationalEquation2=new ar(t,e,i),p=this.motorEquation=new l1(t,e,a);p.enabled=!1,this.equations.push(d,m,p)}enableMotor(){this.motorEquation.enabled=!0}disableMotor(){this.motorEquation.enabled=!1}setMotorSpeed(t){this.motorEquation.targetVelocity=t}setMotorMaxForce(t){this.motorEquation.maxForce=t,this.motorEquation.minForce=-t}update(){const t=this.bodyA,e=this.bodyB,i=this.motorEquation,a=this.rotationalEquation1,o=this.rotationalEquation2,c=KL,u=$L,h=this.axisA,d=this.axisB;super.update(),t.quaternion.vmult(h,c),e.quaternion.vmult(d,u),c.tangents(a.axisA,o.axisA),a.axisB.copy(u),o.axisB.copy(u),this.motorEquation.enabled&&(t.quaternion.vmult(this.axisA,i.axisA),e.quaternion.vmult(this.axisB,i.axisB))}}const KL=new T,$L=new T;class km extends Ds{constructor(t,e,i){super(t,e,-i,i),this.ri=new T,this.rj=new T,this.t=new T}computeB(t){this.a;const e=this.b;this.bi,this.bj;const i=this.ri,a=this.rj,o=tR,c=eR,u=this.t;i.cross(u,o),a.cross(u,c);const h=this.jacobianElementA,d=this.jacobianElementB;u.negate(h.spatial),o.negate(h.rotational),d.spatial.copy(u),d.rotational.copy(c);const m=this.computeGW(),p=this.computeGiMf();return-m*e-t*p}}const tR=new T,eR=new T;class Qo{constructor(t,e,i){i=of.defaults(i,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=Qo.idCounter++,this.materials=[t,e],this.friction=i.friction,this.restitution=i.restitution,this.contactEquationStiffness=i.contactEquationStiffness,this.contactEquationRelaxation=i.contactEquationRelaxation,this.frictionEquationStiffness=i.frictionEquationStiffness,this.frictionEquationRelaxation=i.frictionEquationRelaxation}}Qo.idCounter=0;class pr{constructor(t){t===void 0&&(t={});let e="";typeof t=="string"&&(e=t,t={}),this.name=e,this.id=pr.idCounter++,this.friction=typeof t.friction<"u"?t.friction:-1,this.restitution=typeof t.restitution<"u"?t.restitution:-1}}pr.idCounter=0;class nR{constructor(t,e,i){i===void 0&&(i={}),this.restLength=typeof i.restLength=="number"?i.restLength:1,this.stiffness=i.stiffness||100,this.damping=i.damping||1,this.bodyA=t,this.bodyB=e,this.localAnchorA=new T,this.localAnchorB=new T,i.localAnchorA&&this.localAnchorA.copy(i.localAnchorA),i.localAnchorB&&this.localAnchorB.copy(i.localAnchorB),i.worldAnchorA&&this.setWorldAnchorA(i.worldAnchorA),i.worldAnchorB&&this.setWorldAnchorB(i.worldAnchorB)}setWorldAnchorA(t){this.bodyA.pointToLocalFrame(t,this.localAnchorA)}setWorldAnchorB(t){this.bodyB.pointToLocalFrame(t,this.localAnchorB)}getWorldAnchorA(t){this.bodyA.pointToWorldFrame(this.localAnchorA,t)}getWorldAnchorB(t){this.bodyB.pointToWorldFrame(this.localAnchorB,t)}applyForce(){const t=this.stiffness,e=this.damping,i=this.restLength,a=this.bodyA,o=this.bodyB,c=iR,u=sR,h=aR,d=rR,m=dR,p=oR,g=lR,v=cR,x=uR,M=hR,S=fR;this.getWorldAnchorA(p),this.getWorldAnchorB(g),p.vsub(a.position,v),g.vsub(o.position,x),g.vsub(p,c);const w=c.length();u.copy(c),u.normalize(),o.velocity.vsub(a.velocity,h),o.angularVelocity.cross(x,m),h.vadd(m,h),a.angularVelocity.cross(v,m),h.vsub(m,h),u.scale(-t*(w-i)-e*h.dot(u),d),a.force.vsub(d,a.force),o.force.vadd(d,o.force),v.cross(d,M),x.cross(d,S),a.torque.vsub(M,a.torque),o.torque.vadd(S,o.torque)}}const iR=new T,sR=new T,aR=new T,rR=new T,oR=new T,lR=new T,cR=new T,uR=new T,hR=new T,fR=new T,dR=new T;class u1{constructor(t){t===void 0&&(t={}),t=of.defaults(t,{chassisConnectionPointLocal:new T,chassisConnectionPointWorld:new T,directionLocal:new T,directionWorld:new T,axleLocal:new T,axleWorld:new T,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:10.5,forwardAcceleration:1,sideAcceleration:1,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,slipInfo:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=t.maxSuspensionTravel,this.customSlidingRotationalSpeed=t.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=t.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=t.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=t.chassisConnectionPointWorld.clone(),this.directionLocal=t.directionLocal.clone(),this.directionWorld=t.directionWorld.clone(),this.axleLocal=t.axleLocal.clone(),this.axleWorld=t.axleWorld.clone(),this.suspensionRestLength=t.suspensionRestLength,this.suspensionMaxLength=t.suspensionMaxLength,this.radius=t.radius,this.suspensionStiffness=t.suspensionStiffness,this.dampingCompression=t.dampingCompression,this.dampingRelaxation=t.dampingRelaxation,this.frictionSlip=t.frictionSlip,this.forwardAcceleration=t.forwardAcceleration,this.sideAcceleration=t.sideAcceleration,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=t.rollInfluence,this.maxSuspensionForce=t.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=t.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.slipInfo=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new jo,this.worldTransform=new me,this.isInContact=!1}updateWheel(t){const e=this.raycastResult;if(this.isInContact){const i=e.hitNormalWorld.dot(e.directionWorld);e.hitPointWorld.vsub(t.position,i_),t.getVelocityAtWorldPoint(i_,n_);const a=e.hitNormalWorld.dot(n_);if(i>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=1/.1;else{const o=-1/i;this.suspensionRelativeVelocity=a*o,this.clippedInvContactDotSuspension=o}}else e.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,e.directionWorld.scale(-1,e.hitNormalWorld),this.clippedInvContactDotSuspension=1}}const n_=new T,i_=new T;class pR{constructor(t){this.chassisBody=t.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=typeof t.indexRightAxis<"u"?t.indexRightAxis:2,this.indexForwardAxis=typeof t.indexForwardAxis<"u"?t.indexForwardAxis:0,this.indexUpAxis=typeof t.indexUpAxis<"u"?t.indexUpAxis:1,this.constraints=[],this.preStepCallback=()=>{},this.currentVehicleSpeedKmHour=0,this.numWheelsOnGround=0}addWheel(t){t===void 0&&(t={});const e=new u1(t),i=this.wheelInfos.length;return this.wheelInfos.push(e),i}setSteeringValue(t,e){const i=this.wheelInfos[e];i.steering=t}applyEngineForce(t,e){this.wheelInfos[e].engineForce=t}setBrake(t,e){this.wheelInfos[e].brake=t}addToWorld(t){t.addBody(this.chassisBody);const e=this;this.preStepCallback=()=>{e.updateVehicle(t.dt)},t.addEventListener("preStep",this.preStepCallback),this.world=t}getVehicleAxisWorld(t,e){e.set(t===0?1:0,t===1?1:0,t===2?1:0),this.chassisBody.vectorToWorldFrame(e,e)}updateVehicle(t){const e=this.wheelInfos,i=e.length,a=this.chassisBody;for(let p=0;p<i;p++)this.updateWheelTransform(p);this.currentVehicleSpeedKmHour=3.6*a.velocity.length();const o=new T;this.getVehicleAxisWorld(this.indexForwardAxis,o),o.dot(a.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(let p=0;p<i;p++)this.castRay(e[p]);this.updateSuspension(t);const c=new T,u=new T;for(let p=0;p<i;p++){const g=e[p];let v=g.suspensionForce;v>g.maxSuspensionForce&&(v=g.maxSuspensionForce),g.raycastResult.hitNormalWorld.scale(v*t,c),g.raycastResult.hitPointWorld.vsub(a.position,u),a.applyImpulse(c,u)}this.updateFriction(t);const h=new T,d=new T,m=new T;for(let p=0;p<i;p++){const g=e[p];a.getVelocityAtWorldPoint(g.chassisConnectionPointWorld,m);let v=1;switch(this.indexUpAxis){case 1:v=-1;break}if(g.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,d);const x=d.dot(g.raycastResult.hitNormalWorld);g.raycastResult.hitNormalWorld.scale(x,h),d.vsub(h,d);const M=d.dot(m);g.deltaRotation=v*M*t/g.radius}(g.sliding||!g.isInContact)&&g.engineForce!==0&&g.useCustomSlidingRotationalSpeed&&(g.deltaRotation=(g.engineForce>0?1:-1)*g.customSlidingRotationalSpeed*t),Math.abs(g.brake)>Math.abs(g.engineForce)&&(g.deltaRotation=0),g.rotation+=g.deltaRotation,g.deltaRotation*=.99}}updateSuspension(t){const i=this.chassisBody.mass,a=this.wheelInfos,o=a.length;for(let c=0;c<o;c++){const u=a[c];if(u.isInContact){let h;const d=u.suspensionRestLength,m=u.suspensionLength,p=d-m;h=u.suspensionStiffness*p*u.clippedInvContactDotSuspension;const g=u.suspensionRelativeVelocity;let v;g<0?v=u.dampingCompression:v=u.dampingRelaxation,h-=v*g,u.suspensionForce=h*i,u.suspensionForce<0&&(u.suspensionForce=0)}else u.suspensionForce=0}}removeFromWorld(t){this.constraints,t.removeBody(this.chassisBody),t.removeEventListener("preStep",this.preStepCallback),this.world=null}castRay(t){const e=vR,i=xR;this.updateWheelTransformWorld(t);const a=this.chassisBody;let o=-1;const c=t.suspensionRestLength+t.radius;t.directionWorld.scale(c,e);const u=t.chassisConnectionPointWorld;u.vadd(e,i);const h=t.raycastResult;h.reset();const d=a.collisionResponse;a.collisionResponse=!1,this.world.rayTest(u,i,h),a.collisionResponse=d;const m=h.body;if(t.raycastResult.groundObject=0,m){o=h.distance,t.raycastResult.hitNormalWorld=h.hitNormalWorld,t.isInContact=!0;const p=h.distance;t.suspensionLength=p-t.radius;const g=t.suspensionRestLength-t.maxSuspensionTravel,v=t.suspensionRestLength+t.maxSuspensionTravel;t.suspensionLength<g&&(t.suspensionLength=g),t.suspensionLength>v&&(t.suspensionLength=v,t.raycastResult.reset());const x=t.raycastResult.hitNormalWorld.dot(t.directionWorld),M=new T;a.getVelocityAtWorldPoint(t.raycastResult.hitPointWorld,M);const S=t.raycastResult.hitNormalWorld.dot(M);if(x>=-.1)t.suspensionRelativeVelocity=0,t.clippedInvContactDotSuspension=1/.1;else{const w=-1/x;t.suspensionRelativeVelocity=S*w,t.clippedInvContactDotSuspension=w}}else t.suspensionLength=t.suspensionRestLength+0*t.maxSuspensionTravel,t.suspensionRelativeVelocity=0,t.directionWorld.scale(-1,t.raycastResult.hitNormalWorld),t.clippedInvContactDotSuspension=1;return o}updateWheelTransformWorld(t){t.isInContact=!1;const e=this.chassisBody;e.pointToWorldFrame(t.chassisConnectionPointLocal,t.chassisConnectionPointWorld),e.vectorToWorldFrame(t.directionLocal,t.directionWorld),e.vectorToWorldFrame(t.axleLocal,t.axleWorld)}updateWheelTransform(t){const e=mR,i=gR,a=yR,o=this.wheelInfos[t];this.updateWheelTransformWorld(o),o.directionLocal.scale(-1,e),i.copy(o.axleLocal),e.cross(i,a),a.normalize(),i.normalize();const c=o.steering,u=new je;u.setFromAxisAngle(e,c);const h=new je;h.setFromAxisAngle(i,o.rotation);const d=o.worldTransform.quaternion;this.chassisBody.quaternion.mult(u,d),d.mult(h,d),d.normalize();const m=o.worldTransform.position;m.copy(o.directionWorld),m.scale(o.suspensionLength,m),m.vadd(o.chassisConnectionPointWorld,m)}getWheelTransformWorld(t){return this.wheelInfos[t].worldTransform}updateFriction(t){const e=_R,i=this.wheelInfos,a=i.length,o=this.chassisBody,c=MR,u=wR;this.numWheelsOnGround=0;for(let m=0;m<a;m++){const p=i[m];p.raycastResult.body&&this.numWheelsOnGround++,p.sideImpulse=0,p.forwardImpulse=0,c[m]||(c[m]=new T),u[m]||(u[m]=new T)}for(let m=0;m<a;m++){const p=i[m],g=p.raycastResult.body;if(g){const v=u[m];this.getWheelTransformWorld(m).vectorToWorldFrame(bR[this.indexRightAxis],v);const M=p.raycastResult.hitNormalWorld,S=v.dot(M);M.scale(S,e),v.vsub(e,v),v.normalize(),M.cross(v,c[m]),c[m].normalize(),p.sideImpulse=PR(o,p.raycastResult.hitPointWorld,g,p.raycastResult.hitPointWorld,v),p.sideImpulse*=SR}}const h=1,d=.5;this.sliding=!1;for(let m=0;m<a;m++){const p=i[m],g=p.raycastResult.body;let v=0;if(p.slipInfo=1,g){const M=p.brake?p.brake:0;v=CR(o,g,p.raycastResult.hitPointWorld,c[m],M),v+=p.engineForce*t;const S=M/v;p.slipInfo*=S}if(p.forwardImpulse=0,p.skidInfo=1,g){p.skidInfo=1;const x=p.suspensionForce*t*p.frictionSlip,S=x*x;p.forwardImpulse=v;const w=p.forwardImpulse*d/p.forwardAcceleration,_=p.sideImpulse*h/p.sideAcceleration,L=w*w+_*_;if(p.sliding=!1,L>S){this.sliding=!0,p.sliding=!0;const R=x/Math.sqrt(L);p.skidInfo*=R}}}if(this.sliding)for(let m=0;m<a;m++){const p=i[m];p.sideImpulse!==0&&p.skidInfo<1&&(p.forwardImpulse*=p.skidInfo,p.sideImpulse*=p.skidInfo)}for(let m=0;m<a;m++){const p=i[m],g=new T;if(p.raycastResult.hitPointWorld.vsub(o.position,g),p.forwardImpulse!==0){const v=new T;c[m].scale(p.forwardImpulse,v),o.applyImpulse(v,g)}if(p.sideImpulse!==0){const v=p.raycastResult.body,x=new T;p.raycastResult.hitPointWorld.vsub(v.position,x);const M=new T;u[m].scale(p.sideImpulse,M),o.vectorToLocalFrame(g,g),g["xyz"[this.indexUpAxis]]*=p.rollInfluence,o.vectorToWorldFrame(g,g),o.applyImpulse(M,g),M.scale(-1,M),v.applyImpulse(M,x)}}}}new T;new T;new T;const mR=new T,gR=new T,yR=new T;new tn;new T;const vR=new T,xR=new T,bR=[new T(1,0,0),new T(0,1,0),new T(0,0,1)],_R=new T,wR=[],MR=[],SR=1,ER=new T,TR=new T,AR=new T;function CR(n,t,e,i,a){let o=0;const c=e,u=ER,h=TR,d=AR;n.getVelocityAtWorldPoint(c,u),t.getVelocityAtWorldPoint(c,h),u.vsub(h,d);const m=i.dot(d),p=s_(n,e,i),g=s_(t,e,i),x=1/(p+g);return o=-m*x,a<o&&(o=a),o<-a&&(o=-a),o}const LR=new T,RR=new T,NR=new T,zR=new T;function s_(n,t,e){const i=LR,a=RR,o=NR,c=zR;return t.vsub(n.position,i),i.cross(e,a),n.invInertiaWorld.vmult(a,c),c.cross(i,o),n.invMass+e.dot(o)}const BR=new T,DR=new T,OR=new T;function PR(n,t,e,i,a){if(a.lengthSquared()>1.1)return 0;const c=BR,u=DR,h=OR;n.getVelocityAtWorldPoint(t,c),e.getVelocityAtWorldPoint(i,u),c.vsub(u,h);const d=a.dot(h),m=1/(n.invMass+e.invMass);return-.2*d*m}class h1 extends Dt{constructor(t){if(super({type:Dt.types.SPHERE}),this.radius=t!==void 0?t:1,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}calculateLocalInertia(t,e){e===void 0&&(e=new T);const i=2*t*this.radius*this.radius/5;return e.x=i,e.y=i,e.z=i,e}volume(){return 4*Math.PI*Math.pow(this.radius,3)/3}updateBoundingSphereRadius(){this.boundingSphereRadius=this.radius}calculateWorldAABB(t,e,i,a){const o=this.radius,c=["x","y","z"];for(let u=0;u<c.length;u++){const h=c[u];i[h]=t[h]-o,a[h]=t[h]+o}}}class UR{constructor(t){t===void 0&&(t={}),this.wheelBodies=[],this.coordinateSystem=typeof t.coordinateSystem<"u"?t.coordinateSystem.clone():new T(1,2,3),t.chassisBody?this.chassisBody=t.chassisBody:this.chassisBody=new Ut({mass:1,shape:new gr(new T(5,.5,2))}),this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}addWheel(t){t===void 0&&(t={});let e;t.body?e=t.body:e=new Ut({mass:1,shape:new h1(1.2)}),this.wheelBodies.push(e),this.wheelForces.push(0);const i=typeof t.position<"u"?t.position.clone():new T,a=new T;this.chassisBody.pointToWorldFrame(i,a),e.position.set(a.x,a.y,a.z);const o=typeof t.axis<"u"?t.axis.clone():new T(0,0,1);this.wheelAxes.push(o);const c=new c1(this.chassisBody,e,{pivotA:i,axisA:o,pivotB:T.ZERO,axisB:o,collideConnected:!1});return this.constraints.push(c),this.wheelBodies.length-1}setSteeringValue(t,e){const i=this.wheelAxes[e],a=Math.cos(t),o=Math.sin(t),c=i.x,u=i.z;this.constraints[e].axisA.set(-a*c+o*u,0,o*c+a*u)}setMotorSpeed(t,e){const i=this.constraints[e];i.enableMotor(),i.motorTargetVelocity=t}disableMotor(t){this.constraints[t].disableMotor()}setWheelForce(t,e){this.wheelForces[e]=t}applyWheelForce(t,e){const i=this.wheelAxes[e],a=this.wheelBodies[e],o=a.torque;i.scale(t,Th),a.vectorToWorldFrame(Th,Th),o.vadd(Th,o)}addToWorld(t){const e=this.constraints,i=this.wheelBodies.concat([this.chassisBody]);for(let a=0;a<i.length;a++)t.addBody(i[a]);for(let a=0;a<e.length;a++)t.addConstraint(e[a]);t.addEventListener("preStep",this._update.bind(this))}_update(){const t=this.wheelForces;for(let e=0;e<t.length;e++)this.applyWheelForce(t[e],e)}removeFromWorld(t){const e=this.constraints,i=this.wheelBodies.concat([this.chassisBody]);for(let a=0;a<i.length;a++)t.removeBody(i[a]);for(let a=0;a<e.length;a++)t.removeConstraint(e[a])}getWheelSpeed(t){const e=this.wheelAxes[t],a=this.wheelBodies[t].angularVelocity;return this.chassisBody.vectorToWorldFrame(e,a_),a.dot(a_)}}const Th=new T,a_=new T;class IR{constructor(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}add(t){this.particles.push(t),this.neighbors.length<this.particles.length&&this.neighbors.push([])}remove(t){const e=this.particles.indexOf(t);e!==-1&&(this.particles.splice(e,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())}getNeighbors(t,e){const i=this.particles.length,a=t.id,o=this.smoothingRadius*this.smoothingRadius,c=FR;for(let u=0;u!==i;u++){const h=this.particles[u];h.position.vsub(t.position,c),a!==h.id&&c.lengthSquared()<o&&e.push(h)}}update(){const t=this.particles.length,e=HR,i=this.speedOfSound,a=this.eps;for(let m=0;m!==t;m++){const p=this.particles[m],g=this.neighbors[m];g.length=0,this.getNeighbors(p,g),g.push(this.particles[m]);const v=g.length;let x=0;for(let M=0;M!==v;M++){p.position.vsub(g[M].position,e);const S=e.length(),w=this.w(S);x+=g[M].mass*w}this.densities[m]=x,this.pressures[m]=i*i*(this.densities[m]-this.density)}const o=GR,c=VR,u=kR,h=WR,d=jR;for(let m=0;m!==t;m++){const p=this.particles[m];o.set(0,0,0),c.set(0,0,0);let g,v;const x=this.neighbors[m],M=x.length;for(let S=0;S!==M;S++){const w=x[S];p.position.vsub(w.position,h);const _=h.length();g=-w.mass*(this.pressures[m]/(this.densities[m]*this.densities[m]+a)+this.pressures[S]/(this.densities[S]*this.densities[S]+a)),this.gradw(h,u),u.scale(g,u),o.vadd(u,o),w.velocity.vsub(p.velocity,d),d.scale(1/(1e-4+this.densities[m]*this.densities[S])*this.viscosity*w.mass,d),v=this.nablaw(_),d.scale(v,d),c.vadd(d,c)}c.scale(p.mass,c),o.scale(p.mass,o),p.force.vadd(c,p.force),p.force.vadd(o,p.force)}}w(t){const e=this.smoothingRadius;return 315/(64*Math.PI*e**9)*(e*e-t*t)**3}gradw(t,e){const i=t.length(),a=this.smoothingRadius;t.scale(945/(32*Math.PI*a**9)*(a*a-i*i)**2,e)}nablaw(t){const e=this.smoothingRadius;return 945/(32*Math.PI*e**9)*(e*e-t*t)*(7*t*t-3*e*e)}}const FR=new T,HR=new T,GR=new T,VR=new T,kR=new T,WR=new T,jR=new T;class qR extends gi{constructor(t,e,i,a){if(t===void 0&&(t=1),e===void 0&&(e=1),i===void 0&&(i=1),a===void 0&&(a=8),t<0)throw new Error("The cylinder radiusTop cannot be negative.");if(e<0)throw new Error("The cylinder radiusBottom cannot be negative.");const o=a,c=[],u=[],h=[],d=[],m=[],p=Math.cos,g=Math.sin;c.push(new T(-e*g(0),-i*.5,e*p(0))),d.push(0),c.push(new T(-t*g(0),i*.5,t*p(0))),m.push(1);for(let x=0;x<o;x++){const M=2*Math.PI/o*(x+1),S=2*Math.PI/o*(x+.5);x<o-1?(c.push(new T(-e*g(M),-i*.5,e*p(M))),d.push(2*x+2),c.push(new T(-t*g(M),i*.5,t*p(M))),m.push(2*x+3),h.push([2*x,2*x+1,2*x+3,2*x+2])):h.push([2*x,2*x+1,1,0]),(o%2===1||x<o/2)&&u.push(new T(-g(S),0,p(S)))}h.push(d),u.push(new T(0,1,0));const v=[];for(let x=0;x<m.length;x++)v.push(m[m.length-x-1]);h.push(v),super({vertices:c,faces:h,axes:u}),this.type=Dt.types.CYLINDER,this.radiusTop=t,this.radiusBottom=e,this.height=i,this.numSegments=a}}class YR extends Dt{constructor(){super({type:Dt.types.PARTICLE})}calculateLocalInertia(t,e){return e===void 0&&(e=new T),e.set(0,0,0),e}volume(){return 0}updateBoundingSphereRadius(){this.boundingSphereRadius=0}calculateWorldAABB(t,e,i,a){i.copy(t),a.copy(t)}}class f1 extends Dt{constructor(){super({type:Dt.types.PLANE}),this.worldNormal=new T,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}computeWorldNormal(t){const e=this.worldNormal;e.set(0,0,1),t.vmult(e,e),this.worldNormalNeedsUpdate=!1}calculateLocalInertia(t,e){return e===void 0&&(e=new T),e}volume(){return Number.MAX_VALUE}calculateWorldAABB(t,e,i,a){Ss.set(0,0,1),e.vmult(Ss,Ss);const o=Number.MAX_VALUE;i.set(-o,-o,-o),a.set(o,o,o),Ss.x===1?a.x=t.x:Ss.x===-1&&(i.x=t.x),Ss.y===1?a.y=t.y:Ss.y===-1&&(i.y=t.y),Ss.z===1?a.z=t.z:Ss.z===-1&&(i.z=t.z)}updateBoundingSphereRadius(){this.boundingSphereRadius=Number.MAX_VALUE}}const Ss=new T;class XR extends Dt{constructor(t,e){e===void 0&&(e={}),e=of.defaults(e,{maxValue:null,minValue:null,elementSize:1}),super({type:Dt.types.HEIGHTFIELD}),this.data=t,this.maxValue=e.maxValue,this.minValue=e.minValue,this.elementSize=e.elementSize,e.minValue===null&&this.updateMinValue(),e.maxValue===null&&this.updateMaxValue(),this.cacheEnabled=!0,this.pillarConvex=new gi,this.pillarOffset=new T,this.updateBoundingSphereRadius(),this._cachedPillars={}}update(){this._cachedPillars={}}updateMinValue(){const t=this.data;let e=t[0][0];for(let i=0;i!==t.length;i++)for(let a=0;a!==t[i].length;a++){const o=t[i][a];o<e&&(e=o)}this.minValue=e}updateMaxValue(){const t=this.data;let e=t[0][0];for(let i=0;i!==t.length;i++)for(let a=0;a!==t[i].length;a++){const o=t[i][a];o>e&&(e=o)}this.maxValue=e}setHeightValueAtIndex(t,e,i){const a=this.data;a[t][e]=i,this.clearCachedConvexTrianglePillar(t,e,!1),t>0&&(this.clearCachedConvexTrianglePillar(t-1,e,!0),this.clearCachedConvexTrianglePillar(t-1,e,!1)),e>0&&(this.clearCachedConvexTrianglePillar(t,e-1,!0),this.clearCachedConvexTrianglePillar(t,e-1,!1)),e>0&&t>0&&this.clearCachedConvexTrianglePillar(t-1,e-1,!0)}getRectMinMax(t,e,i,a,o){o===void 0&&(o=[]);const c=this.data;let u=this.minValue;for(let h=t;h<=i;h++)for(let d=e;d<=a;d++){const m=c[h][d];m>u&&(u=m)}o[0]=this.minValue,o[1]=u}getIndexOfPosition(t,e,i,a){const o=this.elementSize,c=this.data;let u=Math.floor(t/o),h=Math.floor(e/o);return i[0]=u,i[1]=h,a&&(u<0&&(u=0),h<0&&(h=0),u>=c.length-1&&(u=c.length-1),h>=c[0].length-1&&(h=c[0].length-1)),!(u<0||h<0||u>=c.length-1||h>=c[0].length-1)}getTriangleAt(t,e,i,a,o,c){const u=r_;this.getIndexOfPosition(t,e,u,i);let h=u[0],d=u[1];const m=this.data;i&&(h=Math.min(m.length-2,Math.max(0,h)),d=Math.min(m[0].length-2,Math.max(0,d)));const p=this.elementSize,g=(t/p-h)**2+(e/p-d)**2,v=(t/p-(h+1))**2+(e/p-(d+1))**2,x=g>v;return this.getTriangle(h,d,x,a,o,c),x}getNormalAt(t,e,i,a){const o=KR,c=$R,u=tN,h=eN,d=nN;this.getTriangleAt(t,e,i,o,c,u),c.vsub(o,h),u.vsub(o,d),h.cross(d,a),a.normalize()}getAabbAtIndex(t,e,i){let{lowerBound:a,upperBound:o}=i;const c=this.data,u=this.elementSize;a.set(t*u,e*u,c[t][e]),o.set((t+1)*u,(e+1)*u,c[t+1][e+1])}getHeightAt(t,e,i){const a=this.data,o=ZR,c=QR,u=JR,h=r_;this.getIndexOfPosition(t,e,h,i);let d=h[0],m=h[1];i&&(d=Math.min(a.length-2,Math.max(0,d)),m=Math.min(a[0].length-2,Math.max(0,m)));const p=this.getTriangleAt(t,e,i,o,c,u);iN(t,e,o.x,o.y,c.x,c.y,u.x,u.y,o_);const g=o_;return p?a[d+1][m+1]*g.x+a[d][m+1]*g.y+a[d+1][m]*g.z:a[d][m]*g.x+a[d+1][m]*g.y+a[d][m+1]*g.z}getCacheConvexTrianglePillarKey(t,e,i){return`${t}_${e}_${i?1:0}`}getCachedConvexTrianglePillar(t,e,i){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,i)]}setCachedConvexTrianglePillar(t,e,i,a,o){this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,i)]={convex:a,offset:o}}clearCachedConvexTrianglePillar(t,e,i){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,i)]}getTriangle(t,e,i,a,o,c){const u=this.data,h=this.elementSize;i?(a.set((t+1)*h,(e+1)*h,u[t+1][e+1]),o.set(t*h,(e+1)*h,u[t][e+1]),c.set((t+1)*h,e*h,u[t+1][e])):(a.set(t*h,e*h,u[t][e]),o.set((t+1)*h,e*h,u[t+1][e]),c.set(t*h,(e+1)*h,u[t][e+1]))}getConvexTrianglePillar(t,e,i){let a=this.pillarConvex,o=this.pillarOffset;if(this.cacheEnabled){const p=this.getCachedConvexTrianglePillar(t,e,i);if(p){this.pillarConvex=p.convex,this.pillarOffset=p.offset;return}a=new gi,o=new T,this.pillarConvex=a,this.pillarOffset=o}const c=this.data,u=this.elementSize,h=a.faces;a.vertices.length=6;for(let p=0;p<6;p++)a.vertices[p]||(a.vertices[p]=new T);h.length=5;for(let p=0;p<5;p++)h[p]||(h[p]=[]);const d=a.vertices,m=(Math.min(c[t][e],c[t+1][e],c[t][e+1],c[t+1][e+1])-this.minValue)/2+this.minValue;i?(o.set((t+.75)*u,(e+.75)*u,m),d[0].set(.25*u,.25*u,c[t+1][e+1]-m),d[1].set(-.75*u,.25*u,c[t][e+1]-m),d[2].set(.25*u,-.75*u,c[t+1][e]-m),d[3].set(.25*u,.25*u,-Math.abs(m)-1),d[4].set(-.75*u,.25*u,-Math.abs(m)-1),d[5].set(.25*u,-.75*u,-Math.abs(m)-1),h[0][0]=0,h[0][1]=1,h[0][2]=2,h[1][0]=5,h[1][1]=4,h[1][2]=3,h[2][0]=2,h[2][1]=5,h[2][2]=3,h[2][3]=0,h[3][0]=3,h[3][1]=4,h[3][2]=1,h[3][3]=0,h[4][0]=1,h[4][1]=4,h[4][2]=5,h[4][3]=2):(o.set((t+.25)*u,(e+.25)*u,m),d[0].set(-.25*u,-.25*u,c[t][e]-m),d[1].set(.75*u,-.25*u,c[t+1][e]-m),d[2].set(-.25*u,.75*u,c[t][e+1]-m),d[3].set(-.25*u,-.25*u,-Math.abs(m)-1),d[4].set(.75*u,-.25*u,-Math.abs(m)-1),d[5].set(-.25*u,.75*u,-Math.abs(m)-1),h[0][0]=0,h[0][1]=1,h[0][2]=2,h[1][0]=5,h[1][1]=4,h[1][2]=3,h[2][0]=0,h[2][1]=2,h[2][2]=5,h[2][3]=3,h[3][0]=1,h[3][1]=0,h[3][2]=3,h[3][3]=4,h[4][0]=4,h[4][1]=5,h[4][2]=2,h[4][3]=1),a.computeNormals(),a.computeEdges(),a.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(t,e,i,a,o)}calculateLocalInertia(t,e){return e===void 0&&(e=new T),e.set(0,0,0),e}volume(){return Number.MAX_VALUE}calculateWorldAABB(t,e,i,a){i.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),a.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}updateBoundingSphereRadius(){const t=this.data,e=this.elementSize;this.boundingSphereRadius=new T(t.length*e,t[0].length*e,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).length()}setHeightsFromImage(t,e){const{x:i,z:a,y:o}=e,c=document.createElement("canvas");c.width=t.width,c.height=t.height;const u=c.getContext("2d");u.drawImage(t,0,0);const h=u.getImageData(0,0,t.width,t.height),d=this.data;d.length=0,this.elementSize=Math.abs(i)/h.width;for(let m=0;m<h.height;m++){const p=[];for(let g=0;g<h.width;g++){const v=h.data[(m*h.height+g)*4],x=h.data[(m*h.height+g)*4+1],M=h.data[(m*h.height+g)*4+2],S=(v+x+M)/4/255*a;i<0?p.push(S):p.unshift(S)}o<0?d.unshift(p):d.push(p)}this.updateMaxValue(),this.updateMinValue(),this.update()}}const r_=[],o_=new T,ZR=new T,QR=new T,JR=new T,KR=new T,$R=new T,tN=new T,eN=new T,nN=new T;function iN(n,t,e,i,a,o,c,u,h){h.x=((o-u)*(n-c)+(c-a)*(t-u))/((o-u)*(e-c)+(c-a)*(i-u)),h.y=((u-i)*(n-c)+(e-c)*(t-u))/((o-u)*(e-c)+(c-a)*(i-u)),h.z=1-h.x-h.y}class qi{constructor(t){t===void 0&&(t={}),this.root=t.root||null,this.aabb=t.aabb?t.aabb.clone():new Ie,this.data=[],this.children=[]}reset(){this.children.length=this.data.length=0}insert(t,e,i){i===void 0&&(i=0);const a=this.data;if(!this.aabb.contains(t))return!1;const o=this.children,c=this.maxDepth||this.root.maxDepth;if(i<c){let u=!1;o.length||(this.subdivide(),u=!0);for(let h=0;h!==8;h++)if(o[h].insert(t,e,i+1))return!0;u&&(o.length=0)}return a.push(e),!0}subdivide(){const t=this.aabb,e=t.lowerBound,i=t.upperBound,a=this.children;a.push(new qi({aabb:new Ie({lowerBound:new T(0,0,0)})}),new qi({aabb:new Ie({lowerBound:new T(1,0,0)})}),new qi({aabb:new Ie({lowerBound:new T(1,1,0)})}),new qi({aabb:new Ie({lowerBound:new T(1,1,1)})}),new qi({aabb:new Ie({lowerBound:new T(0,1,1)})}),new qi({aabb:new Ie({lowerBound:new T(0,0,1)})}),new qi({aabb:new Ie({lowerBound:new T(1,0,1)})}),new qi({aabb:new Ie({lowerBound:new T(0,1,0)})})),i.vsub(e,tr),tr.scale(.5,tr);const o=this.root||this;for(let c=0;c!==8;c++){const u=a[c];u.root=o;const h=u.aabb.lowerBound;h.x*=tr.x,h.y*=tr.y,h.z*=tr.z,h.vadd(e,h),h.vadd(tr,u.aabb.upperBound)}}aabbQuery(t,e){this.data,this.children;const i=[this];for(;i.length;){const a=i.pop();a.aabb.overlaps(t)&&Array.prototype.push.apply(e,a.data),Array.prototype.push.apply(i,a.children)}return e}rayQuery(t,e,i){return t.getAABB(Ah),Ah.toLocalFrame(e,Ah),this.aabbQuery(Ah,i),i}removeEmptyNodes(){for(let t=this.children.length-1;t>=0;t--)this.children[t].removeEmptyNodes(),!this.children[t].children.length&&!this.children[t].data.length&&this.children.splice(t,1)}}class sN extends qi{constructor(t,e){e===void 0&&(e={}),super({root:null,aabb:t}),this.maxDepth=typeof e.maxDepth<"u"?e.maxDepth:8}}const tr=new T,Ah=new Ie;class Yh extends Dt{constructor(t,e){super({type:Dt.types.TRIMESH}),this.vertices=new Float32Array(t),this.indices=new Int16Array(e),this.normals=new Float32Array(e.length),this.aabb=new Ie,this.edges=null,this.scale=new T(1,1,1),this.tree=new sN,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}updateTree(){const t=this.tree;t.reset(),t.aabb.copy(this.aabb);const e=this.scale;t.aabb.lowerBound.x*=1/e.x,t.aabb.lowerBound.y*=1/e.y,t.aabb.lowerBound.z*=1/e.z,t.aabb.upperBound.x*=1/e.x,t.aabb.upperBound.y*=1/e.y,t.aabb.upperBound.z*=1/e.z;const i=new Ie,a=new T,o=new T,c=new T,u=[a,o,c];for(let h=0;h<this.indices.length/3;h++){const d=h*3;this._getUnscaledVertex(this.indices[d],a),this._getUnscaledVertex(this.indices[d+1],o),this._getUnscaledVertex(this.indices[d+2],c),i.setFromPoints(u),t.insert(i,h)}t.removeEmptyNodes()}getTrianglesInAABB(t,e){Ch.copy(t);const i=this.scale,a=i.x,o=i.y,c=i.z,u=Ch.lowerBound,h=Ch.upperBound;return u.x/=a,u.y/=o,u.z/=c,h.x/=a,h.y/=o,h.z/=c,this.tree.aabbQuery(Ch,e)}setScale(t){const e=this.scale.x===this.scale.y&&this.scale.y===this.scale.z,i=t.x===t.y&&t.y===t.z;e&&i||this.updateNormals(),this.scale.copy(t),this.updateAABB(),this.updateBoundingSphereRadius()}updateNormals(){const t=aN,e=this.normals;for(let i=0;i<this.indices.length/3;i++){const a=i*3,o=this.indices[a],c=this.indices[a+1],u=this.indices[a+2];this.getVertex(o,u_),this.getVertex(c,h_),this.getVertex(u,f_),Yh.computeNormal(h_,u_,f_,t),e[a]=t.x,e[a+1]=t.y,e[a+2]=t.z}}updateEdges(){const t={},e=(a,o)=>{const c=a<o?`${a}_${o}`:`${o}_${a}`;t[c]=!0};for(let a=0;a<this.indices.length/3;a++){const o=a*3,c=this.indices[o],u=this.indices[o+1],h=this.indices[o+2];e(c,u),e(u,h),e(h,c)}const i=Object.keys(t);this.edges=new Int16Array(i.length*2);for(let a=0;a<i.length;a++){const o=i[a].split("_");this.edges[2*a]=parseInt(o[0],10),this.edges[2*a+1]=parseInt(o[1],10)}}getEdgeVertex(t,e,i){const a=this.edges[t*2+(e?1:0)];this.getVertex(a,i)}getEdgeVector(t,e){const i=rN,a=oN;this.getEdgeVertex(t,0,i),this.getEdgeVertex(t,1,a),a.vsub(i,e)}static computeNormal(t,e,i,a){e.vsub(t,c_),i.vsub(e,l_),l_.cross(c_,a),a.isZero()||a.normalize()}getVertex(t,e){const i=this.scale;return this._getUnscaledVertex(t,e),e.x*=i.x,e.y*=i.y,e.z*=i.z,e}_getUnscaledVertex(t,e){const i=t*3,a=this.vertices;return e.set(a[i],a[i+1],a[i+2])}getWorldVertex(t,e,i,a){return this.getVertex(t,a),me.pointToWorldFrame(e,i,a,a),a}getTriangleVertices(t,e,i,a){const o=t*3;this.getVertex(this.indices[o],e),this.getVertex(this.indices[o+1],i),this.getVertex(this.indices[o+2],a)}getNormal(t,e){const i=t*3;return e.set(this.normals[i],this.normals[i+1],this.normals[i+2])}calculateLocalInertia(t,e){this.computeLocalAABB(er);const i=er.upperBound.x-er.lowerBound.x,a=er.upperBound.y-er.lowerBound.y,o=er.upperBound.z-er.lowerBound.z;return e.set(1/12*t*(2*a*2*a+2*o*2*o),1/12*t*(2*i*2*i+2*o*2*o),1/12*t*(2*a*2*a+2*i*2*i))}computeLocalAABB(t){const e=t.lowerBound,i=t.upperBound,a=this.vertices.length;this.vertices;const o=lN;this.getVertex(0,o),e.copy(o),i.copy(o);for(let c=0;c!==a;c++)this.getVertex(c,o),o.x<e.x?e.x=o.x:o.x>i.x&&(i.x=o.x),o.y<e.y?e.y=o.y:o.y>i.y&&(i.y=o.y),o.z<e.z?e.z=o.z:o.z>i.z&&(i.z=o.z)}updateAABB(){this.computeLocalAABB(this.aabb)}updateBoundingSphereRadius(){let t=0;const e=this.vertices,i=new T;for(let a=0,o=e.length/3;a!==o;a++){this.getVertex(a,i);const c=i.lengthSquared();c>t&&(t=c)}this.boundingSphereRadius=Math.sqrt(t)}calculateWorldAABB(t,e,i,a){const o=cN,c=uN;o.position=t,o.quaternion=e,this.aabb.toWorldFrame(o,c),i.copy(c.lowerBound),a.copy(c.upperBound)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}static createTorus(t,e,i,a,o){t===void 0&&(t=1),e===void 0&&(e=.5),i===void 0&&(i=8),a===void 0&&(a=6),o===void 0&&(o=Math.PI*2);const c=[],u=[];for(let h=0;h<=i;h++)for(let d=0;d<=a;d++){const m=d/a*o,p=h/i*Math.PI*2,g=(t+e*Math.cos(p))*Math.cos(m),v=(t+e*Math.cos(p))*Math.sin(m),x=e*Math.sin(p);c.push(g,v,x)}for(let h=1;h<=i;h++)for(let d=1;d<=a;d++){const m=(a+1)*h+d-1,p=(a+1)*(h-1)+d-1,g=(a+1)*(h-1)+d,v=(a+1)*h+d;u.push(m,p,v),u.push(p,g,v)}return new Yh(c,u)}}const aN=new T,Ch=new Ie,rN=new T,oN=new T,l_=new T,c_=new T,u_=new T,h_=new T,f_=new T,er=new Ie,lN=new T,cN=new me,uN=new Ie;class rg{constructor(){this.equations=[]}solve(t,e){return 0}addEquation(t){t.enabled&&!t.bi.isTrigger&&!t.bj.isTrigger&&this.equations.push(t)}removeEquation(t){const e=this.equations,i=e.indexOf(t);i!==-1&&e.splice(i,1)}removeAllEquations(){this.equations.length=0}}class d1 extends rg{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(t,e){let i=0;const a=this.iterations,o=this.tolerance*this.tolerance,c=this.equations,u=c.length,h=e.bodies,d=h.length,m=t;let p,g,v,x,M,S;if(u!==0)for(let R=0;R!==d;R++)h[R].updateSolveMassProperties();const w=fN,_=dN,L=hN;w.length=u,_.length=u,L.length=u;for(let R=0;R!==u;R++){const C=c[R];L[R]=0,_[R]=C.computeB(m),w[R]=1/C.computeC()}if(u!==0){for(let A=0;A!==d;A++){const B=h[A],Y=B.vlambda,X=B.wlambda;Y.set(0,0,0),X.set(0,0,0)}for(i=0;i!==a;i++){x=0;for(let A=0;A!==u;A++){const B=c[A];p=_[A],g=w[A],S=L[A],M=B.computeGWlambda(),v=g*(p-M-B.eps*S),S+v<B.minForce?v=B.minForce-S:S+v>B.maxForce&&(v=B.maxForce-S),L[A]+=v,x+=v>0?v:-v,B.addToWlambda(v)}if(x*x<o)break}for(let A=0;A!==d;A++){const B=h[A],Y=B.velocity,X=B.angularVelocity;B.vlambda.vmul(B.linearFactor,B.vlambda),Y.vadd(B.vlambda,Y),B.wlambda.vmul(B.angularFactor,B.wlambda),X.vadd(B.wlambda,X)}let R=c.length;const C=1/m;for(;R--;)c[R].multiplier=L[R]*C}return i}}const hN=[],fN=[],dN=[];class pN extends rg{constructor(t){for(super(),this.iterations=10,this.tolerance=1e-7,this.subsolver=t,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}createNode(){return{body:null,children:[],eqs:[],visited:!1}}solve(t,e){const i=mN,a=this.nodePool,o=e.bodies,c=this.equations,u=c.length,h=o.length,d=this.subsolver;for(;a.length<h;)a.push(this.createNode());i.length=h;for(let x=0;x<h;x++)i[x]=a[x];for(let x=0;x!==h;x++){const M=i[x];M.body=o[x],M.children.length=0,M.eqs.length=0,M.visited=!1}for(let x=0;x!==u;x++){const M=c[x],S=o.indexOf(M.bi),w=o.indexOf(M.bj),_=i[S],L=i[w];_.children.push(L),_.eqs.push(M),L.children.push(_),L.eqs.push(M)}let m,p=0,g=gN;d.tolerance=this.tolerance,d.iterations=this.iterations;const v=yN;for(;m=p1(i);){g.length=0,v.bodies.length=0,xN(m,bN,v.bodies,g);const x=g.length;g=g.sort(_N);for(let M=0;M!==x;M++)d.addEquation(g[M]);d.solve(t,v),d.removeAllEquations(),p++}return p}}const mN=[],gN=[],yN={bodies:[]},vN=Ut.STATIC;function p1(n){const t=n.length;for(let e=0;e!==t;e++){const i=n[e];if(!i.visited&&!(i.body.type&vN))return i}return!1}const Lh=[];function xN(n,t,e,i){for(Lh.push(n),n.visited=!0,t(n,e,i);Lh.length;){const a=Lh.pop();let o;for(;o=p1(a.children);)o.visited=!0,t(o,e,i),Lh.push(o)}}function bN(n,t,e){t.push(n.body);const i=n.eqs.length;for(let a=0;a!==i;a++){const o=n.eqs[a];e.includes(o)||e.push(o)}}function _N(n,t){return t.id-n.id}class m1{constructor(){this.objects=[],this.type=Object}release(){const t=arguments.length;for(let e=0;e!==t;e++)this.objects.push(e<0||arguments.length<=e?void 0:arguments[e]);return this}get(){return this.objects.length===0?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(t){const e=this.objects;for(;e.length>t;)e.pop();for(;e.length<t;)e.push(this.constructObject());return this}}class g1 extends m1{constructor(){super(...arguments),this.type=T}constructObject(){return new T}}const Be={sphereSphere:Dt.types.SPHERE,spherePlane:Dt.types.SPHERE|Dt.types.PLANE,boxBox:Dt.types.BOX|Dt.types.BOX,sphereBox:Dt.types.SPHERE|Dt.types.BOX,planeBox:Dt.types.PLANE|Dt.types.BOX,convexConvex:Dt.types.CONVEXPOLYHEDRON,sphereConvex:Dt.types.SPHERE|Dt.types.CONVEXPOLYHEDRON,planeConvex:Dt.types.PLANE|Dt.types.CONVEXPOLYHEDRON,boxConvex:Dt.types.BOX|Dt.types.CONVEXPOLYHEDRON,sphereHeightfield:Dt.types.SPHERE|Dt.types.HEIGHTFIELD,boxHeightfield:Dt.types.BOX|Dt.types.HEIGHTFIELD,convexHeightfield:Dt.types.CONVEXPOLYHEDRON|Dt.types.HEIGHTFIELD,sphereParticle:Dt.types.PARTICLE|Dt.types.SPHERE,planeParticle:Dt.types.PLANE|Dt.types.PARTICLE,boxParticle:Dt.types.BOX|Dt.types.PARTICLE,convexParticle:Dt.types.PARTICLE|Dt.types.CONVEXPOLYHEDRON,cylinderCylinder:Dt.types.CYLINDER,sphereCylinder:Dt.types.SPHERE|Dt.types.CYLINDER,planeCylinder:Dt.types.PLANE|Dt.types.CYLINDER,boxCylinder:Dt.types.BOX|Dt.types.CYLINDER,convexCylinder:Dt.types.CONVEXPOLYHEDRON|Dt.types.CYLINDER,heightfieldCylinder:Dt.types.HEIGHTFIELD|Dt.types.CYLINDER,particleCylinder:Dt.types.PARTICLE|Dt.types.CYLINDER,sphereTrimesh:Dt.types.SPHERE|Dt.types.TRIMESH,planeTrimesh:Dt.types.PLANE|Dt.types.TRIMESH};class y1{get[Be.sphereSphere](){return this.sphereSphere}get[Be.spherePlane](){return this.spherePlane}get[Be.boxBox](){return this.boxBox}get[Be.sphereBox](){return this.sphereBox}get[Be.planeBox](){return this.planeBox}get[Be.convexConvex](){return this.convexConvex}get[Be.sphereConvex](){return this.sphereConvex}get[Be.planeConvex](){return this.planeConvex}get[Be.boxConvex](){return this.boxConvex}get[Be.sphereHeightfield](){return this.sphereHeightfield}get[Be.boxHeightfield](){return this.boxHeightfield}get[Be.convexHeightfield](){return this.convexHeightfield}get[Be.sphereParticle](){return this.sphereParticle}get[Be.planeParticle](){return this.planeParticle}get[Be.boxParticle](){return this.boxParticle}get[Be.convexParticle](){return this.convexParticle}get[Be.cylinderCylinder](){return this.convexConvex}get[Be.sphereCylinder](){return this.sphereConvex}get[Be.planeCylinder](){return this.planeConvex}get[Be.boxCylinder](){return this.boxConvex}get[Be.convexCylinder](){return this.convexConvex}get[Be.heightfieldCylinder](){return this.heightfieldCylinder}get[Be.particleCylinder](){return this.particleCylinder}get[Be.sphereTrimesh](){return this.sphereTrimesh}get[Be.planeTrimesh](){return this.planeTrimesh}constructor(t){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new g1,this.world=t,this.currentContactMaterial=t.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(t,e,i,a,o,c){let u;this.contactPointPool.length?(u=this.contactPointPool.pop(),u.bi=t,u.bj=e):u=new No(t,e),u.enabled=t.collisionResponse&&e.collisionResponse&&i.collisionResponse&&a.collisionResponse;const h=this.currentContactMaterial;u.restitution=h.restitution,u.setSpookParams(h.contactEquationStiffness,h.contactEquationRelaxation,this.world.dt);const d=i.material||t.material,m=a.material||e.material;return d&&m&&d.restitution>=0&&m.restitution>=0&&(u.restitution=d.restitution*m.restitution),u.si=o||i,u.sj=c||a,u}createFrictionEquationsFromContact(t,e){const i=t.bi,a=t.bj,o=t.si,c=t.sj,u=this.world,h=this.currentContactMaterial;let d=h.friction;const m=o.material||i.material,p=c.material||a.material;if(m&&p&&m.friction>=0&&p.friction>=0&&(d=m.friction*p.friction),d>0){const g=d*(u.frictionGravity||u.gravity).length();let v=i.invMass+a.invMass;v>0&&(v=1/v);const x=this.frictionEquationPool,M=x.length?x.pop():new km(i,a,g*v),S=x.length?x.pop():new km(i,a,g*v);return M.bi=S.bi=i,M.bj=S.bj=a,M.minForce=S.minForce=-g*v,M.maxForce=S.maxForce=g*v,M.ri.copy(t.ri),M.rj.copy(t.rj),S.ri.copy(t.ri),S.rj.copy(t.rj),t.ni.tangents(M.t,S.t),M.setSpookParams(h.frictionEquationStiffness,h.frictionEquationRelaxation,u.dt),S.setSpookParams(h.frictionEquationStiffness,h.frictionEquationRelaxation,u.dt),M.enabled=S.enabled=t.enabled,e.push(M,S),!0}return!1}createFrictionFromAverage(t){let e=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(e,this.frictionResult)||t===1)return;const i=this.frictionResult[this.frictionResult.length-2],a=this.frictionResult[this.frictionResult.length-1];nr.setZero(),go.setZero(),yo.setZero();const o=e.bi;e.bj;for(let u=0;u!==t;u++)e=this.result[this.result.length-1-u],e.bi!==o?(nr.vadd(e.ni,nr),go.vadd(e.ri,go),yo.vadd(e.rj,yo)):(nr.vsub(e.ni,nr),go.vadd(e.rj,go),yo.vadd(e.ri,yo));const c=1/t;go.scale(c,i.ri),yo.scale(c,i.rj),a.ri.copy(i.ri),a.rj.copy(i.rj),nr.normalize(),nr.tangents(i.t,a.t)}getContacts(t,e,i,a,o,c,u){this.contactPointPool=o,this.frictionEquationPool=u,this.result=a,this.frictionResult=c;const h=SN,d=EN,m=wN,p=MN;for(let g=0,v=t.length;g!==v;g++){const x=t[g],M=e[g];let S=null;x.material&&M.material&&(S=i.getContactMaterial(x.material,M.material)||null);const w=x.type&Ut.KINEMATIC&&M.type&Ut.STATIC||x.type&Ut.STATIC&&M.type&Ut.KINEMATIC||x.type&Ut.KINEMATIC&&M.type&Ut.KINEMATIC;for(let _=0;_<x.shapes.length;_++){x.quaternion.mult(x.shapeOrientations[_],h),x.quaternion.vmult(x.shapeOffsets[_],m),m.vadd(x.position,m);const L=x.shapes[_];for(let R=0;R<M.shapes.length;R++){M.quaternion.mult(M.shapeOrientations[R],d),M.quaternion.vmult(M.shapeOffsets[R],p),p.vadd(M.position,p);const C=M.shapes[R];if(!(L.collisionFilterMask&C.collisionFilterGroup&&C.collisionFilterMask&L.collisionFilterGroup)||m.distanceTo(p)>L.boundingSphereRadius+C.boundingSphereRadius)continue;let A=null;L.material&&C.material&&(A=i.getContactMaterial(L.material,C.material)||null),this.currentContactMaterial=A||S||i.defaultContactMaterial;const B=L.type|C.type,Y=this[B];if(Y){let X=!1;L.type<C.type?X=Y.call(this,L,C,m,p,h,d,x,M,L,C,w):X=Y.call(this,C,L,p,m,d,h,M,x,L,C,w),X&&w&&(i.shapeOverlapKeeper.set(L.id,C.id),i.bodyOverlapKeeper.set(x.id,M.id))}}}}}sphereSphere(t,e,i,a,o,c,u,h,d,m,p){if(p)return i.distanceSquared(a)<(t.radius+e.radius)**2;const g=this.createContactEquation(u,h,t,e,d,m);a.vsub(i,g.ni),g.ni.normalize(),g.ri.copy(g.ni),g.rj.copy(g.ni),g.ri.scale(t.radius,g.ri),g.rj.scale(-e.radius,g.rj),g.ri.vadd(i,g.ri),g.ri.vsub(u.position,g.ri),g.rj.vadd(a,g.rj),g.rj.vsub(h.position,g.rj),this.result.push(g),this.createFrictionEquationsFromContact(g,this.frictionResult)}spherePlane(t,e,i,a,o,c,u,h,d,m,p){const g=this.createContactEquation(u,h,t,e,d,m);if(g.ni.set(0,0,1),c.vmult(g.ni,g.ni),g.ni.negate(g.ni),g.ni.normalize(),g.ni.scale(t.radius,g.ri),i.vsub(a,Rh),g.ni.scale(g.ni.dot(Rh),d_),Rh.vsub(d_,g.rj),-Rh.dot(g.ni)<=t.radius){if(p)return!0;const v=g.ri,x=g.rj;v.vadd(i,v),v.vsub(u.position,v),x.vadd(a,x),x.vsub(h.position,x),this.result.push(g),this.createFrictionEquationsFromContact(g,this.frictionResult)}}boxBox(t,e,i,a,o,c,u,h,d,m,p){return t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(t.convexPolyhedronRepresentation,e.convexPolyhedronRepresentation,i,a,o,c,u,h,t,e,p)}sphereBox(t,e,i,a,o,c,u,h,d,m,p){const g=this.v3pool,v=JN;i.vsub(a,Nh),e.getSideNormals(v,c);const x=t.radius;let M=!1;const S=$N,w=tz,_=ez;let L=null,R=0,C=0,A=0,B=null;for(let z=0,Q=v.length;z!==Q&&M===!1;z++){const $=XN;$.copy(v[z]);const it=$.length();$.normalize();const ct=Nh.dot($);if(ct<it+x&&ct>0){const D=ZN,q=QN;D.copy(v[(z+1)%3]),q.copy(v[(z+2)%3]);const ut=D.length(),yt=q.length();D.normalize(),q.normalize();const tt=Nh.dot(D),Ct=Nh.dot(q);if(tt<ut&&tt>-ut&&Ct<yt&&Ct>-yt){const bt=Math.abs(ct-it-x);if((B===null||bt<B)&&(B=bt,C=tt,A=Ct,L=it,S.copy($),w.copy(D),_.copy(q),R++,p))return!0}}}if(R){M=!0;const z=this.createContactEquation(u,h,t,e,d,m);S.scale(-x,z.ri),z.ni.copy(S),z.ni.negate(z.ni),S.scale(L,S),w.scale(C,w),S.vadd(w,S),_.scale(A,_),S.vadd(_,z.rj),z.ri.vadd(i,z.ri),z.ri.vsub(u.position,z.ri),z.rj.vadd(a,z.rj),z.rj.vsub(h.position,z.rj),this.result.push(z),this.createFrictionEquationsFromContact(z,this.frictionResult)}let Y=g.get();const X=KN;for(let z=0;z!==2&&!M;z++)for(let Q=0;Q!==2&&!M;Q++)for(let $=0;$!==2&&!M;$++)if(Y.set(0,0,0),z?Y.vadd(v[0],Y):Y.vsub(v[0],Y),Q?Y.vadd(v[1],Y):Y.vsub(v[1],Y),$?Y.vadd(v[2],Y):Y.vsub(v[2],Y),a.vadd(Y,X),X.vsub(i,X),X.lengthSquared()<x*x){if(p)return!0;M=!0;const it=this.createContactEquation(u,h,t,e,d,m);it.ri.copy(X),it.ri.normalize(),it.ni.copy(it.ri),it.ri.scale(x,it.ri),it.rj.copy(Y),it.ri.vadd(i,it.ri),it.ri.vsub(u.position,it.ri),it.rj.vadd(a,it.rj),it.rj.vsub(h.position,it.rj),this.result.push(it),this.createFrictionEquationsFromContact(it,this.frictionResult)}g.release(Y),Y=null;const st=g.get(),V=g.get(),j=g.get(),I=g.get(),H=g.get(),U=v.length;for(let z=0;z!==U&&!M;z++)for(let Q=0;Q!==U&&!M;Q++)if(z%3!==Q%3){v[Q].cross(v[z],st),st.normalize(),v[z].vadd(v[Q],V),j.copy(i),j.vsub(V,j),j.vsub(a,j);const $=j.dot(st);st.scale($,I);let it=0;for(;it===z%3||it===Q%3;)it++;H.copy(i),H.vsub(I,H),H.vsub(V,H),H.vsub(a,H);const ct=Math.abs($),D=H.length();if(ct<v[it].length()&&D<x){if(p)return!0;M=!0;const q=this.createContactEquation(u,h,t,e,d,m);V.vadd(I,q.rj),q.rj.copy(q.rj),H.negate(q.ni),q.ni.normalize(),q.ri.copy(q.rj),q.ri.vadd(a,q.ri),q.ri.vsub(i,q.ri),q.ri.normalize(),q.ri.scale(x,q.ri),q.ri.vadd(i,q.ri),q.ri.vsub(u.position,q.ri),q.rj.vadd(a,q.rj),q.rj.vsub(h.position,q.rj),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult)}}g.release(st,V,j,I,H)}planeBox(t,e,i,a,o,c,u,h,d,m,p){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,e.convexPolyhedronRepresentation.id=e.id,this.planeConvex(t,e.convexPolyhedronRepresentation,i,a,o,c,u,h,t,e,p)}convexConvex(t,e,i,a,o,c,u,h,d,m,p,g,v){const x=gz;if(!(i.distanceTo(a)>t.boundingSphereRadius+e.boundingSphereRadius)&&t.findSeparatingAxis(e,i,o,a,c,x,g,v)){const M=[],S=yz;t.clipAgainstHull(i,o,e,a,c,x,-100,100,M);let w=0;for(let _=0;_!==M.length;_++){if(p)return!0;const L=this.createContactEquation(u,h,t,e,d,m),R=L.ri,C=L.rj;x.negate(L.ni),M[_].normal.negate(S),S.scale(M[_].depth,S),M[_].point.vadd(S,R),C.copy(M[_].point),R.vsub(i,R),C.vsub(a,C),R.vadd(i,R),R.vsub(u.position,R),C.vadd(a,C),C.vsub(h.position,C),this.result.push(L),w++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(L,this.frictionResult)}this.enableFrictionReduction&&w&&this.createFrictionFromAverage(w)}}sphereConvex(t,e,i,a,o,c,u,h,d,m,p){const g=this.v3pool;i.vsub(a,nz);const v=e.faceNormals,x=e.faces,M=e.vertices,S=t.radius;let w=!1;for(let _=0;_!==M.length;_++){const L=M[_],R=rz;c.vmult(L,R),a.vadd(R,R);const C=az;if(R.vsub(i,C),C.lengthSquared()<S*S){if(p)return!0;w=!0;const A=this.createContactEquation(u,h,t,e,d,m);A.ri.copy(C),A.ri.normalize(),A.ni.copy(A.ri),A.ri.scale(S,A.ri),R.vsub(a,A.rj),A.ri.vadd(i,A.ri),A.ri.vsub(u.position,A.ri),A.rj.vadd(a,A.rj),A.rj.vsub(h.position,A.rj),this.result.push(A),this.createFrictionEquationsFromContact(A,this.frictionResult);return}}for(let _=0,L=x.length;_!==L&&w===!1;_++){const R=v[_],C=x[_],A=oz;c.vmult(R,A);const B=lz;c.vmult(M[C[0]],B),B.vadd(a,B);const Y=cz;A.scale(-S,Y),i.vadd(Y,Y);const X=uz;Y.vsub(B,X);const st=X.dot(A),V=hz;if(i.vsub(B,V),st<0&&V.dot(A)>0){const j=[];for(let I=0,H=C.length;I!==H;I++){const U=g.get();c.vmult(M[C[I]],U),a.vadd(U,U),j.push(U)}if(YN(j,A,i)){if(p)return!0;w=!0;const I=this.createContactEquation(u,h,t,e,d,m);A.scale(-S,I.ri),A.negate(I.ni);const H=g.get();A.scale(-st,H);const U=g.get();A.scale(-S,U),i.vsub(a,I.rj),I.rj.vadd(U,I.rj),I.rj.vadd(H,I.rj),I.rj.vadd(a,I.rj),I.rj.vsub(h.position,I.rj),I.ri.vadd(i,I.ri),I.ri.vsub(u.position,I.ri),g.release(H),g.release(U),this.result.push(I),this.createFrictionEquationsFromContact(I,this.frictionResult);for(let z=0,Q=j.length;z!==Q;z++)g.release(j[z]);return}else for(let I=0;I!==C.length;I++){const H=g.get(),U=g.get();c.vmult(M[C[(I+1)%C.length]],H),c.vmult(M[C[(I+2)%C.length]],U),a.vadd(H,H),a.vadd(U,U);const z=iz;U.vsub(H,z);const Q=sz;z.unit(Q);const $=g.get(),it=g.get();i.vsub(H,it);const ct=it.dot(Q);Q.scale(ct,$),$.vadd(H,$);const D=g.get();if($.vsub(i,D),ct>0&&ct*ct<z.lengthSquared()&&D.lengthSquared()<S*S){if(p)return!0;const q=this.createContactEquation(u,h,t,e,d,m);$.vsub(a,q.rj),$.vsub(i,q.ni),q.ni.normalize(),q.ni.scale(S,q.ri),q.rj.vadd(a,q.rj),q.rj.vsub(h.position,q.rj),q.ri.vadd(i,q.ri),q.ri.vsub(u.position,q.ri),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult);for(let ut=0,yt=j.length;ut!==yt;ut++)g.release(j[ut]);g.release(H),g.release(U),g.release($),g.release(D),g.release(it);return}g.release(H),g.release(U),g.release($),g.release(D),g.release(it)}for(let I=0,H=j.length;I!==H;I++)g.release(j[I])}}}planeConvex(t,e,i,a,o,c,u,h,d,m,p){const g=fz,v=dz;v.set(0,0,1),o.vmult(v,v);let x=0;const M=pz;for(let S=0;S!==e.vertices.length;S++)if(g.copy(e.vertices[S]),c.vmult(g,g),a.vadd(g,g),g.vsub(i,M),v.dot(M)<=0){if(p)return!0;const _=this.createContactEquation(u,h,t,e,d,m),L=mz;v.scale(v.dot(M),L),g.vsub(L,L),L.vsub(i,_.ri),_.ni.copy(v),g.vsub(a,_.rj),_.ri.vadd(i,_.ri),_.ri.vsub(u.position,_.ri),_.rj.vadd(a,_.rj),_.rj.vsub(h.position,_.rj),this.result.push(_),x++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(_,this.frictionResult)}this.enableFrictionReduction&&x&&this.createFrictionFromAverage(x)}boxConvex(t,e,i,a,o,c,u,h,d,m,p){return t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(t.convexPolyhedronRepresentation,e,i,a,o,c,u,h,t,e,p)}sphereHeightfield(t,e,i,a,o,c,u,h,d,m,p){const g=e.data,v=t.radius,x=e.elementSize,M=Lz,S=Cz;me.pointToLocalFrame(a,c,i,S);let w=Math.floor((S.x-v)/x)-1,_=Math.ceil((S.x+v)/x)+1,L=Math.floor((S.y-v)/x)-1,R=Math.ceil((S.y+v)/x)+1;if(_<0||R<0||w>g.length||L>g[0].length)return;w<0&&(w=0),_<0&&(_=0),L<0&&(L=0),R<0&&(R=0),w>=g.length&&(w=g.length-1),_>=g.length&&(_=g.length-1),R>=g[0].length&&(R=g[0].length-1),L>=g[0].length&&(L=g[0].length-1);const C=[];e.getRectMinMax(w,L,_,R,C);const A=C[0],B=C[1];if(S.z-v>B||S.z+v<A)return;const Y=this.result;for(let X=w;X<_;X++)for(let st=L;st<R;st++){const V=Y.length;let j=!1;if(e.getConvexTrianglePillar(X,st,!1),me.pointToWorldFrame(a,c,e.pillarOffset,M),i.distanceTo(M)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&(j=this.sphereConvex(t,e.pillarConvex,i,M,o,c,u,h,t,e,p)),p&&j||(e.getConvexTrianglePillar(X,st,!0),me.pointToWorldFrame(a,c,e.pillarOffset,M),i.distanceTo(M)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&(j=this.sphereConvex(t,e.pillarConvex,i,M,o,c,u,h,t,e,p)),p&&j))return!0;if(Y.length-V>2)return}}boxHeightfield(t,e,i,a,o,c,u,h,d,m,p){return t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexHeightfield(t.convexPolyhedronRepresentation,e,i,a,o,c,u,h,t,e,p)}convexHeightfield(t,e,i,a,o,c,u,h,d,m,p){const g=e.data,v=e.elementSize,x=t.boundingSphereRadius,M=Tz,S=Az,w=Ez;me.pointToLocalFrame(a,c,i,w);let _=Math.floor((w.x-x)/v)-1,L=Math.ceil((w.x+x)/v)+1,R=Math.floor((w.y-x)/v)-1,C=Math.ceil((w.y+x)/v)+1;if(L<0||C<0||_>g.length||R>g[0].length)return;_<0&&(_=0),L<0&&(L=0),R<0&&(R=0),C<0&&(C=0),_>=g.length&&(_=g.length-1),L>=g.length&&(L=g.length-1),C>=g[0].length&&(C=g[0].length-1),R>=g[0].length&&(R=g[0].length-1);const A=[];e.getRectMinMax(_,R,L,C,A);const B=A[0],Y=A[1];if(!(w.z-x>Y||w.z+x<B))for(let X=_;X<L;X++)for(let st=R;st<C;st++){let V=!1;if(e.getConvexTrianglePillar(X,st,!1),me.pointToWorldFrame(a,c,e.pillarOffset,M),i.distanceTo(M)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&(V=this.convexConvex(t,e.pillarConvex,i,M,o,c,u,h,null,null,p,S,null)),p&&V||(e.getConvexTrianglePillar(X,st,!0),me.pointToWorldFrame(a,c,e.pillarOffset,M),i.distanceTo(M)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&(V=this.convexConvex(t,e.pillarConvex,i,M,o,c,u,h,null,null,p,S,null)),p&&V))return!0}}sphereParticle(t,e,i,a,o,c,u,h,d,m,p){const g=_z;if(g.set(0,0,1),a.vsub(i,g),g.lengthSquared()<=t.radius*t.radius){if(p)return!0;const x=this.createContactEquation(h,u,e,t,d,m);g.normalize(),x.rj.copy(g),x.rj.scale(t.radius,x.rj),x.ni.copy(g),x.ni.negate(x.ni),x.ri.set(0,0,0),this.result.push(x),this.createFrictionEquationsFromContact(x,this.frictionResult)}}planeParticle(t,e,i,a,o,c,u,h,d,m,p){const g=vz;g.set(0,0,1),u.quaternion.vmult(g,g);const v=xz;if(a.vsub(u.position,v),g.dot(v)<=0){if(p)return!0;const M=this.createContactEquation(h,u,e,t,d,m);M.ni.copy(g),M.ni.negate(M.ni),M.ri.set(0,0,0);const S=bz;g.scale(g.dot(a),S),a.vsub(S,S),M.rj.copy(S),this.result.push(M),this.createFrictionEquationsFromContact(M,this.frictionResult)}}boxParticle(t,e,i,a,o,c,u,h,d,m,p){return t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexParticle(t.convexPolyhedronRepresentation,e,i,a,o,c,u,h,t,e,p)}convexParticle(t,e,i,a,o,c,u,h,d,m,p){let g=-1;const v=Mz,x=Sz;let M=null;const S=wz;if(S.copy(a),S.vsub(i,S),o.conjugate(p_),p_.vmult(S,S),t.pointIsInside(S)){t.worldVerticesNeedsUpdate&&t.computeWorldVertices(i,o),t.worldFaceNormalsNeedsUpdate&&t.computeWorldFaceNormals(o);for(let w=0,_=t.faces.length;w!==_;w++){const L=[t.worldVertices[t.faces[w][0]]],R=t.worldFaceNormals[w];a.vsub(L[0],m_);const C=-R.dot(m_);if(M===null||Math.abs(C)<Math.abs(M)){if(p)return!0;M=C,g=w,v.copy(R)}}if(g!==-1){const w=this.createContactEquation(h,u,e,t,d,m);v.scale(M,x),x.vadd(a,x),x.vsub(i,x),w.rj.copy(x),v.negate(w.ni),w.ri.set(0,0,0);const _=w.ri,L=w.rj;_.vadd(a,_),_.vsub(h.position,_),L.vadd(i,L),L.vsub(u.position,L),this.result.push(w),this.createFrictionEquationsFromContact(w,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}heightfieldCylinder(t,e,i,a,o,c,u,h,d,m,p){return this.convexHeightfield(e,t,a,i,c,o,h,u,d,m,p)}particleCylinder(t,e,i,a,o,c,u,h,d,m,p){return this.convexParticle(e,t,a,i,c,o,h,u,d,m,p)}sphereTrimesh(t,e,i,a,o,c,u,h,d,m,p){const g=BN,v=DN,x=ON,M=PN,S=UN,w=IN,_=VN,L=zN,R=RN,C=kN;me.pointToLocalFrame(a,c,i,S);const A=t.radius;_.lowerBound.set(S.x-A,S.y-A,S.z-A),_.upperBound.set(S.x+A,S.y+A,S.z+A),e.getTrianglesInAABB(_,C);const B=NN,Y=t.radius*t.radius;for(let I=0;I<C.length;I++)for(let H=0;H<3;H++)if(e.getVertex(e.indices[C[I]*3+H],B),B.vsub(S,R),R.lengthSquared()<=Y){if(L.copy(B),me.pointToWorldFrame(a,c,L,B),B.vsub(i,R),p)return!0;let U=this.createContactEquation(u,h,t,e,d,m);U.ni.copy(R),U.ni.normalize(),U.ri.copy(U.ni),U.ri.scale(t.radius,U.ri),U.ri.vadd(i,U.ri),U.ri.vsub(u.position,U.ri),U.rj.copy(B),U.rj.vsub(h.position,U.rj),this.result.push(U),this.createFrictionEquationsFromContact(U,this.frictionResult)}for(let I=0;I<C.length;I++)for(let H=0;H<3;H++){e.getVertex(e.indices[C[I]*3+H],g),e.getVertex(e.indices[C[I]*3+(H+1)%3],v),v.vsub(g,x),S.vsub(v,w);const U=w.dot(x);S.vsub(g,w);let z=w.dot(x);if(z>0&&U<0&&(S.vsub(g,w),M.copy(x),M.normalize(),z=w.dot(M),M.scale(z,w),w.vadd(g,w),w.distanceTo(S)<t.radius)){if(p)return!0;const $=this.createContactEquation(u,h,t,e,d,m);w.vsub(S,$.ni),$.ni.normalize(),$.ni.scale(t.radius,$.ri),$.ri.vadd(i,$.ri),$.ri.vsub(u.position,$.ri),me.pointToWorldFrame(a,c,w,w),w.vsub(h.position,$.rj),me.vectorToWorldFrame(c,$.ni,$.ni),me.vectorToWorldFrame(c,$.ri,$.ri),this.result.push($),this.createFrictionEquationsFromContact($,this.frictionResult)}}const X=FN,st=HN,V=GN,j=LN;for(let I=0,H=C.length;I!==H;I++){e.getTriangleVertices(C[I],X,st,V),e.getNormal(C[I],j),S.vsub(X,w);let U=w.dot(j);if(j.scale(U,w),S.vsub(w,w),U=w.distanceTo(S),tn.pointInTriangle(w,X,st,V)&&U<t.radius){if(p)return!0;let z=this.createContactEquation(u,h,t,e,d,m);w.vsub(S,z.ni),z.ni.normalize(),z.ni.scale(t.radius,z.ri),z.ri.vadd(i,z.ri),z.ri.vsub(u.position,z.ri),me.pointToWorldFrame(a,c,w,w),w.vsub(h.position,z.rj),me.vectorToWorldFrame(c,z.ni,z.ni),me.vectorToWorldFrame(c,z.ri,z.ri),this.result.push(z),this.createFrictionEquationsFromContact(z,this.frictionResult)}}C.length=0}planeTrimesh(t,e,i,a,o,c,u,h,d,m,p){const g=new T,v=TN;v.set(0,0,1),o.vmult(v,v);for(let x=0;x<e.vertices.length/3;x++){e.getVertex(x,g);const M=new T;M.copy(g),me.pointToWorldFrame(a,c,M,g);const S=AN;if(g.vsub(i,S),v.dot(S)<=0){if(p)return!0;const _=this.createContactEquation(u,h,t,e,d,m);_.ni.copy(v);const L=CN;v.scale(S.dot(v),L),g.vsub(L,L),_.ri.copy(L),_.ri.vsub(u.position,_.ri),_.rj.copy(g),_.rj.vsub(h.position,_.rj),this.result.push(_),this.createFrictionEquationsFromContact(_,this.frictionResult)}}}}const nr=new T,go=new T,yo=new T,wN=new T,MN=new T,SN=new je,EN=new je,TN=new T,AN=new T,CN=new T,LN=new T,RN=new T;new T;const NN=new T,zN=new T,BN=new T,DN=new T,ON=new T,PN=new T,UN=new T,IN=new T,FN=new T,HN=new T,GN=new T,VN=new Ie,kN=[],Rh=new T,d_=new T,WN=new T,jN=new T,qN=new T;function YN(n,t,e){let i=null;const a=n.length;for(let o=0;o!==a;o++){const c=n[o],u=WN;n[(o+1)%a].vsub(c,u);const h=jN;u.cross(t,h);const d=qN;e.vsub(c,d);const m=h.dot(d);if(i===null||m>0&&i===!0||m<=0&&i===!1){i===null&&(i=m>0);continue}else return!1}return!0}const Nh=new T,XN=new T,ZN=new T,QN=new T,JN=[new T,new T,new T,new T,new T,new T],KN=new T,$N=new T,tz=new T,ez=new T,nz=new T,iz=new T,sz=new T,az=new T,rz=new T,oz=new T,lz=new T,cz=new T,uz=new T,hz=new T;new T;new T;const fz=new T,dz=new T,pz=new T,mz=new T,gz=new T,yz=new T,vz=new T,xz=new T,bz=new T,_z=new T,p_=new je,wz=new T;new T;const Mz=new T,m_=new T,Sz=new T,Ez=new T,Tz=new T,Az=[0],Cz=new T,Lz=new T;class g_{constructor(){this.current=[],this.previous=[]}getKey(t,e){if(e<t){const i=e;e=t,t=i}return t<<16|e}set(t,e){const i=this.getKey(t,e),a=this.current;let o=0;for(;i>a[o];)o++;if(i!==a[o]){for(let c=a.length-1;c>=o;c--)a[c+1]=a[c];a[o]=i}}tick(){const t=this.current;this.current=this.previous,this.previous=t,this.current.length=0}getDiff(t,e){const i=this.current,a=this.previous,o=i.length,c=a.length;let u=0;for(let h=0;h<o;h++){let d=!1;const m=i[h];for(;m>a[u];)u++;d=m===a[u],d||y_(t,m)}u=0;for(let h=0;h<c;h++){let d=!1;const m=a[h];for(;m>i[u];)u++;d=i[u]===m,d||y_(e,m)}}}function y_(n,t){n.push((t&4294901760)>>16,t&65535)}const sm=(n,t)=>n<t?`${n}-${t}`:`${t}-${n}`;class Rz{constructor(){this.data={keys:[]}}get(t,e){const i=sm(t,e);return this.data[i]}set(t,e,i){const a=sm(t,e);this.get(t,e)||this.data.keys.push(a),this.data[a]=i}delete(t,e){const i=sm(t,e),a=this.data.keys.indexOf(i);a!==-1&&this.data.keys.splice(a,1),delete this.data[i]}reset(){const t=this.data,e=t.keys;for(;e.length>0;){const i=e.pop();delete t[i]}}}class v1 extends sg{constructor(t){t===void 0&&(t={}),super(),this.dt=-1,this.allowSleep=!!t.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=t.quatNormalizeSkip!==void 0?t.quatNormalizeSkip:0,this.quatNormalizeFast=t.quatNormalizeFast!==void 0?t.quatNormalizeFast:!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new T,t.gravity&&this.gravity.copy(t.gravity),t.frictionGravity&&(this.frictionGravity=new T,this.frictionGravity.copy(t.frictionGravity)),this.broadphase=t.broadphase!==void 0?t.broadphase:new ag,this.bodies=[],this.hasActiveBodies=!1,this.solver=t.solver!==void 0?t.solver:new d1,this.constraints=[],this.narrowphase=new y1(this),this.collisionMatrix=new Gm,this.collisionMatrixPrevious=new Gm,this.bodyOverlapKeeper=new g_,this.shapeOverlapKeeper=new g_,this.contactmaterials=[],this.contactMaterialTable=new Rz,this.defaultMaterial=new pr("default"),this.defaultContactMaterial=new Qo(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(t,e){return this.contactMaterialTable.get(t.id,e.id)}collisionMatrixTick(){const t=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=t,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(t){this.constraints.push(t)}removeConstraint(t){const e=this.constraints.indexOf(t);e!==-1&&this.constraints.splice(e,1)}rayTest(t,e,i){i instanceof jo?this.raycastClosest(t,e,{skipBackfaces:!0},i):this.raycastAll(t,e,{skipBackfaces:!0},i)}raycastAll(t,e,i,a){return i===void 0&&(i={}),i.mode=tn.ALL,i.from=t,i.to=e,i.callback=a,am.intersectWorld(this,i)}raycastAny(t,e,i,a){return i===void 0&&(i={}),i.mode=tn.ANY,i.from=t,i.to=e,i.result=a,am.intersectWorld(this,i)}raycastClosest(t,e,i,a){return i===void 0&&(i={}),i.mode=tn.CLOSEST,i.from=t,i.to=e,i.result=a,am.intersectWorld(this,i)}addBody(t){this.bodies.includes(t)||(t.index=this.bodies.length,this.bodies.push(t),t.world=this,t.initPosition.copy(t.position),t.initVelocity.copy(t.velocity),t.timeLastSleepy=this.time,t instanceof Ut&&(t.initAngularVelocity.copy(t.angularVelocity),t.initQuaternion.copy(t.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=t,this.idToBodyMap[t.id]=t,this.dispatchEvent(this.addBodyEvent))}removeBody(t){t.world=null;const e=this.bodies.length-1,i=this.bodies,a=i.indexOf(t);if(a!==-1){i.splice(a,1);for(let o=0;o!==i.length;o++)i[o].index=o;this.collisionMatrix.setNumObjects(e),this.removeBodyEvent.body=t,delete this.idToBodyMap[t.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(t){return this.idToBodyMap[t]}getShapeById(t){const e=this.bodies;for(let i=0;i<e.length;i++){const a=e[i].shapes;for(let o=0;o<a.length;o++){const c=a[o];if(c.id===t)return c}}return null}addContactMaterial(t){this.contactmaterials.push(t),this.contactMaterialTable.set(t.materials[0].id,t.materials[1].id,t)}removeContactMaterial(t){const e=this.contactmaterials.indexOf(t);e!==-1&&(this.contactmaterials.splice(e,1),this.contactMaterialTable.delete(t.materials[0].id,t.materials[1].id))}fixedStep(t,e){t===void 0&&(t=1/60),e===void 0&&(e=10);const i=cn.now()/1e3;if(!this.lastCallTime)this.step(t,void 0,e);else{const a=i-this.lastCallTime;this.step(t,a,e)}this.lastCallTime=i}step(t,e,i){if(i===void 0&&(i=10),e===void 0)this.internalStep(t),this.time+=t;else{this.accumulator+=e;const a=cn.now();let o=0;for(;this.accumulator>=t&&o<i&&(this.internalStep(t),this.accumulator-=t,o++,!(cn.now()-a>t*1e3)););this.accumulator=this.accumulator%t;const c=this.accumulator/t;for(let u=0;u!==this.bodies.length;u++){const h=this.bodies[u];h.previousPosition.lerp(h.position,c,h.interpolatedPosition),h.previousQuaternion.slerp(h.quaternion,c,h.interpolatedQuaternion),h.previousQuaternion.normalize()}this.time+=e}}internalStep(t){this.dt=t;const e=this.contacts,i=Oz,a=Pz,o=this.bodies.length,c=this.bodies,u=this.solver,h=this.gravity,d=this.doProfiling,m=this.profile,p=Ut.DYNAMIC;let g=-1/0;const v=this.constraints,x=Dz;h.length();const M=h.x,S=h.y,w=h.z;let _=0;for(d&&(g=cn.now()),_=0;_!==o;_++){const I=c[_];if(I.type===p){const H=I.force,U=I.mass;H.x+=U*M,H.y+=U*S,H.z+=U*w}}for(let I=0,H=this.subsystems.length;I!==H;I++)this.subsystems[I].update();d&&(g=cn.now()),i.length=0,a.length=0,this.broadphase.collisionPairs(this,i,a),d&&(m.broadphase=cn.now()-g);let L=v.length;for(_=0;_!==L;_++){const I=v[_];if(!I.collideConnected)for(let H=i.length-1;H>=0;H-=1)(I.bodyA===i[H]&&I.bodyB===a[H]||I.bodyB===i[H]&&I.bodyA===a[H])&&(i.splice(H,1),a.splice(H,1))}this.collisionMatrixTick(),d&&(g=cn.now());const R=Bz,C=e.length;for(_=0;_!==C;_++)R.push(e[_]);e.length=0;const A=this.frictionEquations.length;for(_=0;_!==A;_++)x.push(this.frictionEquations[_]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(i,a,this,e,R,this.frictionEquations,x),d&&(m.narrowphase=cn.now()-g),d&&(g=cn.now()),_=0;_<this.frictionEquations.length;_++)u.addEquation(this.frictionEquations[_]);const B=e.length;for(let I=0;I!==B;I++){const H=e[I],U=H.bi,z=H.bj,Q=H.si,$=H.sj;let it;if(U.material&&z.material?it=this.getContactMaterial(U.material,z.material)||this.defaultContactMaterial:it=this.defaultContactMaterial,it.friction,U.material&&z.material&&(U.material.friction>=0&&z.material.friction>=0&&U.material.friction*z.material.friction,U.material.restitution>=0&&z.material.restitution>=0&&(H.restitution=U.material.restitution*z.material.restitution)),u.addEquation(H),U.allowSleep&&U.type===Ut.DYNAMIC&&U.sleepState===Ut.SLEEPING&&z.sleepState===Ut.AWAKE&&z.type!==Ut.STATIC){const ct=z.velocity.lengthSquared()+z.angularVelocity.lengthSquared(),D=z.sleepSpeedLimit**2;ct>=D*2&&(U.wakeUpAfterNarrowphase=!0)}if(z.allowSleep&&z.type===Ut.DYNAMIC&&z.sleepState===Ut.SLEEPING&&U.sleepState===Ut.AWAKE&&U.type!==Ut.STATIC){const ct=U.velocity.lengthSquared()+U.angularVelocity.lengthSquared(),D=U.sleepSpeedLimit**2;ct>=D*2&&(z.wakeUpAfterNarrowphase=!0)}this.collisionMatrix.set(U,z,!0),this.collisionMatrixPrevious.get(U,z)||($l.body=z,$l.contact=H,U.dispatchEvent($l),$l.body=U,z.dispatchEvent($l)),this.bodyOverlapKeeper.set(U.id,z.id),this.shapeOverlapKeeper.set(Q.id,$.id)}for(this.emitContactEvents(),d&&(m.makeContactConstraints=cn.now()-g,g=cn.now()),_=0;_!==o;_++){const I=c[_];I.wakeUpAfterNarrowphase&&(I.wakeUp(),I.wakeUpAfterNarrowphase=!1)}for(L=v.length,_=0;_!==L;_++){const I=v[_];I.update();for(let H=0,U=I.equations.length;H!==U;H++){const z=I.equations[H];u.addEquation(z)}}u.solve(t,this),d&&(m.solve=cn.now()-g),u.removeAllEquations();const Y=Math.pow;for(_=0;_!==o;_++){const I=c[_];if(I.type&p){const H=Y(1-I.linearDamping,t),U=I.velocity;U.scale(H,U);const z=I.angularVelocity;if(z){const Q=Y(1-I.angularDamping,t);z.scale(Q,z)}}}this.dispatchEvent(zz),d&&(g=cn.now());const st=this.stepnumber%(this.quatNormalizeSkip+1)===0,V=this.quatNormalizeFast;for(_=0;_!==o;_++)c[_].integrate(t,st,V);this.clearForces(),this.broadphase.dirty=!0,d&&(m.integrate=cn.now()-g),this.stepnumber+=1,this.dispatchEvent(Nz);let j=!0;if(this.allowSleep)for(j=!1,_=0;_!==o;_++){const I=c[_];I.sleepTick(this.time),I.sleepState!==Ut.SLEEPING&&(j=!0)}this.hasActiveBodies=j}emitContactEvents(){const t=this.hasAnyEventListener("beginContact"),e=this.hasAnyEventListener("endContact");if((t||e)&&this.bodyOverlapKeeper.getDiff(Es,Ts),t){for(let o=0,c=Es.length;o<c;o+=2)tc.bodyA=this.getBodyById(Es[o]),tc.bodyB=this.getBodyById(Es[o+1]),this.dispatchEvent(tc);tc.bodyA=tc.bodyB=null}if(e){for(let o=0,c=Ts.length;o<c;o+=2)ec.bodyA=this.getBodyById(Ts[o]),ec.bodyB=this.getBodyById(Ts[o+1]),this.dispatchEvent(ec);ec.bodyA=ec.bodyB=null}Es.length=Ts.length=0;const i=this.hasAnyEventListener("beginShapeContact"),a=this.hasAnyEventListener("endShapeContact");if((i||a)&&this.shapeOverlapKeeper.getDiff(Es,Ts),i){for(let o=0,c=Es.length;o<c;o+=2){const u=this.getShapeById(Es[o]),h=this.getShapeById(Es[o+1]);As.shapeA=u,As.shapeB=h,u&&(As.bodyA=u.body),h&&(As.bodyB=h.body),this.dispatchEvent(As)}As.bodyA=As.bodyB=As.shapeA=As.shapeB=null}if(a){for(let o=0,c=Ts.length;o<c;o+=2){const u=this.getShapeById(Ts[o]),h=this.getShapeById(Ts[o+1]);Cs.shapeA=u,Cs.shapeB=h,u&&(Cs.bodyA=u.body),h&&(Cs.bodyB=h.body),this.dispatchEvent(Cs)}Cs.bodyA=Cs.bodyB=Cs.shapeA=Cs.shapeB=null}}clearForces(){const t=this.bodies,e=t.length;for(let i=0;i!==e;i++){const a=t[i];a.force,a.torque,a.force.set(0,0,0),a.torque.set(0,0,0)}}}new Ie;const am=new tn,cn=globalThis.performance||{};if(!cn.now){let n=Date.now();cn.timing&&cn.timing.navigationStart&&(n=cn.timing.navigationStart),cn.now=()=>Date.now()-n}new T;const Nz={type:"postStep"},zz={type:"preStep"},$l={type:Ut.COLLIDE_EVENT_NAME,body:null,contact:null},Bz=[],Dz=[],Oz=[],Pz=[],Es=[],Ts=[],tc={type:"beginContact",bodyA:null,bodyB:null},ec={type:"endContact",bodyA:null,bodyB:null},As={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},Cs={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},rm=Object.freeze(Object.defineProperty({__proto__:null,AABB:Ie,ArrayCollisionMatrix:Gm,BODY_SLEEP_STATES:sf,BODY_TYPES:nf,Body:Ut,Box:gr,Broadphase:af,COLLISION_TYPES:Be,ConeTwistConstraint:ZL,Constraint:Zo,ContactEquation:No,ContactMaterial:Qo,ConvexPolyhedron:gi,Cylinder:qR,DistanceConstraint:QL,Equation:Ds,EventTarget:sg,FrictionEquation:km,GSSolver:d1,GridBroadphase:yL,Heightfield:XR,HingeConstraint:c1,JacobianElement:Vm,LockConstraint:JL,Mat3:pi,Material:pr,NaiveBroadphase:ag,Narrowphase:y1,ObjectCollisionMatrix:qC,Particle:YR,Plane:f1,PointToPointConstraint:lf,Pool:m1,Quaternion:je,RAY_MODES:rf,Ray:tn,RaycastResult:jo,RaycastVehicle:pR,RigidVehicle:UR,RotationalEquation:ar,RotationalMotorEquation:l1,SAPBroadphase:Ao,SHAPE_TYPES:t1,SPHSystem:IR,Shape:Dt,Solver:rg,Sphere:h1,SplitSolver:pN,Spring:nR,Transform:me,Trimesh:Yh,Vec3:T,Vec3Pool:g1,WheelInfo:u1,World:v1},Symbol.toStringTag,{value:"Module"}));class ya{static instance;audioContext;buffers=new Map;volume=.5;enabled=!1;loaded=!1;assets={dicehits:15,surfaces:{felt:7,wood_tray:7,metal:9}};constructor(){const t=window.AudioContext||window.webkitAudioContext;this.audioContext=new t,this.enabled=!0;const e=()=>{this.audioContext.state==="suspended"&&this.audioContext.resume().then(()=>{console.log("AudioManager: AudioContext resumed successfully."),this.enabled=!0}).catch(i=>console.error("AudioManager: Failed to resume AudioContext:",i)),window.removeEventListener("click",e,!0),window.removeEventListener("touchstart",e,!0),window.removeEventListener("keydown",e,!0)};window.addEventListener("click",e,!0),window.addEventListener("touchstart",e,!0),window.addEventListener("keydown",e,!0),this.loadAssets()}static getInstance(){return ya.instance||(ya.instance=new ya),ya.instance}setVolume(t){this.volume=Math.max(0,Math.min(1,t)),this.audioContext.state==="suspended"&&this.volume>0&&this.audioContext.resume()}async loadAssets(){const t=async(i,a)=>{try{const c=await(await fetch(i)).arrayBuffer(),u=await this.audioContext.decodeAudioData(c);this.buffers.set(a,u)}catch(o){console.warn(`Failed to load sound: ${i}`,o)}},e=[];for(let i=1;i<=this.assets.dicehits;i++)e.push(t(`sounds/dicehit${i}.wav`,`dicehit${i}`));for(let i=1;i<=this.assets.surfaces.felt;i++)e.push(t(`sounds/felt/surface_felt${i}.wav`,`felt${i}`));for(let i=1;i<=this.assets.surfaces.wood_tray;i++)e.push(t(`sounds/wood_tray/surface_wood_tray${i}.wav`,`wood${i}`));for(let i=1;i<=this.assets.surfaces.metal;i++)e.push(t(`sounds/metal/surface_metal${i}.wav`,`metal${i}`));await Promise.all(e),this.loaded=!0,console.log("AudioManager: All sounds loaded.")}playDiceHit(t){if(!this.enabled||!this.loaded||this.volume<=0)return;const e=Math.min(1,Math.max(.1,t/20)),i=Math.floor(Math.random()*this.assets.dicehits)+1;this.playSound(`dicehit${i}`,e)}playSurfaceHit(t,e){if(!this.enabled||!this.loaded||this.volume<=0)return;const i=Math.min(1,Math.max(.1,t/30));let a="felt",o=this.assets.surfaces.felt;switch(e){case"wood":case"glass":a="wood",o=this.assets.surfaces.wood_tray;break;case"felt":case"rubber":a="felt",o=this.assets.surfaces.felt;break}e==="glass"&&(a="metal",o=this.assets.surfaces.metal);const c=Math.floor(Math.random()*o)+1;this.playSound(`${a}${c}`,i)}playSound(t,e){if(!this.buffers.has(t)){console.warn(`AudioManager: Sound buffer missing for key: ${t}`);return}const i=this.buffers.get(t);if(!i)return;console.log(`AudioManager: Playing ${t} (Vol: ${this.volume}, Int: ${e.toFixed(2)})`);const a=this.audioContext.createBufferSource();a.buffer=i;const o=this.audioContext.createGain();o.gain.value=this.volume*e,a.playbackRate.value=.9+Math.random()*.2,a.connect(o),o.connect(this.audioContext.destination),a.start(0)}}class Uz{world;bodies=[];walls=[];diceMaterial;groundMaterial;diceGroundContact;currentSurface="felt";constructor(){this.world=new v1,this.world.gravity.set(0,-9.82*20,0),this.world.broadphase=new ag,this.world.solver.iterations=10,this.diceMaterial=new pr,this.groundMaterial=new pr,this.diceGroundContact=new Qo(this.diceMaterial,this.groundMaterial,{friction:.1,restitution:.5}),this.world.addContactMaterial(this.diceGroundContact);const t=new Ut({mass:0,shape:new f1,material:this.groundMaterial});t.quaternion.setFromAxisAngle(new T(1,0,0),-Math.PI/2),this.world.addBody(t),t.addEventListener("collide",this.handleGroundCollision),this.updateBounds(44,28)}handleGroundCollision=t=>{const e=t.contact.getImpactVelocityAlongNormal();Math.abs(e)>.5&&(console.log(`PhysicsWorld: Ground Hit. Vel: ${e.toFixed(2)}`),ya.getInstance().playSurfaceHit(Math.abs(e),this.currentSurface||"felt"))};handleDiceCollision=t=>{if(t.body.mass>0){const i=t.contact.getImpactVelocityAlongNormal();Math.abs(i)>.5&&(console.log(`PhysicsWorld: Dice Hit. Vel: ${i.toFixed(2)}`),ya.getInstance().playDiceHit(Math.abs(i)))}};setGravity(t){this.world.gravity.set(0,-t*20,0)}setSurface(t){this.currentSurface=t;let e=.3,i=.3;switch(t){case"felt":e=.8,i=.1;break;case"wood":e=.5,i=.3;break;case"rubber":e=.9,i=.8;break;case"glass":e=.1,i=.5;break}this.diceGroundContact.friction=e,this.diceGroundContact.restitution=i}updateBounds(t,e){this.walls.forEach(p=>this.world.removeBody(p)),this.walls=[];const i=t/2,a=e/2,o=10,c=20,u=i+o/2,h=a+o/2,d=t+o*2+20;this.addWall(new T(0,0,-h),new T(0,0,0),new T(d,c,o)),this.addWall(new T(0,0,h),new T(0,0,0),new T(d,c,o));const m=e+o*2;this.addWall(new T(-u,0,0),new T(0,Math.PI/2,0),new T(m,c,o)),this.addWall(new T(u,0,0),new T(0,Math.PI/2,0),new T(m,c,o))}addWall(t,e,i){const a=new gr(new T(i.x/2,i.y/2,i.z/2)),o=new Ut({mass:0,shape:a,position:t,material:this.diceMaterial});o.quaternion.setFromEuler(e.x,e.y,e.z),this.world.addBody(o),this.walls.push(o),o.addEventListener("collide",this.handleGroundCollision)}step(t){this.world.step(1/60,t,3)}addBody(t){this.world.addBody(t),this.bodies.push(t),t.addEventListener("collide",this.handleDiceCollision)}removeBody(t){t.removeEventListener("collide",this.handleDiceCollision),this.world.removeBody(t);const e=this.bodies.indexOf(t);e!==-1&&this.bodies.splice(e,1)}}const xo={none:{name:"none",composite:"source-over"},bonepith:{name:"Bone Pith",composite:"multiply",source:"textures/bonepith.png",bump:"textures/bonepith-bump.png",material:"wood"},circuittrace:{name:"Circuit Trace",composite:"multiply",source:"textures/circuittrace.png",bump:"textures/circuittrace-bump.png",material:"plastic"},crackedobsidian:{name:"Cracked Obsidian",composite:"multiply",source:"textures/crackedobsidian.png",bump:"textures/crackedobsidian-bump.png",material:"glass"},dualcoreswirl:{name:"Dual Core Swirl",composite:"multiply",source:"textures/dualcoreswirl.png",bump:"textures/dualcoreswirl-bump.png",material:"plastic"},forgescored:{name:"Forge Scored",composite:"multiply",source:"textures/forgescored.png",bump:"textures/forgescored-bump.png",material:"metal"},fracturedglass:{name:"Fractured Glass",composite:"multiply",source:"textures/fracturedglass.png",bump:"textures/fracturedglass-bump.png",material:"glass"},graveyard:{name:"Graveyard",composite:"source-over",source:"textures/graveyard.png",bump:"textures/graveyard-bump.png",material:"stone"},hammeredsteel:{name:"Hammered Steel",composite:"multiply",source:"textures/hammeredsteel.png",bump:"textures/hammeredsteel-bump.png",material:"metal"},ledgerandink:{name:"Ledger and Ink",composite:"multiply",source:"textures/ledgerandink.png",bump:"textures/ledgerandink-bump.png",material:"wood"},runicbranding:{name:"Runic Branding",composite:"multiply",source:"textures/runicbranding.png",bump:"textures/runicbranding-bump.png",material:"stone"},sinewstrands:{name:"Sinew Strands",composite:"multiply",source:"textures/sinewstrands.png",bump:"textures/sinewstrands-bump.png",material:"plastic"},slagscarred:{name:"Slag Scarred",composite:"multiply",source:"textures/slagscarred.png",bump:"textures/slagscarred-bump.png",material:"metal"},smokynebula:{name:"Smoky Nebula",composite:"multiply",source:"textures/smokynebula.png",bump:"textures/smokynebula-bump.png",material:"plastic"},starmap:{name:"Starmap",composite:"multiply",source:"textures/starmap.png",bump:"textures/starmap-bump.png",material:"plastic"},swirl:{name:"Swirl",composite:"multiply",source:"textures/swirl.png",bump:"textures/swirl-bump.png",material:"plastic"},tapestry:{name:"Tapestry",composite:"multiply",source:"textures/tapestry.png",bump:"textures/tapestry-bump.png",material:"cloth"},treering:{name:"Tree Ring",composite:"multiply",source:"textures/treering.png",bump:"textures/treering-bump.png",material:"wood"},wovenlinen:{name:"Woven Linen",composite:"multiply",source:"textures/wovenlinen.png",bump:"textures/wovenlinen-bump.png",material:"cloth"},thearchitect:{name:"The Architect",composite:"multiply",source:"textures/thearchitect.png",bump:"textures/thearchitect-bump.png",material:"metal"},eldritchvein:{name:"Eldritch Vein",composite:"multiply",source:"textures/eldritchvein.png",bump:"textures/eldritchvein-bump.png",material:"metal"}},Co={};let fc="idle";const Wm=[];class x1{constructor(t){t&&(fc==="complete"?t(Co):Wm.push(t)),fc==="idle"&&new Iz().loadImages()}getImage(t){return Co[t]}}class Iz{loadImages(){if(fc!=="idle")return;fc="loading";let t=0,e=0;for(const a in xo)xo[a].source&&e++,xo[a].bump&&e++;if(e===0){this.finish();return}const i=()=>{t++,t>=e&&this.finish()};for(const a in xo){Co[a]={};const o=xo[a];if(o.source){const c=new Image;c.onload=i,c.onerror=()=>{console.warn("Texture load failed:",o.source),i()},c.src=o.source,Co[a].texture=c}if(o.bump){const c=new Image;c.onload=i,c.onerror=()=>{console.warn("Bump load failed:",o.bump),i()},c.src=o.bump,Co[a].bump=c}}}finish(){fc="complete",Wm.forEach(t=>t(Co)),Wm.length=0,console.log("DiceColors: All images loaded.")}}const Cc={diceColor:"#dddddd",labelColor:"#000000",outlineColor:"#000000",texture:"ledgerandink",material:"plastic",font:"Arial",scale:1,textureContrast:1},jm={throwForce:60,gravity:9.81,surface:"felt",soundVolume:.5,spinForce:15,wallRestitution:.5,groundFriction:.5};class bn{diceColors;geometryCache={};static D2_LABELS=["1","2"];static D100_LABELS=["10","20","50","40","70","60","30","80","90","00"];static D4_LABELS=["1","2","3","4"];static D6_LABELS=["1","2","3","4","5","6"];static D60_LABELS=["10","20","30","40","50","60"];static D8_LABELS=["1","7","5","3","6","4","2","8"];static D80_LABELS=["10","70","50","30","60","40","20","80"];static D14_LABELS=["1","13","5","9","7","3","11","8","12","4","14","2","10","6"];static D16_LABELS=["1","15","3","7","11","9","5","13","8","4","12","16","2","14","10","6"];static D18_LABELS=["1","17","3","13","7","9","11","5","15","10","8","14","4","18","2","16","6","12"];static D10_LABELS=["1","2","5","4","7","6","3","8","9","0"];static D12_LABELS=["1","11","7","9","10","5","8","3","4","6","2","12"];static D20_LABELS=["1","13","11","9","19","5","7","3","6","4","12","10","8","20","2","15","17","16","14","18"];constructor(){this.diceColors=new x1}createdice(t,e=Cc){let i,a=[];const o=e.scale||1;switch(t){case"d2":i=this.getGeometry("d2",1*o),a=bn.D2_LABELS;break;case"d4":i=this.getGeometry("d4",1*o),a=bn.D4_LABELS;break;case"d6":i=this.getGeometry("d6",1*o),a=bn.D6_LABELS;break;case"d60":i=this.getGeometry("d6",1*o),a=bn.D60_LABELS;break;case"d8":i=this.getGeometry("d8",1*o),a=bn.D8_LABELS;break;case"d80":i=this.getGeometry("d8",1*o),a=bn.D80_LABELS;break;case"d10":i=this.getGeometry("d10",1*o),a=bn.D10_LABELS;break;case"d14":i=this.getGeometry("d14",1*o),a=bn.D14_LABELS;break;case"d16":i=this.getGeometry("d16",1*o),a=bn.D16_LABELS;break;case"d18":i=this.getGeometry("d18",1*o),a=bn.D18_LABELS;break;case"d12":i=this.getGeometry("d12",.9*o),a=bn.D12_LABELS;break;case"d20":i=this.getGeometry("d20",1*o),a=bn.D20_LABELS;break;case"d100":i=this.getGeometry("d100",1*o),a=bn.D100_LABELS;break;default:throw new Error(`Unknown dice type: ${t}`)}if(!i)throw new Error("Geometry failed");const c=this.calculateLabels(t,a),u=this.createMaterials(t,c,e),h=new Ze(i,u);h.castShadow=!0,h.receiveShadow=!0,h.body_shape=i.cannon_shape,h.userData.faceValues=[];for(const d of i.faces)if(d.materialIndex>=0&&d.materialIndex<c.length){let m=c[d.materialIndex];if(!m||Array.isArray(m)&&m.length===0)continue;h.userData.faceValues.push({normal:d.normal.clone(),value:m})}return h}calculateLabels(t,e){if(t==="d2")return["",e[0],e[1]];if(t==="d4"){const a=e[0],o=e[1],c=e[2],u=e[3];return[[],[],[o,u,c],[a,c,u],[o,a,u],[a,o,c]]}const i=[...e];return t==="d10"||t==="d100"||t==="d14"||t==="d16"||t==="d18"||i.unshift(""),i.unshift(""),i}getGeometry(t,e){if(this.geometryCache[t])return this.geometryCache[t];let i=null;switch(t){case"d2":i=this.create_d2_geometry(e);break;case"d4":i=this.create_d4_geometry(e);break;case"d6":i=this.create_d6_geometry(e);break;case"d8":i=this.create_d8_geometry(e);break;case"d10":i=this.create_d10_geometry(e);break;case"d100":i=this.create_d10_geometry(e);break;case"d12":i=this.create_d12_geometry(e);break;case"d20":i=this.create_d20_geometry(e);break;case"d14":i=this.create_trapezohedron_geometry(e,7);break;case"d16":i=this.create_trapezohedron_geometry(e,8);break;case"d18":i=this.create_trapezohedron_geometry(e,9);break}if(i)return this.geometryCache[t]=i,i;throw new Error(`Failed to create geometry for ${t}`)}createMaterials(t,e,i){const a=[],o=i.labelColor||"#000000",c=this.diceColors.getImage(i.texture),u=c&&c.texture?"#ffffff":"#dddddd",h=i.diceColor||u,d=i.outlineColor||"#000000",m=i.font||"Arial";let p=.5,g=.1;switch(i.material){case"metal":p=.2,g=.8;break;case"wood":p=.8,g=0;break;case"glass":p=.1,g=.1;break;case"plastic":default:p=.5,g=.1;break}for(let v=0;v<e.length;v++){let x=e[v],M=!1;if((!x||Array.isArray(x)&&x.length===0)&&(M=!0),M){a.push(new Qi({color:h,roughness:p,metalness:g,side:zo}));continue}const S=document.createElement("canvas");S.width=256,S.height=256;const w=S.getContext("2d");if(w.fillStyle=h,w.fillRect(0,0,256,256),c&&c.texture){w.globalCompositeOperation="multiply";const Y=i.textureContrast!==void 0?i.textureContrast:1;w.filter=`contrast(${Y})`,w.drawImage(c.texture,0,0,256,256),w.filter="none",w.globalCompositeOperation="source-over"}w.fillStyle=o,w.strokeStyle=d,w.lineWidth=8,w.textAlign="center",w.textBaseline="middle",w.save(),w.translate(128,128);let _=1;m.includes("Faculty")||m.includes("Orbitron")?_=.85:m.includes("IM Fell")&&(_=1.15),(t==="d100"||t==="d80"||t==="d60")&&(_*=.6),t==="d14"?_*=.75:(t==="d16"||t==="d18")&&(_*=.55);const L=Y=>{if(t==="d4"&&Array.isArray(x)){const X=Math.round(60*_);Y.font=`bold ${X}px ${m}`;for(let st=0;st<x.length;st++)Y.strokeText(x[st],0,-256*.3),Y.fillText(x[st],0,-256*.3),Y.rotate(Math.PI*2/3)}else{const X=Math.round(120*_);Y.font=`bold ${X}px ${m}`;let st=0;t==="d8"?st=v%2===0?-7.5:-127.5:t==="d10"?st=-6:t==="d12"?st=5:t==="d20"&&(st=-7.5),st!==0&&Y.rotate(st*Math.PI/180);let V=String(x);(V==="6"||V==="9")&&t!=="d6"&&(V+="."),Y.strokeText(V,0,0),Y.fillText(V,0,0)}};L(w),w.restore();const R=new Uo(S);R.encoding=Jh;let C=R;if(c&&c.bump){const Y=document.createElement("canvas");Y.width=256,Y.height=256;const X=Y.getContext("2d");X.fillStyle="#ffffff",X.fillRect(0,0,256,256),c.bump&&X.drawImage(c.bump,0,0,256,256),X.fillStyle="#000000",X.strokeStyle="#000000",X.lineWidth=8,X.textAlign="center",X.textBaseline="middle",X.save(),X.translate(128,128),L(X),X.restore(),C=new Uo(Y)}const A={map:R,bumpMap:C,bumpScale:.08,roughness:p,metalness:g,flatShading:!0};i.material==="glass"&&(A.transparent=!0,A.opacity=.85,A.side=zo,A.transmission=0);const B=new Sa(A);a.push(B)}return a}create_geom(t,e,i,a,o){return this.make_geom(t,e,i,a,o)}make_geom(t,e,i,a,o){for(var c=new Tn,u=0;u<t.length;++u){var h=new G(t[u][0],t[u][1],t[u][2]).normalize().multiplyScalar(i);h.index=c.vertices.push(h)-1}for(var u=0;u<e.length;++u)for(var d=e[u],m=d.length-1,p=Math.PI*2/m,g=0;g<m-2;++g)c.faces.push(new Jn(d[0],d[g+1],d[g+2],[c.vertices[d[0]],c.vertices[d[g+1]],c.vertices[d[g+2]]],void 0,d[m]+1)),d[m]!==-1?c.faceVertexUvs[0].push([new ht((Math.cos(o)+1+a)/2/(1+a),(Math.sin(o)+1+a)/2/(1+a)),new ht((Math.cos(p*(g+1)+o)+1+a)/2/(1+a),(Math.sin(p*(g+1)+o)+1+a)/2/(1+a)),new ht((Math.cos(p*(g+2)+o)+1+a)/2/(1+a),(Math.sin(p*(g+2)+o)+1+a)/2/(1+a))]):c.faceVertexUvs[0].push([new ht(0,0),new ht(0,0),new ht(0,0)]);if(c.computeFaceNormals(),c.boundingSphere=new Di(new G,i),rm){const v=c.vertices.map(M=>new T(M.x,M.y,M.z)),x=c.faces.map(M=>[M.a,M.b,M.c]);c.cannon_shape=new gi({vertices:v,faces:x})}return c}make_d10_geom(t,e,i,a,o){for(var c=new Tn,u=0;u<t.length;++u){var h=t[u].normalize().multiplyScalar(i);h.index=c.vertices.push(h)-1}for(var u=0;u<e.length;++u)for(var d=e[u],m=d.length-1,p=Math.PI*2/m,g=.65,v=.85,x=1-1*v,M=1-.895/1.105*v,S=1,w=0;w<m-2;++w)c.faces.push(new Jn(d[0],d[w+1],d[w+2],[c.vertices[d[0]],c.vertices[d[w+1]],c.vertices[d[w+2]]],void 0,d[m]+1)),e[u][e[u].length-1]==-1||w>=2?c.faceVertexUvs[0].push([new ht((Math.cos(o)+1+a)/2/(1+a),(Math.sin(o)+1+a)/2/(1+a)),new ht((Math.cos(p*(w+1)+o)+1+a)/2/(1+a),(Math.sin(p*(w+1)+o)+1+a)/2/(1+a)),new ht((Math.cos(p*(w+2)+o)+1+a)/2/(1+a),(Math.sin(p*(w+2)+o)+1+a)/2/(1+a))]):w==0?c.faceVertexUvs[0].push([new ht(.5-g/2,M),new ht(.5,x),new ht(.5+g/2,M)]):w==1&&c.faceVertexUvs[0].push([new ht(.5-g/2,M),new ht(.5+g/2,M),new ht(.5,S)]);if(c.computeFaceNormals(),c.boundingSphere=new Di(new G,i),rm){const _=c.vertices.map(R=>new T(R.x,R.y,R.z)),L=c.faces.map(R=>[R.a,R.b,R.c]);c.cannon_shape=new gi({vertices:_,faces:L})}return c}create_d2_geometry(t){const i=.1*t,a=.05*t,o=t,c=t-a,u=i,h=i-a,d=new Tn;let m=0;const p=(C,A,B)=>(d.vertices.push(new G(C,A,B)),m++),g=p(0,i,0),v=p(0,-i,0),x=m;for(let C=0;C<24;C++){const A=C/24*Math.PI*2;p(Math.cos(A)*c,u,Math.sin(A)*c)}const M=m;for(let C=0;C<24;C++){const A=C/24*Math.PI*2;p(Math.cos(A)*o,h,Math.sin(A)*o)}const S=m;for(let C=0;C<24;C++){const A=C/24*Math.PI*2;p(Math.cos(A)*o,-h,Math.sin(A)*o)}const w=m;for(let C=0;C<24;C++){const A=C/24*Math.PI*2;p(Math.cos(A)*c,-u,Math.sin(A)*c)}const _=new ht(.5,.5),L=(C,A)=>{const B=A/24*Math.PI*2;return new ht(.5-.5*Math.cos(B)*C,.5+.5*Math.sin(B)*C)},R=(C,A)=>{const B=A/24*Math.PI*2;return new ht(.5+.5*Math.cos(B)*C,.5+.5*Math.sin(B)*C)};for(let C=0;C<24;C++){const A=(C+1)%24,B=new Jn(g,x+A,x+C);B.materialIndex=1,d.faces.push(B),d.faceVertexUvs[0].push([_,L(.9,A),L(.9,C)])}for(let C=0;C<24;C++){const A=(C+1)%24,B=x+C,Y=x+A,X=M+C,st=M+A,V=new Jn(B,Y,X);V.materialIndex=1,d.faces.push(V),d.faceVertexUvs[0].push([L(.9,C),L(.9,A),L(1,C)]);const j=new Jn(Y,st,X);j.materialIndex=1,d.faces.push(j),d.faceVertexUvs[0].push([L(.9,A),L(1,A),L(1,C)])}for(let C=0;C<24;C++){const A=(C+1)%24,B=M+C,Y=M+A,X=S+C,st=S+A,V=new Jn(B,X,Y);V.materialIndex=0,d.faces.push(V),d.faceVertexUvs[0].push([new ht(0,1),new ht(0,0),new ht(1,1)]);const j=new Jn(Y,X,st);j.materialIndex=0,d.faces.push(j),d.faceVertexUvs[0].push([new ht(1,1),new ht(0,0),new ht(1,0)])}for(let C=0;C<24;C++){const A=(C+1)%24,B=S+C,Y=S+A,X=w+C,st=w+A,V=new Jn(X,B,st);V.materialIndex=2,d.faces.push(V),d.faceVertexUvs[0].push([R(.9,C),R(1,C),R(.9,A)]);const j=new Jn(B,Y,st);j.materialIndex=2,d.faces.push(j),d.faceVertexUvs[0].push([R(1,C),R(1,A),R(.9,A)])}for(let C=0;C<24;C++){const A=(C+1)%24,B=new Jn(v,C+w,A+w);B.materialIndex=2,d.faces.push(B),d.faceVertexUvs[0].push([_,R(.9,C),R(.9,A)])}if(d.computeFaceNormals(),d.boundingSphere=new Di(new G,t),rm){const C=d.vertices.map(B=>new T(B.x,B.y,B.z)),A=d.faces.map(B=>[B.a,B.b,B.c]);d.cannon_shape=new gi({vertices:C,faces:A})}return d}create_d4_geometry(t){var e=[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],i=[[1,0,2,1],[0,1,3,2],[0,3,2,3],[1,2,3,4]];return this.create_geom(e,i,t,-.1,Math.PI*7/6)}create_d6_geometry(t){var e=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]],i=[[0,3,2,1,1],[1,2,6,5,2],[0,1,5,4,3],[3,7,6,2,4],[0,4,7,3,5],[4,5,6,7,6]];return this.create_geom(e,i,t,.1,Math.PI/4)}create_d8_geometry(t){var e=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],i=[[0,2,4,1],[0,4,3,2],[0,3,5,3],[0,5,2,4],[1,3,4,5],[1,4,2,6],[1,2,5,7],[1,5,3,8]];return this.create_geom(e,i,t,0,-Math.PI/4/2)}create_d10_geometry(t){for(var e=Math.PI*2/10,i=.105,a=[],o=0,c=0;o<10;++o,c+=e)a.push([Math.cos(c),Math.sin(c),i*(o%2?1:-1)]);a.push([0,0,-1]),a.push([0,0,1]);var u=[[5,6,7,11,0],[4,3,2,10,1],[1,2,3,11,2],[0,9,8,10,3],[7,8,9,11,4],[8,7,6,10,5],[9,0,1,11,6],[2,1,0,10,7],[3,4,5,11,8],[6,5,4,10,9]];return this.make_d10_geom(a.map(h=>new G(h[0],h[1],h[2])),u,t,.3,Math.PI)}create_d12_geometry(t){var e=(1+Math.sqrt(5))/2,i=1/e,a=[[0,i,e],[0,i,-e],[0,-i,e],[0,-i,-e],[e,0,i],[e,0,-i],[-e,0,i],[-e,0,-i],[i,e,0],[i,-e,0],[-i,e,0],[-i,-e,0],[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]],o=[[2,14,4,12,0,1],[15,9,11,19,3,2],[16,10,17,7,6,3],[6,7,19,11,18,4],[6,18,2,0,16,5],[18,11,9,14,2,6],[1,17,10,8,13,7],[1,13,5,15,3,8],[13,8,12,4,5,9],[5,4,14,9,15,10],[0,12,8,10,16,11],[3,19,7,17,1,12]];return this.create_geom(a,o,t,.2,-Math.PI/4/2)}create_d20_geometry(t){var e=(1+Math.sqrt(5))/2,i=[[-1,e,0],[1,e,0],[-1,-e,0],[1,-e,0],[0,-1,e],[0,1,e],[0,-1,-e],[0,1,-e],[e,0,-1],[e,0,1],[-e,0,-1],[-e,0,1]],a=[[0,11,5,1],[0,5,1,2],[0,1,7,3],[0,7,10,4],[0,10,11,5],[1,5,9,6],[5,11,4,7],[11,10,2,8],[10,7,6,9],[7,1,8,10],[3,9,4,11],[3,4,2,12],[3,2,6,13],[3,6,8,14],[3,8,9,15],[4,9,5,16],[2,4,11,17],[6,2,10,18],[8,6,7,19],[9,8,1,20]];return this.create_geom(i,a,t,-.2,-Math.PI/4/2)}create_trapezohedron_geometry(t,e){for(var i=e*2,a=.105,o=Math.PI*2/i,c=[],u=0,h=0;u<i;++u,h+=o)c.push([Math.cos(h),Math.sin(h),a*(u%2?1:-1)]);c.push([0,0,-1]),c.push([0,0,1]);var d=[];for(let m=0;m<e;m++){let p=m*2,g=(p-1+i)%i,v=(p+1)%i;d.push([g,p,v,i+1,m])}for(let m=0;m<e;m++){let p=m*2+1,g=(p-1+i)%i,v=(p+1)%i;d.push([v,p,g,i,e+m])}return this.make_d10_geom(c.map(m=>new G(m[0],m[1],m[2])),d,t,.3,Math.PI)}}class Fz{static parse(t){const e=t.toLowerCase().replace(/\s+/g,""),i={groups:[],modifier:0,originalNotation:t};let a=e;!a.startsWith("+")&&!a.startsWith("-")&&(a="+"+a);const o=a.split(/(?=[+-])/).filter(c=>c.trim()!=="");for(const c of o)this.parseToken(c,i);return i}static parseToken(t,e){let i=1,a=t;if(t.startsWith("-")?(i=-1,a=t.substring(1)):t.startsWith("+")&&(a=t.substring(1)),a.includes("d")){const o=a.split("d"),c=o[0];let u=o[1],h=c===""?1:parseInt(c);isNaN(h)&&(h=1),h*=i;let d,m;if(u.includes("kh")){d="highest";const v=u.split("kh");u=v[0];const x=parseInt(v[1]);m=isNaN(x)?1:x}else if(u.includes("kl")){d="lowest";const v=u.split("kl");u=v[0];const x=parseInt(v[1]);m=isNaN(x)?1:x}let p,g="";if(u==="%")p="d%",g="d%";else{const v=parseInt(u);v===66?(p=66,g="d66"):v===88?(p=88,g="d88"):v===100?(p=100,g="d100"):(p=isNaN(v)?6:v,g=`d${p}`)}e.groups.push({count:h,sides:p,type:g,keep:d,keepCount:m})}else{const o=parseInt(a);isNaN(o)||(e.modifier+=o*i)}}}class Hz{diceForge;physicsWorld;scene;activeDice=[];bounds={width:44,depth:28};currentTheme=Cc;currentPhysics=jm;onRollComplete=null;isRolling=!1;currentModifier=0;currentNotation="";currentParseResult=null;spawnOrigin="right";constructor(t,e){this.physicsWorld=t,this.scene=e,this.diceForge=new bn}updateTheme(t){this.currentTheme=t}updatePhysics(t){this.currentPhysics=t}setBounds(t,e){this.bounds={width:t,depth:e}}setSpawnOrigin(t){this.spawnOrigin=t}roll(t){this.clear(),this.isRolling=!0,this.currentNotation=t;const e=Fz.parse(t);this.currentParseResult=e,this.currentModifier=e.modifier;let i=0;e.groups.forEach((a,o)=>{const c=Math.abs(a.count);for(let u=0;u<c;u++)a.type==="d%"?(this.spawnDie("d100",i++,o,"d%_tens"),this.spawnDie("d10",i++,o,"d%_ones")):a.type==="d66"?(this.spawnDie("d60",i++,o,"d66_tens"),this.spawnDie("d6",i++,o,"d66_ones")):a.type==="d88"?(this.spawnDie("d80",i++,o,"d88_tens"),this.spawnDie("d8",i++,o,"d88_ones")):this.spawnDie(a.type,i++,o,a.type)}),this.activeDice.length===0&&(this.isRolling=!1,this.finishRoll())}clear(){this.activeDice.forEach(t=>{this.scene.remove(t.mesh),this.physicsWorld.removeBody(t.body)}),this.activeDice=[],this.isRolling=!1,this.currentModifier=0,this.currentNotation=""}update(){if(!this.isRolling||this.activeDice.length===0)return;let t=!0;this.activeDice.forEach(e=>{if(e.mesh.position.copy(e.body.position),e.mesh.quaternion.copy(e.body.quaternion),!e.stopped){const i=e.body.velocity.lengthSquared(),a=e.body.angularVelocity.lengthSquared();i<.01&&a<.01?(e.stopped=!0,e.result=this.getDieValue(e),console.log(`Die stopped. Result: ${e.result}`)):t=!1}}),t&&this.isRolling&&(this.isRolling=!1,console.log("All dice stopped."),this.finishRoll())}finishRoll(){let t=0;const e=[],i=new Map;this.activeDice.forEach(o=>{i.has(o.groupId)||i.set(o.groupId,[]),i.get(o.groupId).push(o)}),i.forEach((o,c)=>{const u=o[0]?.type||"";if(u.startsWith("d%")){o.sort((h,d)=>h.rollId-d.rollId);for(let h=0;h<o.length;h+=2){const d=o[h],m=o[h+1];if(d&&m){const p=String(d.result),g=String(m.result);let v=parseInt(p.replace("00","0")),x=parseInt(g);isNaN(v)&&(v=0),isNaN(x)&&(x=0);let M=v+x;M===0&&p==="00"&&g==="0"&&(M=100),t+=M,e.push({type:"d%",value:M})}}}else if(u.startsWith("d66")){o.sort((h,d)=>h.rollId-d.rollId);for(let h=0;h<o.length;h+=2){const d=o[h],m=o[h+1];if(d&&m){const p=parseInt(String(d.result))||10,g=parseInt(String(m.result))||1,v=p+g;t+=v,e.push({type:"d66",value:v})}}}else if(u.startsWith("d88")){o.sort((h,d)=>h.rollId-d.rollId);for(let h=0;h<o.length;h+=2){const d=o[h],m=o[h+1];if(d&&m){const p=parseInt(String(d.result))||10,g=parseInt(String(m.result))||1,v=p+g;t+=v,e.push({type:"d88",value:v})}}}else{const h=this.currentParseResult?.groups[o[0].groupId];let d=[];if(o.forEach(m=>{let p=String(m.result),g=parseInt(p);m.type==="d10"&&p==="0"&&(g=10),m.type==="d100"&&p==="00"&&(g=0),isNaN(g)&&(g=0),d.push({die:m,val:g})}),h&&h.keep){h.keep==="highest"?d.sort((p,g)=>g.val-p.val):d.sort((p,g)=>p.val-g.val);const m=h.keepCount||1;d.forEach((p,g)=>{const v=g<m;v&&(t+=p.val),e.push({type:p.die.type,value:p.val,dropped:!v})})}else d.forEach(m=>{t+=m.val,e.push({type:m.die.type,value:m.val,dropped:!1})})}}),t+=this.currentModifier;const a={total:t,notation:this.currentNotation,breakdown:e,modifier:this.currentModifier};this.onRollComplete&&this.onRollComplete(a)}getDieValue(t){const e=t.mesh,i=e.userData.faceValues;if(!i||i.length===0)return"?";const a=new G(0,1,0),o=e.quaternion.clone().invert(),c=a.applyQuaternion(o);if(Array.isArray(i[0].value)){const h=c.clone().negate();let d=null,m=-1/0;for(const x of i){const M=h.dot(x.normal);M>m&&(m=M,d=x)}if(!d)return"?";const p=d.value;return["1","2","3","4"].find(x=>!p.includes(x))||"?"}else{let h=null,d=-1/0;for(const m of i){const p=c.dot(m.normal);p>d&&(d=p,h=m)}return h?h.value:"?"}}spawnDie(t,e,i,a){try{let o=t;a==="d%_tens"&&(o="d100"),a==="d%_ones"&&(o="d10");const c=this.diceForge.createdice(o,this.currentTheme);let u=0,h=0,d=0,m=0,p=0,g=0;const v=(this.currentPhysics.throwForce||40)+Math.random()*5;if(this.spawnOrigin==="bottom"){const _=this.bounds.depth/2-1,L=this.bounds.width/2-4,R=L>0?L*2:5;u=(Math.random()-.5)*R,h=5+Math.random()*2,d=_+Math.random()*2,m=(Math.random()-.5)*5,p=0,g=-v}else{const _=this.bounds.width/2-1,L=this.bounds.depth/2-3,R=L>0?L*2:2;u=_+(Math.random()-.5)*1,h=2+Math.random()*1,d=(Math.random()-.5)*R,m=-v,p=0,g=(Math.random()-.5)*2}c.position.set(u,h,d),c.castShadow=!0;let x=null;c.body_shape?x=c.body_shape:x=new gr(new T(1,1,1));const M=new Ut({mass:1,shape:x,position:new T(u,h,d),material:this.physicsWorld.diceMaterial});M.quaternion.setFromEuler(Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2);const S=new T(m,p,g);M.velocity.copy(S),M.angularVelocity.set((Math.random()-.5)*20,(Math.random()-.5)*20,(Math.random()-.5)*20),this.scene.add(c),this.physicsWorld.addBody(M),this.activeDice.push({mesh:c,body:M,stopped:!1,result:null,groupId:i,type:a,rollId:e})}catch(o){console.error(`Failed to spawn die: ${t}`,o)}}}class Gz{renderer;sceneManager;physicsWorld;rollController;animationId=null;lastTime=0;constructor(t){this.renderer=new mr({alpha:!0,antialias:!0}),this.renderer.setSize(t.clientWidth,t.clientHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=Ym,this.renderer.outputEncoding=Jh,t.appendChild(this.renderer.domElement),this.sceneManager=new jC(this.renderer.domElement),this.physicsWorld=new Uz,this.rollController=new Hz(this.physicsWorld,this.sceneManager.getScene()),window.addEventListener("resize",()=>this.handleResize(t))}start(){this.animationId||(this.lastTime=performance.now(),this.loop())}stop(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null)}updateBounds(t,e){this.physicsWorld.updateBounds(t,e),this.sceneManager.updateDebugBounds(t,e),this.rollController.setBounds(t,e)}fitBoundsToScreen(){const{width:t,depth:e}=this.sceneManager.getVisibleBounds(),i=0,a=0;return this.updateBounds(t+i,e+a),{width:t+i,depth:e+a}}setDebugVisibility(t){this.sceneManager.setDebugVisibility(t)}updateSettings(t){this.rollController.updateTheme(t.theme),this.rollController.updatePhysics(t.physics),this.physicsWorld.setGravity(t.physics.gravity),this.physicsWorld.setSurface(t.physics.surface),ya.getInstance().setVolume(t.soundVolume)}destroy(){this.stop(),this.renderer.domElement.parentElement&&this.renderer.domElement.parentElement.removeChild(this.renderer.domElement)}loop=()=>{const t=performance.now(),e=(t-this.lastTime)/1e3;this.lastTime=t,this.physicsWorld.step(e),this.rollController.update(),this.renderer.render(this.sceneManager.getScene(),this.sceneManager.getCamera()),this.animationId=requestAnimationFrame(this.loop)};handleResize(t){const e=t.clientWidth,i=t.clientHeight;this.renderer.setSize(e,i),this.sceneManager.updateCamera(e,i)}}const b1=_e.createContext(null),Vz=({children:n})=>{const[t,e]=_e.useState(()=>{const u=localStorage.getItem("anvil_dice_settings"),h={theme:Cc,physics:jm,soundVolume:.5};if(u){const d=JSON.parse(u);return{...h,...d}}return h});_e.useEffect(()=>{localStorage.setItem("anvil_dice_settings",JSON.stringify(t))},[t]);const i=u=>{e(h=>({...h,theme:{...h.theme,...u}}))},a=u=>{e(h=>({...h,physics:{...h.physics,...u}}))},o=u=>{e(h=>({...h,soundVolume:Math.max(0,Math.min(1,u))}))},c=()=>{e({theme:Cc,physics:jm,soundVolume:.5})};return rt.jsx(b1.Provider,{value:{settings:t,updateTheme:i,updatePhysics:a,setSoundVolume:o,resetSettings:c},children:n})},og=()=>{const n=_e.useContext(b1);if(!n)throw new Error("useSettings must be used within SettingsProvider");return n},kz=()=>{const n=_e.useRef(null),{settings:t}=og(),e=_e.useRef(null),i=_e.useRef(null),a=_e.useRef(null),o=_e.useRef(null),c=_e.useRef(null);return _e.useEffect(()=>{if(!n.current)return;const u=new tf;e.current=u;const h=new on(45,1,.1,100);h.position.set(0,1.5,2.5),h.lookAt(0,0,0),i.current=h;const d=new mr({alpha:!0,antialias:!0});d.setSize(200,200),d.setPixelRatio(window.devicePixelRatio),n.current.appendChild(d.domElement),a.current=d;const m=new Ac(16777215,.7);u.add(m);const p=new Ea(16777215,1.2);p.position.set(5,10,5),u.add(p);const g=new Ea(16777215,.5);g.position.set(-5,5,-5),u.add(g),c.current=new bn;let v;const x=()=>{o.current&&(o.current.rotation.y+=.01,o.current.rotation.x+=.005),d.render(u,h),v=requestAnimationFrame(x)};return x(),()=>{cancelAnimationFrame(v),d.domElement.parentNode&&d.domElement.parentNode.removeChild(d.domElement),d.dispose()}},[]),_e.useEffect(()=>{if(!(!e.current||!c.current)){o.current&&(e.current.remove(o.current),o.current.geometry&&o.current.geometry.dispose(),Array.isArray(o.current.material)?o.current.material.forEach(u=>u.dispose()):o.current.material.dispose());try{const u=c.current.createdice("d20",t.theme);e.current.add(u),o.current=u}catch(u){console.error("Failed to generate preview dice",u)}}},[t.theme]),rt.jsx("div",{ref:n,style:{width:"200px",height:"200px",margin:"0 auto"}})},Wz=({isOpen:n,onClose:t,textures:e,boundsWidth:i,setBoundsWidth:a,boundsDepth:o,setBoundsDepth:c,isAutoFit:u,setIsAutoFit:h,onUpdateBounds:d})=>{const{settings:m,updateTheme:p,updatePhysics:g,setSoundVolume:v,resetSettings:x}=og(),[M,S]=_e.useState("appearance");if(!n)return null;const w=_=>{g({surface:_})};return rt.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.85)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:rt.jsxs("div",{style:{width:"800px",height:"600px",backgroundColor:"#222",borderRadius:"12px",border:"1px solid #444",display:"flex",flexDirection:"column",boxShadow:"0 10px 30px rgba(0,0,0,0.5)",color:"#eee",fontFamily:"sans-serif"},children:[rt.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #333",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[rt.jsx("h2",{style:{margin:0},children:"Dice Settings"}),rt.jsx("button",{onClick:t,style:{background:"transparent",border:"none",color:"#888",fontSize:"24px",cursor:"pointer"},children:""})]}),rt.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #333"},children:[rt.jsx("button",{onClick:()=>S("appearance"),style:{flex:1,padding:"15px",background:M==="appearance"?"#333":"transparent",border:"none",color:M==="appearance"?"white":"#888",cursor:"pointer",fontWeight:"bold"},children:"Appearance"}),rt.jsx("button",{onClick:()=>S("behavior"),style:{flex:1,padding:"15px",background:M==="behavior"?"#333":"transparent",border:"none",color:M==="behavior"?"white":"#888",cursor:"pointer",fontWeight:"bold"},children:"Behavior"})]}),rt.jsxs("div",{style:{flex:1,padding:"30px",overflowY:"auto",display:"flex",gap:"30px"},children:[M==="appearance"&&rt.jsxs(rt.Fragment,{children:[rt.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"20px"},children:[rt.jsxs("div",{children:[rt.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#aaa"},children:"Texture"}),rt.jsx("select",{value:m.theme.texture,onChange:_=>p({texture:_.target.value}),style:{width:"100%",padding:"10px",background:"#333",border:"1px solid #555",color:"white",borderRadius:"6px"},children:e.map(_=>rt.jsx("option",{value:_,children:_},_))})]}),rt.jsxs("div",{children:[rt.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#aaa"},children:"Material"}),rt.jsxs("select",{value:m.theme.material,onChange:_=>p({material:_.target.value}),style:{width:"100%",padding:"10px",background:"#333",border:"1px solid #555",color:"white",borderRadius:"6px"},children:[rt.jsx("option",{value:"plastic",children:"Plastic"}),rt.jsx("option",{value:"metal",children:"Metal"}),rt.jsx("option",{value:"wood",children:"Wood"}),rt.jsx("option",{value:"glass",children:"Glass"})]})]}),rt.jsxs("div",{children:[rt.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#aaa"},children:"Font"}),rt.jsxs("select",{value:m.theme.font,onChange:_=>p({font:_.target.value}),style:{width:"100%",padding:"10px",background:"#333",border:"1px solid #555",color:"white",borderRadius:"6px",fontFamily:m.theme.font},children:[rt.jsx("option",{value:"Arial",children:"Arial (Default)"}),rt.jsx("option",{value:"Cinzel",children:"Cinzel"}),rt.jsx("option",{value:"Faculty Glyphic",children:"Faculty Glyphic"}),rt.jsx("option",{value:"IM Fell English SC",children:"IM Fell English SC"}),rt.jsx("option",{value:"Orbitron",children:"Orbitron"}),rt.jsx("option",{value:"Oxanium",children:"Oxanium"}),rt.jsx("option",{value:"Teko",children:"Teko"}),rt.jsx("option",{value:"Unica One",children:"Unica One"}),rt.jsx("option",{value:"Valkyrie",children:"Valkyrie"})]})]}),rt.jsxs("div",{style:{display:"flex",gap:"10px"},children:[rt.jsxs("div",{style:{flex:1},children:[rt.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#aaa",fontSize:"12px"},children:"Dice Color"}),rt.jsx("input",{type:"color",value:m.theme.diceColor,onChange:_=>p({diceColor:_.target.value}),style:{width:"100%",height:"40px",cursor:"pointer"}})]}),rt.jsxs("div",{style:{flex:1},children:[rt.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#aaa",fontSize:"12px"},children:"Label Color"}),rt.jsx("input",{type:"color",value:m.theme.labelColor,onChange:_=>p({labelColor:_.target.value}),style:{width:"100%",height:"40px",cursor:"pointer"}})]}),rt.jsxs("div",{style:{flex:1},children:[rt.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#aaa",fontSize:"12px"},children:"Outline"}),rt.jsx("input",{type:"color",value:m.theme.outlineColor,onChange:_=>p({outlineColor:_.target.value}),style:{width:"100%",height:"40px",cursor:"pointer"}})]})]}),rt.jsxs("div",{style:{display:"flex",gap:"10px"},children:[rt.jsxs("div",{style:{flex:1},children:[rt.jsxs("label",{style:{display:"block",marginBottom:"8px",color:"#aaa"},children:["Scale: ",m.theme.scale.toFixed(1),"x"]}),rt.jsx("input",{type:"range",min:"0.6",max:"1.5",step:"0.1",value:m.theme.scale,onChange:_=>p({scale:parseFloat(_.target.value)}),style:{width:"100%"}})]}),rt.jsxs("div",{style:{flex:1},children:[rt.jsxs("label",{style:{display:"block",marginBottom:"8px",color:"#aaa"},children:["Contrast: ",(m.theme.textureContrast||1).toFixed(1)]}),rt.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:m.theme.textureContrast||1,onChange:_=>p({textureContrast:parseFloat(_.target.value)}),style:{width:"100%"}})]})]})]}),rt.jsxs("div",{style:{width:"300px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#111",borderRadius:"12px"},children:[rt.jsx(kz,{}),rt.jsx("div",{style:{marginTop:"10px",color:"#666",fontSize:"12px"},children:"Live Preview (D20)"})]})]}),M==="behavior"&&rt.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"30px"},children:[rt.jsxs("div",{children:[rt.jsx("label",{style:{display:"block",marginBottom:"15px",color:"#aaa"},children:"Surface Material (Friction & Bounce)"}),rt.jsx("div",{style:{display:"flex",gap:"15px"},children:["felt","wood","rubber","glass"].map(_=>rt.jsx("button",{onClick:()=>w(_),style:{flex:1,padding:"20px",background:m.physics.surface===_?"#4a90e2":"#333",border:"1px solid #555",borderRadius:"8px",color:"white",cursor:"pointer",textTransform:"capitalize",fontSize:"16px"},children:_},_))})]}),rt.jsxs("div",{children:[rt.jsxs("label",{style:{display:"block",marginBottom:"8px",color:"#aaa"},children:["Throw Force: ",m.physics.throwForce]}),rt.jsx("input",{type:"range",min:"20",max:"80",step:"5",value:m.physics.throwForce,onChange:_=>g({throwForce:parseInt(_.target.value)}),style:{width:"100%"}}),rt.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"5px"},children:"Higher force = faster, harder rolls."})]}),rt.jsxs("div",{children:[rt.jsxs("label",{style:{display:"block",marginBottom:"8px",color:"#aaa"},children:["Gravity: ",m.physics.gravity.toFixed(1)]}),rt.jsx("input",{type:"range",min:"5",max:"20",step:"0.1",value:m.physics.gravity,onChange:_=>g({gravity:parseFloat(_.target.value)}),style:{width:"100%"}}),rt.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"5px"},children:"Standard Earth gravity is 9.8."})]}),rt.jsxs("div",{children:[rt.jsxs("label",{style:{display:"block",marginBottom:"8px",color:"#aaa"},children:["Master Volume: ",Math.round(m.soundVolume*100),"%"]}),rt.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:m.soundVolume,onChange:_=>v(parseFloat(_.target.value)),style:{width:"100%"}}),rt.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"5px"},children:"Adjust sound effects volume (0 to mute)."})]}),rt.jsxs("div",{style:{borderTop:"1px solid #444",paddingTop:"20px",marginTop:"10px"},children:[rt.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"15px"},children:[rt.jsx("h3",{style:{margin:0,fontSize:"16px",color:"#white"},children:"Simulation Bounds"}),rt.jsxs("label",{style:{fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",color:"#aaa"},children:[rt.jsx("input",{type:"checkbox",checked:u,onChange:_=>h(_.target.checked)}),"Auto-Fit to Screen"]})]}),rt.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"center"},children:[rt.jsxs("div",{children:[rt.jsx("label",{style:{marginRight:"10px",color:"#aaa"},children:"Width:"}),rt.jsx("input",{type:"number",value:i,onChange:_=>a(Number(_.target.value)),disabled:u,style:{width:"60px",padding:"10px",borderRadius:"6px",background:"#333",border:"1px solid #555",color:"white",opacity:u?.5:1}})]}),rt.jsxs("div",{children:[rt.jsx("label",{style:{marginRight:"10px",color:"#aaa"},children:"Depth:"}),rt.jsx("input",{type:"number",value:o,onChange:_=>c(Number(_.target.value)),disabled:u,style:{width:"60px",padding:"10px",borderRadius:"6px",background:"#333",border:"1px solid #555",color:"white",opacity:u?.5:1}})]}),rt.jsx("button",{onClick:d,disabled:u,style:{padding:"10px 20px",background:"#555",border:"none",color:"white",borderRadius:"6px",cursor:u?"default":"pointer",opacity:u?.5:1},children:"Update Bounds"})]}),rt.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"10px"},children:"Defines the invisible walls around the dice."})]})]})]}),rt.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #333",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[rt.jsx("button",{onClick:x,style:{padding:"10px 20px",background:"transparent",border:"1px solid #555",color:"#aaa",borderRadius:"6px",cursor:"pointer"},children:"Reset Defaults"}),rt.jsx("button",{onClick:t,style:{padding:"10px 30px",background:"#4a90e2",border:"none",color:"white",borderRadius:"6px",cursor:"pointer",fontWeight:"bold"},children:"Done"})]})]})})},jz=({engine:n})=>{const{settings:t}=og();return _e.useEffect(()=>{n&&n.updateSettings(t)},[n,t]),null};function qz({isOpen:n,onClose:t}){const e=_e.useRef(null);return _e.useEffect(()=>{if(!n||!e.current)return;const i=new tf;i.background=new Wt("#222");const a=new on(45,e.current.clientWidth/e.current.clientHeight,.1,100);a.position.set(0,5,10),a.lookAt(0,0,0);const o=new mr({antialias:!0,alpha:!0});o.setSize(e.current.clientWidth,e.current.clientHeight),o.shadowMap.enabled=!0,o.shadowMap.type=Ym,e.current.appendChild(o.domElement);const c=new Ac(16777215,.6);i.add(c);const u=new Ea(16777215,1);u.position.set(5,10,5),u.castShadow=!0,i.add(u);const h=new Ea(16777215,.5);h.position.set(-5,0,-5),i.add(h);const d=new Wo(a,o.domElement);d.enableDamping=!0,d.dampingFactor=.05;const m=new bn,p=["d14","d16","d18"],g=3.5,v=[];p.forEach((w,_)=>{try{const L=m.createdice(w,Cc),R=(_-1)*g;L.position.set(R,0,0),i.add(L),v.push(L)}catch(L){console.error(`Failed to inspect ${w}`,L)}});const x=new K_(20,20,5592405,3355443);x.position.y=-1.5,i.add(x);let M;const S=()=>{M=requestAnimationFrame(S),d.update(),o.render(i,a)};return S(),()=>{cancelAnimationFrame(M),e.current&&e.current.removeChild(o.domElement),o.dispose(),d.dispose()}},[n]),n?rt.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:rt.jsxs("div",{style:{width:"800px",height:"600px",background:"#1a1a1a",borderRadius:"8px",border:"1px solid #444",position:"relative",display:"flex",flexDirection:"column"},children:[rt.jsxs("div",{style:{padding:"10px",borderBottom:"1px solid #444",display:"flex",justifyContent:"space-between",alignItems:"center",background:"#222",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},children:[rt.jsx("h3",{style:{margin:0,color:"white"},children:"Dice Inspector: Trapezohedrons"}),rt.jsx("button",{onClick:t,style:{background:"#d44",color:"white",border:"none",borderRadius:"4px",padding:"5px 10px",cursor:"pointer"},children:"Close"})]}),rt.jsx("div",{ref:e,style:{flex:1,overflow:"hidden",position:"relative"},children:rt.jsxs("div",{style:{position:"absolute",bottom:10,left:0,right:0,textAlign:"center",color:"#888",pointerEvents:"none"},children:["Left: d14 | Center: d16 | Right: d18 ",rt.jsx("br",{}),rt.jsx("span",{style:{fontSize:"12px"},children:"Click & Drag to Rotate  Scroll to Zoom"})]})})]})}):null}function Yz(){const n=_e.useRef(null),t=_e.useRef(null),[e,i]=_e.useState("4d6"),[a,o]=_e.useState(44),[c,u]=_e.useState(28),[h,d]=_e.useState(!0),[m,p]=_e.useState(null),[g,v]=_e.useState(!1),[x,M]=_e.useState(!1),[S,w]=_e.useState(!1),[_,L]=_e.useState(!1);_e.useEffect(()=>{if(!n.current)return;const j=new Gz(n.current);return j.rollController.onRollComplete=I=>{p(I),v(!1)},j.start(),t.current=j,j.setDebugVisibility(!1),new x1,()=>{j.destroy()}},[]),_e.useEffect(()=>{const j=()=>{const I=window.matchMedia("(max-width: 768px)").matches;M(I),t.current&&t.current.rollController.setSpawnOrigin(I?"bottom":"right")};return j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]),_e.useEffect(()=>{const j=()=>{if(h&&t.current){const{width:I,depth:H}=t.current.fitBoundsToScreen();o(Math.floor(I)),u(Math.floor(H))}};return window.addEventListener("resize",j),h&&t.current&&setTimeout(j,100),()=>window.removeEventListener("resize",j)},[h]);const R=()=>{if(e.trim()&&t.current){v(!0),p(null);try{t.current.rollController.roll(e)}catch(j){console.error("Roll failed:",j),v(!1)}}},C=()=>{t.current&&(t.current.rollController.clear(),p(null),i(""),v(!1))},A=()=>{t.current&&(t.current.updateBounds(a,c),d(!1))},B=j=>{const I=e.trim();if(!I){i(`1${j}`);return}const H=j.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),U=new RegExp(`(\\d+)${H}$`),z=I.match(U);if(z&&z.index!==void 0){const Q=parseInt(z[1],10),$=I.substring(0,z.index);i(`${$}${Q+1}${j}`);return}I.match(/[+-]$/)?i(`${I} 1${j}`):i(`${I} + 1${j}`)},Y=j=>{const I=e.trim(),H=I.match(/([+-])\s*(\d+)$/);if(H){const U=H[1]==="-"?-1:1,z=parseInt(H[2]),Q=U*z+j,$=I.substring(0,H.index),it=Q>=0?"+":"-";i(`${$}${it} ${Math.abs(Q)}`)}else{const U=j>=0?"+":"-";i(`${I} ${U} ${Math.abs(j)}`)}},X=j=>{i(I=>I.trim()+j)},st=Object.keys(xo),V={background:"#444",color:"#fff",border:"1px solid #555",borderRadius:"4px",cursor:"pointer",padding:"4px 0px",fontWeight:"bold",fontSize:"13px",flex:1};return rt.jsxs("div",{ref:n,style:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},children:[rt.jsx(jz,{engine:t.current}),rt.jsx(Wz,{isOpen:S,onClose:()=>w(!1),textures:st,boundsWidth:a,setBoundsWidth:o,boundsDepth:c,setBoundsDepth:u,isAutoFit:h,setIsAutoFit:d,onUpdateBounds:A}),rt.jsx(qz,{isOpen:_,onClose:()=>L(!1)}),rt.jsxs("div",{style:{position:"absolute",top:x?"auto":20,bottom:x?20:"auto",left:x?"50%":20,transform:x?"translateX(-50%)":"none",width:x?"90%":"320px",color:"white",backgroundColor:"rgba(0,0,0,0.7)",backdropFilter:"blur(5px)",padding:"15px",borderRadius:"12px",fontFamily:"sans-serif",zIndex:10,display:"flex",flexDirection:"column",gap:"8px",boxShadow:"0 4px 15px rgba(0,0,0,0.5)"},children:[rt.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[rt.jsxs("h2",{style:{margin:0,fontSize:"18px",display:"flex",alignItems:"center",gap:"8px"},children:[rt.jsx("span",{children:""})," Anvil Dice"]}),rt.jsxs("div",{style:{display:"flex",gap:"5px"},children:[rt.jsx("button",{onClick:()=>L(!0),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"16px",padding:"4px"},title:"Inspect New Dice",children:""}),rt.jsx("button",{onClick:()=>w(!0),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"20px",padding:"4px"},title:"Settings",children:""})]})]}),rt.jsxs("div",{style:{display:"flex",gap:"8px"},children:[rt.jsx("input",{type:"text",value:e,onChange:j=>i(j.target.value),placeholder:"e.g. 4d6",style:{flex:1,padding:"8px",borderRadius:"4px",border:"1px solid #555",background:"#222",color:"white",fontSize:"16px"}}),rt.jsx("button",{onClick:R,disabled:g,style:{...V,background:g?"#555":"#4a90e2",border:"none",flex:.4,padding:"8px"},children:g?"...":"ROLL"})]}),rt.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"stretch"},children:[rt.jsxs("div",{style:{flex:1,background:"rgba(0,0,0,0.3)",borderRadius:"4px",padding:"8px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[rt.jsx("span",{style:{color:"#aaa",fontSize:"12px"},children:"RESULT"}),rt.jsx("span",{style:{color:"#ffd700",fontSize:"20px",fontWeight:"bold"},children:m?m.total:"-"})]}),rt.jsx("button",{onClick:C,style:{...V,background:"#333",flex:.3,fontSize:"12px",padding:"8px"},children:"CLEAR"})]}),m&&rt.jsxs("div",{style:{fontSize:"12px",color:"#888",display:"flex",flexWrap:"wrap",gap:"4px",maxHeight:"60px",overflowY:"auto"},children:[m.breakdown.map((j,I)=>rt.jsx("span",{style:{background:j.dropped?"#422":"#333",color:j.dropped?"#888":"#eee",textDecoration:j.dropped?"line-through":"none",padding:"2px 5px",borderRadius:"3px"},children:j.value},I)),m.modifier!==0&&rt.jsxs("span",{style:{background:"#334",padding:"2px 5px",borderRadius:"3px",color:"#aaf"},children:[m.modifier>0?"+":"",m.modifier]})]}),rt.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:"4px"},children:["d4","d6","d8","d10","d12","d20"].map(j=>rt.jsx("button",{onClick:()=>B(j),style:V,children:j},j))}),rt.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px"},children:[rt.jsx("button",{onClick:()=>B("d2"),style:V,children:"d2"}),rt.jsx("button",{onClick:()=>B("d%"),style:V,children:"d%"}),rt.jsx("button",{onClick:()=>B("d66"),style:V,children:"d66"}),rt.jsx("button",{onClick:()=>B("d88"),style:V,children:"d88"}),rt.jsx("button",{onClick:()=>B("d14"),style:V,children:"d14"}),rt.jsx("button",{onClick:()=>B("d16"),style:V,children:"d16"}),rt.jsx("button",{onClick:()=>B("d18"),style:V,children:"d18"})]}),rt.jsxs("div",{style:{display:"flex",gap:"5px"},children:[rt.jsx("button",{onClick:()=>Y(1),style:{...V,background:"#3a5"},children:"+"}),rt.jsx("button",{onClick:()=>X("kh"),style:V,title:"Keep Highest",children:"ADV"}),rt.jsx("button",{onClick:()=>X("kl"),style:V,title:"Keep Lowest",children:"DIS"}),rt.jsx("button",{onClick:()=>Y(-1),style:{...V,background:"#d44"},children:"-"})]})]})]})}function Xz(){return rt.jsx(Vz,{children:rt.jsx(Yz,{})})}GM.createRoot(document.getElementById("root")).render(rt.jsx(BM.StrictMode,{children:rt.jsx(Xz,{})}));
